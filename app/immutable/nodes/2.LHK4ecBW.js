const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/quill.Bk4jDS0q.js","../chunks/core.CG__ofcG.js"])))=>i.map(i=>d[i]);
var Lt=Object.defineProperty;var xt=(e,t,n)=>t in e?Lt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var B=(e,t,n)=>xt(e,typeof t!="symbol"?t+"":t,n);import{s as De,n as fe,r as vt,e as ke,f as Ze,c as se,a as de,o as $e,z as Dt,d as ne,A as Ct,B as It}from"../chunks/scheduler.Cbw2My0d.js";import{S as Ce,i as Ie,e as H,b as Mt,c as A,d as O,f as Yt,g as X,w as Y,A as W,j as $,k as I,x as ie,G as je,l as Xt,s as j,v as ue,h as G,z as et,a as U,o as me,t as F,n as ve,I as Ee,p as be,q as pe,r as ye,u as we,J as Pt,m as Te}from"../chunks/index.s-tUku1V.js";import{e as _e,u as Ke,o as Qe}from"../chunks/each.B7A4Ty6x.js";import{b as z}from"../chunks/paths.ToY6vlHV.js";import{m as he,a as bt,t as ae,f as St,d as oe,s as Ht}from"../chunks/firebaseStore.BXU8qJOB.js";import{c as ge,s as Le,S as At}from"../chunks/Spinner.BephAqbH.js";import{_ as tt}from"../chunks/preload-helper.D6kgxu3v.js";function Rt(e){let t,n,i,s,c,u;return{c(){t=H("div"),n=H("button"),i=H("span"),s=Mt(e[0]),this.h()},l(o){t=A(o,"DIV",{class:!0});var l=O(t);n=A(l,"BUTTON",{class:!0,draggable:!0});var h=O(n);i=A(h,"SPAN",{class:!0});var d=O(i);s=Yt(d,e[0]),d.forEach(X),h.forEach(X),l.forEach(X),this.h()},h(){Y(i,"class","title svelte-w1fi59"),Y(n,"class","tab svelte-w1fi59"),Y(n,"draggable","true"),W(n,"active",e[1]),Y(t,"class","tab-container svelte-w1fi59"),W(t,"preventHover",e[2])},m(o,l){$(o,t,l),I(t,n),I(n,i),I(i,s),c||(u=[ie(n,"mousedown",je(function(){ke(e[3])&&e[3].apply(this,arguments)})),ie(n,"touchstart",je(function(){ke(e[3])&&e[3].apply(this,arguments)})),ie(n,"dragstart",je(function(){ke(e[4])&&e[4].apply(this,arguments)}))],c=!0)},p(o,[l]){e=o,l&1&&Xt(s,e[0]),l&2&&W(n,"active",e[1]),l&4&&W(t,"preventHover",e[2])},i:fe,o:fe,d(o){o&&X(t),c=!1,vt(u)}}}function qt(e,t,n){let{title:i=""}=t,{active:s=!1}=t,{preventHover:c=!1}=t,{onPointerdown:u=l=>{}}=t,{onDragstart:o=l=>{}}=t;return e.$$set=l=>{"title"in l&&n(0,i=l.title),"active"in l&&n(1,s=l.active),"preventHover"in l&&n(2,c=l.preventHover),"onPointerdown"in l&&n(3,u=l.onPointerdown),"onDragstart"in l&&n(4,o=l.onDragstart)},[i,s,c,u,o]}class pt extends Ce{constructor(t){super(),Ie(this,t,qt,Rt,De,{title:0,active:1,preventHover:2,onPointerdown:3,onDragstart:4})}}const nt=(e,t)=>{const{duration:n=300,easing:i=ge,onEnd:s=()=>{},onStep:c=()=>{},css:u}=t;let o;function l(h){if(!e){console.warn("Cannot find element to animate");return}o===void 0&&(o=h);const d=i((h-o)/n),x=1-d;d<1?(e.style.cssText=u(d,x),c(d,x),requestAnimationFrame(l)):(e.style.cssText="",s())}requestAnimationFrame(l)},Ge=e=>{const{duration:t=300,easing:n=ge,onEnd:i=()=>{},onStep:s=()=>{}}=e;let c;function u(o){c===void 0&&(c=o);const l=n((o-c)/t),h=1-l;l<1?(s(l,h),requestAnimationFrame(u)):i()}requestAnimationFrame(u)};function it(e){let t,n,i=`<span class="button-icon svelte-8kqmh1" style="-webkit-mask: url(${z}/images/svg/undo.svg) no-repeat center / contain; mask: url(${z}/images/svg/undo.svg) no-repeat center / contain;"></span>`,s,c,u,o,l,h;return{c(){t=H("div"),n=H("button"),n.innerHTML=i,s=j(),c=H("input"),this.h()},l(d){t=A(d,"DIV",{class:!0});var x=O(t);n=A(x,"BUTTON",{class:!0,"data-svelte-h":!0}),ue(n)!=="svelte-1b4fip4"&&(n.innerHTML=i),s=G(x),c=A(x,"INPUT",{type:!0}),x.forEach(X),this.h()},h(){Y(n,"class","button svelte-8kqmh1"),Y(c,"type","number"),Y(t,"class","pencil-tools svelte-8kqmh1")},m(d,x){$(d,t,x),I(t,n),I(t,s),I(t,c),o=!0,l||(h=ie(n,"click",function(){ke(e[2])&&e[2].apply(this,arguments)}),l=!0)},p(d,x){e=d},i(d){o||(d&&Ze(()=>{o&&(u||(u=Ee(t,Le,{duration:200,axis:"x"},!0)),u.run(1))}),o=!0)},o(d){d&&(u||(u=Ee(t,Le,{duration:200,axis:"x"},!1)),u.run(0)),o=!1},d(d){d&&X(t),d&&u&&u.end(),l=!1,h()}}}function Vt(e){let t,n,i=`<span class="button-icon svelte-8kqmh1" style="-webkit-mask: url(${z}/images/svg/pencil.svg) no-repeat center / contain; mask: url(${z}/images/svg/pencil.svg) no-repeat center / contain;"></span>`,s,c,u,o,l,h=`<span class="button-icon svelte-8kqmh1" style="-webkit-mask: url(${z}/images/svg/trash.svg) no-repeat center / contain; mask: url(${z}/images/svg/trash.svg) no-repeat center / contain;"></span>`,d,x,S,q,V,y,w=`<span class="button-icon svelte-8kqmh1" style="-webkit-mask: url(${z}/images/svg/user.svg) no-repeat center / contain; mask: url(${z}/images/svg/user.svg) no-repeat center / contain;"></span>`,m,g,k=`<span class="button-icon svelte-8kqmh1" style="-webkit-mask: url(${z}/images/svg/maximize.svg) no-repeat center / contain; mask: url(${z}/images/svg/maximize.svg) no-repeat center / contain;"></span>`,p,D,P,T,E=e[3].activeTool==="pencil"&&it(e);return{c(){t=H("div"),n=H("button"),n.innerHTML=i,s=j(),E&&E.c(),c=j(),u=H("div"),o=j(),l=H("button"),l.innerHTML=h,d=j(),x=H("button"),S=H("span"),V=j(),y=H("a"),y.innerHTML=w,m=j(),g=H("button"),g.innerHTML=k,this.h()},l(b){t=A(b,"DIV",{class:!0});var v=O(t);n=A(v,"BUTTON",{class:!0,"data-svelte-h":!0}),ue(n)!=="svelte-t1zbc2"&&(n.innerHTML=i),s=G(v),E&&E.l(v),c=G(v),u=A(v,"DIV",{class:!0}),O(u).forEach(X),o=G(v),l=A(v,"BUTTON",{class:!0,"data-svelte-h":!0}),ue(l)!=="svelte-cbr57k"&&(l.innerHTML=h),d=G(v),x=A(v,"BUTTON",{class:!0});var R=O(x);S=A(R,"SPAN",{class:!0,style:!0}),O(S).forEach(X),R.forEach(X),V=G(v),y=A(v,"A",{class:!0,href:!0,"data-svelte-h":!0}),ue(y)!=="svelte-1xuhzhs"&&(y.innerHTML=w),m=G(v),g=A(v,"BUTTON",{class:!0,"data-svelte-h":!0}),ue(g)!=="svelte-siuh87"&&(g.innerHTML=k),v.forEach(X),this.h()},h(){Y(n,"class","pencil button svelte-8kqmh1"),W(n,"selected",e[3].activeTool==="pencil"),Y(u,"class","spacer svelte-8kqmh1"),Y(l,"class","close button svelte-8kqmh1"),Y(S,"class","button-icon svelte-8kqmh1"),et(S,"-webkit-mask","url("+z+"/images/svg/refresh.svg) no-repeat center / contain"),et(S,"mask","url("+z+"/images/svg/refresh.svg) no-repeat center / contain"),Y(x,"class","refresh button svelte-8kqmh1"),x.disabled=q=e[4].savingStatus==="saving",Y(y,"class","button svelte-8kqmh1"),Y(y,"href",z+"/profile"),Y(g,"class","button svelte-8kqmh1"),Y(t,"class","toolbar-container svelte-8kqmh1")},m(b,v){$(b,t,v),I(t,n),I(t,s),E&&E.m(t,null),I(t,c),I(t,u),I(t,o),I(t,l),I(t,d),I(t,x),I(x,S),I(t,V),I(t,y),I(t,m),I(t,g),D=!0,P||(T=[ie(n,"click",e[5]),ie(l,"click",function(){ke(e[1])&&e[1].apply(this,arguments)}),ie(x,"click",function(){ke(e[0])&&e[0].apply(this,arguments)}),ie(g,"click",e[6])],P=!0)},p(b,[v]){e=b,(!D||v&8)&&W(n,"selected",e[3].activeTool==="pencil"),e[3].activeTool==="pencil"?E?(E.p(e,v),v&8&&U(E,1)):(E=it(e),E.c(),U(E,1),E.m(t,c)):E&&(me(),F(E,1,1,()=>{E=null}),ve()),(!D||v&16&&q!==(q=e[4].savingStatus==="saving"))&&(x.disabled=q)},i(b){D||(U(E),b&&Ze(()=>{D&&(p||(p=Ee(t,Le,{duration:200},!0)),p.run(1))}),D=!0)},o(b){F(E),b&&(p||(p=Ee(t,Le,{duration:200},!1)),p.run(0)),D=!1},d(b){b&&X(t),E&&E.d(),b&&p&&p.end(),P=!1,vt(T)}}}function Ot(e,t,n){let i,s;se(e,he,d=>n(3,i=d)),se(e,bt,d=>n(4,s=d));let{onRefresh:c=()=>{}}=t,{onClose:u=()=>{}}=t,{onDrawingUndo:o=()=>{}}=t;const l=()=>{de(he,i.activeTool=i.activeTool==="pencil"?void 0:"pencil",i)},h=()=>{de(he,i.toolbarVisible=!1,i),de(he,i.activeTool=void 0,i)};return e.$$set=d=>{"onRefresh"in d&&n(0,c=d.onRefresh),"onClose"in d&&n(1,u=d.onClose),"onDrawingUndo"in d&&n(2,o=d.onDrawingUndo)},[c,u,o,i,s,l,h]}class Bt extends Ce{constructor(t){super(),Ie(this,t,Ot,Vt,De,{onRefresh:0,onClose:1,onDrawingUndo:2})}}const st=500,Ut=300,lt=500,Nt=300;class Wt{constructor(){B(this,"isMoving",!1);B(this,"isLongclick",!1);B(this,"button",0);B(this,"lastX",0);B(this,"lastY",0);B(this,"consecutiveClicks",0);B(this,"lastMouseupTime",0);B(this,"activeElement",null);this.reset()}reset(){this.isMoving=!1,this.isLongclick=!1,this.button=0,this.lastX=0,this.lastY=0,this.consecutiveClicks=0,this.lastMouseupTime=0,this.activeElement=null}}class Ft{constructor(){B(this,"isDragging",!1);B(this,"isPinching",!1);B(this,"isLongpressed",!1);B(this,"consecutiveTaps",0);B(this,"lastTouchendTime",0);B(this,"lastCenterX",0);B(this,"lastCenterY",0);B(this,"identifier",0);B(this,"x",0);B(this,"y",0);B(this,"hypotenuse",0);B(this,"activeElement",null);this.reset()}reset(){this.isDragging=!1,this.isPinching=!1,this.isLongpressed=!1,this.consecutiveTaps=0,this.lastTouchendTime=0,this.lastCenterX=0,this.lastCenterY=0,this.identifier=0,this.x=0,this.y=0,this.hypotenuse=0,this.activeElement=null}}let ce=[],f=new Wt,a=new Ft;const M=(e,t)=>{e!=null&&e.dispatchEvent(new CustomEvent("gesture",{detail:t,bubbles:!1,cancelable:!1}))},yt=e=>{f.reset(),a.reset(),f.lastMouseupTime=Date.now(),window.removeEventListener("mousemove",qe),window.removeEventListener("mouseup",Ve),window.removeEventListener("touchmove",Oe),window.removeEventListener("touchend",xe)},wt=e=>{if(window.removeEventListener("mousemove",qe),window.removeEventListener("mouseup",Ve),window.removeEventListener("touchmove",Oe),window.removeEventListener("touchend",xe),f.isMoving)if(f.isMoving=!1,f.isLongclick)f.isLongclick=!1,M(f.activeElement,{event:e,name:"longclick-drag-end",x:f.lastX,y:f.lastY,dx:0,dy:0});else switch(f.button){case 0:M(f.activeElement,{event:e,name:"left-click-drag-end",x:f.lastX,y:f.lastY,dx:0,dy:0});break;case 1:M(f.activeElement,{event:e,name:"middle-click-drag-end",x:f.lastX,y:f.lastY,dx:0,dy:0});break;case 2:M(f.activeElement,{event:e,name:"right-click-drag-end",x:f.lastX,y:f.lastY,dx:0,dy:0});break}f.isLongclick&&M(f.activeElement,{event:e,name:"longclick-release",x:f.lastX,y:f.lastY,dx:0,dy:0}),f.reset(),a.isDragging&&(a.isDragging=!1,a.isLongpressed?(a.isLongpressed=!1,M(a.activeElement,{event:e,name:"longpress-drag-end",x:a.lastCenterX,y:a.lastCenterY,dx:0,dy:0})):M(a.activeElement,{event:e,name:"touch-drag-end",x:a.lastCenterX,y:a.lastCenterY,dx:0,dy:0})),a.isLongpressed&&M(a.activeElement,{event:e,name:"longpress-release",x:a.lastCenterX,y:a.lastCenterY,dx:0,dy:0}),a.reset()},_t=e=>{M(e.target,{event:e,name:"wheel",x:e.clientX,y:e.clientY,dx:0,dy:0})},kt=e=>{},Et=e=>{document.activeElement!==e.target&&(window.addEventListener("mousemove",qe),window.addEventListener("mouseup",Ve),f.activeElement=e.target,f.lastX=e.clientX,f.lastY=e.clientY,f.isMoving||(f.button=e.button),f.button===0&&window.setTimeout(()=>{Date.now()-f.lastMouseupTime>=lt&&!f.isMoving&&(f.isLongclick=!0,M(f.activeElement,{event:e,name:"longclick",x:e.clientX,y:e.clientY,dx:0,dy:0}))},lt))},qe=e=>{if(e.movementX===0&&e.movementY===0)return;let t=e.clientX-f.lastX,n=e.clientY-f.lastY;if(!f.isMoving)if(f.isLongclick)M(f.activeElement,{event:e,name:"longclick-drag-start",x:e.clientX,y:e.clientY,dx:0,dy:0});else switch(f.button){case 0:M(f.activeElement,{event:e,name:"left-click-drag-start",x:e.clientX,y:e.clientY,dx:0,dy:0});break;case 1:M(f.activeElement,{event:e,name:"middle-click-drag-start",x:e.clientX,y:e.clientY,dx:0,dy:0});break;case 2:M(f.activeElement,{event:e,name:"right-click-drag-start",x:e.clientX,y:e.clientY,dx:0,dy:0});break}if(f.isMoving=!0,f.lastX=e.clientX,f.lastY=e.clientY,f.isLongclick)M(f.activeElement,{event:e,name:"longclick-dragging",x:e.clientX,y:e.clientY,dx:t,dy:n});else switch(f.button){case 0:M(f.activeElement,{event:e,name:"left-click-dragging",x:e.clientX,y:e.clientY,dx:t,dy:n});break;case 1:M(f.activeElement,{event:e,name:"middle-click-dragging",x:e.clientX,y:e.clientY,dx:t,dy:n});break;case 2:M(f.activeElement,{event:e,name:"right-click-dragging",x:e.clientX,y:e.clientY,dx:t,dy:n});break}},Ve=e=>{if(window.removeEventListener("mousemove",qe),window.removeEventListener("mouseup",Ve),f.lastMouseupTime=Date.now(),f.isMoving)if(f.isMoving=!1,f.isLongclick)f.isLongclick=!1,M(f.activeElement,{event:e,name:"longclick-drag-end",x:f.lastX,y:f.lastY,dx:0,dy:0});else switch(f.button){case 0:M(f.activeElement,{event:e,name:"left-click-drag-end",x:f.lastX,y:f.lastY,dx:0,dy:0});break;case 1:M(f.activeElement,{event:e,name:"middle-click-drag-end",x:f.lastX,y:f.lastY,dx:0,dy:0});break;case 2:M(f.activeElement,{event:e,name:"right-click-drag-end",x:f.lastX,y:f.lastY,dx:0,dy:0});break}else f.isLongclick||(e.button===2?M(f.activeElement,{event:e,name:"right-click",x:e.clientX,y:e.clientY,dx:0,dy:0}):e.button===1?M(f.activeElement,{event:e,name:"middle-click",x:e.clientX,y:e.clientY,dx:0,dy:0}):(f.consecutiveClicks===0&&M(f.activeElement,{event:e,name:"left-click",x:e.clientX,y:e.clientY,dx:0,dy:0}),f.consecutiveClicks++,window.setTimeout(()=>{f.consecutiveClicks>1&&M(f.activeElement,{event:e,name:"double-click",x:e.clientX,y:e.clientY,dx:0,dy:0}),f.consecutiveClicks=0},Nt)));f.isLongclick&&M(f.activeElement,{event:e,name:"longclick-release",x:e.clientX,y:e.clientY,dx:0,dy:0}),f.isLongclick=!1},Tt=e=>{if(e.touches.length>1,document.activeElement!==e.target){if(e.touches.length>1){if(e.touches[0].identifier===a.identifier)return;a.isPinching=!0}window.addEventListener("touchmove",Oe,{passive:!1}),window.addEventListener("touchend",xe),window.addEventListener("touchcancel",xe),a.identifier=e.touches[0].identifier,a.x=e.touches[0].clientX,a.y=e.touches[0].clientY,a.activeElement=e.target,window.setTimeout(()=>{a.isPinching||a.isDragging||Date.now()-a.lastTouchendTime>=st&&(a.isDragging=!1,a.isPinching=!1,a.hypotenuse=null,a.isLongpressed=!0,M(a.activeElement,{event:e,name:"longpress",x:a.x,y:a.y,dx:0,dy:0}))},st)}},Oe=e=>{if(a.isDragging){let t=a.x,n=a.y;a.x=e.touches[0].clientX,a.y=e.touches[0].clientY;let i=a.x-t,s=a.y-n;a.isLongpressed?M(a.activeElement,{event:e,name:"longpress-dragging",x:a.x,y:a.y,dx:i,dy:s,force:e.touches[0].force}):M(a.activeElement,{event:e,name:"touch-dragging",x:a.x,y:a.y,dx:i,dy:s,force:e.touches[0].force});return}else if(!a.isLongpressed&&(a.isPinching||e.touches.length>1)){a.x=e.touches[0].clientX,a.y=e.touches[0].clientY;let t={x:e.touches[1].clientX,y:e.touches[1].clientY},n={x:(a.x+t.x)/2,y:(a.y+t.y)/2},i=Math.hypot(a.x-t.x,a.y-t.y);a.hypotenuse===null&&(a.hypotenuse=i,a.lastCenterX=n.x,a.lastCenterY=n.y,M(a.activeElement,{event:e,name:"pinch-start",x:n.x,y:n.y,dx:0,dy:0})),a.isPinching=!0;let s=i/a.hypotenuse,c=n.x-a.lastCenterX,u=n.y-a.lastCenterY;M(a.activeElement,{event:e,name:"pinching",x:n.x,y:n.y,zoom:s,dx:c,dy:u}),a.hypotenuse=i,a.lastCenterX=n.x,a.lastCenterY=n.y;return}else a.isDragging=!0,a.isLongpressed?(M(a.activeElement,{event:e,name:"longpress-drag-start",x:a.x,y:a.y,dx:0,dy:0,force:e.touches[0].force}),a.x=e.touches[0].clientX,a.y=e.touches[0].clientY,M(a.activeElement,{event:e,name:"longpress-dragging",x:a.x,y:a.y,dx:0,dy:0,force:e.touches[0].force})):(M(a.activeElement,{event:e,name:"touch-drag-start",x:a.x,y:a.y,dx:0,dy:0,force:e.touches[0].force}),a.x=e.touches[0].clientX,a.y=e.touches[0].clientY,M(a.activeElement,{event:e,name:"touch-dragging",x:a.x,y:a.y,dx:0,dy:0,force:e.touches[0].force}))},xe=e=>{a.isDragging&&e.touches.length>0&&e.touches[0].identifier===a.identifier||(a.lastTouchendTime=Date.now(),window.removeEventListener("touchmove",Oe),window.removeEventListener("touchend",xe),window.removeEventListener("touchcancel",xe),a.isDragging?(a.isDragging=!1,a.isLongpressed?(a.isLongpressed=!1,M(a.activeElement,{event:e,name:"longpress-drag-end",x:a.x,y:a.y,dx:0,dy:0})):M(a.activeElement,{event:e,name:"touch-drag-end",x:a.x,y:a.y,dx:0,dy:0})):a.isPinching?(a.isPinching=!1,a.hypotenuse=null,M(a.activeElement,{event:e,name:"pinch-end",x:a.lastCenterX,y:a.lastCenterY,dx:0,dy:0})):a.isLongpressed||(a.consecutiveTaps===0&&M(a.activeElement,{event:e,name:"tap",x:a.x,y:a.y,dx:0,dy:0}),a.consecutiveTaps++,window.setTimeout(()=>{a.consecutiveTaps>1&&M(a.activeElement,{event:e,name:"double-tap",x:a.x,y:a.y,dx:0,dy:0}),a.consecutiveTaps=0},Ut)),a.isLongpressed&&M(a.activeElement,{event:e,name:"longpress-release",x:a.x,y:a.y,dx:0,dy:0}),a.isLongpressed=!1)};function zt(...e){for(let t of e)ce.findIndex(n=>n===t)===-1&&(ce.length==0&&(window.addEventListener("blur",wt),window.addEventListener("focus",yt)),ce.push(t),t.addEventListener("touchstart",Tt,{passive:!1}),t.addEventListener("mousedown",Et,{passive:!1}),t.addEventListener("contextmenu",kt,{passive:!1}),t.addEventListener("wheel",_t,{passive:!1}))}function jt(...e){const t=n=>{n.removeEventListener("touchstart",Tt),n.removeEventListener("mousedown",Et),n.removeEventListener("contextmenu",kt),n.removeEventListener("wheel",_t)};if(e.length==0){for(let n of ce)t(n);ce=[]}else for(let n of e){let i=ce.findIndex(s=>s===n);i!==-1&&(t(n),ce.splice(i,1))}ce.length==0&&(window.removeEventListener("blur",wt),window.removeEventListener("focus",yt))}function Gt(e){let t,n,i,s,c,u,o="LOG";return{c(){t=H("div"),n=H("canvas"),i=j(),s=H("canvas"),c=j(),u=H("div"),u.textContent=o,this.h()},l(l){t=A(l,"DIV",{class:!0});var h=O(t);n=A(h,"CANVAS",{id:!0,class:!0}),O(n).forEach(X),i=G(h),s=A(h,"CANVAS",{id:!0,class:!0}),O(s).forEach(X),c=G(h),u=A(h,"DIV",{class:!0,"data-svelte-h":!0}),ue(u)!=="svelte-rtly9t"&&(u.textContent=o),h.forEach(X),this.h()},h(){Y(n,"id","currentPath"),Y(n,"class","svelte-mgp9tj"),W(n,"disabled",e[0]),Y(s,"id","canvas"),Y(s,"class","svelte-mgp9tj"),W(s,"disabled",e[0]),Y(u,"class","log svelte-mgp9tj"),Y(t,"class","canvas-container svelte-mgp9tj"),W(t,"hide",e[1])},m(l,h){$(l,t,h),I(t,n),e[13](n),I(t,i),I(t,s),e[14](s),I(t,c),I(t,u),e[15](u)},p(l,h){h[0]&1&&W(n,"disabled",l[0]),h[0]&1&&W(s,"disabled",l[0]),h[0]&2&&W(t,"hide",l[1])},i:fe,o:fe,d(l){l&&X(t),e[13](null),e[14](null),e[15](null)}}}const Kt=2,Qt=178;function Jt(e,t,n){var i=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),s=Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2)),c=Math.sqrt(Math.pow(n.x-e.x,2)+Math.pow(n.y-e.y,2)),u=Math.acos((s*s+i*i-c*c)/(2*s*i));return u*(180/Math.PI)}function rt(e){if(e.points.length<4)return e;for(let t=1;t<e.points.length-2;t++){const n=e.points[t-1],i=e.points[t],s=e.points[t+1];Jt(n,i,s)>Qt&&(e.points.splice(t,1),e.lineWidths.splice(t,1),t--)}return e}async function Xe(e,t){if(t.lineWidth=e.lineWidths[0],t.lineCap="round",t.strokeStyle=e.color,e.points.length<2){t.beginPath(),t.moveTo(e.points[0].x,e.points[0].y),t.lineTo(e.points[0].x,e.points[0].y),t.lineWidth=e.lineWidths[0],t.stroke();return}let n=e.points[0].x,i=e.points[0].y;for(let s=0;s<e.points.length-1;s++)t.beginPath(),t.moveTo(n,i),n=(e.points[s].x+e.points[s+1].x)/2,i=(e.points[s].y+e.points[s+1].y)/2,t.lineWidth=e.lineWidths[s],t.quadraticCurveTo(e.points[s].x,e.points[s].y,n,i),t.stroke()}function Zt(e){return{x:Je(e.x),y:Je(e.y)}}function Je(e){const t=e.toFixed(Kt);return Number(t)}function $t(e,t,n){let i,s;se(e,ae,r=>n(28,s=r));let{radius:c=3}=t,{smoothness:u=0}=t,{stroke:o=5}=t,{pressureScaler:l=5}=t,{color:h="#000000"}=t,{disabled:d=!1}=t,{hide:x=!1}=t,{tabID:S=""}=t;function q(){w.clearRect(0,0,P,D),N=[]}function V(){if(N.length!=0){n(4,b.innerHTML="Undo",b),N.pop(),g.clearRect(0,0,P,D);for(let r=0;r<N.length;r++)Xe(N[r],g);ee()}}let y,w,m,g,k={x:0,y:0},p=0,D=0,P=0,T,E=!1,b,v,R,N=[];function K(){y&&(zt(y),window.addEventListener("keydown",Ae))}function Q(){y&&(jt(y),window.removeEventListener("keydown",Ae))}const J=(r,_,C,L)=>{var te=C-r,Z=L-_;return Math.sqrt(te*te+Z*Z)},le=(r,_=300)=>{let C;return(...L)=>{clearTimeout(C),C=setTimeout(()=>{r.apply(void 0,L)},_)}};function Me(r,_){let C=y.getBoundingClientRect();return{x:(r-C.left)*T,y:(_-C.top)*T}}function re(){if(!y||!m)return;He(),T=window.devicePixelRatio;let r=y.getBoundingClientRect();D=r.height*T,P=r.width*T,n(2,y.width=P,y),n(2,y.height=D,y),n(3,m.width=P,m),n(3,m.height=D,m);for(let _=0;_<N.length;_++)Xe(N[_],g)}function ee(){s[S]&&de(ae,s[S].paths=N.filter(r=>rt(r)),s)}function Be(){s[S]&&(N=s[S].paths,re())}function Ue(r,_,C){E=!0,k=Me(r,_),C!==void 0&&C>0?p=Math.log(C+1)*l*i:p=i,w.lineWidth=p,w.lineCap="round",w.strokeStyle=h,w.beginPath(),w.moveTo(k.x,k.y),w.stroke(),v={points:[],lineWidths:[],color:h}}function Ne(r,_,C){if(!E)return;let L=Me(r,_);if(C!==void 0&&C>0&&(p=Math.log(C+1)*l*i*.2+p*.8),c>0){if(J(L.x,L.y,k.x,k.y)<=c){v.points.length===0&&(v.points.push(L),v.lineWidths.push(p),Xe(v,w));return}let te=Math.sqrt(L.x*L.x+L.y*L.y-2*L.x*k.x+k.x*k.x-2*L.y*k.y+k.y*k.y);if(L={x:L.x+c*((k.x-L.x)/te),y:L.y+c*((k.y-L.y)/te)},J(k.x,k.y,L.x,L.y)<=u)return}v.points.push(Zt(L)),v.lineWidths.push(Je(p)),w.clearRect(0,0,P,D),Xe(v,w),k=L}function He(){E&&(N.push(rt(v)),Xe(v,g),w.clearRect(0,0,P,D),ee()),E=!1}const Ae=function(r){r.ctrlKey&&r.key=="z"&&V(),r.preventDefault()};$e(()=>{w=y.getContext("2d"),w.imageSmoothingEnabled=!1,g=m.getContext("2d"),g.imageSmoothingEnabled=!1,y.addEventListener("gesture",r=>{switch(r.detail.name){case"left-click-drag-start":case"touch-drag-start":Ue(r.detail.x,r.detail.y,r.detail.force);break;case"left-click-dragging":case"touch-dragging":r.detail.force>0&&n(4,b.innerHTML=r.detail.force,b),Ne(r.detail.x,r.detail.y,r.detail.force);break;case"left-click-drag-end":case"touch-drag-end":He();break}}),R=new ResizeObserver(le(re,0)),R.observe(y),Be(),d?Q():K()}),Dt(()=>{R&&R.disconnect(),Q()});function We(r){ne[r?"unshift":"push"](()=>{m=r,n(3,m)})}function Fe(r){ne[r?"unshift":"push"](()=>{y=r,n(2,y)})}function ze(r){ne[r?"unshift":"push"](()=>{b=r,n(4,b)})}return e.$$set=r=>{"radius"in r&&n(5,c=r.radius),"smoothness"in r&&n(6,u=r.smoothness),"stroke"in r&&n(7,o=r.stroke),"pressureScaler"in r&&n(8,l=r.pressureScaler),"color"in r&&n(9,h=r.color),"disabled"in r&&n(0,d=r.disabled),"hide"in r&&n(1,x=r.hide),"tabID"in r&&n(10,S=r.tabID)},e.$$.update=()=>{e.$$.dirty[0]&128&&(i=Math.max(o,1)),e.$$.dirty[0]&1&&(d?Q():K())},[d,x,y,m,b,c,u,o,l,h,S,q,V,We,Fe,ze]}class en extends Ce{constructor(t){super(),Ie(this,t,$t,Gt,De,{radius:5,smoothness:6,stroke:7,pressureScaler:8,color:9,disabled:0,hide:1,tabID:10,clear:11,undo:12},null,[-1,-1])}get clear(){return this.$$.ctx[11]}get undo(){return this.$$.ctx[12]}}function ot(e,t,n){const i=e.slice();return i[42]=t[n],i[43]=t,i[44]=n,i}function at(e,t){let n,i,s,c,u=t[44],o,l,h;function d(...y){return t[18](t[44],...y)}function x(y){t[19](y,t[42])}let S={active:t[10]==t[42],preventHover:t[9],onPointerdown:d,onDragstart:t[16]};t[12][t[42]].title!==void 0&&(S.title=t[12][t[42]].title),i=new pt({props:S}),ne.push(()=>Pt(i,"title",x));const q=()=>t[20](n,u),V=()=>t[20](null,u);return{key:e,first:null,c(){n=H("div"),be(i.$$.fragment),c=j(),this.h()},l(y){n=A(y,"DIV",{class:!0});var w=O(n);pe(i.$$.fragment,w),c=G(w),w.forEach(X),this.h()},h(){Y(n,"class","tab-container svelte-6u8cf7"),W(n,"placeholder",t[11]==t[42]),this.first=n},m(y,w){$(y,n,w),ye(i,n,null),I(n,c),q(),o=!0,l||(h=Ct(t[15].call(null,n)),l=!0)},p(y,w){t=y;const m={};w[0]&1028&&(m.active=t[10]==t[42]),w[0]&512&&(m.preventHover=t[9]),w[0]&4&&(m.onPointerdown=d),!s&&w[0]&4100&&(s=!0,m.title=t[12][t[42]].title,It(()=>s=!1)),i.$set(m),u!==t[44]&&(V(),u=t[44],q()),(!o||w[0]&2052)&&W(n,"placeholder",t[11]==t[42])},i(y){o||(U(i.$$.fragment,y),o=!0)},o(y){F(i.$$.fragment,y),o=!1},d(y){y&&X(n),we(i),V(),l=!1,h()}}}function ct(e){let t,n=`<span class="button-icon svelte-6u8cf7" style="-webkit-mask: url(${z}/images/svg/gear.svg) no-repeat center / contain; mask: url(${z}/images/svg/gear.svg) no-repeat center / contain;"></span>`,i,s,c,u;return{c(){t=H("button"),t.innerHTML=n,this.h()},l(o){t=A(o,"BUTTON",{class:!0,"data-svelte-h":!0}),ue(t)!=="svelte-1wioe5y"&&(t.innerHTML=n),this.h()},h(){Y(t,"class","button svelte-6u8cf7")},m(o,l){$(o,t,l),s=!0,c||(u=ie(t,"click",e[22]),c=!0)},p:fe,i(o){s||(o&&Ze(()=>{s&&(i||(i=Ee(t,Le,{duration:200,axis:"x"},!0)),i.run(1))}),s=!0)},o(o){o&&(i||(i=Ee(t,Le,{duration:200,axis:"x"},!1)),i.run(0)),s=!1},d(o){o&&X(t),o&&i&&i.end(),c=!1,u()}}}function ut(e){let t,n;return t=new Bt({props:{onDrawingUndo:e[0],onRefresh:St.loadFromFirestore,onClose:e[24]}}),{c(){be(t.$$.fragment)},l(i){pe(t.$$.fragment,i)},m(i,s){ye(t,i,s),n=!0},p(i,s){const c={};s[0]&1&&(c.onDrawingUndo=i[0]),s[0]&1024&&(c.onClose=i[24]),t.$set(c)},i(i){n||(U(t.$$.fragment,i),n=!0)},o(i){F(t.$$.fragment,i),n=!1},d(i){we(t,i)}}}function tn(e){let t,n,i,s=[],c=new Map,u,o,l,h=`<span class="button-icon svelte-6u8cf7" style="-webkit-mask: url(${z}/images/svg/plus.svg) no-repeat center / contain; mask: url(${z}/images/svg/plus.svg) no-repeat center / contain;"></span>`,d,x,S,q,V,y,w,m,g,k,p,D=_e(e[2].order);const P=b=>b[42];for(let b=0;b<D.length;b+=1){let v=ot(e,D,b),R=P(v);c.set(R,s[b]=at(R,v))}let T=!e[2].toolbarVisible&&ct(e);V=new pt({props:{title:e[5],active:!e[7],preventHover:!0}});let E=e[2].toolbarVisible&&ut(e);return{c(){t=H("div"),n=H("div"),i=H("div");for(let b=0;b<s.length;b+=1)s[b].c();u=j(),o=H("div"),l=H("button"),l.innerHTML=h,d=j(),x=H("div"),T&&T.c(),S=j(),q=H("div"),be(V.$$.fragment),y=j(),w=H("div"),m=j(),E&&E.c(),this.h()},l(b){t=A(b,"DIV",{class:!0});var v=O(t);n=A(v,"DIV",{class:!0});var R=O(n);i=A(R,"DIV",{class:!0});var N=O(i);for(let le=0;le<s.length;le+=1)s[le].l(N);N.forEach(X),u=G(R),o=A(R,"DIV",{class:!0});var K=O(o);l=A(K,"BUTTON",{class:!0,"data-svelte-h":!0}),ue(l)!=="svelte-g0ls06"&&(l.innerHTML=h),K.forEach(X),d=G(R),x=A(R,"DIV",{class:!0});var Q=O(x);T&&T.l(Q),Q.forEach(X),S=G(R),q=A(R,"DIV",{class:!0});var J=O(q);pe(V.$$.fragment,J),J.forEach(X),R.forEach(X),y=G(v),w=A(v,"DIV",{class:!0}),O(w).forEach(X),m=G(v),E&&E.l(v),v.forEach(X),this.h()},h(){Y(i,"class","tabs svelte-6u8cf7"),Y(l,"class","button svelte-6u8cf7"),Y(o,"class","new-tab-container svelte-6u8cf7"),Y(x,"class","buttons-container svelte-6u8cf7"),Y(q,"class","clone svelte-6u8cf7"),W(q,"dragging",e[1]),Y(n,"class","tabbar svelte-6u8cf7"),Y(w,"class","divider svelte-6u8cf7"),Y(t,"class","svelte-6u8cf7")},m(b,v){$(b,t,v),I(t,n),I(n,i);for(let R=0;R<s.length;R+=1)s[R]&&s[R].m(i,null);e[21](i),I(n,u),I(n,o),I(o,l),I(n,d),I(n,x),T&&T.m(x,null),I(n,S),I(n,q),ye(V,q,null),e[23](q),I(t,y),I(t,w),I(t,m),E&&E.m(t,null),e[25](t),g=!0,k||(p=ie(l,"click",e[13]),k=!0)},p(b,v){v[0]&204308&&(D=_e(b[2].order),me(),s=Ke(s,v,P,1,b,D,c,i,Qe,at,null,ot),ve()),b[2].toolbarVisible?T&&(me(),F(T,1,1,()=>{T=null}),ve()):T?(T.p(b,v),v[0]&4&&U(T,1)):(T=ct(b),T.c(),U(T,1),T.m(x,null));const R={};v[0]&32&&(R.title=b[5]),v[0]&128&&(R.active=!b[7]),V.$set(R),(!g||v[0]&2)&&W(q,"dragging",b[1]),b[2].toolbarVisible?E?(E.p(b,v),v[0]&4&&U(E,1)):(E=ut(b),E.c(),U(E,1),E.m(t,null)):E&&(me(),F(E,1,1,()=>{E=null}),ve())},i(b){if(!g){for(let v=0;v<D.length;v+=1)U(s[v]);U(T),U(V.$$.fragment,b),U(E),g=!0}},o(b){for(let v=0;v<s.length;v+=1)F(s[v]);F(T),F(V.$$.fragment,b),F(E),g=!1},d(b){b&&X(t);for(let v=0;v<s.length;v+=1)s[v].d();e[21](null),T&&T.d(),we(V),e[23](null),E&&E.d(),e[25](null),k=!1,p()}}}const nn=12,Re=200,Pe=32,Se=200,sn=1600,dt=.3;function ln(e,t,n){let i,s,c,u;se(e,he,r=>n(2,c=r)),se(e,ae,r=>n(12,u=r));let{onDrawingUndo:o=()=>{}}=t,l,h=[],d=0,x=null,S=-1,q="",V,y,w,m=!1,g=!1,k=0,p=0,D,P=!1;const T=(r,_=300)=>{let C;return(...L)=>{clearTimeout(C),C=setTimeout(()=>{r.apply(void 0,L)},_)}};function E(){oe.newTab()}const b=r=>{const _=c.order.findIndex(C=>C===r);if(_<0||!h[_]){console.warn("Cannot close tab!");return}d=h[_].getBoundingClientRect().width,_<c.order.length-1&&(l.style.setProperty("--tab-max-width",`${d}px`),v()),_==c.activeIndex&&(_==c.order.length-1?oe.setActiveIndex(_-1):oe.setActiveIndex(_+1)),Ge({duration:Se,easing:ge,onStep:(C,L)=>{_==0?n(3,l.style.gridTemplateColumns=`minmax(${L*Pe}px, ${L*d}px)`,l):n(3,l.style.gridTemplateColumns=`repeat(${_}, minmax(var(--tab-min-width), var(--tab-max-width))) minmax(${L*Pe}px, ${L*d}px)`,l)},onEnd:()=>{n(3,l.style.gridTemplateColumns="",l),oe.removeTab(r)}})},v=T(()=>{l&&(l.style.setProperty("--tab-max-width",`${Re}px`),Ge({duration:Se,easing:ge,onStep:(r,_)=>{l.style.setProperty("--tab-max-width",`${d+r*(Re-d)}px`)},onEnd:()=>{l.style.setProperty("--tab-max-width",`${Re}px`)}}))},sn);function R(r){if(!l)return;const _=r.getBoundingClientRect().width;Ge({duration:Se,easing:ge,onStep:(C,L)=>{c.order.length==1?n(3,l.style.gridTemplateColumns=`minmax(${C*Pe}px, ${C*_}px)`,l):n(3,l.style.gridTemplateColumns=`repeat(${c.order.length-1}, minmax(var(--tab-min-width), var(--tab-max-width))) minmax(${C*Pe}px, ${C*_}px)`,l),n(3,l.scrollLeft=l.scrollWidth,l)},onEnd:()=>{n(3,l.style.gridTemplateColumns="",l)}})}const N=(r,_)=>{const C=h[0].getBoundingClientRect().width;oe.moveTab(r,_,()=>{if(r>_)for(let L=_;L<r;L++)nt(h[L],{duration:Se,easing:ge,css:(te,Z)=>`transform: translateX(-${Z*C}px);`});if(r<_)for(let L=_;L>r;L--)nt(h[L],{duration:Se,easing:ge,css:(te,Z)=>`transform: translateX(${Z*C}px);`})})};function K(r){!r.target||!r.dataTransfer||(r.dataTransfer.setData("text/plain",i),r.dataTransfer.setDragImage(new Image,0,0))}function Q(r,_){if(r==0&&_==0){n(6,w.style.left="-1000px",w),n(6,w.style.top="-1000px",w);return}let C=D.getBoundingClientRect();if(r<C.left||r>C.right||_<C.top||_>C.bottom){g||(p=0),n(6,w.style.left=`${r+k}px`,w),n(6,w.style.top=`${_-y.height/2}px`,w),n(7,g=!0);return}g&&n(7,g=!1),n(6,w.style.left=`${r+k}px`,w),n(6,w.style.top=`${y.top}px`,w);const L=-l.scrollLeft,te=h[0].getBoundingClientRect().width;let Z=-1;if(r>L+c.order.length*te)Z=c.order.length-1;else for(let Ye=0;Ye<c.order.length;Ye++)if(r>L+Ye*te&&r<L+(Ye+1)*te){Z=Ye;break}r<20?(p=-dt,requestAnimationFrame(le)):r>l.clientWidth-10?(p=dt,requestAnimationFrame(le)):p=0,!(Z==-1||Z==c.placeholderIndex)&&N(c.placeholderIndex,Z)}let J=0;function le(r){if(!m||p==0){J=0;return}J==0&&(J=r);const _=r-J;J=r,l.scrollBy({left:p*_}),requestAnimationFrame(le)}function Me(r,_){if(!r.target)return;let C,L;r instanceof TouchEvent?(C=r.touches[0].clientX,L=r.touches[0].clientY):(C=r.clientX,L=r.clientY),window.addEventListener("touchmove",re,{passive:!1}),window.addEventListener("touchend",ee),window.addEventListener("mousemove",re),window.addEventListener("mouseup",ee),window.addEventListener("drag",re),window.addEventListener("dragend",ee),window.addEventListener("blur",ee),oe.setActiveIndex(_),V=r.target,y=V.getBoundingClientRect(),x=[C,L],k=y.left-C,y.top-L,n(6,w.style.width=`${y.width}px`,w),n(6,w.style.left=`${y.left}px`,w),n(6,w.style.top=`${y.top}px`,w),S=_,n(5,q=u[c.order[_]].title)}function re(r){let _,C;if(r instanceof TouchEvent?(_=r.touches[0].clientX,C=r.touches[0].clientY,r.preventDefault()):(_=r.clientX,C=r.clientY),m){Q(_,C);return}x===null||Math.hypot(x[0]-_,x[1]-C)<nn||(n(1,m=!0),oe.setPlaceholderIndex(S),oe.setActiveIndex(S))}function ee(){window.removeEventListener("touchmove",re),window.removeEventListener("touchend",ee),window.removeEventListener("mousemove",re),window.removeEventListener("mouseup",ee),window.removeEventListener("drag",re),window.removeEventListener("dragend",ee),window.removeEventListener("blur",ee),x=null,n(7,g=!1),S=-1,k=0,oe.setPlaceholderIndex(),n(1,m=!1)}$e(()=>{l.style.setProperty("--tab-max-width",`${Re}px`),l.style.setProperty("--tab-min-width",`${Pe}px`)});const Be=(r,_)=>Me(_,r);function Ue(r,_){e.$$.not_equal(u[_].title,r)&&(u[_].title=r,ae.set(u))}function Ne(r,_){ne[r?"unshift":"push"](()=>{h[_]=r,n(4,h)})}function He(r){ne[r?"unshift":"push"](()=>{l=r,n(3,l)})}const Ae=()=>{de(he,c.toolbarVisible=!0,c)};function We(r){ne[r?"unshift":"push"](()=>{w=r,n(6,w)})}const Fe=()=>b(i);function ze(r){ne[r?"unshift":"push"](()=>{D=r,n(8,D)})}return e.$$set=r=>{"onDrawingUndo"in r&&n(0,o=r.onDrawingUndo)},e.$$.update=()=>{e.$$.dirty[0]&4&&n(10,i=c.order[c.activeIndex]),e.$$.dirty[0]&4&&n(11,s=c.order[c.placeholderIndex]),e.$$.dirty[0]&2&&(m?n(9,P=!0):setTimeout(()=>n(9,P=!1),20))},[o,m,c,l,h,q,w,g,D,P,i,s,u,E,b,R,K,Me,Be,Ue,Ne,He,Ae,We,Fe,ze]}class rn extends Ce{constructor(t){super(),Ie(this,t,ln,tn,De,{onDrawingUndo:0},null,[-1,-1])}}function on(e){let t,n;return{c(){t=H("div"),n=H("div"),this.h()},l(i){t=A(i,"DIV",{class:!0});var s=O(t);n=A(s,"DIV",{class:!0}),O(n).forEach(X),s.forEach(X),this.h()},h(){Y(n,"class","quill-editor svelte-1zs6ve"),Y(t,"class","quill-editor-wrapper svelte-1zs6ve"),W(t,"disabled",e[0])},m(i,s){$(i,t,s),I(t,n),e[5](n)},p(i,[s]){s&1&&W(t,"disabled",i[0])},i:fe,o:fe,d(i){i&&X(t),e[5](null)}}}function an(e,t,n){let i,s;se(e,ae,p=>n(6,i=p)),se(e,Ht,p=>n(4,s=p));let{tabID:c}=t,{disabled:u=!1}=t,o,l;const h=(p,D=300)=>{let P;return(...T)=>{clearTimeout(P),P=setTimeout(()=>{p.apply(void 0,T)},D)}};async function d(p){var E,b,v,R;if(!o)return;const{Delta:D,Range:P}=await tt(async()=>{const{Delta:N,Range:K}=await import("../chunks/core.CG__ofcG.js").then(Q=>Q.G);return{Delta:N,Range:K}},[],import.meta.url);if(p.undo.length>0)for(var T=0;T<p.undo.length;T++){const N=(E=p.undo[T].range)==null?void 0:E.index,K=(b=p.undo[T].range)==null?void 0:b.length,Q={delta:new D(p.undo[T].delta.ops),range:N!==void 0&&K!==void 0?new P(N,K):null};o.history.stack.undo.push(Q)}if(p.redo.length>0)for(var T=0;T<p.redo.length;T++){const K=(v=p.redo[T].range)==null?void 0:v.index,Q=(R=p.redo[T].range)==null?void 0:R.length,J={delta:new D(p.redo[T].delta.ops),range:K!==void 0&&Q!==void 0?new P(K,Q):null};o.history.stack.redo.push(J)}}function x(p){var D;o&&((D=o.getSelection())==null?void 0:D.length)===0&&window.open(p.target.href,"_blank")}function S(){if(!o||!i[c])return;const p=i[c].ops;o.setContents(p);const D=i[c].history;d(D)}function q(){if(!o||!i[c])return;de(ae,i[c].ops=o.getContents().ops,i);const p=structuredClone(o.history.stack);de(ae,i[c].history=p,i)}const V=h(q,500);function y(){if(!o)return;o.formatText(0,o.getLength(),"link",!1,"api");const p=o.getText(),D=/https?:\/\/\S+/gi,P=p.matchAll(D);for(const b of P)o.formatText(b.index,b[0].length,"link",b[0],"api");const T=/.+\@.+\..+/gi,E=p.matchAll(T);for(const b of E)o.formatText(b.index,b[0].length,"link","mailto:"+b[0],"api");document.querySelectorAll(".ql-editor a").forEach(b=>{b.addEventListener("click",x)})}const w=h(y,500);function m(p,D,P){if(P==="user"){const T=o.getText().split(`
`)[0].trim();de(ae,i[c].title=T===""?"Untitled":T,i),w(),V()}}async function g(){const{default:p}=await tt(async()=>{const{default:D}=await import("../chunks/quill.Bk4jDS0q.js");return{default:D}},__vite__mapDeps([0,1]),import.meta.url);n(3,o=new p(l,{formats:["bold","italic","underline","strike","code","link"],placeholder:"Enter text here"})),S(),y(),o.on("text-change",m),o.keyboard.addBinding({key:"/",altKey:!0},()=>{o.format("code",!o.getFormat().code)}),o.keyboard.addBinding({key:"-",altKey:!0},()=>{o.format("strike",!o.getFormat().strike)})}$e(()=>{g()});function k(p){ne[p?"unshift":"push"](()=>{l=p,n(1,l)})}return e.$$set=p=>{"tabID"in p&&n(2,c=p.tabID),"disabled"in p&&n(0,u=p.disabled)},e.$$.update=()=>{e.$$.dirty&9&&(u?o==null||o.disable():o==null||o.enable()),e.$$.dirty&24&&(o==null||o.root.setAttribute("spellcheck",s.spellCheck.toString()))},[u,l,c,o,s,k]}class cn extends Ce{constructor(t){super(),Ie(this,t,an,on,De,{tabID:2,disabled:0})}}function ft(e,t,n){const i=e.slice();return i[7]=t[n],i}function gt(e,t,n){const i=e.slice();return i[7]=t[n],i}function un(e){let t,n;return t=new At({}),{c(){be(t.$$.fragment)},l(i){pe(t.$$.fragment,i)},m(i,s){ye(t,i,s),n=!0},p:fe,i(i){n||(U(t.$$.fragment,i),n=!0)},o(i){F(t.$$.fragment,i),n=!1},d(i){we(t,i)}}}function dn(e){let t,n,i,s,c,u=[],o=new Map,l,h,d=[],x=new Map,S;n=new rn({props:{onDrawingUndo:e[5]}});let q=_e(Object.keys(e[4]));const V=m=>m[7];for(let m=0;m<q.length;m+=1){let g=gt(e,q,m),k=V(g);o.set(k,u[m]=ht(k,g))}let y=_e(Object.keys(e[4]));const w=m=>m[7];for(let m=0;m<y.length;m+=1){let g=ft(e,y,m),k=w(g);x.set(k,d[m]=mt(k,g))}return{c(){t=H("div"),be(n.$$.fragment),i=j(),s=H("div"),c=H("div");for(let m=0;m<u.length;m+=1)u[m].c();l=j(),h=H("div");for(let m=0;m<d.length;m+=1)d[m].c();this.h()},l(m){t=A(m,"DIV",{class:!0});var g=O(t);pe(n.$$.fragment,g),i=G(g),s=A(g,"DIV",{class:!0});var k=O(s);c=A(k,"DIV",{class:!0});var p=O(c);for(let P=0;P<u.length;P+=1)u[P].l(p);p.forEach(X),l=G(k),h=A(k,"DIV",{class:!0});var D=O(h);for(let P=0;P<d.length;P+=1)d[P].l(D);D.forEach(X),k.forEach(X),g.forEach(X),this.h()},h(){Y(c,"class","editor-container svelte-gwyvkn"),Y(h,"class","drawing-container svelte-gwyvkn"),W(h,"disabled",e[0].activeTool!=="pencil"),Y(s,"class","canvas-container svelte-gwyvkn"),Y(t,"class","page-container svelte-gwyvkn")},m(m,g){$(m,t,g),ye(n,t,null),I(t,i),I(t,s),I(s,c);for(let k=0;k<u.length;k+=1)u[k]&&u[k].m(c,null);I(s,l),I(s,h);for(let k=0;k<d.length;k+=1)d[k]&&d[k].m(h,null);S=!0},p(m,g){const k={};g&2&&(k.onDrawingUndo=m[5]),n.$set(k),g&20&&(q=_e(Object.keys(m[4])),me(),u=Ke(u,g,V,1,m,q,o,c,Qe,ht,null,gt),ve()),g&23&&(y=_e(Object.keys(m[4])),me(),d=Ke(d,g,w,1,m,y,x,h,Qe,mt,null,ft),ve()),(!S||g&1)&&W(h,"disabled",m[0].activeTool!=="pencil")},i(m){if(!S){U(n.$$.fragment,m);for(let g=0;g<q.length;g+=1)U(u[g]);for(let g=0;g<y.length;g+=1)U(d[g]);S=!0}},o(m){F(n.$$.fragment,m);for(let g=0;g<u.length;g+=1)F(u[g]);for(let g=0;g<d.length;g+=1)F(d[g]);S=!1},d(m){m&&X(t),we(n);for(let g=0;g<u.length;g+=1)u[g].d();for(let g=0;g<d.length;g+=1)d[g].d()}}}function ht(e,t){let n,i,s;return i=new cn({props:{disabled:t[7]!==t[2],tabID:t[7]}}),{key:e,first:null,c(){n=Te(),be(i.$$.fragment),this.h()},l(c){n=Te(),pe(i.$$.fragment,c),this.h()},h(){this.first=n},m(c,u){$(c,n,u),ye(i,c,u),s=!0},p(c,u){t=c;const o={};u&20&&(o.disabled=t[7]!==t[2]),u&16&&(o.tabID=t[7]),i.$set(o)},i(c){s||(U(i.$$.fragment,c),s=!0)},o(c){F(i.$$.fragment,c),s=!1},d(c){c&&X(n),we(i,c)}}}function mt(e,t){let n,i,s,c={color:mn,stroke:gn,radius:hn,tabID:t[7],hide:t[7]!==t[2],disabled:t[7]!==t[2]||t[0].activeTool!=="pencil"};return i=new en({props:c}),t[6](i),{key:e,first:null,c(){n=Te(),be(i.$$.fragment),this.h()},l(u){n=Te(),pe(i.$$.fragment,u),this.h()},h(){this.first=n},m(u,o){$(u,n,o),ye(i,u,o),s=!0},p(u,o){t=u;const l={};o&16&&(l.tabID=t[7]),o&20&&(l.hide=t[7]!==t[2]),o&21&&(l.disabled=t[7]!==t[2]||t[0].activeTool!=="pencil"),i.$set(l)},i(u){s||(U(i.$$.fragment,u),s=!0)},o(u){F(i.$$.fragment,u),s=!1},d(u){u&&X(n),t[6](null),we(i,u)}}}function fn(e){let t,n,i,s;const c=[dn,un],u=[];function o(l,h){return l[3].currentUser&&!l[3].isLoading?0:1}return t=o(e),n=u[t]=c[t](e),{c(){n.c(),i=Te()},l(l){n.l(l),i=Te()},m(l,h){u[t].m(l,h),$(l,i,h),s=!0},p(l,[h]){let d=t;t=o(l),t===d?u[t].p(l,h):(me(),F(u[d],1,1,()=>{u[d]=null}),ve(),n=u[t],n?n.p(l,h):(n=u[t]=c[t](l),n.c()),U(n,1),n.m(i.parentNode,i))},i(l){s||(U(n),s=!0)},o(l){F(n),s=!1},d(l){l&&X(i),u[t].d(l)}}}let gn=10,hn=20,mn="rgba(253, 221, 77)";function vn(e,t,n){let i,s,c,u;se(e,he,d=>n(0,s=d)),se(e,bt,d=>n(3,c=d)),se(e,ae,d=>n(4,u=d));let o;const l=()=>o.undo();function h(d){ne[d?"unshift":"push"](()=>{o=d,n(1,o)})}return e.$$.update=()=>{e.$$.dirty&1&&n(2,i=s.order[s.activeIndex])},[s,o,i,c,u,l,h]}class Ln extends Ce{constructor(t){super(),Ie(this,t,vn,fn,De,{})}}export{Ln as component};
