const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/quill.Bk4jDS0q.js","../chunks/core.CG__ofcG.js"])))=>i.map(i=>d[i]);
var Lt=Object.defineProperty;var xt=(e,t,n)=>t in e?Lt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var U=(e,t,n)=>xt(e,typeof t!="symbol"?t+"":t,n);import{s as be,n as ge,r as Ue,i as Se,c as le,o as qe,a as ae,d as Q,A as Dt,B as Re,C as ht,e as We}from"../chunks/scheduler.CE28Mlnp.js";import{S as _e,i as we,e as P,t as Ct,c as A,a as V,b as It,d as X,w as I,A as q,g as ne,h as Y,x as te,F as Je,j as Yt,s as G,p as he,f as j,v as Te,q as ve,r as me,o as Le,m as xe,n as F,l as W,u as pe,G as Ve,z as Oe,I as De,C as Be,J as Mt,K as Xt}from"../chunks/index.CblOyuwr.js";import{e as $e,u as Pt,o as At,t as Ht}from"../chunks/themes.CBFgFqeR.js";import{m as oe,t as fe,d as de,s as vt,a as mt,f as St}from"../chunks/firebaseStore.DWmHsQa2.js";import{b as z}from"../chunks/paths.BcU-29E4.js";import{_ as et}from"../chunks/preload-helper.D6kgxu3v.js";import{P as Rt}from"../chunks/ProgressBar.Cdh5Uk4U.js";function Vt(e){let t,n,i,o,s,d;return{c(){t=P("div"),n=P("button"),i=P("span"),o=Ct(e[0]),this.h()},l(a){t=A(a,"DIV",{class:!0});var r=V(t);n=A(r,"BUTTON",{class:!0,draggable:!0});var u=V(n);i=A(u,"SPAN",{class:!0});var l=V(i);o=It(l,e[0]),l.forEach(X),u.forEach(X),r.forEach(X),this.h()},h(){I(i,"class","title svelte-1jmw20r"),I(n,"class","tab svelte-1jmw20r"),I(n,"draggable","true"),q(n,"active",e[1]),I(t,"class","tab-container svelte-1jmw20r"),q(t,"preventHover",e[2])},m(a,r){ne(a,t,r),Y(t,n),Y(n,i),Y(i,o),s||(d=[te(n,"mousedown",Je(function(){Se(e[3])&&e[3].apply(this,arguments)})),te(n,"touchstart",Je(function(){Se(e[3])&&e[3].apply(this,arguments)})),te(n,"dragstart",Je(function(){Se(e[4])&&e[4].apply(this,arguments)}))],s=!0)},p(a,[r]){e=a,r&1&&Yt(o,e[0]),r&2&&q(n,"active",e[1]),r&4&&q(t,"preventHover",e[2])},i:ge,o:ge,d(a){a&&X(t),s=!1,Ue(d)}}}function Bt(e,t,n){let{title:i=""}=t,{active:o=!1}=t,{preventHover:s=!1}=t,{onPointerdown:d=r=>{}}=t,{onDragstart:a=r=>{}}=t;return e.$$set=r=>{"title"in r&&n(0,i=r.title),"active"in r&&n(1,o=r.active),"preventHover"in r&&n(2,s=r.preventHover),"onPointerdown"in r&&n(3,d=r.onPointerdown),"onDragstart"in r&&n(4,a=r.onDragstart)},[i,o,s,d,a]}class pt extends _e{constructor(t){super(),we(this,t,Bt,Vt,be,{title:0,active:1,preventHover:2,onPointerdown:3,onDragstart:4})}}function ye(e){return e<.5?4*e*e*e:.5*Math.pow(2*e-2,3)+1}function bt(e){const t=e-1;return t*t*t+1}const tt=(e,t)=>{const{duration:n=300,easing:i=ye,onEnd:o=()=>{},onStep:s=()=>{},css:d}=t;let a;function r(u){if(!e){console.warn("Cannot find element to animate");return}a===void 0&&(a=u);const l=i((u-a)/n),b=1-l;l<1?(e.style.cssText=d(l,b),s(l,b),requestAnimationFrame(r)):(e.style.cssText="",o())}requestAnimationFrame(r)},Ze=e=>{const{duration:t=300,easing:n=ye,onEnd:i=()=>{},onStep:o=()=>{}}=e;let s;function d(a){s===void 0&&(s=a);const r=n((a-s)/t),u=1-r;r<1?(o(r,u),requestAnimationFrame(d)):i()}requestAnimationFrame(d)};function nt(e,t,n){const i=e.slice();return i[41]=t[n],i[42]=t,i[43]=n,i}function it(e,t){let n,i,o,s,d=t[43],a,r,u;function l(...g){return t[17](t[43],...g)}function b(g){t[18](g,t[41])}let h={active:t[9]==t[41],preventHover:t[8],onPointerdown:l,onDragstart:t[14]};t[11][t[41]].title!==void 0&&(h.title=t[11][t[41]].title),i=new pt({props:h}),Q.push(()=>Ve(i,"title",b));const m=()=>t[19](n,d),E=()=>t[19](null,d);return{key:e,first:null,c(){n=P("div"),he(i.$$.fragment),s=G(),this.h()},l(g){n=A(g,"DIV",{class:!0});var y=V(n);ve(i.$$.fragment,y),s=j(y),y.forEach(X),this.h()},h(){I(n,"class","tab-container svelte-17fp8fv"),q(n,"placeholder",t[10]==t[41]),this.first=n},m(g,y){ne(g,n,y),me(i,n,null),Y(n,s),m(),a=!0,r||(u=Dt(t[13].call(null,n)),r=!0)},p(g,y){t=g;const w={};y[0]&516&&(w.active=t[9]==t[41]),y[0]&256&&(w.preventHover=t[8]),y[0]&4&&(w.onPointerdown=l),!o&&y[0]&2052&&(o=!0,w.title=t[11][t[41]].title,Re(()=>o=!1)),i.$set(w),d!==t[43]&&(E(),d=t[43],m()),(!a||y[0]&1028)&&q(n,"placeholder",t[10]==t[41])},i(g){a||(F(i.$$.fragment,g),a=!0)},o(g){W(i.$$.fragment,g),a=!1},d(g){g&&X(n),pe(i),E(),r=!1,u()}}}function Nt(e){let t,n,i,o=[],s=new Map,d,a,r,u=`<span class="button-icon svelte-17fp8fv" style="-webkit-mask: url(${z}/images/svg/plus.svg) no-repeat center / contain; mask: url(${z}/images/svg/plus.svg) no-repeat center / contain;"></span>`,l,b,h,m=`<span class="button-icon svelte-17fp8fv" style="-webkit-mask: url(${z}/images/svg/gear.svg) no-repeat center / contain; mask: url(${z}/images/svg/gear.svg) no-repeat center / contain;"></span>`,E,g,y,w,H,B,p,L,_=$e(e[2].order);const T=x=>x[41];for(let x=0;x<_.length;x+=1){let D=nt(e,_,x),S=T(D);s.set(S,o[x]=it(S,D))}return y=new pt({props:{title:e[5],active:!e[1],preventHover:!0}}),{c(){t=P("div"),n=P("div"),i=P("div");for(let x=0;x<o.length;x+=1)o[x].c();d=G(),a=P("div"),r=P("button"),r.innerHTML=u,l=G(),b=P("div"),h=P("button"),h.innerHTML=m,E=G(),g=P("div"),he(y.$$.fragment),w=G(),H=P("div"),this.h()},l(x){t=A(x,"DIV",{class:!0});var D=V(t);n=A(D,"DIV",{class:!0});var S=V(n);i=A(S,"DIV",{class:!0});var se=V(i);for(let Z=0;Z<o.length;Z+=1)o[Z].l(se);se.forEach(X),d=j(S),a=A(S,"DIV",{class:!0});var ee=V(a);r=A(ee,"BUTTON",{class:!0,"data-svelte-h":!0}),Te(r)!=="svelte-g0ls06"&&(r.innerHTML=u),ee.forEach(X),l=j(S),b=A(S,"DIV",{class:!0});var K=V(b);h=A(K,"BUTTON",{class:!0,"data-svelte-h":!0}),Te(h)!=="svelte-4x2iay"&&(h.innerHTML=m),K.forEach(X),E=j(S),g=A(S,"DIV",{class:!0});var J=V(g);ve(y.$$.fragment,J),J.forEach(X),S.forEach(X),w=j(D),H=A(D,"DIV",{class:!0}),V(H).forEach(X),D.forEach(X),this.h()},h(){I(i,"class","tabs svelte-17fp8fv"),I(r,"class","button svelte-17fp8fv"),I(a,"class","new-tab-container svelte-17fp8fv"),I(h,"class","button svelte-17fp8fv"),I(b,"class","buttons-container svelte-17fp8fv"),I(g,"class","clone svelte-17fp8fv"),q(g,"dragging",e[0]),I(n,"class","tabbar svelte-17fp8fv"),I(H,"class","divider svelte-17fp8fv"),I(t,"class","svelte-17fp8fv")},m(x,D){ne(x,t,D),Y(t,n),Y(n,i);for(let S=0;S<o.length;S+=1)o[S]&&o[S].m(i,null);e[20](i),Y(n,d),Y(n,a),Y(a,r),Y(n,l),Y(n,b),Y(b,h),Y(n,E),Y(n,g),me(y,g,null),e[22](g),Y(t,w),Y(t,H),e[23](t),B=!0,p||(L=[te(r,"click",e[12]),te(h,"click",e[21])],p=!0)},p(x,D){D[0]&53012&&(_=$e(x[2].order),Le(),o=Pt(o,D,T,1,x,_,s,i,At,it,null,nt),xe());const S={};D[0]&32&&(S.title=x[5]),D[0]&2&&(S.active=!x[1]),y.$set(S),(!B||D[0]&1)&&q(g,"dragging",x[0])},i(x){if(!B){for(let D=0;D<_.length;D+=1)F(o[D]);F(y.$$.fragment,x),B=!0}},o(x){for(let D=0;D<o.length;D+=1)W(o[D]);W(y.$$.fragment,x),B=!1},d(x){x&&X(t);for(let D=0;D<o.length;D+=1)o[D].d();e[20](null),pe(y),e[22](null),e[23](null),p=!1,Ue(L)}}}const Ot=12,Ne=200,Pe=32,Ae=200,Ft=1600,st=.3;function Ut(e,t,n){let i,o,s,d;le(e,oe,v=>n(2,s=v)),le(e,fe,v=>n(11,d=v));const a=()=>{D(s.order[s.activeIndex])};let r,u=[],l=0,b=null,h=-1,m="",E,g,y,w=!1,H=!1,B=0,p=0,L,_=!1;const T=(v,C=300)=>{let R;return(...O)=>{clearTimeout(R),R=setTimeout(()=>{v.apply(void 0,O)},C)}};function x(){de.newTab()}const D=v=>{const C=s.order.findIndex(R=>R===v);if(C<0||!u[C]){console.warn("Cannot close tab!");return}l=u[C].getBoundingClientRect().width,C<s.order.length-1&&(r.style.setProperty("--tab-max-width",`${l}px`),S()),C==s.activeIndex&&(C==s.order.length-1?de.setActiveIndex(C-1):de.setActiveIndex(C+1)),Ze({duration:Ae,easing:ye,onStep:(R,O)=>{C==0?n(3,r.style.gridTemplateColumns=`minmax(${O*Pe}px, ${O*l}px)`,r):n(3,r.style.gridTemplateColumns=`repeat(${C}, minmax(var(--tab-min-width), var(--tab-max-width))) minmax(${O*Pe}px, ${O*l}px)`,r)},onEnd:()=>{n(3,r.style.gridTemplateColumns="",r),de.removeTab(v)}})},S=T(()=>{r&&(r.style.setProperty("--tab-max-width",`${Ne}px`),Ze({duration:Ae,easing:ye,onStep:(v,C)=>{r.style.setProperty("--tab-max-width",`${l+v*(Ne-l)}px`)},onEnd:()=>{r.style.setProperty("--tab-max-width",`${Ne}px`)}}))},Ft);function se(v){if(!r)return;const C=v.getBoundingClientRect().width;Ze({duration:Ae,easing:ye,onStep:(R,O)=>{s.order.length==1?n(3,r.style.gridTemplateColumns=`minmax(${R*Pe}px, ${R*C}px)`,r):n(3,r.style.gridTemplateColumns=`repeat(${s.order.length-1}, minmax(var(--tab-min-width), var(--tab-max-width))) minmax(${R*Pe}px, ${R*C}px)`,r),n(3,r.scrollLeft=r.scrollWidth,r)},onEnd:()=>{n(3,r.style.gridTemplateColumns="",r)}})}const ee=(v,C)=>{const R=u[0].getBoundingClientRect().width;de.moveTab(v,C,()=>{if(v>C)for(let O=C;O<v;O++)tt(u[O],{duration:Ae,easing:ye,css:(Me,ce)=>`transform: translateX(-${ce*R}px);`});if(v<C)for(let O=C;O>v;O--)tt(u[O],{duration:Ae,easing:ye,css:(Me,ce)=>`transform: translateX(${ce*R}px);`})})};function K(v){!v.target||!v.dataTransfer||(v.dataTransfer.setData("text/plain",i),v.dataTransfer.setDragImage(new Image,0,0))}function J(v,C){if(v==0&&C==0){n(6,y.style.left="-1000px",y),n(6,y.style.top="-1000px",y);return}let R=L.getBoundingClientRect();if(v<R.left||v>R.right||C<R.top||C>R.bottom){H||(p=0),n(6,y.style.left=`${v+B}px`,y),n(6,y.style.top=`${C-g.height/2}px`,y),n(1,H=!0);return}H&&n(1,H=!1),n(6,y.style.left=`${v+B}px`,y),n(6,y.style.top=`${g.top}px`,y);const O=-r.scrollLeft,Me=u[0].getBoundingClientRect().width;let ce=-1;if(v>O+s.order.length*Me)ce=s.order.length-1;else for(let Xe=0;Xe<s.order.length;Xe++)if(v>O+Xe*Me&&v<O+(Xe+1)*Me){ce=Xe;break}v<20?(p=-st,requestAnimationFrame(Ee)):v>r.clientWidth-10?(p=st,requestAnimationFrame(Ee)):p=0,!(ce==-1||ce==s.placeholderIndex)&&ee(s.placeholderIndex,ce)}let Z=0;function Ee(v){if(!w||p==0){Z=0;return}Z==0&&(Z=v);const C=v-Z;Z=v,r.scrollBy({left:p*C}),requestAnimationFrame(Ee)}function Ie(v,C){if(!v.target)return;let R,O;v instanceof TouchEvent?(R=v.touches[0].clientX,O=v.touches[0].clientY,v.preventDefault()):(R=v.clientX,O=v.clientY),window.addEventListener("touchmove",re,{passive:!1}),window.addEventListener("touchend",ie),window.addEventListener("mousemove",re),window.addEventListener("mouseup",ie),window.addEventListener("drag",re),window.addEventListener("dragend",ie),window.addEventListener("blur",ie),de.setActiveIndex(C),E=v.target,g=E.getBoundingClientRect(),b=[R,O],B=g.left-R,g.top-O,n(6,y.style.width=`${g.width}px`,y),n(6,y.style.left=`${g.left}px`,y),n(6,y.style.top=`${g.top}px`,y),h=C,n(5,m=d[s.order[C]].title)}function re(v){let C,R;if(v instanceof TouchEvent?(C=v.touches[0].clientX,R=v.touches[0].clientY):(C=v.clientX,R=v.clientY),w){J(C,R);return}b===null||Math.hypot(b[0]-C,b[1]-R)<Ot||(n(0,w=!0),de.setPlaceholderIndex(h),de.setActiveIndex(h))}function ie(){window.removeEventListener("touchmove",re),window.removeEventListener("touchend",ie),window.removeEventListener("mousemove",re),window.removeEventListener("mouseup",ie),window.removeEventListener("drag",re),window.removeEventListener("dragend",ie),window.removeEventListener("blur",ie),b=null,n(1,H=!1),h=-1,B=0,de.setPlaceholderIndex(),n(0,w=!1)}qe(()=>{r.style.setProperty("--tab-max-width",`${Ne}px`),r.style.setProperty("--tab-min-width",`${Pe}px`)});const Ke=(v,C)=>Ie(C,v);function Qe(v,C){e.$$.not_equal(d[C].title,v)&&(d[C].title=v,fe.set(d))}function k(v,C){Q[v?"unshift":"push"](()=>{u[C]=v,n(4,u)})}function $(v){Q[v?"unshift":"push"](()=>{r=v,n(3,r)})}const N=()=>{ae(oe,s.toolbarVisible=!s.toolbarVisible,s),s.toolbarVisible||ae(oe,s.activeTool=void 0,s)};function ke(v){Q[v?"unshift":"push"](()=>{y=v,n(6,y)})}function Ye(v){Q[v?"unshift":"push"](()=>{L=v,n(7,L)})}return e.$$.update=()=>{e.$$.dirty[0]&2&&(H?ae(oe,s.trashcanVisible=!0,s):ae(oe,s.trashcanVisible=!1,s)),e.$$.dirty[0]&4&&n(9,i=s.order[s.activeIndex]),e.$$.dirty[0]&4&&n(10,o=s.order[s.placeholderIndex]),e.$$.dirty[0]&1&&(w?n(8,_=!0):setTimeout(()=>{n(8,_=!1)},20))},[w,H,s,r,u,m,y,L,_,i,o,d,x,se,K,Ie,a,Ke,Qe,k,$,N,ke,Ye]}class qt extends _e{constructor(t){super(),we(this,t,Ut,Nt,be,{closeActiveTab:16},null,[-1,-1])}get closeActiveTab(){return this.$$.ctx[16]}}function Wt(e){let t,n;return{c(){t=P("div"),n=P("div"),this.h()},l(i){t=A(i,"DIV",{class:!0});var o=V(t);n=A(o,"DIV",{class:!0}),V(n).forEach(X),o.forEach(X),this.h()},h(){I(n,"class","quill-editor"),I(t,"class","quill-editor-container svelte-16m16ue"),q(t,"disabled",e[0])},m(i,o){ne(i,t,o),Y(t,n),e[5](n)},p(i,[o]){o&1&&q(t,"disabled",i[0])},i:ge,o:ge,d(i){i&&X(t),e[5](null)}}}function zt(e,t,n){let i,o;le(e,fe,p=>n(6,i=p)),le(e,vt,p=>n(4,o=p));let{tabID:s}=t,{disabled:d=!1}=t,a,r;const u=(p,L=300)=>{let _;return(...T)=>{clearTimeout(_),_=setTimeout(()=>{p.apply(void 0,T)},L)}};async function l(p){var x,D,S,se;if(!a)return;const{Delta:L,Range:_}=await et(async()=>{const{Delta:ee,Range:K}=await import("../chunks/core.CG__ofcG.js").then(J=>J.G);return{Delta:ee,Range:K}},[],import.meta.url);if(p.undo.length>0)for(var T=0;T<p.undo.length;T++){const ee=(x=p.undo[T].range)==null?void 0:x.index,K=(D=p.undo[T].range)==null?void 0:D.length,J={delta:new L(p.undo[T].delta.ops),range:ee!==void 0&&K!==void 0?new _(ee,K):null};a.history.stack.undo.push(J)}if(p.redo.length>0)for(var T=0;T<p.redo.length;T++){const K=(S=p.redo[T].range)==null?void 0:S.index,J=(se=p.redo[T].range)==null?void 0:se.length,Z={delta:new L(p.redo[T].delta.ops),range:K!==void 0&&J!==void 0?new _(K,J):null};a.history.stack.redo.push(Z)}}function b(p){var L;a&&((L=a.getSelection())==null?void 0:L.length)===0&&window.open(p.target.href,"_blank")}function h(){if(!a||!i[s])return;const p=i[s].ops;a.setContents(p);const L=i[s].history;l(L)}function m(){if(!a||!i[s])return;ae(fe,i[s].ops=a.getContents().ops,i);const p=structuredClone(a.history.stack);ae(fe,i[s].history=p,i)}const E=u(m,500);function g(){if(!a)return;a.formatText(0,a.getLength(),"link",!1,"api");const p=a.getText(),L=/https?:\/\/\S+/gi,_=p.matchAll(L);for(const D of _)a.formatText(D.index,D[0].length,"link",D[0],"api");const T=/.+\@.+\..+/gi,x=p.matchAll(T);for(const D of x)a.formatText(D.index,D[0].length,"link","mailto:"+D[0],"api");document.querySelectorAll(".ql-editor a").forEach(D=>{D.addEventListener("click",b)})}const y=u(g,500);function w(p,L,_){if(_==="user"){const T=a.getText().split(`
`)[0].trim();ae(fe,i[s].title=T===""?"Untitled":T,i),y(),E()}}async function H(){const{default:p}=await et(async()=>{const{default:L}=await import("../chunks/quill.Bk4jDS0q.js");return{default:L}},__vite__mapDeps([0,1]),import.meta.url);n(3,a=new p(r,{formats:["bold","italic","underline","strike","code","link"],placeholder:"Enter text here"})),h(),g(),a.on("text-change",w),a.keyboard.addBinding({key:"/",altKey:!0},()=>{a.format("code",!a.getFormat().code)}),a.keyboard.addBinding({key:"-",altKey:!0},()=>{a.format("strike",!a.getFormat().strike)})}qe(()=>{H()});function B(p){Q[p?"unshift":"push"](()=>{r=p,n(1,r)})}return e.$$set=p=>{"tabID"in p&&n(2,s=p.tabID),"disabled"in p&&n(0,d=p.disabled)},e.$$.update=()=>{e.$$.dirty&9&&(d?a==null||a.disable():a==null||a.enable()),e.$$.dirty&24&&(a==null||a.root.setAttribute("spellcheck",o.spellCheck.toString()))},[d,r,s,a,o,B]}class Gt extends _e{constructor(t){super(),we(this,t,zt,Wt,be,{tabID:2,disabled:0})}}const rt=500,jt=300,ot=500,Kt=300;class Qt{constructor(){U(this,"isMoving",!1);U(this,"isLongclick",!1);U(this,"button",0);U(this,"lastX",0);U(this,"lastY",0);U(this,"consecutiveClicks",0);U(this,"lastMouseupTime",0);U(this,"activeElement",null);this.reset()}reset(){this.isMoving=!1,this.isLongclick=!1,this.button=0,this.lastX=0,this.lastY=0,this.consecutiveClicks=0,this.lastMouseupTime=0,this.activeElement=null}}class Jt{constructor(){U(this,"isDragging",!1);U(this,"isPinching",!1);U(this,"isLongpressed",!1);U(this,"consecutiveTaps",0);U(this,"lastTouchendTime",0);U(this,"lastCenterX",0);U(this,"lastCenterY",0);U(this,"identifier",0);U(this,"x",0);U(this,"y",0);U(this,"hypotenuse",0);U(this,"activeElement",null);this.reset()}reset(){this.isDragging=!1,this.isPinching=!1,this.isLongpressed=!1,this.consecutiveTaps=0,this.lastTouchendTime=0,this.lastCenterX=0,this.lastCenterY=0,this.identifier=0,this.x=0,this.y=0,this.hypotenuse=0,this.activeElement=null}}let ue=[],f=new Qt,c=new Jt;const M=(e,t)=>{e!=null&&e.dispatchEvent(new CustomEvent("gesture",{detail:t,bubbles:!1,cancelable:!1}))},yt=e=>{f.reset(),c.reset(),f.lastMouseupTime=Date.now(),window.removeEventListener("mousemove",ze),window.removeEventListener("mouseup",Ge),window.removeEventListener("touchmove",je),window.removeEventListener("touchend",Ce)},_t=e=>{if(window.removeEventListener("mousemove",ze),window.removeEventListener("mouseup",Ge),window.removeEventListener("touchmove",je),window.removeEventListener("touchend",Ce),f.isMoving)if(f.isMoving=!1,f.isLongclick)f.isLongclick=!1,M(f.activeElement,{event:e,name:"longclick-drag-end",x:f.lastX,y:f.lastY,dx:0,dy:0});else switch(f.button){case 0:M(f.activeElement,{event:e,name:"left-click-drag-end",x:f.lastX,y:f.lastY,dx:0,dy:0});break;case 1:M(f.activeElement,{event:e,name:"middle-click-drag-end",x:f.lastX,y:f.lastY,dx:0,dy:0});break;case 2:M(f.activeElement,{event:e,name:"right-click-drag-end",x:f.lastX,y:f.lastY,dx:0,dy:0});break}f.isLongclick&&M(f.activeElement,{event:e,name:"longclick-release",x:f.lastX,y:f.lastY,dx:0,dy:0}),f.reset(),c.isDragging&&(c.isDragging=!1,c.isLongpressed?(c.isLongpressed=!1,M(c.activeElement,{event:e,name:"longpress-drag-end",x:c.lastCenterX,y:c.lastCenterY,dx:0,dy:0})):M(c.activeElement,{event:e,name:"touch-drag-end",x:c.lastCenterX,y:c.lastCenterY,dx:0,dy:0})),c.isLongpressed&&M(c.activeElement,{event:e,name:"longpress-release",x:c.lastCenterX,y:c.lastCenterY,dx:0,dy:0}),c.reset()},wt=e=>{M(e.target,{event:e,name:"wheel",x:e.clientX,y:e.clientY,dx:0,dy:0})},Et=e=>{},kt=e=>{document.activeElement!==e.target&&(window.addEventListener("mousemove",ze),window.addEventListener("mouseup",Ge),f.activeElement=e.target,f.lastX=e.clientX,f.lastY=e.clientY,f.isMoving||(f.button=e.button),f.button===0&&window.setTimeout(()=>{Date.now()-f.lastMouseupTime>=ot&&!f.isMoving&&(f.isLongclick=!0,M(f.activeElement,{event:e,name:"longclick",x:e.clientX,y:e.clientY,dx:0,dy:0}))},ot))},ze=e=>{if(e.movementX===0&&e.movementY===0)return;let t=e.clientX-f.lastX,n=e.clientY-f.lastY;if(!f.isMoving)if(f.isLongclick)M(f.activeElement,{event:e,name:"longclick-drag-start",x:e.clientX,y:e.clientY,dx:0,dy:0});else switch(f.button){case 0:M(f.activeElement,{event:e,name:"left-click-drag-start",x:e.clientX,y:e.clientY,dx:0,dy:0});break;case 1:M(f.activeElement,{event:e,name:"middle-click-drag-start",x:e.clientX,y:e.clientY,dx:0,dy:0});break;case 2:M(f.activeElement,{event:e,name:"right-click-drag-start",x:e.clientX,y:e.clientY,dx:0,dy:0});break}if(f.isMoving=!0,f.lastX=e.clientX,f.lastY=e.clientY,f.isLongclick)M(f.activeElement,{event:e,name:"longclick-dragging",x:e.clientX,y:e.clientY,dx:t,dy:n});else switch(f.button){case 0:M(f.activeElement,{event:e,name:"left-click-dragging",x:e.clientX,y:e.clientY,dx:t,dy:n});break;case 1:M(f.activeElement,{event:e,name:"middle-click-dragging",x:e.clientX,y:e.clientY,dx:t,dy:n});break;case 2:M(f.activeElement,{event:e,name:"right-click-dragging",x:e.clientX,y:e.clientY,dx:t,dy:n});break}},Ge=e=>{if(window.removeEventListener("mousemove",ze),window.removeEventListener("mouseup",Ge),f.lastMouseupTime=Date.now(),f.isMoving)if(f.isMoving=!1,f.isLongclick)f.isLongclick=!1,M(f.activeElement,{event:e,name:"longclick-drag-end",x:f.lastX,y:f.lastY,dx:0,dy:0});else switch(f.button){case 0:M(f.activeElement,{event:e,name:"left-click-drag-end",x:f.lastX,y:f.lastY,dx:0,dy:0});break;case 1:M(f.activeElement,{event:e,name:"middle-click-drag-end",x:f.lastX,y:f.lastY,dx:0,dy:0});break;case 2:M(f.activeElement,{event:e,name:"right-click-drag-end",x:f.lastX,y:f.lastY,dx:0,dy:0});break}else f.isLongclick||(e.button===2?M(f.activeElement,{event:e,name:"right-click",x:e.clientX,y:e.clientY,dx:0,dy:0}):e.button===1?M(f.activeElement,{event:e,name:"middle-click",x:e.clientX,y:e.clientY,dx:0,dy:0}):(f.consecutiveClicks===0&&M(f.activeElement,{event:e,name:"left-click",x:e.clientX,y:e.clientY,dx:0,dy:0}),f.consecutiveClicks++,window.setTimeout(()=>{f.consecutiveClicks>1&&M(f.activeElement,{event:e,name:"double-click",x:e.clientX,y:e.clientY,dx:0,dy:0}),f.consecutiveClicks=0},Kt)));f.isLongclick&&M(f.activeElement,{event:e,name:"longclick-release",x:e.clientX,y:e.clientY,dx:0,dy:0}),f.isLongclick=!1},Tt=e=>{if(document.activeElement!==e.target){if(e.preventDefault(),e.stopPropagation(),e.touches.length>1){if(e.touches[0].identifier===c.identifier)return;c.isPinching=!0}window.addEventListener("touchmove",je,{passive:!1}),window.addEventListener("touchend",Ce),window.addEventListener("touchcancel",Ce),c.identifier=e.touches[0].identifier,c.x=e.touches[0].clientX,c.y=e.touches[0].clientY,c.activeElement=e.target,window.setTimeout(()=>{c.isPinching||c.isDragging||Date.now()-c.lastTouchendTime>=rt&&(c.isDragging=!1,c.isPinching=!1,c.hypotenuse=null,c.isLongpressed=!0,M(c.activeElement,{event:e,name:"longpress",x:c.x,y:c.y,dx:0,dy:0}))},rt)}},je=e=>{if(c.isDragging){let t=c.x,n=c.y;c.x=e.touches[0].clientX,c.y=e.touches[0].clientY;let i=c.x-t,o=c.y-n;c.isLongpressed?M(c.activeElement,{event:e,name:"longpress-dragging",x:c.x,y:c.y,dx:i,dy:o,force:e.touches[0].force}):M(c.activeElement,{event:e,name:"touch-dragging",x:c.x,y:c.y,dx:i,dy:o,force:e.touches[0].force});return}else if(!c.isLongpressed&&(c.isPinching||e.touches.length>1)){c.x=e.touches[0].clientX,c.y=e.touches[0].clientY;let t={x:e.touches[1].clientX,y:e.touches[1].clientY},n={x:(c.x+t.x)/2,y:(c.y+t.y)/2},i=Math.hypot(c.x-t.x,c.y-t.y);c.hypotenuse===null&&(c.hypotenuse=i,c.lastCenterX=n.x,c.lastCenterY=n.y,M(c.activeElement,{event:e,name:"pinch-start",x:n.x,y:n.y,dx:0,dy:0})),c.isPinching=!0;let o=i/c.hypotenuse,s=n.x-c.lastCenterX,d=n.y-c.lastCenterY;M(c.activeElement,{event:e,name:"pinching",x:n.x,y:n.y,zoom:o,dx:s,dy:d}),c.hypotenuse=i,c.lastCenterX=n.x,c.lastCenterY=n.y;return}else c.isDragging=!0,c.isLongpressed?(M(c.activeElement,{event:e,name:"longpress-drag-start",x:c.x,y:c.y,dx:0,dy:0,force:e.touches[0].force}),c.x=e.touches[0].clientX,c.y=e.touches[0].clientY,M(c.activeElement,{event:e,name:"longpress-dragging",x:c.x,y:c.y,dx:0,dy:0,force:e.touches[0].force})):(M(c.activeElement,{event:e,name:"touch-drag-start",x:c.x,y:c.y,dx:0,dy:0,force:e.touches[0].force}),c.x=e.touches[0].clientX,c.y=e.touches[0].clientY,M(c.activeElement,{event:e,name:"touch-dragging",x:c.x,y:c.y,dx:0,dy:0,force:e.touches[0].force}))},Ce=e=>{c.isDragging&&e.touches.length>0&&e.touches[0].identifier===c.identifier||(c.lastTouchendTime=Date.now(),window.removeEventListener("touchmove",je),window.removeEventListener("touchend",Ce),window.removeEventListener("touchcancel",Ce),c.isDragging?(c.isDragging=!1,c.isLongpressed?(c.isLongpressed=!1,M(c.activeElement,{event:e,name:"longpress-drag-end",x:c.x,y:c.y,dx:0,dy:0})):M(c.activeElement,{event:e,name:"touch-drag-end",x:c.x,y:c.y,dx:0,dy:0})):c.isPinching?(c.isPinching=!1,c.hypotenuse=null,M(c.activeElement,{event:e,name:"pinch-end",x:c.lastCenterX,y:c.lastCenterY,dx:0,dy:0})):c.isLongpressed||(c.consecutiveTaps===0&&M(c.activeElement,{event:e,name:"tap",x:c.x,y:c.y,dx:0,dy:0}),c.consecutiveTaps++,window.setTimeout(()=>{c.consecutiveTaps>1&&M(c.activeElement,{event:e,name:"double-tap",x:c.x,y:c.y,dx:0,dy:0}),c.consecutiveTaps=0},jt)),c.isLongpressed&&M(c.activeElement,{event:e,name:"longpress-release",x:c.x,y:c.y,dx:0,dy:0}),c.isLongpressed=!1)};function Zt(...e){for(let t of e)ue.findIndex(n=>n===t)===-1&&(ue.length==0&&(window.addEventListener("blur",_t),window.addEventListener("focus",yt)),ue.push(t),t.addEventListener("touchstart",Tt,{passive:!1}),t.addEventListener("mousedown",kt,{passive:!1}),t.addEventListener("contextmenu",Et,{passive:!1}),t.addEventListener("wheel",wt,{passive:!1}))}function $t(...e){const t=n=>{n.removeEventListener("touchstart",Tt),n.removeEventListener("mousedown",kt),n.removeEventListener("contextmenu",Et),n.removeEventListener("wheel",wt)};if(e.length==0){for(let n of ue)t(n);ue=[]}else for(let n of e){let i=ue.findIndex(o=>o===n);i!==-1&&(t(n),ue.splice(i,1))}ue.length==0&&(window.removeEventListener("blur",_t),window.removeEventListener("focus",yt))}function en(e){let t,n,i,o;return{c(){t=P("div"),n=P("canvas"),i=G(),o=P("canvas"),this.h()},l(s){t=A(s,"DIV",{class:!0});var d=V(t);n=A(d,"CANVAS",{id:!0,class:!0}),V(n).forEach(X),i=j(d),o=A(d,"CANVAS",{id:!0,class:!0}),V(o).forEach(X),d.forEach(X),this.h()},h(){I(n,"id","currentPath"),I(n,"class","svelte-1d1danm"),I(o,"id","canvas"),I(o,"class","svelte-1d1danm"),I(t,"class","drawing-container svelte-1d1danm"),q(t,"hide",e[1]),q(t,"disabled",e[0])},m(s,d){ne(s,t,d),Y(t,n),e[11](n),Y(t,i),Y(t,o),e[12](o)},p(s,d){d[0]&2&&q(t,"hide",s[1]),d[0]&1&&q(t,"disabled",s[0])},i:ge,o:ge,d(s){s&&X(t),e[11](null),e[12](null)}}}const tn=2,nn=178;function sn(e,t,n){var i=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),o=Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2)),s=Math.sqrt(Math.pow(n.x-e.x,2)+Math.pow(n.y-e.y,2)),d=Math.acos((o*o+i*i-s*s)/(2*o*i));return d*(180/Math.PI)}function at(e){if(e.points.length<4)return e;for(let t=1;t<e.points.length-2;t++){const n=e.points[t-1],i=e.points[t],o=e.points[t+1];sn(n,i,o)>nn&&(e.points.splice(t,1),t--)}return e}async function He(e,t){if(t.lineWidth=e.lineWidth,t.lineCap="round",t.strokeStyle=e.color,e.points.length<2){t.beginPath(),t.moveTo(e.points[0].x,e.points[0].y),t.lineTo(e.points[0].x,e.points[0].y),t.stroke();return}t.beginPath();let n=e.points[0].x,i=e.points[0].y;for(let o=0;o<e.points.length-1;o++)t.moveTo(n,i),n=(e.points[o].x+e.points[o+1].x)/2,i=(e.points[o].y+e.points[o+1].y)/2,t.quadraticCurveTo(e.points[o].x,e.points[o].y,n,i);t.stroke()}function rn(e){return{x:lt(e.x),y:lt(e.y)}}function lt(e){const t=e.toFixed(tn);return Number(t)}function on(e,t,n){let i;le(e,fe,k=>n(23,i=k));let{radius:o=3}=t,{smoothness:s=0}=t,{stroke:d=5}=t,{color:a="#000000"}=t,{disabled:r=!1}=t,{hide:u=!1}=t,{tabID:l=""}=t;const b=()=>{E.clearRect(0,0,B/p,H/p),x=[]},h=()=>{if(x.length!=0){x.pop(),y.clearRect(0,0,B/p,H/p);for(let k=0;k<x.length;k++)He(x[k],y);J()}};let m,E,g,y,w={x:0,y:0},H=0,B=0,p,L=!1,_,T,x=[];function D(){m&&(Zt(m),window.addEventListener("keydown",ie))}function S(){m&&($t(m),window.removeEventListener("keydown",ie))}const se=(k,$,N,ke)=>{var Ye=N-k,v=ke-$;return Math.sqrt(Ye*Ye+v*v)};function ee(k,$){let N=m.getBoundingClientRect();return{x:k-N.left,y:$-N.top}}function K(){if(!m||!g)return;re(),p=window.devicePixelRatio;let k=m.getBoundingClientRect();H=k.height*p,B=k.width*p,n(2,m.width=B,m),n(2,m.height=H,m),n(3,g.width=B,g),n(3,g.height=H,g),E.scale(p,p),y.scale(p,p);for(let $=0;$<x.length;$++)He(x[$],y)}function J(){i[l]&&ae(fe,i[l].paths=x.filter(k=>at(k)),i)}function Z(){i[l]&&(x=i[l].paths,K())}function Ee(k,$){L=!0,w=ee(k,$),E.lineWidth=d,E.lineCap="round",E.strokeStyle=a,E.beginPath(),E.moveTo(w.x,w.y),E.stroke(),_={points:[],lineWidth:d,color:a}}function Ie(k,$){if(!L)return;let N=ee(k,$);if(o>0){if(se(N.x,N.y,w.x,w.y)<=o){_.points.length===0&&(_.points.push(N),He(_,E));return}let ke=Math.sqrt(N.x*N.x+N.y*N.y-2*N.x*w.x+w.x*w.x-2*N.y*w.y+w.y*w.y);if(N={x:N.x+o*((w.x-N.x)/ke),y:N.y+o*((w.y-N.y)/ke)},se(w.x,w.y,N.x,N.y)<=s)return}_.points.push(rn(N)),E.clearRect(0,0,B/p,H/p),He(_,E),w=N}function re(){L&&(x.push(at(_)),He(_,y),E.clearRect(0,0,B/p,H/p),J()),L=!1}const ie=function(k){k.ctrlKey&&k.key=="z"&&h(),k.preventDefault()};qe(()=>{E=m.getContext("2d"),E.imageSmoothingEnabled=!1,y=g.getContext("2d"),y.imageSmoothingEnabled=!1,m.addEventListener("gesture",k=>{switch(k.detail.name){case"left-click-drag-start":case"touch-drag-start":Ee(k.detail.x,k.detail.y);break;case"left-click-dragging":case"touch-dragging":Ie(k.detail.x,k.detail.y);break;case"left-click-drag-end":case"touch-drag-end":re();break;case"left-click":case"tap":Ee(k.detail.x,k.detail.y),Ie(k.detail.x,k.detail.y),re();break}}),T=new ResizeObserver(K),T.observe(m),Z(),r?S():D()}),ht(()=>{T&&T.disconnect(),S()});function Ke(k){Q[k?"unshift":"push"](()=>{g=k,n(3,g)})}function Qe(k){Q[k?"unshift":"push"](()=>{m=k,n(2,m)})}return e.$$set=k=>{"radius"in k&&n(4,o=k.radius),"smoothness"in k&&n(5,s=k.smoothness),"stroke"in k&&n(6,d=k.stroke),"color"in k&&n(7,a=k.color),"disabled"in k&&n(0,r=k.disabled),"hide"in k&&n(1,u=k.hide),"tabID"in k&&n(8,l=k.tabID)},e.$$.update=()=>{e.$$.dirty[0]&1&&(r?S():D())},[r,u,m,g,o,s,d,a,l,b,h,Ke,Qe]}class an extends _e{constructor(t){super(),we(this,t,on,en,be,{radius:4,smoothness:5,stroke:6,color:7,disabled:0,hide:1,tabID:8,clear:9,undo:10},null,[-1,-1])}get clear(){return this.$$.ctx[9]}get undo(){return this.$$.ctx[10]}}function Fe(e,{delay:t=0,duration:n=400,easing:i=bt,axis:o="y"}={}){const s=getComputedStyle(e),d=+s.opacity,a=o==="y"?"height":"width",r=parseFloat(s[a]),u=o==="y"?["top","bottom"]:["left","right"],l=u.map(w=>`${w[0].toUpperCase()}${w.slice(1)}`),b=parseFloat(s[`padding${l[0]}`]),h=parseFloat(s[`padding${l[1]}`]),m=parseFloat(s[`margin${l[0]}`]),E=parseFloat(s[`margin${l[1]}`]),g=parseFloat(s[`border${l[0]}Width`]),y=parseFloat(s[`border${l[1]}Width`]);return{delay:t,duration:n,easing:i,css:w=>`overflow: hidden;opacity: ${Math.min(w*20,1)*d};${a}: ${w*r}px;padding-${u[0]}: ${w*b}px;padding-${u[1]}: ${w*h}px;margin-${u[0]}: ${w*m}px;margin-${u[1]}: ${w*E}px;border-${u[0]}-width: ${w*g}px;border-${u[1]}-width: ${w*y}px;`}}function ct(e,{delay:t=0,duration:n=400,easing:i=bt,start:o=0,opacity:s=0}={}){const d=getComputedStyle(e),a=+d.opacity,r=d.transform==="none"?"":d.transform,u=1-o,l=a*(1-s);return{delay:t,duration:n,easing:i,css:(b,h)=>`
			transform: ${r} scale(${1-u*h});
			opacity: ${a-l*h}
		`}}function dt(e){let t,n,i=`<span class="button-icon svelte-lafg0f" style="-webkit-mask: url(${z}/images/svg/undo.svg) no-repeat center / contain; mask: url(${z}/images/svg/undo.svg) no-repeat center / contain;"></span>`,o,s,d,a,r,u,l,b;return{c(){t=P("div"),n=P("button"),n.innerHTML=i,o=G(),s=P("input"),d=G(),a=P("input"),this.h()},l(h){t=A(h,"DIV",{class:!0});var m=V(t);n=A(m,"BUTTON",{class:!0,"data-svelte-h":!0}),Te(n)!=="svelte-1b4fip4"&&(n.innerHTML=i),o=j(m),s=A(m,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),d=j(m),a=A(m,"INPUT",{type:!0,class:!0}),m.forEach(X),this.h()},h(){I(n,"class","button svelte-lafg0f"),I(s,"type","range"),I(s,"min","2"),I(s,"max","20"),I(s,"step","2"),I(s,"class","slider svelte-lafg0f"),I(a,"type","color"),I(a,"class","color-picker svelte-lafg0f"),I(t,"class","pencil-tools svelte-lafg0f")},m(h,m){ne(h,t,m),Y(t,n),Y(t,o),Y(t,s),Be(s,e[0]),Y(t,d),Y(t,a),Be(a,e[1]),u=!0,l||(b=[te(n,"click",function(){Se(e[3])&&e[3].apply(this,arguments)}),te(s,"change",e[8]),te(s,"input",e[8]),te(a,"input",e[9])],l=!0)},p(h,m){e=h,m&1&&Be(s,e[0]),m&2&&Be(a,e[1])},i(h){u||(h&&We(()=>{u&&(r||(r=De(t,Fe,{duration:200,axis:"x"},!0)),r.run(1))}),u=!0)},o(h){h&&(r||(r=De(t,Fe,{duration:200,axis:"x"},!1)),r.run(0)),u=!1},d(h){h&&X(t),h&&r&&r.end(),l=!1,Ue(b)}}}function ln(e){let t,n,i=`<span class="button-icon svelte-lafg0f" style="-webkit-mask: url(${z}/images/svg/pencil.svg) no-repeat center / contain; mask: url(${z}/images/svg/pencil.svg) no-repeat center / contain;"></span>`,o,s,d=`<span class="button-icon svelte-lafg0f" style="-webkit-mask: url(${z}/images/svg/highlighter.svg) no-repeat center / contain; mask: url(${z}/images/svg/highlighter.svg) no-repeat center / contain;"></span>`,a,r,u,l,b,h,m,E,g,y=`<span class="button-icon svelte-lafg0f" style="-webkit-mask: url(${z}/images/svg/user.svg) no-repeat center / contain; mask: url(${z}/images/svg/user.svg) no-repeat center / contain;"></span>`,w,H,B,p,L=(e[4].activeTool==="pencil"||e[4].activeTool==="highlighter")&&dt(e);return{c(){t=P("div"),n=P("button"),n.innerHTML=i,o=G(),s=P("button"),s.innerHTML=d,a=G(),L&&L.c(),r=G(),u=P("div"),l=G(),b=P("button"),h=P("span"),E=G(),g=P("a"),g.innerHTML=y,this.h()},l(_){t=A(_,"DIV",{class:!0});var T=V(t);n=A(T,"BUTTON",{class:!0,"data-svelte-h":!0}),Te(n)!=="svelte-t1zbc2"&&(n.innerHTML=i),o=j(T),s=A(T,"BUTTON",{class:!0,"data-svelte-h":!0}),Te(s)!=="svelte-113qxbd"&&(s.innerHTML=d),a=j(T),L&&L.l(T),r=j(T),u=A(T,"DIV",{class:!0}),V(u).forEach(X),l=j(T),b=A(T,"BUTTON",{class:!0});var x=V(b);h=A(x,"SPAN",{class:!0,style:!0}),V(h).forEach(X),x.forEach(X),E=j(T),g=A(T,"A",{class:!0,href:!0,"data-svelte-h":!0}),Te(g)!=="svelte-1xuhzhs"&&(g.innerHTML=y),T.forEach(X),this.h()},h(){I(n,"class","pencil button svelte-lafg0f"),q(n,"selected",e[4].activeTool==="pencil"),I(s,"class","button svelte-lafg0f"),q(s,"selected",e[4].activeTool==="highlighter"),I(u,"class","spacer svelte-lafg0f"),I(h,"class","button-icon svelte-lafg0f"),Oe(h,"-webkit-mask","url("+z+"/images/svg/refresh.svg) no-repeat center / contain"),Oe(h,"mask","url("+z+"/images/svg/refresh.svg) no-repeat center / contain"),I(b,"class","refresh button svelte-lafg0f"),b.disabled=m=e[5].savingStatus==="saving",I(g,"class","button svelte-lafg0f"),I(g,"href",z+"/profile"),I(t,"class","toolbar-container svelte-lafg0f")},m(_,T){ne(_,t,T),Y(t,n),Y(t,o),Y(t,s),Y(t,a),L&&L.m(t,null),Y(t,r),Y(t,u),Y(t,l),Y(t,b),Y(b,h),Y(t,E),Y(t,g),H=!0,B||(p=[te(n,"click",e[6]),te(s,"click",e[7]),te(b,"click",function(){Se(e[2])&&e[2].apply(this,arguments)})],B=!0)},p(_,[T]){e=_,(!H||T&16)&&q(n,"selected",e[4].activeTool==="pencil"),(!H||T&16)&&q(s,"selected",e[4].activeTool==="highlighter"),e[4].activeTool==="pencil"||e[4].activeTool==="highlighter"?L?(L.p(e,T),T&16&&F(L,1)):(L=dt(e),L.c(),F(L,1),L.m(t,r)):L&&(Le(),W(L,1,1,()=>{L=null}),xe()),(!H||T&32&&m!==(m=e[5].savingStatus==="saving"))&&(b.disabled=m)},i(_){H||(F(L),_&&We(()=>{H&&(w||(w=De(t,Fe,{duration:200},!0)),w.run(1))}),H=!0)},o(_){W(L),_&&(w||(w=De(t,Fe,{duration:200},!1)),w.run(0)),H=!1},d(_){_&&X(t),L&&L.d(),_&&w&&w.end(),B=!1,Ue(p)}}}function cn(e,t,n){let i,o;le(e,oe,m=>n(4,i=m)),le(e,mt,m=>n(5,o=m));let{onRefresh:s=()=>{}}=t,{onDrawingUndo:d=()=>{}}=t,{stroke:a}=t,{color:r}=t;const u=()=>{ae(oe,i.activeTool=i.activeTool==="pencil"?void 0:"pencil",i)},l=()=>{ae(oe,i.activeTool=i.activeTool==="highlighter"?void 0:"highlighter",i)};function b(){a=Mt(this.value),n(0,a)}function h(){r=this.value,n(1,r)}return e.$$set=m=>{"onRefresh"in m&&n(2,s=m.onRefresh),"onDrawingUndo"in m&&n(3,d=m.onDrawingUndo),"stroke"in m&&n(0,a=m.stroke),"color"in m&&n(1,r=m.color)},[a,r,s,d,i,o,u,l,b,h]}class dn extends _e{constructor(t){super(),we(this,t,cn,ln,be,{onRefresh:2,onDrawingUndo:3,stroke:0,color:1})}}function un(e){let t,n,i,o;return{c(){t=P("div"),n=P("div"),this.h()},l(s){t=A(s,"DIV",{class:!0});var d=V(t);n=A(d,"DIV",{class:!0,style:!0}),V(n).forEach(X),d.forEach(X),this.h()},h(){I(n,"class","trashcan-icon svelte-1y4fjoy"),Oe(n,"-webkit-mask","url("+z+"/images/svg/trash.svg) no-repeat center / contain"),Oe(n,"mask","url("+z+"/images/svg/trash.svg) no-repeat center / contain"),q(n,"overTrashcan",e[1]),I(t,"class","trashcan svelte-1y4fjoy")},m(s,d){ne(s,t,d),Y(t,n),e[3](t),o=!0},p(s,[d]){(!o||d&2)&&q(n,"overTrashcan",s[1])},i(s){o||(s&&We(()=>{o&&(i||(i=De(t,ct,{duration:200},!0)),i.run(1))}),o=!0)},o(s){s&&(i||(i=De(t,ct,{duration:200},!1)),i.run(0)),o=!1},d(s){s&&X(t),e[3](null),s&&i&&i.end()}}}function fn(e,t,n){let{throwAway:i=()=>{}}=t,o,s=!1;const d=u=>{const l=o.getBoundingClientRect(),b=u instanceof MouseEvent?u.clientX:u.touches[0].clientX,h=u instanceof MouseEvent?u.clientY:u.touches[0].clientY;if(b<l.left||b>l.right||h<l.top||h>l.bottom){n(1,s=!1);return}n(1,s=!0)},a=u=>{const l=o.getBoundingClientRect(),b=u instanceof MouseEvent?u.clientX:u.touches[0].clientX,h=u instanceof MouseEvent?u.clientY:u.touches[0].clientY;if(b<l.left||b>l.right||h<l.top||h>l.bottom){n(1,s=!1);return}i()};qe(()=>{window.addEventListener("mousemove",d),window.addEventListener("touchmove",d),window.addEventListener("drag",d),window.addEventListener("dragend",a),window.addEventListener("mouseup",a),window.addEventListener("touchend",a)}),ht(()=>{window.removeEventListener("mousemove",d),window.removeEventListener("touchmove",d),window.removeEventListener("drag",d),window.removeEventListener("dragend",a),window.removeEventListener("mouseup",a),window.removeEventListener("touchend",a)});function r(u){Q[u?"unshift":"push"](()=>{o=u,n(0,o)})}return e.$$set=u=>{"throwAway"in u&&n(2,i=u.throwAway)},[o,s,i,r]}class gn extends _e{constructor(t){super(),we(this,t,fn,un,be,{throwAway:2})}}function ut(e){let t,n,i,o;function s(r){e[12](r)}function d(r){e[13](r)}let a={onDrawingUndo:e[10],onRefresh:e[11]};return e[4]!==void 0&&(a.stroke=e[4]),e[0]!==void 0&&(a.color=e[0]),t=new dn({props:a}),Q.push(()=>Ve(t,"stroke",s)),Q.push(()=>Ve(t,"color",d)),{c(){he(t.$$.fragment)},l(r){ve(t.$$.fragment,r)},m(r,u){me(t,r,u),o=!0},p(r,u){const l={};u&64&&(l.onDrawingUndo=r[10]),!n&&u&16&&(n=!0,l.stroke=r[4],Re(()=>n=!1)),!i&&u&1&&(i=!0,l.color=r[0],Re(()=>i=!1)),t.$set(l)},i(r){o||(F(t.$$.fragment,r),o=!0)},o(r){W(t.$$.fragment,r),o=!1},d(r){pe(t,r)}}}function hn(e){let t,n;return t=new Rt({}),{c(){he(t.$$.fragment)},l(i){ve(t.$$.fragment,i)},m(i,o){me(t,i,o),n=!0},p:ge,i(i){n||(F(t.$$.fragment,i),n=!0)},o(i){W(t.$$.fragment,i),n=!1},d(i){pe(t,i)}}}function vn(e){let t,n,i=e[7],o,s,d,a=ft(e),r=e[2].trashcanVisible&&gt(e);return{c(){t=P("div"),n=P("div"),a.c(),o=G(),r&&r.c(),this.h()},l(u){t=A(u,"DIV",{class:!0});var l=V(t);n=A(l,"DIV",{class:!0});var b=V(n);a.l(b),b.forEach(X),o=j(l),r&&r.l(l),l.forEach(X),this.h()},h(){I(n,"class","editor-container svelte-5x76h8"),I(t,"class","scrollable-canvas svelte-5x76h8"),We(()=>e[17].call(t))},m(u,l){ne(u,t,l),Y(t,n),a.m(n,null),Y(t,o),r&&r.m(t,null),s=Xt(t,e[17].bind(t)),d=!0},p(u,l){l&128&&be(i,i=u[7])?(Le(),W(a,1,1,ge),xe(),a=ft(u),a.c(),F(a,1),a.m(n,null)):a.p(u,l),u[2].trashcanVisible?r?(r.p(u,l),l&4&&F(r,1)):(r=gt(u),r.c(),F(r,1),r.m(t,null)):r&&(Le(),W(r,1,1,()=>{r=null}),xe())},i(u){d||(F(a),F(r),d=!0)},o(u){W(a),W(r),d=!1},d(u){u&&X(t),a.d(u),r&&r.d(),s()}}}function ft(e){let t,n,i,o,s,d;t=new Gt({props:{tabID:e[7]}});function a(l){e[15](l)}function r(l){e[16](l)}let u={tabID:e[7],disabled:e[2].activeTool===void 0};return e[3]!==void 0&&(u.color=e[3]),e[4]!==void 0&&(u.stroke=e[4]),i=new an({props:u}),e[14](i),Q.push(()=>Ve(i,"color",a)),Q.push(()=>Ve(i,"stroke",r)),{c(){he(t.$$.fragment),n=G(),he(i.$$.fragment)},l(l){ve(t.$$.fragment,l),n=j(l),ve(i.$$.fragment,l)},m(l,b){me(t,l,b),ne(l,n,b),me(i,l,b),d=!0},p(l,b){const h={};b&128&&(h.tabID=l[7]),t.$set(h);const m={};b&128&&(m.tabID=l[7]),b&4&&(m.disabled=l[2].activeTool===void 0),!o&&b&8&&(o=!0,m.color=l[3],Re(()=>o=!1)),!s&&b&16&&(s=!0,m.stroke=l[4],Re(()=>s=!1)),i.$set(m)},i(l){d||(F(t.$$.fragment,l),F(i.$$.fragment,l),d=!0)},o(l){W(t.$$.fragment,l),W(i.$$.fragment,l),d=!1},d(l){l&&X(n),pe(t,l),e[14](null),pe(i,l)}}}function gt(e){let t,n,i;return n=new gn({props:{throwAway:e[5].closeActiveTab}}),{c(){t=P("div"),he(n.$$.fragment),this.h()},l(o){t=A(o,"DIV",{class:!0});var s=V(t);ve(n.$$.fragment,s),s.forEach(X),this.h()},h(){I(t,"class","trashcan-container svelte-5x76h8")},m(o,s){ne(o,t,s),me(n,t,null),i=!0},p(o,s){const d={};s&32&&(d.throwAway=o[5].closeActiveTab),n.$set(d)},i(o){i||(F(n.$$.fragment,o),i=!0)},o(o){W(n.$$.fragment,o),i=!1},d(o){o&&X(t),pe(n)}}}function mn(e){let t,n,i,o,s,d,a,r,u={};n=new qt({props:u}),e[9](n);let l=e[2].toolbarVisible&&e[2].order.length>0&&ut(e);const b=[vn,hn],h=[];function m(E,g){return E[8].currentUser&&!E[8].isLoading?0:1}return d=m(e),a=h[d]=b[d](e),{c(){t=P("div"),he(n.$$.fragment),i=G(),o=P("div"),l&&l.c(),s=G(),a.c(),this.h()},l(E){t=A(E,"DIV",{class:!0});var g=V(t);ve(n.$$.fragment,g),i=j(g),o=A(g,"DIV",{class:!0});var y=V(o);l&&l.l(y),y.forEach(X),s=j(g),a.l(g),g.forEach(X),this.h()},h(){I(o,"class","toolbar"),I(t,"class","page-container svelte-5x76h8")},m(E,g){ne(E,t,g),me(n,t,null),Y(t,i),Y(t,o),l&&l.m(o,null),Y(t,s),h[d].m(t,null),r=!0},p(E,[g]){const y={};n.$set(y),E[2].toolbarVisible&&E[2].order.length>0?l?(l.p(E,g),g&4&&F(l,1)):(l=ut(E),l.c(),F(l,1),l.m(o,null)):l&&(Le(),W(l,1,1,()=>{l=null}),xe());let w=d;d=m(E),d===w?h[d].p(E,g):(Le(),W(h[w],1,1,()=>{h[w]=null}),xe(),a=h[d],a?a.p(E,g):(a=h[d]=b[d](E),a.c()),F(a,1),a.m(t,null))},i(E){r||(F(n.$$.fragment,E),F(l),F(a),r=!0)},o(E){W(n.$$.fragment,E),W(l),W(a),r=!1},d(E){E&&X(t),e[9](null),pe(n),l&&l.d(),h[d].d()}}}function pn(e,t){var n=parseInt(e.slice(1,3),16),i=parseInt(e.slice(3,5),16),o=parseInt(e.slice(5,7),16);return"rgba("+n+", "+i+", "+o+", "+t+")"}function bn(e,t,n){let i,o,s,d;le(e,oe,_=>n(2,o=_)),le(e,vt,_=>n(18,s=_)),le(e,mt,_=>n(8,d=_));let a="#000000",r="rgba(0, 0, 0, 1)",u=10,l,b;oe.subscribe(_=>{if(_.activeTool==="highlighter")n(0,a="#ffdd33");else if(_.activeTool==="pencil"){const T=Ht.find(x=>x.name===s.theme);T&&n(0,a=T.caret)}});let h=0;function m(_){Q[_?"unshift":"push"](()=>{l=_,n(5,l)})}const E=()=>b.undo(),g=()=>St.loadFromFirestore();function y(_){u=_,n(4,u)}function w(_){a=_,n(0,a)}function H(_){Q[_?"unshift":"push"](()=>{b=_,n(6,b)})}function B(_){r=_,n(3,r),n(2,o),n(0,a)}function p(_){u=_,n(4,u)}function L(){h=this.clientHeight,n(1,h)}return e.$$.update=()=>{e.$$.dirty&4&&n(7,i=o.order[o.activeIndex]),e.$$.dirty&5&&n(3,r=o.activeTool==="highlighter"?pn(a,.3):a),e.$$.dirty&2&&h>0&&document.documentElement.style.setProperty("--canvas-height",h+"px")},[a,h,o,r,u,l,b,i,d,m,E,g,y,w,H,B,p,L]}class Dn extends _e{constructor(t){super(),we(this,t,bn,mn,be,{})}}export{Dn as component};
