const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/quill.Bk4jDS0q.js","../chunks/core.CG__ofcG.js"])))=>i.map(i=>d[i]);
var xt=Object.defineProperty;var Dt=(e,t,n)=>t in e?xt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var z=(e,t,n)=>Dt(e,typeof t!="symbol"?t+"":t,n);import{s as ye,n as he,r as Ue,i as Ae,c as le,o as je,a as re,d as Q,A as Ct,B as Se,C as mt,e as ze}from"../chunks/scheduler.CE28Mlnp.js";import{S as ke,i as Ee,e as S,t as It,c as R,a as N,b as Mt,d as H,w as I,A as U,g as se,h as M,x as ne,F as Qe,j as Yt,s as q,p as me,f as G,v as fe,q as ve,r as pe,o as Le,m as xe,n as j,l as W,u as be,G as Re,z as Ze,I as De,C as Be,J as Xt,K as Ht}from"../chunks/index.CblOyuwr.js";import{e as $e,u as Pt,o as At,t as St}from"../chunks/themes.CBFgFqeR.js";import{m as ie,t as ge,d as ce,s as vt,a as pt,f as Rt}from"../chunks/firebaseStore.9-Fss-Za.js";import{b as F}from"../chunks/paths.C9bLl7Qh.js";import{_ as et}from"../chunks/preload-helper.D6kgxu3v.js";import{P as Vt}from"../chunks/ProgressBar.Cdh5Uk4U.js";function Bt(e){let t,n,s,o,r,d;return{c(){t=S("div"),n=S("button"),s=S("span"),o=It(e[0]),this.h()},l(l){t=R(l,"DIV",{class:!0});var i=N(t);n=R(i,"BUTTON",{class:!0,draggable:!0});var u=N(n);s=R(u,"SPAN",{class:!0});var a=N(s);o=Mt(a,e[0]),a.forEach(H),u.forEach(H),i.forEach(H),this.h()},h(){I(s,"class","title svelte-1jmw20r"),I(n,"class","tab svelte-1jmw20r"),I(n,"draggable","true"),U(n,"active",e[1]),I(t,"class","tab-container svelte-1jmw20r"),U(t,"preventHover",e[2])},m(l,i){se(l,t,i),M(t,n),M(n,s),M(s,o),r||(d=[ne(n,"mousedown",Qe(function(){Ae(e[3])&&e[3].apply(this,arguments)})),ne(n,"touchstart",Qe(function(){Ae(e[3])&&e[3].apply(this,arguments)})),ne(n,"dragstart",Qe(function(){Ae(e[4])&&e[4].apply(this,arguments)}))],r=!0)},p(l,[i]){e=l,i&1&&Yt(o,e[0]),i&2&&U(n,"active",e[1]),i&4&&U(t,"preventHover",e[2])},i:he,o:he,d(l){l&&H(t),r=!1,Ue(d)}}}function Ot(e,t,n){let{title:s=""}=t,{active:o=!1}=t,{preventHover:r=!1}=t,{onPointerdown:d=i=>{}}=t,{onDragstart:l=i=>{}}=t;return e.$$set=i=>{"title"in i&&n(0,s=i.title),"active"in i&&n(1,o=i.active),"preventHover"in i&&n(2,r=i.preventHover),"onPointerdown"in i&&n(3,d=i.onPointerdown),"onDragstart"in i&&n(4,l=i.onDragstart)},[s,o,r,d,l]}class bt extends ke{constructor(t){super(),Ee(this,t,Ot,Bt,ye,{title:0,active:1,preventHover:2,onPointerdown:3,onDragstart:4})}}function we(e){return e<.5?4*e*e*e:.5*Math.pow(2*e-2,3)+1}function yt(e){const t=e-1;return t*t*t+1}const tt=(e,t)=>{const{duration:n=300,easing:s=we,onEnd:o=()=>{},onStep:r=()=>{},css:d}=t;let l;function i(u){if(!e){console.warn("Cannot find element to animate");return}l===void 0&&(l=u);const a=s((u-l)/n),k=1-a;a<1?(e.style.cssText=d(a,k),r(a,k),requestAnimationFrame(i)):(e.style.cssText="",o())}requestAnimationFrame(i)},Je=e=>{const{duration:t=300,easing:n=we,onEnd:s=()=>{},onStep:o=()=>{}}=e;let r;function d(l){r===void 0&&(r=l);const i=n((l-r)/t),u=1-i;i<1?(o(i,u),requestAnimationFrame(d)):s()}requestAnimationFrame(d)};function nt(e,t,n){const s=e.slice();return s[41]=t[n],s[42]=t,s[43]=n,s}function st(e,t){let n,s,o,r,d=t[43],l,i,u;function a(...m){return t[17](t[43],...m)}function k(m){t[18](m,t[41])}let f={active:t[9]==t[41],preventHover:t[8],onPointerdown:a,onDragstart:t[14]};t[11][t[41]].title!==void 0&&(f.title=t[11][t[41]].title),s=new bt({props:f}),Q.push(()=>Re(s,"title",k));const E=()=>t[19](n,d),p=()=>t[19](null,d);return{key:e,first:null,c(){n=S("div"),me(s.$$.fragment),r=q(),this.h()},l(m){n=R(m,"DIV",{class:!0});var v=N(n);ve(s.$$.fragment,v),r=G(v),v.forEach(H),this.h()},h(){I(n,"class","tab-container svelte-1udz9mj"),U(n,"placeholder",t[10]==t[41]),this.first=n},m(m,v){se(m,n,v),pe(s,n,null),M(n,r),E(),l=!0,i||(u=Ct(t[13].call(null,n)),i=!0)},p(m,v){t=m;const x={};v[0]&516&&(x.active=t[9]==t[41]),v[0]&256&&(x.preventHover=t[8]),v[0]&4&&(x.onPointerdown=a),!o&&v[0]&2052&&(o=!0,x.title=t[11][t[41]].title,Se(()=>o=!1)),s.$set(x),d!==t[43]&&(p(),d=t[43],E()),(!l||v[0]&1028)&&U(n,"placeholder",t[10]==t[41])},i(m){l||(j(s.$$.fragment,m),l=!0)},o(m){W(s.$$.fragment,m),l=!1},d(m){m&&H(n),be(s),p(),i=!1,u()}}}function Nt(e){let t,n,s,o=[],r=new Map,d,l,i,u=`<span class="button-icon svelte-1udz9mj" style="-webkit-mask: url(${F}/images/svg/plus.svg) no-repeat center / contain; mask: url(${F}/images/svg/plus.svg) no-repeat center / contain;"></span>`,a,k,f,E=`<span class="button-icon svelte-1udz9mj" style="-webkit-mask: url(${F}/images/svg/gear.svg) no-repeat center / contain; mask: url(${F}/images/svg/gear.svg) no-repeat center / contain;"></span>`,p,m,v,x,P,X,b,C,V=$e(e[2].order);const y=_=>_[41];for(let _=0;_<V.length;_+=1){let w=nt(e,V,_),L=y(w);r.set(L,o[_]=st(L,w))}return v=new bt({props:{title:e[5],active:!e[1],preventHover:!0}}),{c(){t=S("div"),n=S("div"),s=S("div");for(let _=0;_<o.length;_+=1)o[_].c();d=q(),l=S("div"),i=S("button"),i.innerHTML=u,a=q(),k=S("div"),f=S("button"),f.innerHTML=E,p=q(),m=S("div"),me(v.$$.fragment),x=q(),P=S("div"),this.h()},l(_){t=R(_,"DIV",{class:!0});var w=N(t);n=R(w,"DIV",{class:!0});var L=N(n);s=R(L,"DIV",{class:!0});var Z=N(s);for(let te=0;te<o.length;te+=1)o[te].l(Z);Z.forEach(H),d=G(L),l=R(L,"DIV",{class:!0});var $=N(l);i=R($,"BUTTON",{class:!0,"data-svelte-h":!0}),fe(i)!=="svelte-g0ls06"&&(i.innerHTML=u),$.forEach(H),a=G(L),k=R(L,"DIV",{class:!0});var J=N(k);f=R(J,"BUTTON",{class:!0,"data-svelte-h":!0}),fe(f)!=="svelte-v7vri0"&&(f.innerHTML=E),J.forEach(H),p=G(L),m=R(L,"DIV",{class:!0});var ee=N(m);ve(v.$$.fragment,ee),ee.forEach(H),L.forEach(H),x=G(w),P=R(w,"DIV",{class:!0}),N(P).forEach(H),w.forEach(H),this.h()},h(){I(s,"class","tabs svelte-1udz9mj"),I(i,"class","button svelte-1udz9mj"),I(l,"class","new-tab-container svelte-1udz9mj"),I(f,"class","button svelte-1udz9mj"),I(k,"class","buttons-container svelte-1udz9mj"),I(m,"class","clone svelte-1udz9mj"),U(m,"draggingOutside",e[1]),U(m,"dragging",e[0]),I(n,"class","tabbar svelte-1udz9mj"),I(P,"class","divider svelte-1udz9mj"),I(t,"class","svelte-1udz9mj")},m(_,w){se(_,t,w),M(t,n),M(n,s);for(let L=0;L<o.length;L+=1)o[L]&&o[L].m(s,null);e[20](s),M(n,d),M(n,l),M(l,i),M(n,a),M(n,k),M(k,f),M(n,p),M(n,m),pe(v,m,null),e[22](m),M(t,x),M(t,P),e[23](t),X=!0,b||(C=[ne(i,"click",e[12]),ne(f,"click",e[21])],b=!0)},p(_,w){w[0]&53012&&(V=$e(_[2].order),Le(),o=Pt(o,w,y,1,_,V,r,s,At,st,null,nt),xe());const L={};w[0]&32&&(L.title=_[5]),w[0]&2&&(L.active=!_[1]),v.$set(L),(!X||w[0]&2)&&U(m,"draggingOutside",_[1]),(!X||w[0]&1)&&U(m,"dragging",_[0])},i(_){if(!X){for(let w=0;w<V.length;w+=1)j(o[w]);j(v.$$.fragment,_),X=!0}},o(_){for(let w=0;w<o.length;w+=1)W(o[w]);W(v.$$.fragment,_),X=!1},d(_){_&&H(t);for(let w=0;w<o.length;w+=1)o[w].d();e[20](null),be(v),e[22](null),e[23](null),b=!1,Ue(C)}}}const Ut=12,Oe=200,He=32,Pe=200,jt=1600,it=.3;function zt(e,t,n){let s,o,r,d;le(e,ie,h=>n(2,r=h)),le(e,ge,h=>n(11,d=h));const l=()=>{w(r.order[r.activeIndex])};let i,u=[],a=0,k=null,f=-1,E="",p,m,v,x=!1,P=!1,X=0,b=0,C,V=!1;const y=(h,D=300)=>{let A;return(...O)=>{clearTimeout(A),A=setTimeout(()=>{h.apply(void 0,O)},D)}};function _(){ce.newTab()}const w=h=>{const D=r.order.findIndex(A=>A===h);if(D<0||!u[D]){console.warn("Cannot close tab!");return}a=u[D].getBoundingClientRect().width,D<r.order.length-1&&(i.style.setProperty("--tab-max-width",`${a}px`),L()),D==r.activeIndex&&(D==r.order.length-1?ce.setActiveIndex(D-1):ce.setActiveIndex(D+1)),Je({duration:Pe,easing:we,onStep:(A,O)=>{D==0?n(3,i.style.gridTemplateColumns=`minmax(${O*He}px, ${O*a}px)`,i):n(3,i.style.gridTemplateColumns=`repeat(${D}, minmax(var(--tab-min-width), var(--tab-max-width))) minmax(${O*He}px, ${O*a}px)`,i)},onEnd:()=>{n(3,i.style.gridTemplateColumns="",i),ce.removeTab(h)}})},L=y(()=>{i&&(i.style.setProperty("--tab-max-width",`${Oe}px`),Je({duration:Pe,easing:we,onStep:(h,D)=>{i.style.setProperty("--tab-max-width",`${a+h*(Oe-a)}px`)},onEnd:()=>{i.style.setProperty("--tab-max-width",`${Oe}px`)}}))},jt);function Z(h){if(!i)return;const D=h.getBoundingClientRect().width;Je({duration:Pe,easing:we,onStep:(A,O)=>{r.order.length==1?n(3,i.style.gridTemplateColumns=`minmax(${A*He}px, ${A*D}px)`,i):n(3,i.style.gridTemplateColumns=`repeat(${r.order.length-1}, minmax(var(--tab-min-width), var(--tab-max-width))) minmax(${A*He}px, ${A*D}px)`,i),n(3,i.scrollLeft=i.scrollWidth,i)},onEnd:()=>{n(3,i.style.gridTemplateColumns="",i)}})}const $=(h,D)=>{const A=u[0].getBoundingClientRect().width;ce.moveTab(h,D,()=>{if(h>D)for(let O=D;O<h;O++)tt(u[O],{duration:Pe,easing:we,css:(Ye,ae)=>`transform: translateX(-${ae*A}px);`});if(h<D)for(let O=D;O>h;O--)tt(u[O],{duration:Pe,easing:we,css:(Ye,ae)=>`transform: translateX(${ae*A}px);`})})};function J(h){!h.target||!h.dataTransfer||(h.dataTransfer.setData("text/plain",s),h.dataTransfer.setDragImage(new Image,0,0))}function ee(h,D){if(h==0&&D==0){n(6,v.style.left="-1000px",v),n(6,v.style.top="-1000px",v);return}let A=C.getBoundingClientRect();if(h<A.left||h>A.right||D<A.top||D>A.bottom){P||(b=0),n(6,v.style.left=`${h+X}px`,v),n(6,v.style.top=`${D-m.height/2}px`,v),n(1,P=!0);return}P&&n(1,P=!1),n(6,v.style.left=`${h+X}px`,v),n(6,v.style.top=`${m.top}px`,v);const O=-i.scrollLeft,Ye=u[0].getBoundingClientRect().width;let ae=-1;if(h>O+r.order.length*Ye)ae=r.order.length-1;else for(let Xe=0;Xe<r.order.length;Xe++)if(h>O+Xe*Ye&&h<O+(Xe+1)*Ye){ae=Xe;break}h<20?(b=-it,requestAnimationFrame(Te)):h>i.clientWidth-10?(b=it,requestAnimationFrame(Te)):b=0,!(ae==-1||ae==r.placeholderIndex)&&$(r.placeholderIndex,ae)}let te=0;function Te(h){if(!x||b==0){te=0;return}te==0&&(te=h);const D=h-te;te=h,i.scrollBy({left:b*D}),requestAnimationFrame(Te)}function Ve(h,D){if(!h.target)return;let A,O;h instanceof TouchEvent?(A=h.touches[0].clientX,O=h.touches[0].clientY,h.preventDefault()):(A=h.clientX,O=h.clientY),window.addEventListener("touchmove",ue,{passive:!1}),window.addEventListener("touchend",oe),window.addEventListener("mousemove",ue),window.addEventListener("mouseup",oe),window.addEventListener("drag",ue),window.addEventListener("dragend",oe),window.addEventListener("blur",oe),ce.setActiveIndex(D),p=h.target,m=p.getBoundingClientRect(),k=[A,O],X=m.left-A,m.top-O,n(6,v.style.width=`${m.width}px`,v),n(6,v.style.left=`${m.left}px`,v),n(6,v.style.top=`${m.top}px`,v),f=D,n(5,E=d[r.order[D]].title)}function ue(h){let D,A;if(h instanceof TouchEvent?(D=h.touches[0].clientX,A=h.touches[0].clientY):(D=h.clientX,A=h.clientY),x){ee(D,A);return}k===null||Math.hypot(k[0]-D,k[1]-A)<Ut||(n(0,x=!0),ce.setPlaceholderIndex(f),ce.setActiveIndex(f))}function oe(){window.removeEventListener("touchmove",ue),window.removeEventListener("touchend",oe),window.removeEventListener("mousemove",ue),window.removeEventListener("mouseup",oe),window.removeEventListener("drag",ue),window.removeEventListener("dragend",oe),window.removeEventListener("blur",oe),k=null,n(1,P=!1),f=-1,X=0,ce.setPlaceholderIndex(),n(0,x=!1)}je(()=>{i.style.setProperty("--tab-max-width",`${Oe}px`),i.style.setProperty("--tab-min-width",`${He}px`)});const Ie=(h,D)=>Ve(D,h);function Me(h,D){e.$$.not_equal(d[D].title,h)&&(d[D].title=h,ge.set(d))}function Ge(h,D){Q[h?"unshift":"push"](()=>{u[D]=h,n(4,u)})}function Ke(h){Q[h?"unshift":"push"](()=>{i=h,n(3,i)})}const T=()=>{re(ie,r.toolbarVisible=!r.toolbarVisible,r),r.toolbarVisible||re(ie,r.tool=void 0,r)};function K(h){Q[h?"unshift":"push"](()=>{v=h,n(6,v)})}function B(h){Q[h?"unshift":"push"](()=>{C=h,n(7,C)})}return e.$$.update=()=>{e.$$.dirty[0]&2&&(P?re(ie,r.trashcanVisible=!0,r):re(ie,r.trashcanVisible=!1,r)),e.$$.dirty[0]&4&&n(9,s=r.order[r.activeIndex]),e.$$.dirty[0]&4&&n(10,o=r.order[r.placeholderIndex]),e.$$.dirty[0]&1&&(x?n(8,V=!0):setTimeout(()=>{n(8,V=!1)},20))},[x,P,r,i,u,E,v,C,V,s,o,d,_,Z,J,Ve,l,Ie,Me,Ge,Ke,T,K,B]}class Ft extends ke{constructor(t){super(),Ee(this,t,zt,Nt,ye,{closeActiveTab:16},null,[-1,-1])}get closeActiveTab(){return this.$$.ctx[16]}}function Wt(e){let t,n;return{c(){t=S("div"),n=S("div"),this.h()},l(s){t=R(s,"DIV",{class:!0});var o=N(t);n=R(o,"DIV",{class:!0}),N(n).forEach(H),o.forEach(H),this.h()},h(){I(n,"class","quill-editor"),I(t,"class","quill-editor-container svelte-16m16ue"),U(t,"disabled",e[0])},m(s,o){se(s,t,o),M(t,n),e[5](n)},p(s,[o]){o&1&&U(t,"disabled",s[0])},i:he,o:he,d(s){s&&H(t),e[5](null)}}}function qt(e,t,n){let s,o;le(e,ge,b=>n(6,s=b)),le(e,vt,b=>n(4,o=b));let{tabID:r}=t,{disabled:d=!1}=t,l,i;const u=(b,C=300)=>{let V;return(...y)=>{clearTimeout(V),V=setTimeout(()=>{b.apply(void 0,y)},C)}};async function a(b){var _,w,L,Z;if(!l)return;const{Delta:C,Range:V}=await et(async()=>{const{Delta:$,Range:J}=await import("../chunks/core.CG__ofcG.js").then(ee=>ee.G);return{Delta:$,Range:J}},[],import.meta.url);if(b.undo.length>0)for(var y=0;y<b.undo.length;y++){const $=(_=b.undo[y].range)==null?void 0:_.index,J=(w=b.undo[y].range)==null?void 0:w.length,ee={delta:new C(b.undo[y].delta.ops),range:$!==void 0&&J!==void 0?new V($,J):null};l.history.stack.undo.push(ee)}if(b.redo.length>0)for(var y=0;y<b.redo.length;y++){const J=(L=b.redo[y].range)==null?void 0:L.index,ee=(Z=b.redo[y].range)==null?void 0:Z.length,te={delta:new C(b.redo[y].delta.ops),range:J!==void 0&&ee!==void 0?new V(J,ee):null};l.history.stack.redo.push(te)}}function k(b){var C;l&&((C=l.getSelection())==null?void 0:C.length)===0&&window.open(b.target.href,"_blank")}function f(){if(!l||!s[r])return;const b=s[r].ops;l.setContents(b);const C=s[r].history;a(C)}function E(){if(!l||!s[r])return;re(ge,s[r].ops=l.getContents().ops,s);const b=structuredClone(l.history.stack);re(ge,s[r].history=b,s)}const p=u(E,500);function m(){if(!l)return;l.formatText(0,l.getLength(),"link",!1,"api");const b=l.getText(),C=/https?:\/\/\S+/gi,V=b.matchAll(C);for(const w of V)l.formatText(w.index,w[0].length,"link",w[0],"api");const y=/.+\@.+\..+/gi,_=b.matchAll(y);for(const w of _)l.formatText(w.index,w[0].length,"link","mailto:"+w[0],"api");document.querySelectorAll(".ql-editor a").forEach(w=>{w.addEventListener("click",k)})}const v=u(m,500);function x(b,C,V){if(V==="user"){const y=l.getText().split(`
`)[0].trim();re(ge,s[r].title=y===""?"Untitled":y,s),v(),p()}}async function P(){const{default:b}=await et(async()=>{const{default:C}=await import("../chunks/quill.Bk4jDS0q.js");return{default:C}},__vite__mapDeps([0,1]),import.meta.url);n(3,l=new b(i,{formats:["bold","italic","underline","strike","code","link"],placeholder:"Enter text here"})),f(),m(),l.on("text-change",x),l.keyboard.addBinding({key:"/",altKey:!0},()=>{l.format("code",!l.getFormat().code)}),l.keyboard.addBinding({key:"-",altKey:!0},()=>{l.format("strike",!l.getFormat().strike)})}je(()=>{P()});function X(b){Q[b?"unshift":"push"](()=>{i=b,n(1,i)})}return e.$$set=b=>{"tabID"in b&&n(2,r=b.tabID),"disabled"in b&&n(0,d=b.disabled)},e.$$.update=()=>{e.$$.dirty&9&&(d?l==null||l.disable():l==null||l.enable()),e.$$.dirty&24&&(l==null||l.root.setAttribute("spellcheck",o.spellCheck.toString()))},[d,i,r,l,o,X]}class Gt extends ke{constructor(t){super(),Ee(this,t,qt,Wt,ye,{tabID:2,disabled:0})}}const rt=500,Kt=300,ot=500,Qt=300;class Jt{constructor(){z(this,"isMoving",!1);z(this,"isLongclick",!1);z(this,"button",0);z(this,"lastX",0);z(this,"lastY",0);z(this,"consecutiveClicks",0);z(this,"lastMouseupTime",0);z(this,"activeElement",null);this.reset()}reset(){this.isMoving=!1,this.isLongclick=!1,this.button=0,this.lastX=0,this.lastY=0,this.consecutiveClicks=0,this.lastMouseupTime=0,this.activeElement=null}}class Zt{constructor(){z(this,"isDragging",!1);z(this,"isPinching",!1);z(this,"isLongpressed",!1);z(this,"consecutiveTaps",0);z(this,"lastTouchendTime",0);z(this,"lastCenterX",0);z(this,"lastCenterY",0);z(this,"identifier",0);z(this,"x",0);z(this,"y",0);z(this,"hypotenuse",0);z(this,"activeElement",null);this.reset()}reset(){this.isDragging=!1,this.isPinching=!1,this.isLongpressed=!1,this.consecutiveTaps=0,this.lastTouchendTime=0,this.lastCenterX=0,this.lastCenterY=0,this.identifier=0,this.x=0,this.y=0,this.hypotenuse=0,this.activeElement=null}}let de=[],g=new Jt,c=new Zt;const Y=(e,t)=>{e!=null&&e.dispatchEvent(new CustomEvent("gesture",{detail:t,bubbles:!1,cancelable:!1}))},_t=e=>{g.reset(),c.reset(),g.lastMouseupTime=Date.now(),window.removeEventListener("mousemove",Fe),window.removeEventListener("mouseup",We),window.removeEventListener("touchmove",qe),window.removeEventListener("touchend",Ce)},wt=e=>{if(window.removeEventListener("mousemove",Fe),window.removeEventListener("mouseup",We),window.removeEventListener("touchmove",qe),window.removeEventListener("touchend",Ce),g.isMoving)if(g.isMoving=!1,g.isLongclick)g.isLongclick=!1,Y(g.activeElement,{event:e,name:"longclick-drag-end",x:g.lastX,y:g.lastY,dx:0,dy:0});else switch(g.button){case 0:Y(g.activeElement,{event:e,name:"left-click-drag-end",x:g.lastX,y:g.lastY,dx:0,dy:0});break;case 1:Y(g.activeElement,{event:e,name:"middle-click-drag-end",x:g.lastX,y:g.lastY,dx:0,dy:0});break;case 2:Y(g.activeElement,{event:e,name:"right-click-drag-end",x:g.lastX,y:g.lastY,dx:0,dy:0});break}g.isLongclick&&Y(g.activeElement,{event:e,name:"longclick-release",x:g.lastX,y:g.lastY,dx:0,dy:0}),g.reset(),c.isDragging&&(c.isDragging=!1,c.isLongpressed?(c.isLongpressed=!1,Y(c.activeElement,{event:e,name:"longpress-drag-end",x:c.lastCenterX,y:c.lastCenterY,dx:0,dy:0})):Y(c.activeElement,{event:e,name:"touch-drag-end",x:c.lastCenterX,y:c.lastCenterY,dx:0,dy:0})),c.isLongpressed&&Y(c.activeElement,{event:e,name:"longpress-release",x:c.lastCenterX,y:c.lastCenterY,dx:0,dy:0}),c.reset()},kt=e=>{Y(e.target,{event:e,name:"wheel",x:e.clientX,y:e.clientY,dx:0,dy:0})},Et=e=>{},Tt=e=>{document.activeElement!==e.target&&(window.addEventListener("mousemove",Fe),window.addEventListener("mouseup",We),g.activeElement=e.target,g.lastX=e.clientX,g.lastY=e.clientY,g.isMoving||(g.button=e.button),g.button===0&&window.setTimeout(()=>{Date.now()-g.lastMouseupTime>=ot&&!g.isMoving&&(g.isLongclick=!0,Y(g.activeElement,{event:e,name:"longclick",x:e.clientX,y:e.clientY,dx:0,dy:0}))},ot))},Fe=e=>{if(e.movementX===0&&e.movementY===0)return;let t=e.clientX-g.lastX,n=e.clientY-g.lastY;if(!g.isMoving)if(g.isLongclick)Y(g.activeElement,{event:e,name:"longclick-drag-start",x:e.clientX,y:e.clientY,dx:0,dy:0});else switch(g.button){case 0:Y(g.activeElement,{event:e,name:"left-click-drag-start",x:e.clientX,y:e.clientY,dx:0,dy:0});break;case 1:Y(g.activeElement,{event:e,name:"middle-click-drag-start",x:e.clientX,y:e.clientY,dx:0,dy:0});break;case 2:Y(g.activeElement,{event:e,name:"right-click-drag-start",x:e.clientX,y:e.clientY,dx:0,dy:0});break}if(g.isMoving=!0,g.lastX=e.clientX,g.lastY=e.clientY,g.isLongclick)Y(g.activeElement,{event:e,name:"longclick-dragging",x:e.clientX,y:e.clientY,dx:t,dy:n});else switch(g.button){case 0:Y(g.activeElement,{event:e,name:"left-click-dragging",x:e.clientX,y:e.clientY,dx:t,dy:n});break;case 1:Y(g.activeElement,{event:e,name:"middle-click-dragging",x:e.clientX,y:e.clientY,dx:t,dy:n});break;case 2:Y(g.activeElement,{event:e,name:"right-click-dragging",x:e.clientX,y:e.clientY,dx:t,dy:n});break}},We=e=>{if(window.removeEventListener("mousemove",Fe),window.removeEventListener("mouseup",We),g.lastMouseupTime=Date.now(),g.isMoving)if(g.isMoving=!1,g.isLongclick)g.isLongclick=!1,Y(g.activeElement,{event:e,name:"longclick-drag-end",x:g.lastX,y:g.lastY,dx:0,dy:0});else switch(g.button){case 0:Y(g.activeElement,{event:e,name:"left-click-drag-end",x:g.lastX,y:g.lastY,dx:0,dy:0});break;case 1:Y(g.activeElement,{event:e,name:"middle-click-drag-end",x:g.lastX,y:g.lastY,dx:0,dy:0});break;case 2:Y(g.activeElement,{event:e,name:"right-click-drag-end",x:g.lastX,y:g.lastY,dx:0,dy:0});break}else g.isLongclick||(e.button===2?Y(g.activeElement,{event:e,name:"right-click",x:e.clientX,y:e.clientY,dx:0,dy:0}):e.button===1?Y(g.activeElement,{event:e,name:"middle-click",x:e.clientX,y:e.clientY,dx:0,dy:0}):(g.consecutiveClicks===0&&Y(g.activeElement,{event:e,name:"left-click",x:e.clientX,y:e.clientY,dx:0,dy:0}),g.consecutiveClicks++,window.setTimeout(()=>{g.consecutiveClicks>1&&Y(g.activeElement,{event:e,name:"double-click",x:e.clientX,y:e.clientY,dx:0,dy:0}),g.consecutiveClicks=0},Qt)));g.isLongclick&&Y(g.activeElement,{event:e,name:"longclick-release",x:e.clientX,y:e.clientY,dx:0,dy:0}),g.isLongclick=!1},Lt=e=>{if(document.activeElement!==e.target){if(e.preventDefault(),e.stopPropagation(),e.touches.length>1){if(e.touches[0].identifier===c.identifier)return;c.isPinching=!0}window.addEventListener("touchmove",qe,{passive:!1}),window.addEventListener("touchend",Ce),window.addEventListener("touchcancel",Ce),c.identifier=e.touches[0].identifier,c.x=e.touches[0].clientX,c.y=e.touches[0].clientY,c.activeElement=e.target,window.setTimeout(()=>{c.isPinching||c.isDragging||Date.now()-c.lastTouchendTime>=rt&&(c.isDragging=!1,c.isPinching=!1,c.hypotenuse=null,c.isLongpressed=!0,Y(c.activeElement,{event:e,name:"longpress",x:c.x,y:c.y,dx:0,dy:0}))},rt)}},qe=e=>{if(c.isDragging){let t=c.x,n=c.y;c.x=e.touches[0].clientX,c.y=e.touches[0].clientY;let s=c.x-t,o=c.y-n;c.isLongpressed?Y(c.activeElement,{event:e,name:"longpress-dragging",x:c.x,y:c.y,dx:s,dy:o,force:e.touches[0].force}):Y(c.activeElement,{event:e,name:"touch-dragging",x:c.x,y:c.y,dx:s,dy:o,force:e.touches[0].force});return}else if(!c.isLongpressed&&(c.isPinching||e.touches.length>1)){c.x=e.touches[0].clientX,c.y=e.touches[0].clientY;let t={x:e.touches[1].clientX,y:e.touches[1].clientY},n={x:(c.x+t.x)/2,y:(c.y+t.y)/2},s=Math.hypot(c.x-t.x,c.y-t.y);c.hypotenuse===null&&(c.hypotenuse=s,c.lastCenterX=n.x,c.lastCenterY=n.y,Y(c.activeElement,{event:e,name:"pinch-start",x:n.x,y:n.y,dx:0,dy:0})),c.isPinching=!0;let o=s/c.hypotenuse,r=n.x-c.lastCenterX,d=n.y-c.lastCenterY;Y(c.activeElement,{event:e,name:"pinching",x:n.x,y:n.y,zoom:o,dx:r,dy:d}),c.hypotenuse=s,c.lastCenterX=n.x,c.lastCenterY=n.y;return}else c.isDragging=!0,c.isLongpressed?(Y(c.activeElement,{event:e,name:"longpress-drag-start",x:c.x,y:c.y,dx:0,dy:0,force:e.touches[0].force}),c.x=e.touches[0].clientX,c.y=e.touches[0].clientY,Y(c.activeElement,{event:e,name:"longpress-dragging",x:c.x,y:c.y,dx:0,dy:0,force:e.touches[0].force})):(Y(c.activeElement,{event:e,name:"touch-drag-start",x:c.x,y:c.y,dx:0,dy:0,force:e.touches[0].force}),c.x=e.touches[0].clientX,c.y=e.touches[0].clientY,Y(c.activeElement,{event:e,name:"touch-dragging",x:c.x,y:c.y,dx:0,dy:0,force:e.touches[0].force}))},Ce=e=>{c.isDragging&&e.touches.length>0&&e.touches[0].identifier===c.identifier||(c.lastTouchendTime=Date.now(),window.removeEventListener("touchmove",qe),window.removeEventListener("touchend",Ce),window.removeEventListener("touchcancel",Ce),c.isDragging?(c.isDragging=!1,c.isLongpressed?(c.isLongpressed=!1,Y(c.activeElement,{event:e,name:"longpress-drag-end",x:c.x,y:c.y,dx:0,dy:0})):Y(c.activeElement,{event:e,name:"touch-drag-end",x:c.x,y:c.y,dx:0,dy:0})):c.isPinching?(c.isPinching=!1,c.hypotenuse=null,Y(c.activeElement,{event:e,name:"pinch-end",x:c.lastCenterX,y:c.lastCenterY,dx:0,dy:0})):c.isLongpressed||(c.consecutiveTaps===0&&Y(c.activeElement,{event:e,name:"tap",x:c.x,y:c.y,dx:0,dy:0}),c.consecutiveTaps++,window.setTimeout(()=>{c.consecutiveTaps>1&&Y(c.activeElement,{event:e,name:"double-tap",x:c.x,y:c.y,dx:0,dy:0}),c.consecutiveTaps=0},Kt)),c.isLongpressed&&Y(c.activeElement,{event:e,name:"longpress-release",x:c.x,y:c.y,dx:0,dy:0}),c.isLongpressed=!1)};function $t(...e){for(let t of e)de.findIndex(n=>n===t)===-1&&(de.length==0&&(window.addEventListener("blur",wt),window.addEventListener("focus",_t)),de.push(t),t.addEventListener("touchstart",Lt,{passive:!1}),t.addEventListener("mousedown",Tt,{passive:!1}),t.addEventListener("contextmenu",Et,{passive:!1}),t.addEventListener("wheel",kt,{passive:!1}))}function en(...e){const t=n=>{n.removeEventListener("touchstart",Lt),n.removeEventListener("mousedown",Tt),n.removeEventListener("contextmenu",Et),n.removeEventListener("wheel",kt)};if(e.length==0){for(let n of de)t(n);de=[]}else for(let n of e){let s=de.findIndex(o=>o===n);s!==-1&&(t(n),de.splice(s,1))}de.length==0&&(window.removeEventListener("blur",wt),window.removeEventListener("focus",_t))}function tn(e){let t,n,s,o,r;return{c(){t=S("div"),n=S("canvas"),s=q(),o=S("canvas"),this.h()},l(d){t=R(d,"DIV",{class:!0,style:!0});var l=N(t);n=R(l,"CANVAS",{id:!0,class:!0}),N(n).forEach(H),s=G(l),o=R(l,"CANVAS",{id:!0,class:!0}),N(o).forEach(H),l.forEach(H),this.h()},h(){I(n,"id","currentPath"),I(n,"class","svelte-1rt306j"),I(o,"id","canvas"),I(o,"class","svelte-1rt306j"),I(t,"class","drawing-container svelte-1rt306j"),I(t,"style",r=e[0]==="eraser"?`cursor: url(${F}/images/svg/eraser.svg) 5 18, auto;`:""),U(t,"disabled",e[0]===void 0)},m(d,l){se(d,t,l),M(t,n),e[10](n),M(t,s),M(t,o),e[11](o)},p(d,l){l[0]&1&&r!==(r=d[0]==="eraser"?`cursor: url(${F}/images/svg/eraser.svg) 5 18, auto;`:"")&&I(t,"style",r),l[0]&1&&U(t,"disabled",d[0]===void 0)},i:he,o:he,d(d){d&&H(t),e[10](null),e[11](null)}}}const nn=2,sn=178;function rn(e,t,n){var s=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),o=Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2)),r=Math.sqrt(Math.pow(n.x-e.x,2)+Math.pow(n.y-e.y,2)),d=Math.acos((o*o+s*s-r*r)/(2*o*s));return d*(180/Math.PI)}function lt(e){if(e.points.length<4)return e;for(let t=1;t<e.points.length-2;t++){const n=e.points[t-1],s=e.points[t],o=e.points[t+1];rn(n,s,o)>sn&&(e.points.splice(t,1),t--)}return e}async function _e(e,t){if(t.lineWidth=e.lineWidth,t.lineCap="round",t.strokeStyle=e.color,e.points.length<2){t.beginPath(),t.moveTo(e.points[0].x,e.points[0].y),t.lineTo(e.points[0].x,e.points[0].y),t.stroke();return}t.beginPath();let n=e.points[0].x,s=e.points[0].y;for(let o=0;o<e.points.length-1;o++)t.moveTo(n,s),n=(e.points[o].x+e.points[o+1].x)/2,s=(e.points[o].y+e.points[o+1].y)/2,t.quadraticCurveTo(e.points[o].x,e.points[o].y,n,s);t.stroke()}function at(e){return{x:ct(e.x),y:ct(e.y)}}function ct(e){const t=e.toFixed(nn);return Number(t)}function on(e,t,n){let s;le(e,ge,T=>n(22,s=T));let{radius:o=4}=t,{smoothness:r=0}=t,{stroke:d=5}=t,{color:l="#000000"}=t,{tool:i=void 0}=t,{tabID:u=""}=t;const a=()=>{E.clearRect(0,0,P/X,x/X),y=[]},k=()=>{if(y.length!=0){y.pop(),m.clearRect(0,0,P/X,x/X);for(let T=0;T<y.length;T++)_e(y[T],m);$()}};let f,E,p,m,v={x:0,y:0},x=0,P=0,X,b=!1,C,V,y=[];function _(){if(f){if(!i){f.removeEventListener("gesture",Ie),f.removeEventListener("gesture",Me),en(f);return}i==="pen"?(f.removeEventListener("gesture",Ie),f.addEventListener("gesture",Me)):i==="eraser"&&(f.removeEventListener("gesture",Me),f.addEventListener("gesture",Ie)),$t(f)}}const w=(T,K,B,h)=>{var D=B-T,A=h-K;return Math.sqrt(D*D+A*A)};function L(T,K){let B=f.getBoundingClientRect();return{x:T-B.left,y:K-B.top}}function Z(){if(!f||!p)return;Te(),X=window.devicePixelRatio;let T=f.getBoundingClientRect();x=T.height*X,P=T.width*X,n(1,f.width=P,f),n(1,f.height=x,f),n(2,p.width=P,p),n(2,p.height=x,p),E.scale(X,X),m.scale(X,X);for(let K=0;K<y.length;K++)_e(y[K],m)}function $(){s[u]&&re(ge,s[u].paths=y.filter(T=>lt(T)),s)}function J(){s[u]&&(y=s[u].paths,Z())}function ee(T,K){b=!0,v=L(T,K),C={points:[],lineWidth:d,color:l}}function te(T,K){if(!b)return;let B=L(T,K);if(o>0){if(w(B.x,B.y,v.x,v.y)<=o){C.points.length===0&&(C.points.push(B),_e(C,E));return}let h=Math.sqrt(B.x*B.x+B.y*B.y-2*B.x*v.x+v.x*v.x-2*B.y*v.y+v.y*v.y);if(B={x:B.x+o*((v.x-B.x)/h),y:B.y+o*((v.y-B.y)/h)},w(v.x,v.y,B.x,B.y)<=r)return}C.points.push(at(B)),E.clearRect(0,0,P/X,x/X),_e(C,E),v=B}function Te(){b&&(y.push(lt(C)),_e(C,m),E.clearRect(0,0,P/X,x/X),$()),b=!1}function Ve(T,K){b=!0,C={points:[],lineWidth:10,color:"rgba(0,0,0,0.2)"}}function ue(T,K){if(!b)return;const B=L(T,K);C.points.push(at(B)),setTimeout(()=>{E.clearRect(0,0,P/X,x/X),_e(C,E),C.points.shift(),C.points.length<=1&&!b&&E.clearRect(0,0,P/X,x/X)},100),y.forEach((h,D)=>{for(let A=0;A<h.points.length-1;A++)if(w(h.points[A].x,h.points[A].y,B.x,B.y)<=h.lineWidth){y.splice(D,1),m.clearRect(0,0,P/X,x/X);for(let O=0;O<y.length;O++)_e(y[O],m);$();break}})}function oe(){b=!1}const Ie=function(T){switch(T.detail.name){case"left-click-drag-start":case"touch-drag-start":Ve(T.detail.x,T.detail.y);break;case"left-click-dragging":case"touch-dragging":ue(T.detail.x,T.detail.y);break;case"left-click-drag-end":case"touch-drag-end":oe();break}},Me=function(T){switch(T.detail.name){case"left-click-drag-start":case"touch-drag-start":ee(T.detail.x,T.detail.y);break;case"left-click-dragging":case"touch-dragging":te(T.detail.x,T.detail.y);break;case"left-click-drag-end":case"touch-drag-end":Te();break}};je(()=>{E=f.getContext("2d"),E.imageSmoothingEnabled=!1,m=p.getContext("2d"),m.imageSmoothingEnabled=!1,V=new ResizeObserver(Z),V.observe(f),J(),_()}),mt(()=>{V&&V.disconnect(),n(0,i=void 0),_()});function Ge(T){Q[T?"unshift":"push"](()=>{p=T,n(2,p)})}function Ke(T){Q[T?"unshift":"push"](()=>{f=T,n(1,f)})}return e.$$set=T=>{"radius"in T&&n(3,o=T.radius),"smoothness"in T&&n(4,r=T.smoothness),"stroke"in T&&n(5,d=T.stroke),"color"in T&&n(6,l=T.color),"tool"in T&&n(0,i=T.tool),"tabID"in T&&n(7,u=T.tabID)},e.$$.update=()=>{e.$$.dirty[0]&1&&_()},[i,f,p,o,r,d,l,u,a,k,Ge,Ke]}class ln extends ke{constructor(t){super(),Ee(this,t,on,tn,ye,{radius:3,smoothness:4,stroke:5,color:6,tool:0,tabID:7,clear:8,undo:9},null,[-1,-1])}get clear(){return this.$$.ctx[8]}get undo(){return this.$$.ctx[9]}}function Ne(e,{delay:t=0,duration:n=400,easing:s=yt,axis:o="y"}={}){const r=getComputedStyle(e),d=+r.opacity,l=o==="y"?"height":"width",i=parseFloat(r[l]),u=o==="y"?["top","bottom"]:["left","right"],a=u.map(x=>`${x[0].toUpperCase()}${x.slice(1)}`),k=parseFloat(r[`padding${a[0]}`]),f=parseFloat(r[`padding${a[1]}`]),E=parseFloat(r[`margin${a[0]}`]),p=parseFloat(r[`margin${a[1]}`]),m=parseFloat(r[`border${a[0]}Width`]),v=parseFloat(r[`border${a[1]}Width`]);return{delay:t,duration:n,easing:s,css:x=>`overflow: hidden;opacity: ${Math.min(x*20,1)*d};${l}: ${x*i}px;padding-${u[0]}: ${x*k}px;padding-${u[1]}: ${x*f}px;margin-${u[0]}: ${x*E}px;margin-${u[1]}: ${x*p}px;border-${u[0]}-width: ${x*m}px;border-${u[1]}-width: ${x*v}px;`}}function ut(e,{delay:t=0,duration:n=400,easing:s=yt,start:o=0,opacity:r=0}={}){const d=getComputedStyle(e),l=+d.opacity,i=d.transform==="none"?"":d.transform,u=1-o,a=l*(1-r);return{delay:t,duration:n,easing:s,css:(k,f)=>`
			transform: ${i} scale(${1-u*f});
			opacity: ${l-a*f}
		`}}function dt(e){let t,n,s=`<span class="button-icon svelte-lafg0f" style="-webkit-mask: url(${F}/images/svg/undo.svg) no-repeat center / contain; mask: url(${F}/images/svg/undo.svg) no-repeat center / contain;"></span>`,o,r,d,l,i,u,a,k;return{c(){t=S("div"),n=S("button"),n.innerHTML=s,o=q(),r=S("input"),d=q(),l=S("input"),this.h()},l(f){t=R(f,"DIV",{class:!0});var E=N(t);n=R(E,"BUTTON",{class:!0,"data-svelte-h":!0}),fe(n)!=="svelte-1b4fip4"&&(n.innerHTML=s),o=G(E),r=R(E,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),d=G(E),l=R(E,"INPUT",{type:!0,class:!0}),E.forEach(H),this.h()},h(){I(n,"class","button svelte-lafg0f"),I(r,"type","range"),I(r,"min","2"),I(r,"max","20"),I(r,"step","2"),I(r,"class","slider svelte-lafg0f"),I(l,"type","color"),I(l,"class","color-picker svelte-lafg0f"),I(t,"class","pencil-tools svelte-lafg0f")},m(f,E){se(f,t,E),M(t,n),M(t,o),M(t,r),Be(r,e[0]),M(t,d),M(t,l),Be(l,e[1]),u=!0,a||(k=[ne(n,"click",function(){Ae(e[3])&&e[3].apply(this,arguments)}),ne(r,"change",e[9]),ne(r,"input",e[9]),ne(l,"input",e[10])],a=!0)},p(f,E){e=f,E&1&&Be(r,e[0]),E&2&&Be(l,e[1])},i(f){u||(f&&ze(()=>{u&&(i||(i=De(t,Ne,{duration:200,axis:"x"},!0)),i.run(1))}),u=!0)},o(f){f&&(i||(i=De(t,Ne,{duration:200,axis:"x"},!1)),i.run(0)),u=!1},d(f){f&&H(t),f&&i&&i.end(),a=!1,Ue(k)}}}function an(e){let t,n,s=`<span class="button-icon svelte-lafg0f" style="-webkit-mask: url(${F}/images/svg/pencil.svg) no-repeat center / contain; mask: url(${F}/images/svg/pencil.svg) no-repeat center / contain;"></span>`,o,r,d=`<span class="button-icon svelte-lafg0f" style="-webkit-mask: url(${F}/images/svg/highlighter.svg) no-repeat center / contain; mask: url(${F}/images/svg/highlighter.svg) no-repeat center / contain;"></span>`,l,i,u=`<span class="button-icon svelte-lafg0f" style="-webkit-mask: url(${F}/images/svg/eraser.svg) no-repeat center / contain; mask: url(${F}/images/svg/eraser.svg) no-repeat center / contain;"></span>`,a,k,f,E,p,m,v,x,P,X=`<span class="button-icon svelte-lafg0f" style="-webkit-mask: url(${F}/images/svg/user.svg) no-repeat center / contain; mask: url(${F}/images/svg/user.svg) no-repeat center / contain;"></span>`,b,C,V,y,_=(e[4].tool==="pen"||e[4].tool==="highlighter")&&dt(e);return{c(){t=S("div"),n=S("button"),n.innerHTML=s,o=q(),r=S("button"),r.innerHTML=d,l=q(),i=S("button"),i.innerHTML=u,a=q(),_&&_.c(),k=q(),f=S("div"),E=q(),p=S("button"),m=S("span"),x=q(),P=S("a"),P.innerHTML=X,this.h()},l(w){t=R(w,"DIV",{class:!0});var L=N(t);n=R(L,"BUTTON",{class:!0,"data-svelte-h":!0}),fe(n)!=="svelte-1foumhs"&&(n.innerHTML=s),o=G(L),r=R(L,"BUTTON",{class:!0,"data-svelte-h":!0}),fe(r)!=="svelte-1evhkjr"&&(r.innerHTML=d),l=G(L),i=R(L,"BUTTON",{class:!0,"data-svelte-h":!0}),fe(i)!=="svelte-1aagamc"&&(i.innerHTML=u),a=G(L),_&&_.l(L),k=G(L),f=R(L,"DIV",{class:!0}),N(f).forEach(H),E=G(L),p=R(L,"BUTTON",{class:!0});var Z=N(p);m=R(Z,"SPAN",{class:!0,style:!0}),N(m).forEach(H),Z.forEach(H),x=G(L),P=R(L,"A",{class:!0,href:!0,"data-svelte-h":!0}),fe(P)!=="svelte-1xuhzhs"&&(P.innerHTML=X),L.forEach(H),this.h()},h(){I(n,"class","pencil button svelte-lafg0f"),U(n,"selected",e[4].tool==="pen"),I(r,"class","button svelte-lafg0f"),U(r,"selected",e[4].tool==="highlighter"),I(i,"class","button svelte-lafg0f"),U(i,"selected",e[4].tool==="eraser"),I(f,"class","spacer svelte-lafg0f"),I(m,"class","button-icon svelte-lafg0f"),Ze(m,"-webkit-mask","url("+F+"/images/svg/refresh.svg) no-repeat center / contain"),Ze(m,"mask","url("+F+"/images/svg/refresh.svg) no-repeat center / contain"),I(p,"class","refresh button svelte-lafg0f"),p.disabled=v=e[5].savingStatus==="saving",I(P,"class","button svelte-lafg0f"),I(P,"href",F+"/profile"),I(t,"class","toolbar-container svelte-lafg0f")},m(w,L){se(w,t,L),M(t,n),M(t,o),M(t,r),M(t,l),M(t,i),M(t,a),_&&_.m(t,null),M(t,k),M(t,f),M(t,E),M(t,p),M(p,m),M(t,x),M(t,P),C=!0,V||(y=[ne(n,"click",e[6]),ne(r,"click",e[7]),ne(i,"click",e[8]),ne(p,"click",function(){Ae(e[2])&&e[2].apply(this,arguments)})],V=!0)},p(w,[L]){e=w,(!C||L&16)&&U(n,"selected",e[4].tool==="pen"),(!C||L&16)&&U(r,"selected",e[4].tool==="highlighter"),(!C||L&16)&&U(i,"selected",e[4].tool==="eraser"),e[4].tool==="pen"||e[4].tool==="highlighter"?_?(_.p(e,L),L&16&&j(_,1)):(_=dt(e),_.c(),j(_,1),_.m(t,k)):_&&(Le(),W(_,1,1,()=>{_=null}),xe()),(!C||L&32&&v!==(v=e[5].savingStatus==="saving"))&&(p.disabled=v)},i(w){C||(j(_),w&&ze(()=>{C&&(b||(b=De(t,Ne,{duration:200},!0)),b.run(1))}),C=!0)},o(w){W(_),w&&(b||(b=De(t,Ne,{duration:200},!1)),b.run(0)),C=!1},d(w){w&&H(t),_&&_.d(),w&&b&&b.end(),V=!1,Ue(y)}}}function cn(e,t,n){let s,o;le(e,ie,p=>n(4,s=p)),le(e,pt,p=>n(5,o=p));let{onRefresh:r=()=>{}}=t,{onDrawingUndo:d=()=>{}}=t,{stroke:l}=t,{color:i}=t;const u=()=>{re(ie,s.tool=s.tool==="pen"?void 0:"pen",s)},a=()=>{re(ie,s.tool=s.tool==="highlighter"?void 0:"highlighter",s)},k=()=>{re(ie,s.tool=s.tool==="eraser"?void 0:"eraser",s)};function f(){l=Xt(this.value),n(0,l)}function E(){i=this.value,n(1,i)}return e.$$set=p=>{"onRefresh"in p&&n(2,r=p.onRefresh),"onDrawingUndo"in p&&n(3,d=p.onDrawingUndo),"stroke"in p&&n(0,l=p.stroke),"color"in p&&n(1,i=p.color)},[l,i,r,d,s,o,u,a,k,f,E]}class un extends ke{constructor(t){super(),Ee(this,t,cn,an,ye,{onRefresh:2,onDrawingUndo:3,stroke:0,color:1})}}function dn(e){let t,n=`<div class="trashcan-icon svelte-15jm748" style="-webkit-mask: url(${F}/images/svg/trash.svg) no-repeat center / contain; mask: url(${F}/images/svg/trash.svg) no-repeat center / contain;"></div>`,s,o;return{c(){t=S("div"),t.innerHTML=n,this.h()},l(r){t=R(r,"DIV",{class:!0,"data-svelte-h":!0}),fe(t)!=="svelte-1bi7fon"&&(t.innerHTML=n),this.h()},h(){I(t,"class","trashcan svelte-15jm748"),U(t,"overTrashcan",e[1])},m(r,d){se(r,t,d),e[3](t),o=!0},p(r,[d]){(!o||d&2)&&U(t,"overTrashcan",r[1])},i(r){o||(r&&ze(()=>{o&&(s||(s=De(t,ut,{duration:200},!0)),s.run(1))}),o=!0)},o(r){r&&(s||(s=De(t,ut,{duration:200},!1)),s.run(0)),o=!1},d(r){r&&H(t),e[3](null),r&&s&&s.end()}}}function fn(e,t,n){let{throwAway:s=()=>{}}=t,o,r=!1;const d=u=>{const a=o.getBoundingClientRect(),k=u instanceof MouseEvent?u.clientX:u.touches[0].clientX,f=u instanceof MouseEvent?u.clientY:u.touches[0].clientY;if(k<a.left||k>a.right||f<a.top||f>a.bottom){n(1,r=!1);return}n(1,r=!0)},l=u=>{const a=o.getBoundingClientRect(),k=u instanceof MouseEvent?u.clientX:u.touches[0].clientX,f=u instanceof MouseEvent?u.clientY:u.touches[0].clientY;if(k<a.left||k>a.right||f<a.top||f>a.bottom){n(1,r=!1);return}s()};je(()=>{window.addEventListener("mousemove",d),window.addEventListener("touchmove",d),window.addEventListener("drag",d),window.addEventListener("dragend",l),window.addEventListener("mouseup",l),window.addEventListener("touchend",l)}),mt(()=>{window.removeEventListener("mousemove",d),window.removeEventListener("touchmove",d),window.removeEventListener("drag",d),window.removeEventListener("dragend",l),window.removeEventListener("mouseup",l),window.removeEventListener("touchend",l)});function i(u){Q[u?"unshift":"push"](()=>{o=u,n(0,o)})}return e.$$set=u=>{"throwAway"in u&&n(2,s=u.throwAway)},[o,r,s,i]}class gn extends ke{constructor(t){super(),Ee(this,t,fn,dn,ye,{throwAway:2})}}function ft(e){let t,n,s,o;function r(i){e[13](i)}function d(i){e[14](i)}let l={onDrawingUndo:e[11],onRefresh:e[12]};return e[4]!==void 0&&(l.stroke=e[4]),e[0]!==void 0&&(l.color=e[0]),t=new un({props:l}),Q.push(()=>Re(t,"stroke",r)),Q.push(()=>Re(t,"color",d)),{c(){me(t.$$.fragment)},l(i){ve(t.$$.fragment,i)},m(i,u){pe(t,i,u),o=!0},p(i,u){const a={};u&64&&(a.onDrawingUndo=i[11]),!n&&u&16&&(n=!0,a.stroke=i[4],Se(()=>n=!1)),!s&&u&1&&(s=!0,a.color=i[0],Se(()=>s=!1)),t.$set(a)},i(i){o||(j(t.$$.fragment,i),o=!0)},o(i){W(t.$$.fragment,i),o=!1},d(i){be(t,i)}}}function hn(e){let t,n;return t=new Vt({}),{c(){me(t.$$.fragment)},l(s){ve(t.$$.fragment,s)},m(s,o){pe(t,s,o),n=!0},p:he,i(s){n||(j(t.$$.fragment,s),n=!0)},o(s){W(t.$$.fragment,s),n=!1},d(s){be(t,s)}}}function mn(e){let t,n,s=e[7],o,r,d,l=gt(e),i=e[2].trashcanVisible&&ht(e);return{c(){t=S("div"),n=S("div"),l.c(),o=q(),i&&i.c(),this.h()},l(u){t=R(u,"DIV",{class:!0});var a=N(t);n=R(a,"DIV",{class:!0});var k=N(n);l.l(k),k.forEach(H),o=G(a),i&&i.l(a),a.forEach(H),this.h()},h(){I(n,"class","editor-container svelte-5x76h8"),I(t,"class","scrollable-canvas svelte-5x76h8"),ze(()=>e[18].call(t))},m(u,a){se(u,t,a),M(t,n),l.m(n,null),M(t,o),i&&i.m(t,null),r=Ht(t,e[18].bind(t)),d=!0},p(u,a){a&128&&ye(s,s=u[7])?(Le(),W(l,1,1,he),xe(),l=gt(u),l.c(),j(l,1),l.m(n,null)):l.p(u,a),u[2].trashcanVisible?i?(i.p(u,a),a&4&&j(i,1)):(i=ht(u),i.c(),j(i,1),i.m(t,null)):i&&(Le(),W(i,1,1,()=>{i=null}),xe())},i(u){d||(j(l),j(i),d=!0)},o(u){W(l),W(i),d=!1},d(u){u&&H(t),l.d(u),i&&i.d(),r()}}}function gt(e){let t,n,s,o,r,d;t=new Gt({props:{tabID:e[7]}});function l(a){e[16](a)}function i(a){e[17](a)}let u={tabID:e[7],tool:e[8]};return e[3]!==void 0&&(u.color=e[3]),e[4]!==void 0&&(u.stroke=e[4]),s=new ln({props:u}),e[15](s),Q.push(()=>Re(s,"color",l)),Q.push(()=>Re(s,"stroke",i)),{c(){me(t.$$.fragment),n=q(),me(s.$$.fragment)},l(a){ve(t.$$.fragment,a),n=G(a),ve(s.$$.fragment,a)},m(a,k){pe(t,a,k),se(a,n,k),pe(s,a,k),d=!0},p(a,k){const f={};k&128&&(f.tabID=a[7]),t.$set(f);const E={};k&128&&(E.tabID=a[7]),k&256&&(E.tool=a[8]),!o&&k&8&&(o=!0,E.color=a[3],Se(()=>o=!1)),!r&&k&16&&(r=!0,E.stroke=a[4],Se(()=>r=!1)),s.$set(E)},i(a){d||(j(t.$$.fragment,a),j(s.$$.fragment,a),d=!0)},o(a){W(t.$$.fragment,a),W(s.$$.fragment,a),d=!1},d(a){a&&H(n),be(t,a),e[15](null),be(s,a)}}}function ht(e){let t,n,s;return n=new gn({props:{throwAway:e[5].closeActiveTab}}),{c(){t=S("div"),me(n.$$.fragment),this.h()},l(o){t=R(o,"DIV",{class:!0});var r=N(t);ve(n.$$.fragment,r),r.forEach(H),this.h()},h(){I(t,"class","trashcan-container svelte-5x76h8")},m(o,r){se(o,t,r),pe(n,t,null),s=!0},p(o,r){const d={};r&32&&(d.throwAway=o[5].closeActiveTab),n.$set(d)},i(o){s||(j(n.$$.fragment,o),s=!0)},o(o){W(n.$$.fragment,o),s=!1},d(o){o&&H(t),be(n)}}}function vn(e){let t,n,s,o,r,d,l,i,u={};n=new Ft({props:u}),e[10](n);let a=e[2].toolbarVisible&&e[2].order.length>0&&ft(e);const k=[mn,hn],f=[];function E(p,m){return p[9].currentUser&&!p[9].isLoading?0:1}return d=E(e),l=f[d]=k[d](e),{c(){t=S("div"),me(n.$$.fragment),s=q(),o=S("div"),a&&a.c(),r=q(),l.c(),this.h()},l(p){t=R(p,"DIV",{class:!0});var m=N(t);ve(n.$$.fragment,m),s=G(m),o=R(m,"DIV",{class:!0});var v=N(o);a&&a.l(v),v.forEach(H),r=G(m),l.l(m),m.forEach(H),this.h()},h(){I(o,"class","toolbar"),I(t,"class","page-container svelte-5x76h8")},m(p,m){se(p,t,m),pe(n,t,null),M(t,s),M(t,o),a&&a.m(o,null),M(t,r),f[d].m(t,null),i=!0},p(p,[m]){const v={};n.$set(v),p[2].toolbarVisible&&p[2].order.length>0?a?(a.p(p,m),m&4&&j(a,1)):(a=ft(p),a.c(),j(a,1),a.m(o,null)):a&&(Le(),W(a,1,1,()=>{a=null}),xe());let x=d;d=E(p),d===x?f[d].p(p,m):(Le(),W(f[x],1,1,()=>{f[x]=null}),xe(),l=f[d],l?l.p(p,m):(l=f[d]=k[d](p),l.c()),j(l,1),l.m(t,null))},i(p){i||(j(n.$$.fragment,p),j(a),j(l),i=!0)},o(p){W(n.$$.fragment,p),W(a),W(l),i=!1},d(p){p&&H(t),e[10](null),be(n),a&&a.d(),f[d].d()}}}function pn(e,t){var n=parseInt(e.slice(1,3),16),s=parseInt(e.slice(3,5),16),o=parseInt(e.slice(5,7),16);return"rgba("+n+", "+s+", "+o+", "+t+")"}function bn(e,t,n){let s,o,r,d,l;le(e,ie,y=>n(2,r=y)),le(e,vt,y=>n(19,d=y)),le(e,pt,y=>n(9,l=y));let i="#000000",u="rgba(0, 0, 0, 1)",a=10,k,f,E=0;ie.subscribe(y=>{if(y.tool==="highlighter")n(0,i="#ffdd33");else if(y.tool==="pen"){const _=St.find(w=>w.name===d.theme);_&&n(0,i=_.caret)}});function p(y){Q[y?"unshift":"push"](()=>{k=y,n(5,k)})}const m=()=>f.undo(),v=()=>Rt.loadFromFirestore();function x(y){a=y,n(4,a)}function P(y){i=y,n(0,i)}function X(y){Q[y?"unshift":"push"](()=>{f=y,n(6,f)})}function b(y){u=y,n(3,u),n(2,r),n(0,i)}function C(y){a=y,n(4,a)}function V(){E=this.clientHeight,n(1,E)}return e.$$.update=()=>{e.$$.dirty&4&&n(8,s=r.tool==="highlighter"?"pen":r.tool),e.$$.dirty&4&&n(7,o=r.order[r.activeIndex]),e.$$.dirty&5&&n(3,u=r.tool==="highlighter"?pn(i,.3):i),e.$$.dirty&2&&E>0&&document.documentElement.style.setProperty("--canvas-height",E+"px")},[i,E,r,u,a,k,f,o,s,l,p,m,v,x,P,X,b,C,V]}class Dn extends ke{constructor(t){super(),Ee(this,t,bn,vn,ye,{})}}export{Dn as component};
