const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/quill.Bk4jDS0q.js","../chunks/core.CG__ofcG.js"])))=>i.map(i=>d[i]);
var Lt=Object.defineProperty;var xt=(e,t,n)=>t in e?Lt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var U=(e,t,n)=>xt(e,typeof t!="symbol"?t+"":t,n);import{s as Ce,n as ge,r as vt,e as Ee,f as Ze,c as se,a as fe,o as $e,z as Dt,d as ne,A as Ct,B as It}from"../chunks/scheduler.Cbw2My0d.js";import{S as Ie,i as Ye,e as A,b as Yt,c as R,d as O,f as Xt,g as X,w as Y,A as W,j as $,k as I,x as ie,G as je,l as Pt,s as j,v as ue,h as G,z as et,a as q,o as ve,t as F,n as be,I as Te,p as pe,q as ye,r as we,u as _e,J as Mt,m as Le}from"../chunks/index.s-tUku1V.js";import{e as ke,u as Ke,o as Qe}from"../chunks/each.B7A4Ty6x.js";import{b as z}from"../chunks/paths.CLYfTymW.js";import{m as me,a as bt,t as oe,f as St,d as ae,s as Ht}from"../chunks/firebaseStore.DQbZR32Y.js";import{c as he,s as xe,S as At}from"../chunks/Spinner.BephAqbH.js";import{_ as tt}from"../chunks/preload-helper.D6kgxu3v.js";function Rt(e){let t,n,i,r,c,d;return{c(){t=A("div"),n=A("button"),i=A("span"),r=Yt(e[0]),this.h()},l(o){t=R(o,"DIV",{class:!0});var s=O(t);n=R(s,"BUTTON",{class:!0,draggable:!0});var f=O(n);i=R(f,"SPAN",{class:!0});var h=O(i);r=Xt(h,e[0]),h.forEach(X),f.forEach(X),s.forEach(X),this.h()},h(){Y(i,"class","title svelte-w1fi59"),Y(n,"class","tab svelte-w1fi59"),Y(n,"draggable","true"),W(n,"active",e[1]),Y(t,"class","tab-container svelte-w1fi59"),W(t,"preventHover",e[2])},m(o,s){$(o,t,s),I(t,n),I(n,i),I(i,r),c||(d=[ie(n,"mousedown",je(function(){Ee(e[3])&&e[3].apply(this,arguments)})),ie(n,"touchstart",je(function(){Ee(e[3])&&e[3].apply(this,arguments)})),ie(n,"dragstart",je(function(){Ee(e[4])&&e[4].apply(this,arguments)}))],c=!0)},p(o,[s]){e=o,s&1&&Pt(r,e[0]),s&2&&W(n,"active",e[1]),s&4&&W(t,"preventHover",e[2])},i:ge,o:ge,d(o){o&&X(t),c=!1,vt(d)}}}function Vt(e,t,n){let{title:i=""}=t,{active:r=!1}=t,{preventHover:c=!1}=t,{onPointerdown:d=s=>{}}=t,{onDragstart:o=s=>{}}=t;return e.$$set=s=>{"title"in s&&n(0,i=s.title),"active"in s&&n(1,r=s.active),"preventHover"in s&&n(2,c=s.preventHover),"onPointerdown"in s&&n(3,d=s.onPointerdown),"onDragstart"in s&&n(4,o=s.onDragstart)},[i,r,c,d,o]}class pt extends Ie{constructor(t){super(),Ye(this,t,Vt,Rt,Ce,{title:0,active:1,preventHover:2,onPointerdown:3,onDragstart:4})}}const nt=(e,t)=>{const{duration:n=300,easing:i=he,onEnd:r=()=>{},onStep:c=()=>{},css:d}=t;let o;function s(f){if(!e){console.warn("Cannot find element to animate");return}o===void 0&&(o=f);const h=i((f-o)/n),P=1-h;h<1?(e.style.cssText=d(h,P),c(h,P),requestAnimationFrame(s)):(e.style.cssText="",r())}requestAnimationFrame(s)},Ge=e=>{const{duration:t=300,easing:n=he,onEnd:i=()=>{},onStep:r=()=>{}}=e;let c;function d(o){c===void 0&&(c=o);const s=n((o-c)/t),f=1-s;s<1?(r(s,f),requestAnimationFrame(d)):i()}requestAnimationFrame(d)};function it(e){let t,n,i=`<span class="button-icon svelte-em5dlq" style="-webkit-mask: url(${z}/images/svg/undo.svg) no-repeat center / contain; mask: url(${z}/images/svg/undo.svg) no-repeat center / contain;"></span>`,r,c,d,o;return{c(){t=A("div"),n=A("button"),n.innerHTML=i,this.h()},l(s){t=R(s,"DIV",{class:!0});var f=O(t);n=R(f,"BUTTON",{class:!0,"data-svelte-h":!0}),ue(n)!=="svelte-1b4fip4"&&(n.innerHTML=i),f.forEach(X),this.h()},h(){Y(n,"class","button svelte-em5dlq"),Y(t,"class","pencil-tools")},m(s,f){$(s,t,f),I(t,n),c=!0,d||(o=ie(n,"click",function(){Ee(e[2])&&e[2].apply(this,arguments)}),d=!0)},p(s,f){e=s},i(s){c||(s&&Ze(()=>{c&&(r||(r=Te(t,xe,{duration:200,axis:"x"},!0)),r.run(1))}),c=!0)},o(s){s&&(r||(r=Te(t,xe,{duration:200,axis:"x"},!1)),r.run(0)),c=!1},d(s){s&&X(t),s&&r&&r.end(),d=!1,o()}}}function Bt(e){let t,n,i=`<span class="button-icon svelte-em5dlq" style="-webkit-mask: url(${z}/images/svg/pencil.svg) no-repeat center / contain; mask: url(${z}/images/svg/pencil.svg) no-repeat center / contain;"></span>`,r,c,d,o,s,f=`<span class="button-icon svelte-em5dlq" style="-webkit-mask: url(${z}/images/svg/trash.svg) no-repeat center / contain; mask: url(${z}/images/svg/trash.svg) no-repeat center / contain;"></span>`,h,P,S,V,B,y,w=`<span class="button-icon svelte-em5dlq" style="-webkit-mask: url(${z}/images/svg/user.svg) no-repeat center / contain; mask: url(${z}/images/svg/user.svg) no-repeat center / contain;"></span>`,m,g,k=`<span class="button-icon svelte-em5dlq" style="-webkit-mask: url(${z}/images/svg/maximize.svg) no-repeat center / contain; mask: url(${z}/images/svg/maximize.svg) no-repeat center / contain;"></span>`,p,x,M,T,E=e[3].activeTool==="pencil"&&it(e);return{c(){t=A("div"),n=A("button"),n.innerHTML=i,r=j(),E&&E.c(),c=j(),d=A("div"),o=j(),s=A("button"),s.innerHTML=f,h=j(),P=A("button"),S=A("span"),B=j(),y=A("a"),y.innerHTML=w,m=j(),g=A("button"),g.innerHTML=k,this.h()},l(v){t=R(v,"DIV",{class:!0});var b=O(t);n=R(b,"BUTTON",{class:!0,"data-svelte-h":!0}),ue(n)!=="svelte-t1zbc2"&&(n.innerHTML=i),r=G(b),E&&E.l(b),c=G(b),d=R(b,"DIV",{class:!0}),O(d).forEach(X),o=G(b),s=R(b,"BUTTON",{class:!0,"data-svelte-h":!0}),ue(s)!=="svelte-cbr57k"&&(s.innerHTML=f),h=G(b),P=R(b,"BUTTON",{class:!0});var H=O(P);S=R(H,"SPAN",{class:!0,style:!0}),O(S).forEach(X),H.forEach(X),B=G(b),y=R(b,"A",{class:!0,href:!0,"data-svelte-h":!0}),ue(y)!=="svelte-1xuhzhs"&&(y.innerHTML=w),m=G(b),g=R(b,"BUTTON",{class:!0,"data-svelte-h":!0}),ue(g)!=="svelte-siuh87"&&(g.innerHTML=k),b.forEach(X),this.h()},h(){Y(n,"class","pencil button svelte-em5dlq"),W(n,"selected",e[3].activeTool==="pencil"),Y(d,"class","spacer svelte-em5dlq"),Y(s,"class","close button svelte-em5dlq"),Y(S,"class","button-icon svelte-em5dlq"),et(S,"-webkit-mask","url("+z+"/images/svg/refresh.svg) no-repeat center / contain"),et(S,"mask","url("+z+"/images/svg/refresh.svg) no-repeat center / contain"),Y(P,"class","refresh button svelte-em5dlq"),P.disabled=V=e[4].savingStatus==="saving",Y(y,"class","button svelte-em5dlq"),Y(y,"href",z+"/profile"),Y(g,"class","button svelte-em5dlq"),Y(t,"class","toolbar-container svelte-em5dlq")},m(v,b){$(v,t,b),I(t,n),I(t,r),E&&E.m(t,null),I(t,c),I(t,d),I(t,o),I(t,s),I(t,h),I(t,P),I(P,S),I(t,B),I(t,y),I(t,m),I(t,g),x=!0,M||(T=[ie(n,"click",e[5]),ie(s,"click",function(){Ee(e[1])&&e[1].apply(this,arguments)}),ie(P,"click",function(){Ee(e[0])&&e[0].apply(this,arguments)}),ie(g,"click",e[6])],M=!0)},p(v,[b]){e=v,(!x||b&8)&&W(n,"selected",e[3].activeTool==="pencil"),e[3].activeTool==="pencil"?E?(E.p(e,b),b&8&&q(E,1)):(E=it(e),E.c(),q(E,1),E.m(t,c)):E&&(ve(),F(E,1,1,()=>{E=null}),be()),(!x||b&16&&V!==(V=e[4].savingStatus==="saving"))&&(P.disabled=V)},i(v){x||(q(E),v&&Ze(()=>{x&&(p||(p=Te(t,xe,{duration:200},!0)),p.run(1))}),x=!0)},o(v){F(E),v&&(p||(p=Te(t,xe,{duration:200},!1)),p.run(0)),x=!1},d(v){v&&X(t),E&&E.d(),v&&p&&p.end(),M=!1,vt(T)}}}function Ot(e,t,n){let i,r;se(e,me,h=>n(3,i=h)),se(e,bt,h=>n(4,r=h));let{onRefresh:c=()=>{}}=t,{onClose:d=()=>{}}=t,{onDrawingUndo:o=()=>{}}=t;const s=()=>{fe(me,i.activeTool=i.activeTool==="pencil"?void 0:"pencil",i)},f=()=>{fe(me,i.toolbarVisible=!1,i),fe(me,i.activeTool=void 0,i)};return e.$$set=h=>{"onRefresh"in h&&n(0,c=h.onRefresh),"onClose"in h&&n(1,d=h.onClose),"onDrawingUndo"in h&&n(2,o=h.onDrawingUndo)},[c,d,o,i,r,s,f]}class Ut extends Ie{constructor(t){super(),Ye(this,t,Ot,Bt,Ce,{onRefresh:0,onClose:1,onDrawingUndo:2})}}const st=500,qt=300,lt=500,Nt=300;class Wt{constructor(){U(this,"isMoving",!1);U(this,"isLongclick",!1);U(this,"button",0);U(this,"lastX",0);U(this,"lastY",0);U(this,"consecutiveClicks",0);U(this,"lastMouseupTime",0);U(this,"activeElement",null);this.reset()}reset(){this.isMoving=!1,this.isLongclick=!1,this.button=0,this.lastX=0,this.lastY=0,this.consecutiveClicks=0,this.lastMouseupTime=0,this.activeElement=null}}class Ft{constructor(){U(this,"isDragging",!1);U(this,"isPinching",!1);U(this,"isLongpressed",!1);U(this,"consecutiveTaps",0);U(this,"lastTouchendTime",0);U(this,"lastCenterX",0);U(this,"lastCenterY",0);U(this,"identifier",0);U(this,"x",0);U(this,"y",0);U(this,"hypotenuse",0);U(this,"activeElement",null);this.reset()}reset(){this.isDragging=!1,this.isPinching=!1,this.isLongpressed=!1,this.consecutiveTaps=0,this.lastTouchendTime=0,this.lastCenterX=0,this.lastCenterY=0,this.identifier=0,this.x=0,this.y=0,this.hypotenuse=0,this.activeElement=null}}let de=[],u=new Wt,a=new Ft;const C=(e,t)=>{e!=null&&e.dispatchEvent(new CustomEvent("gesture",{detail:t,bubbles:!1,cancelable:!1}))},yt=e=>{u.reset(),a.reset(),u.lastMouseupTime=Date.now(),window.removeEventListener("mousemove",Ve),window.removeEventListener("mouseup",Be),window.removeEventListener("touchmove",Oe),window.removeEventListener("touchend",De)},wt=e=>{if(window.removeEventListener("mousemove",Ve),window.removeEventListener("mouseup",Be),window.removeEventListener("touchmove",Oe),window.removeEventListener("touchend",De),u.isMoving)if(u.isMoving=!1,u.isLongclick)u.isLongclick=!1,C(u.activeElement,{event:e,name:"longclick-drag-end",x:u.lastX,y:u.lastY,dx:0,dy:0});else switch(u.button){case 0:C(u.activeElement,{event:e,name:"left-click-drag-end",x:u.lastX,y:u.lastY,dx:0,dy:0});break;case 1:C(u.activeElement,{event:e,name:"middle-click-drag-end",x:u.lastX,y:u.lastY,dx:0,dy:0});break;case 2:C(u.activeElement,{event:e,name:"right-click-drag-end",x:u.lastX,y:u.lastY,dx:0,dy:0});break}u.isLongclick&&C(u.activeElement,{event:e,name:"longclick-release",x:u.lastX,y:u.lastY,dx:0,dy:0}),u.reset(),a.isDragging&&(a.isDragging=!1,a.isLongpressed?(a.isLongpressed=!1,C(a.activeElement,{event:e,name:"longpress-drag-end",x:a.lastCenterX,y:a.lastCenterY,dx:0,dy:0})):C(a.activeElement,{event:e,name:"touch-drag-end",x:a.lastCenterX,y:a.lastCenterY,dx:0,dy:0})),a.isLongpressed&&C(a.activeElement,{event:e,name:"longpress-release",x:a.lastCenterX,y:a.lastCenterY,dx:0,dy:0}),a.reset()},_t=e=>{C(e.target,{event:e,name:"wheel",x:e.clientX,y:e.clientY,dx:0,dy:0})},kt=e=>{},Et=e=>{document.activeElement!==e.target&&(window.addEventListener("mousemove",Ve),window.addEventListener("mouseup",Be),u.activeElement=e.target,u.lastX=e.clientX,u.lastY=e.clientY,u.isMoving||(u.button=e.button),u.button===0&&window.setTimeout(()=>{Date.now()-u.lastMouseupTime>=lt&&!u.isMoving&&(u.isLongclick=!0,C(u.activeElement,{event:e,name:"longclick",x:e.clientX,y:e.clientY,dx:0,dy:0}))},lt))},Ve=e=>{if(e.movementX===0&&e.movementY===0)return;let t=e.clientX-u.lastX,n=e.clientY-u.lastY;if(!u.isMoving)if(u.isLongclick)C(u.activeElement,{event:e,name:"longclick-drag-start",x:e.clientX,y:e.clientY,dx:0,dy:0});else switch(u.button){case 0:C(u.activeElement,{event:e,name:"left-click-drag-start",x:e.clientX,y:e.clientY,dx:0,dy:0});break;case 1:C(u.activeElement,{event:e,name:"middle-click-drag-start",x:e.clientX,y:e.clientY,dx:0,dy:0});break;case 2:C(u.activeElement,{event:e,name:"right-click-drag-start",x:e.clientX,y:e.clientY,dx:0,dy:0});break}if(u.isMoving=!0,u.lastX=e.clientX,u.lastY=e.clientY,u.isLongclick)C(u.activeElement,{event:e,name:"longclick-dragging",x:e.clientX,y:e.clientY,dx:t,dy:n});else switch(u.button){case 0:C(u.activeElement,{event:e,name:"left-click-dragging",x:e.clientX,y:e.clientY,dx:t,dy:n});break;case 1:C(u.activeElement,{event:e,name:"middle-click-dragging",x:e.clientX,y:e.clientY,dx:t,dy:n});break;case 2:C(u.activeElement,{event:e,name:"right-click-dragging",x:e.clientX,y:e.clientY,dx:t,dy:n});break}},Be=e=>{if(window.removeEventListener("mousemove",Ve),window.removeEventListener("mouseup",Be),u.lastMouseupTime=Date.now(),u.isMoving)if(u.isMoving=!1,u.isLongclick)u.isLongclick=!1,C(u.activeElement,{event:e,name:"longclick-drag-end",x:u.lastX,y:u.lastY,dx:0,dy:0});else switch(u.button){case 0:C(u.activeElement,{event:e,name:"left-click-drag-end",x:u.lastX,y:u.lastY,dx:0,dy:0});break;case 1:C(u.activeElement,{event:e,name:"middle-click-drag-end",x:u.lastX,y:u.lastY,dx:0,dy:0});break;case 2:C(u.activeElement,{event:e,name:"right-click-drag-end",x:u.lastX,y:u.lastY,dx:0,dy:0});break}else u.isLongclick||(e.button===2?C(u.activeElement,{event:e,name:"right-click",x:e.clientX,y:e.clientY,dx:0,dy:0}):e.button===1?C(u.activeElement,{event:e,name:"middle-click",x:e.clientX,y:e.clientY,dx:0,dy:0}):(u.consecutiveClicks===0&&C(u.activeElement,{event:e,name:"left-click",x:e.clientX,y:e.clientY,dx:0,dy:0}),u.consecutiveClicks++,window.setTimeout(()=>{u.consecutiveClicks>1&&C(u.activeElement,{event:e,name:"double-click",x:e.clientX,y:e.clientY,dx:0,dy:0}),u.consecutiveClicks=0},Nt)));u.isLongclick&&C(u.activeElement,{event:e,name:"longclick-release",x:e.clientX,y:e.clientY,dx:0,dy:0}),u.isLongclick=!1},Tt=e=>{if(e.touches.length>1,document.activeElement!==e.target){if(e.touches.length>1){if(e.touches[0].identifier===a.identifier)return;a.isPinching=!0}window.addEventListener("touchmove",Oe,{passive:!1}),window.addEventListener("touchend",De),window.addEventListener("touchcancel",De),a.identifier=e.touches[0].identifier,a.x=e.touches[0].clientX,a.y=e.touches[0].clientY,a.activeElement=e.target,window.setTimeout(()=>{a.isPinching||a.isDragging||Date.now()-a.lastTouchendTime>=st&&(a.isDragging=!1,a.isPinching=!1,a.hypotenuse=null,a.isLongpressed=!0,C(a.activeElement,{event:e,name:"longpress",x:a.x,y:a.y,dx:0,dy:0}))},st)}},Oe=e=>{if(a.isDragging){let t=a.x,n=a.y;a.x=e.touches[0].clientX,a.y=e.touches[0].clientY;let i=a.x-t,r=a.y-n;a.isLongpressed?C(a.activeElement,{event:e,name:"longpress-dragging",x:a.x,y:a.y,dx:i,dy:r,force:e.touches[0].force}):C(a.activeElement,{event:e,name:"touch-dragging",x:a.x,y:a.y,dx:i,dy:r,force:e.touches[0].force});return}else if(!a.isLongpressed&&(a.isPinching||e.touches.length>1)){a.x=e.touches[0].clientX,a.y=e.touches[0].clientY;let t={x:e.touches[1].clientX,y:e.touches[1].clientY},n={x:(a.x+t.x)/2,y:(a.y+t.y)/2},i=Math.hypot(a.x-t.x,a.y-t.y);a.hypotenuse===null&&(a.hypotenuse=i,a.lastCenterX=n.x,a.lastCenterY=n.y,C(a.activeElement,{event:e,name:"pinch-start",x:n.x,y:n.y,dx:0,dy:0})),a.isPinching=!0;let r=i/a.hypotenuse,c=n.x-a.lastCenterX,d=n.y-a.lastCenterY;C(a.activeElement,{event:e,name:"pinching",x:n.x,y:n.y,zoom:r,dx:c,dy:d}),a.hypotenuse=i,a.lastCenterX=n.x,a.lastCenterY=n.y;return}else a.isDragging=!0,a.isLongpressed?(C(a.activeElement,{event:e,name:"longpress-drag-start",x:a.x,y:a.y,dx:0,dy:0,force:e.touches[0].force}),a.x=e.touches[0].clientX,a.y=e.touches[0].clientY,C(a.activeElement,{event:e,name:"longpress-dragging",x:a.x,y:a.y,dx:0,dy:0,force:e.touches[0].force})):(C(a.activeElement,{event:e,name:"touch-drag-start",x:a.x,y:a.y,dx:0,dy:0,force:e.touches[0].force}),a.x=e.touches[0].clientX,a.y=e.touches[0].clientY,C(a.activeElement,{event:e,name:"touch-dragging",x:a.x,y:a.y,dx:0,dy:0,force:e.touches[0].force}))},De=e=>{a.isDragging&&e.touches.length>0&&e.touches[0].identifier===a.identifier||(a.lastTouchendTime=Date.now(),window.removeEventListener("touchmove",Oe),window.removeEventListener("touchend",De),window.removeEventListener("touchcancel",De),a.isDragging?(a.isDragging=!1,a.isLongpressed?(a.isLongpressed=!1,C(a.activeElement,{event:e,name:"longpress-drag-end",x:a.x,y:a.y,dx:0,dy:0})):C(a.activeElement,{event:e,name:"touch-drag-end",x:a.x,y:a.y,dx:0,dy:0})):a.isPinching?(a.isPinching=!1,a.hypotenuse=null,C(a.activeElement,{event:e,name:"pinch-end",x:a.lastCenterX,y:a.lastCenterY,dx:0,dy:0})):a.isLongpressed||(a.consecutiveTaps===0&&C(a.activeElement,{event:e,name:"tap",x:a.x,y:a.y,dx:0,dy:0}),a.consecutiveTaps++,window.setTimeout(()=>{a.consecutiveTaps>1&&C(a.activeElement,{event:e,name:"double-tap",x:a.x,y:a.y,dx:0,dy:0}),a.consecutiveTaps=0},qt)),a.isLongpressed&&C(a.activeElement,{event:e,name:"longpress-release",x:a.x,y:a.y,dx:0,dy:0}),a.isLongpressed=!1)};function zt(...e){for(let t of e)de.findIndex(n=>n===t)===-1&&(de.length==0&&(window.addEventListener("blur",wt),window.addEventListener("focus",yt)),de.push(t),t.addEventListener("touchstart",Tt,{passive:!1}),t.addEventListener("mousedown",Et,{passive:!1}),t.addEventListener("contextmenu",kt,{passive:!1}),t.addEventListener("wheel",_t,{passive:!1}))}function jt(...e){const t=n=>{n.removeEventListener("touchstart",Tt),n.removeEventListener("mousedown",Et),n.removeEventListener("contextmenu",kt),n.removeEventListener("wheel",_t)};if(e.length==0){for(let n of de)t(n);de=[]}else for(let n of e){let i=de.findIndex(r=>r===n);i!==-1&&(t(n),de.splice(i,1))}de.length==0&&(window.removeEventListener("blur",wt),window.removeEventListener("focus",yt))}function Gt(e){let t,n,i,r,c,d,o="LOG";return{c(){t=A("div"),n=A("canvas"),i=j(),r=A("canvas"),c=j(),d=A("div"),d.textContent=o,this.h()},l(s){t=R(s,"DIV",{class:!0});var f=O(t);n=R(f,"CANVAS",{id:!0,class:!0}),O(n).forEach(X),i=G(f),r=R(f,"CANVAS",{id:!0,class:!0}),O(r).forEach(X),c=G(f),d=R(f,"DIV",{class:!0,"data-svelte-h":!0}),ue(d)!=="svelte-rtly9t"&&(d.textContent=o),f.forEach(X),this.h()},h(){Y(n,"id","currentPath"),Y(n,"class","svelte-1aj9b7c"),W(n,"disabled",e[0]),Y(r,"id","canvas"),Y(r,"class","svelte-1aj9b7c"),W(r,"disabled",e[0]),Y(d,"class","log svelte-1aj9b7c"),Y(t,"class","canvas-container svelte-1aj9b7c"),W(t,"hide",e[1])},m(s,f){$(s,t,f),I(t,n),e[13](n),I(t,i),I(t,r),e[14](r),I(t,c),I(t,d),e[15](d)},p(s,f){f[0]&1&&W(n,"disabled",s[0]),f[0]&1&&W(r,"disabled",s[0]),f[0]&2&&W(t,"hide",s[1])},i:ge,o:ge,d(s){s&&X(t),e[13](null),e[14](null),e[15](null)}}}const Kt=2;function Ae(e,t){t.lineWidth=e.lineWidths[0],t.lineCap="round",t.strokeStyle=e.color,t.beginPath(),t.moveTo(e.points[0].x,e.points[0].y);for(let n=0;n<e.points.length;n++)t.lineWidth=e.lineWidths[n],t.quadraticCurveTo(e.points[n].x,e.points[n].y,e.ctrlPoints[n].x,e.ctrlPoints[n].y),t.moveTo(e.ctrlPoints[n].x,e.ctrlPoints[n].y);t.stroke()}function rt(e){return{x:Je(e.x),y:Je(e.y)}}function Je(e){return Number(e.toFixed(Kt))}function Qt(e,t,n){let i,r;se(e,oe,l=>n(28,r=l));let{radius:c=3}=t,{smoothness:d=2}=t,{stroke:o=5}=t,{pressureScaler:s=5}=t,{color:f="#000000"}=t,{disabled:h=!1}=t,{hide:P=!1}=t,{tabID:S=""}=t;function V(){w.clearRect(0,0,M,x),N=[]}function B(){if(N.length!=0){n(4,v.innerHTML="Undo",v),N.pop(),g.clearRect(0,0,M,x);for(let l=0;l<N.length;l++)Ae(N[l],g)}}let y,w,m,g,k={x:0,y:0},p=0,x=0,M=0,T,E=!1,v,b,H,N=[];function K(){y&&(zt(y),window.addEventListener("keydown",He))}function Q(){y&&(jt(y),window.removeEventListener("keydown",He))}const Z=(l,_,D,L)=>{var te=D-l,J=L-_;return Math.sqrt(te*te+J*J)},le=(l,_=300)=>{let D;return(...L)=>{clearTimeout(D),D=setTimeout(()=>{l.apply(void 0,L)},_)}};function Xe(l,_){let D=y.getBoundingClientRect();return{x:(l-D.left)*T,y:(_-D.top)*T}}function re(){if(!y||!m)return;Se(),T=window.devicePixelRatio;let l=y.getBoundingClientRect();x=l.height*T,M=l.width*T,n(2,y.width=M,y),n(2,y.height=x,y),n(3,m.width=M,m),n(3,m.height=x,m);for(let _=0;_<N.length;_++)Ae(N[_],g)}function ee(){r[S]&&fe(oe,r[S].paths=N,r)}function Ue(){r[S]&&(N=r[S].paths,re())}function qe(l,_,D){E=!0,k=Xe(l,_),D!==void 0&&D>0?p=Math.log(D+1)*s*i:p=i,w.lineWidth=p,w.lineCap="round",w.strokeStyle=f,w.beginPath(),w.moveTo(k.x,k.y),w.stroke(),b={points:[],ctrlPoints:[],lineWidths:[],color:f}}function Ne(l,_,D){if(!E)return;let L=Xe(l,_);if(c>0){if(Z(L.x,L.y,k.x,k.y)<=c)return;let ce=Math.sqrt(L.x*L.x+L.y*L.y-2*L.x*k.x+k.x*k.x-2*L.y*k.y+k.y*k.y);if(L={x:L.x+c*((k.x-L.x)/ce),y:L.y+c*((k.y-L.y)/ce)},Z(k.x,k.y,L.x,L.y)<=d)return}let te=(k.x+L.x)/2,J=(k.y+L.y)/2;D!==void 0&&D>0&&(p=Math.log(D+1)*s*i*.2+p*.8),b.points.push(rt(k)),b.ctrlPoints.push(rt({x:te,y:J})),b.lineWidths.push(Je(p)),w.clearRect(0,0,M,x),Ae(b,w),k=L}function Se(){E&&(N.push(b),Ae(b,g),w.clearRect(0,0,M,x),ee()),E=!1}const He=function(l){l.ctrlKey&&l.key=="z"&&(B(),ee()),l.preventDefault()};$e(()=>{w=y.getContext("2d"),w.imageSmoothingEnabled=!1,g=m.getContext("2d"),g.imageSmoothingEnabled=!1,y.addEventListener("gesture",l=>{switch(l.detail.name){case"left-click-drag-start":case"touch-drag-start":qe(l.detail.x,l.detail.y,l.detail.force);break;case"left-click-dragging":case"touch-dragging":l.detail.force>0&&n(4,v.innerHTML=l.detail.force,v),Ne(l.detail.x,l.detail.y,l.detail.force);break;case"left-click-drag-end":case"touch-drag-end":Se();break}}),H=new ResizeObserver(le(re,0)),H.observe(y),Ue(),h?Q():K()}),Dt(()=>{H&&H.disconnect(),Q()});function We(l){ne[l?"unshift":"push"](()=>{m=l,n(3,m)})}function Fe(l){ne[l?"unshift":"push"](()=>{y=l,n(2,y)})}function ze(l){ne[l?"unshift":"push"](()=>{v=l,n(4,v)})}return e.$$set=l=>{"radius"in l&&n(5,c=l.radius),"smoothness"in l&&n(6,d=l.smoothness),"stroke"in l&&n(7,o=l.stroke),"pressureScaler"in l&&n(8,s=l.pressureScaler),"color"in l&&n(9,f=l.color),"disabled"in l&&n(0,h=l.disabled),"hide"in l&&n(1,P=l.hide),"tabID"in l&&n(10,S=l.tabID)},e.$$.update=()=>{e.$$.dirty[0]&128&&(i=Math.max(o,1)),e.$$.dirty[0]&1&&(h?Q():K())},[h,P,y,m,v,c,d,o,s,f,S,V,B,We,Fe,ze]}class Jt extends Ie{constructor(t){super(),Ye(this,t,Qt,Gt,Ce,{radius:5,smoothness:6,stroke:7,pressureScaler:8,color:9,disabled:0,hide:1,tabID:10,clear:11,undo:12},null,[-1,-1])}get clear(){return this.$$.ctx[11]}get undo(){return this.$$.ctx[12]}}function at(e,t,n){const i=e.slice();return i[42]=t[n],i[43]=t,i[44]=n,i}function ot(e,t){let n,i,r,c,d=t[44],o,s,f;function h(...y){return t[18](t[44],...y)}function P(y){t[19](y,t[42])}let S={active:t[10]==t[42],preventHover:t[9],onPointerdown:h,onDragstart:t[16]};t[12][t[42]].title!==void 0&&(S.title=t[12][t[42]].title),i=new pt({props:S}),ne.push(()=>Mt(i,"title",P));const V=()=>t[20](n,d),B=()=>t[20](null,d);return{key:e,first:null,c(){n=A("div"),pe(i.$$.fragment),c=j(),this.h()},l(y){n=R(y,"DIV",{class:!0});var w=O(n);ye(i.$$.fragment,w),c=G(w),w.forEach(X),this.h()},h(){Y(n,"class","tab-container svelte-6u8cf7"),W(n,"placeholder",t[11]==t[42]),this.first=n},m(y,w){$(y,n,w),we(i,n,null),I(n,c),V(),o=!0,s||(f=Ct(t[15].call(null,n)),s=!0)},p(y,w){t=y;const m={};w[0]&1028&&(m.active=t[10]==t[42]),w[0]&512&&(m.preventHover=t[9]),w[0]&4&&(m.onPointerdown=h),!r&&w[0]&4100&&(r=!0,m.title=t[12][t[42]].title,It(()=>r=!1)),i.$set(m),d!==t[44]&&(B(),d=t[44],V()),(!o||w[0]&2052)&&W(n,"placeholder",t[11]==t[42])},i(y){o||(q(i.$$.fragment,y),o=!0)},o(y){F(i.$$.fragment,y),o=!1},d(y){y&&X(n),_e(i),B(),s=!1,f()}}}function ct(e){let t,n=`<span class="button-icon svelte-6u8cf7" style="-webkit-mask: url(${z}/images/svg/gear.svg) no-repeat center / contain; mask: url(${z}/images/svg/gear.svg) no-repeat center / contain;"></span>`,i,r,c,d;return{c(){t=A("button"),t.innerHTML=n,this.h()},l(o){t=R(o,"BUTTON",{class:!0,"data-svelte-h":!0}),ue(t)!=="svelte-1wioe5y"&&(t.innerHTML=n),this.h()},h(){Y(t,"class","button svelte-6u8cf7")},m(o,s){$(o,t,s),r=!0,c||(d=ie(t,"click",e[22]),c=!0)},p:ge,i(o){r||(o&&Ze(()=>{r&&(i||(i=Te(t,xe,{duration:200,axis:"x"},!0)),i.run(1))}),r=!0)},o(o){o&&(i||(i=Te(t,xe,{duration:200,axis:"x"},!1)),i.run(0)),r=!1},d(o){o&&X(t),o&&i&&i.end(),c=!1,d()}}}function dt(e){let t,n;return t=new Ut({props:{onDrawingUndo:e[0],onRefresh:St.loadFromFirestore,onClose:e[24]}}),{c(){pe(t.$$.fragment)},l(i){ye(t.$$.fragment,i)},m(i,r){we(t,i,r),n=!0},p(i,r){const c={};r[0]&1&&(c.onDrawingUndo=i[0]),r[0]&1024&&(c.onClose=i[24]),t.$set(c)},i(i){n||(q(t.$$.fragment,i),n=!0)},o(i){F(t.$$.fragment,i),n=!1},d(i){_e(t,i)}}}function Zt(e){let t,n,i,r=[],c=new Map,d,o,s,f=`<span class="button-icon svelte-6u8cf7" style="-webkit-mask: url(${z}/images/svg/plus.svg) no-repeat center / contain; mask: url(${z}/images/svg/plus.svg) no-repeat center / contain;"></span>`,h,P,S,V,B,y,w,m,g,k,p,x=ke(e[2].order);const M=v=>v[42];for(let v=0;v<x.length;v+=1){let b=at(e,x,v),H=M(b);c.set(H,r[v]=ot(H,b))}let T=!e[2].toolbarVisible&&ct(e);B=new pt({props:{title:e[5],active:!e[7],preventHover:!0}});let E=e[2].toolbarVisible&&dt(e);return{c(){t=A("div"),n=A("div"),i=A("div");for(let v=0;v<r.length;v+=1)r[v].c();d=j(),o=A("div"),s=A("button"),s.innerHTML=f,h=j(),P=A("div"),T&&T.c(),S=j(),V=A("div"),pe(B.$$.fragment),y=j(),w=A("div"),m=j(),E&&E.c(),this.h()},l(v){t=R(v,"DIV",{class:!0});var b=O(t);n=R(b,"DIV",{class:!0});var H=O(n);i=R(H,"DIV",{class:!0});var N=O(i);for(let le=0;le<r.length;le+=1)r[le].l(N);N.forEach(X),d=G(H),o=R(H,"DIV",{class:!0});var K=O(o);s=R(K,"BUTTON",{class:!0,"data-svelte-h":!0}),ue(s)!=="svelte-g0ls06"&&(s.innerHTML=f),K.forEach(X),h=G(H),P=R(H,"DIV",{class:!0});var Q=O(P);T&&T.l(Q),Q.forEach(X),S=G(H),V=R(H,"DIV",{class:!0});var Z=O(V);ye(B.$$.fragment,Z),Z.forEach(X),H.forEach(X),y=G(b),w=R(b,"DIV",{class:!0}),O(w).forEach(X),m=G(b),E&&E.l(b),b.forEach(X),this.h()},h(){Y(i,"class","tabs svelte-6u8cf7"),Y(s,"class","button svelte-6u8cf7"),Y(o,"class","new-tab-container svelte-6u8cf7"),Y(P,"class","buttons-container svelte-6u8cf7"),Y(V,"class","clone svelte-6u8cf7"),W(V,"dragging",e[1]),Y(n,"class","tabbar svelte-6u8cf7"),Y(w,"class","divider svelte-6u8cf7"),Y(t,"class","svelte-6u8cf7")},m(v,b){$(v,t,b),I(t,n),I(n,i);for(let H=0;H<r.length;H+=1)r[H]&&r[H].m(i,null);e[21](i),I(n,d),I(n,o),I(o,s),I(n,h),I(n,P),T&&T.m(P,null),I(n,S),I(n,V),we(B,V,null),e[23](V),I(t,y),I(t,w),I(t,m),E&&E.m(t,null),e[25](t),g=!0,k||(p=ie(s,"click",e[13]),k=!0)},p(v,b){b[0]&204308&&(x=ke(v[2].order),ve(),r=Ke(r,b,M,1,v,x,c,i,Qe,ot,null,at),be()),v[2].toolbarVisible?T&&(ve(),F(T,1,1,()=>{T=null}),be()):T?(T.p(v,b),b[0]&4&&q(T,1)):(T=ct(v),T.c(),q(T,1),T.m(P,null));const H={};b[0]&32&&(H.title=v[5]),b[0]&128&&(H.active=!v[7]),B.$set(H),(!g||b[0]&2)&&W(V,"dragging",v[1]),v[2].toolbarVisible?E?(E.p(v,b),b[0]&4&&q(E,1)):(E=dt(v),E.c(),q(E,1),E.m(t,null)):E&&(ve(),F(E,1,1,()=>{E=null}),be())},i(v){if(!g){for(let b=0;b<x.length;b+=1)q(r[b]);q(T),q(B.$$.fragment,v),q(E),g=!0}},o(v){for(let b=0;b<r.length;b+=1)F(r[b]);F(T),F(B.$$.fragment,v),F(E),g=!1},d(v){v&&X(t);for(let b=0;b<r.length;b+=1)r[b].d();e[21](null),T&&T.d(),_e(B),e[23](null),E&&E.d(),e[25](null),k=!1,p()}}}const $t=12,Re=200,Pe=32,Me=200,en=1600,ut=.3;function tn(e,t,n){let i,r,c,d;se(e,me,l=>n(2,c=l)),se(e,oe,l=>n(12,d=l));let{onDrawingUndo:o=()=>{}}=t,s,f=[],h=0,P=null,S=-1,V="",B,y,w,m=!1,g=!1,k=0,p=0,x,M=!1;const T=(l,_=300)=>{let D;return(...L)=>{clearTimeout(D),D=setTimeout(()=>{l.apply(void 0,L)},_)}};function E(){ae.newTab()}const v=l=>{const _=c.order.findIndex(D=>D===l);if(_<0||!f[_]){console.warn("Cannot close tab!");return}h=f[_].getBoundingClientRect().width,_<c.order.length-1&&(s.style.setProperty("--tab-max-width",`${h}px`),b()),_==c.activeIndex&&(_==c.order.length-1?ae.setActiveIndex(_-1):ae.setActiveIndex(_+1)),Ge({duration:Me,easing:he,onStep:(D,L)=>{_==0?n(3,s.style.gridTemplateColumns=`minmax(${L*Pe}px, ${L*h}px)`,s):n(3,s.style.gridTemplateColumns=`repeat(${_}, minmax(var(--tab-min-width), var(--tab-max-width))) minmax(${L*Pe}px, ${L*h}px)`,s)},onEnd:()=>{n(3,s.style.gridTemplateColumns="",s),ae.removeTab(l)}})},b=T(()=>{s&&(s.style.setProperty("--tab-max-width",`${Re}px`),Ge({duration:Me,easing:he,onStep:(l,_)=>{s.style.setProperty("--tab-max-width",`${h+l*(Re-h)}px`)},onEnd:()=>{s.style.setProperty("--tab-max-width",`${Re}px`)}}))},en);function H(l){if(!s)return;const _=l.getBoundingClientRect().width;Ge({duration:Me,easing:he,onStep:(D,L)=>{c.order.length==1?n(3,s.style.gridTemplateColumns=`minmax(${D*Pe}px, ${D*_}px)`,s):n(3,s.style.gridTemplateColumns=`repeat(${c.order.length-1}, minmax(var(--tab-min-width), var(--tab-max-width))) minmax(${D*Pe}px, ${D*_}px)`,s),n(3,s.scrollLeft=s.scrollWidth,s)},onEnd:()=>{n(3,s.style.gridTemplateColumns="",s)}})}const N=(l,_)=>{const D=f[0].getBoundingClientRect().width;ae.moveTab(l,_,()=>{if(l>_)for(let L=_;L<l;L++)nt(f[L],{duration:Me,easing:he,css:(te,J)=>`transform: translateX(-${J*D}px);`});if(l<_)for(let L=_;L>l;L--)nt(f[L],{duration:Me,easing:he,css:(te,J)=>`transform: translateX(${J*D}px);`})})};function K(l){!l.target||!l.dataTransfer||(l.dataTransfer.setData("text/plain",i),l.dataTransfer.setDragImage(new Image,0,0))}function Q(l,_){if(l==0&&_==0){n(6,w.style.left="-1000px",w),n(6,w.style.top="-1000px",w);return}let D=x.getBoundingClientRect();if(l<D.left||l>D.right||_<D.top||_>D.bottom){g||(p=0),n(6,w.style.left=`${l+k}px`,w),n(6,w.style.top=`${_-y.height/2}px`,w),n(7,g=!0);return}g&&n(7,g=!1),n(6,w.style.left=`${l+k}px`,w),n(6,w.style.top=`${y.top}px`,w);const L=-s.scrollLeft,te=f[0].getBoundingClientRect().width;let J=-1;if(l>L+c.order.length*te)J=c.order.length-1;else for(let ce=0;ce<c.order.length;ce++)if(l>L+ce*te&&l<L+(ce+1)*te){J=ce;break}l<20?(p=-ut,requestAnimationFrame(le)):l>s.clientWidth-10?(p=ut,requestAnimationFrame(le)):p=0,!(J==-1||J==c.placeholderIndex)&&N(c.placeholderIndex,J)}let Z=0;function le(l){if(!m||p==0){Z=0;return}Z==0&&(Z=l);const _=l-Z;Z=l,s.scrollBy({left:p*_}),requestAnimationFrame(le)}function Xe(l,_){if(!l.target)return;let D,L;l instanceof TouchEvent?(D=l.touches[0].clientX,L=l.touches[0].clientY):(D=l.clientX,L=l.clientY),window.addEventListener("touchmove",re,{passive:!1}),window.addEventListener("touchend",ee),window.addEventListener("mousemove",re),window.addEventListener("mouseup",ee),window.addEventListener("drag",re),window.addEventListener("dragend",ee),window.addEventListener("blur",ee),ae.setActiveIndex(_),B=l.target,y=B.getBoundingClientRect(),P=[D,L],k=y.left-D,y.top-L,n(6,w.style.width=`${y.width}px`,w),n(6,w.style.left=`${y.left}px`,w),n(6,w.style.top=`${y.top}px`,w),S=_,n(5,V=d[c.order[_]].title)}function re(l){let _,D;if(l instanceof TouchEvent?(_=l.touches[0].clientX,D=l.touches[0].clientY,l.preventDefault()):(_=l.clientX,D=l.clientY),m){Q(_,D);return}P===null||Math.hypot(P[0]-_,P[1]-D)<$t||(n(1,m=!0),ae.setPlaceholderIndex(S),ae.setActiveIndex(S))}function ee(){window.removeEventListener("touchmove",re),window.removeEventListener("touchend",ee),window.removeEventListener("mousemove",re),window.removeEventListener("mouseup",ee),window.removeEventListener("drag",re),window.removeEventListener("dragend",ee),window.removeEventListener("blur",ee),P=null,n(7,g=!1),S=-1,k=0,ae.setPlaceholderIndex(),n(1,m=!1)}$e(()=>{s.style.setProperty("--tab-max-width",`${Re}px`),s.style.setProperty("--tab-min-width",`${Pe}px`)});const Ue=(l,_)=>Xe(_,l);function qe(l,_){e.$$.not_equal(d[_].title,l)&&(d[_].title=l,oe.set(d))}function Ne(l,_){ne[l?"unshift":"push"](()=>{f[_]=l,n(4,f)})}function Se(l){ne[l?"unshift":"push"](()=>{s=l,n(3,s)})}const He=()=>{fe(me,c.toolbarVisible=!0,c)};function We(l){ne[l?"unshift":"push"](()=>{w=l,n(6,w)})}const Fe=()=>v(i);function ze(l){ne[l?"unshift":"push"](()=>{x=l,n(8,x)})}return e.$$set=l=>{"onDrawingUndo"in l&&n(0,o=l.onDrawingUndo)},e.$$.update=()=>{e.$$.dirty[0]&4&&n(10,i=c.order[c.activeIndex]),e.$$.dirty[0]&4&&n(11,r=c.order[c.placeholderIndex]),e.$$.dirty[0]&2&&(m?n(9,M=!0):setTimeout(()=>n(9,M=!1),20))},[o,m,c,s,f,V,w,g,x,M,i,r,d,E,v,H,K,Xe,Ue,qe,Ne,Se,He,We,Fe,ze]}class nn extends Ie{constructor(t){super(),Ye(this,t,tn,Zt,Ce,{onDrawingUndo:0},null,[-1,-1])}}function sn(e){let t,n;return{c(){t=A("div"),n=A("div"),this.h()},l(i){t=R(i,"DIV",{class:!0});var r=O(t);n=R(r,"DIV",{class:!0}),O(n).forEach(X),r.forEach(X),this.h()},h(){Y(n,"class","quill-editor svelte-1zs6ve"),Y(t,"class","quill-editor-wrapper svelte-1zs6ve"),W(t,"disabled",e[0])},m(i,r){$(i,t,r),I(t,n),e[5](n)},p(i,[r]){r&1&&W(t,"disabled",i[0])},i:ge,o:ge,d(i){i&&X(t),e[5](null)}}}function ln(e,t,n){let i,r;se(e,oe,p=>n(6,i=p)),se(e,Ht,p=>n(4,r=p));let{tabID:c}=t,{disabled:d=!1}=t,o,s;const f=(p,x=300)=>{let M;return(...T)=>{clearTimeout(M),M=setTimeout(()=>{p.apply(void 0,T)},x)}};async function h(p){var E,v,b,H;if(!o)return;const{Delta:x,Range:M}=await tt(async()=>{const{Delta:N,Range:K}=await import("../chunks/core.CG__ofcG.js").then(Q=>Q.G);return{Delta:N,Range:K}},[],import.meta.url);if(p.undo.length>0)for(var T=0;T<p.undo.length;T++){const N=(E=p.undo[T].range)==null?void 0:E.index,K=(v=p.undo[T].range)==null?void 0:v.length,Q={delta:new x(p.undo[T].delta.ops),range:N!==void 0&&K!==void 0?new M(N,K):null};o.history.stack.undo.push(Q)}if(p.redo.length>0)for(var T=0;T<p.redo.length;T++){const K=(b=p.redo[T].range)==null?void 0:b.index,Q=(H=p.redo[T].range)==null?void 0:H.length,Z={delta:new x(p.redo[T].delta.ops),range:K!==void 0&&Q!==void 0?new M(K,Q):null};o.history.stack.redo.push(Z)}}function P(p){var x;o&&((x=o.getSelection())==null?void 0:x.length)===0&&window.open(p.target.href,"_blank")}function S(){if(!o||!i[c])return;const p=i[c].ops;o.setContents(p);const x=i[c].history;h(x)}function V(){if(!o||!i[c])return;fe(oe,i[c].ops=o.getContents().ops,i);const p=structuredClone(o.history.stack);fe(oe,i[c].history=p,i)}const B=f(V,500);function y(){if(!o)return;o.formatText(0,o.getLength(),"link",!1,"api");const p=o.getText(),x=/https?:\/\/\S+/gi,M=p.matchAll(x);for(const v of M)o.formatText(v.index,v[0].length,"link",v[0],"api");const T=/.+\@.+\..+/gi,E=p.matchAll(T);for(const v of E)o.formatText(v.index,v[0].length,"link","mailto:"+v[0],"api");document.querySelectorAll(".ql-editor a").forEach(v=>{v.addEventListener("click",P)})}const w=f(y,500);function m(p,x,M){if(M==="user"){const T=o.getText().split(`
`)[0].trim();fe(oe,i[c].title=T===""?"Untitled":T,i),w(),B()}}async function g(){const{default:p}=await tt(async()=>{const{default:x}=await import("../chunks/quill.Bk4jDS0q.js");return{default:x}},__vite__mapDeps([0,1]),import.meta.url);n(3,o=new p(s,{formats:["bold","italic","underline","strike","code","link"],placeholder:"Enter text here"})),S(),y(),o.on("text-change",m),o.keyboard.addBinding({key:"/",altKey:!0},()=>{o.format("code",!o.getFormat().code)}),o.keyboard.addBinding({key:"-",altKey:!0},()=>{o.format("strike",!o.getFormat().strike)})}$e(()=>{g()});function k(p){ne[p?"unshift":"push"](()=>{s=p,n(1,s)})}return e.$$set=p=>{"tabID"in p&&n(2,c=p.tabID),"disabled"in p&&n(0,d=p.disabled)},e.$$.update=()=>{e.$$.dirty&9&&(d?o==null||o.disable():o==null||o.enable()),e.$$.dirty&24&&(o==null||o.root.setAttribute("spellcheck",r.spellCheck.toString()))},[d,s,c,o,r,k]}class rn extends Ie{constructor(t){super(),Ye(this,t,ln,sn,Ce,{tabID:2,disabled:0})}}function ft(e,t,n){const i=e.slice();return i[7]=t[n],i}function gt(e,t,n){const i=e.slice();return i[7]=t[n],i}function an(e){let t,n;return t=new At({}),{c(){pe(t.$$.fragment)},l(i){ye(t.$$.fragment,i)},m(i,r){we(t,i,r),n=!0},p:ge,i(i){n||(q(t.$$.fragment,i),n=!0)},o(i){F(t.$$.fragment,i),n=!1},d(i){_e(t,i)}}}function on(e){let t,n,i,r,c,d=[],o=new Map,s,f,h=[],P=new Map,S;n=new nn({props:{onDrawingUndo:e[5]}});let V=ke(Object.keys(e[4]));const B=m=>m[7];for(let m=0;m<V.length;m+=1){let g=gt(e,V,m),k=B(g);o.set(k,d[m]=ht(k,g))}let y=ke(Object.keys(e[4]));const w=m=>m[7];for(let m=0;m<y.length;m+=1){let g=ft(e,y,m),k=w(g);P.set(k,h[m]=mt(k,g))}return{c(){t=A("div"),pe(n.$$.fragment),i=j(),r=A("div"),c=A("div");for(let m=0;m<d.length;m+=1)d[m].c();s=j(),f=A("div");for(let m=0;m<h.length;m+=1)h[m].c();this.h()},l(m){t=R(m,"DIV",{class:!0});var g=O(t);ye(n.$$.fragment,g),i=G(g),r=R(g,"DIV",{class:!0});var k=O(r);c=R(k,"DIV",{class:!0});var p=O(c);for(let M=0;M<d.length;M+=1)d[M].l(p);p.forEach(X),s=G(k),f=R(k,"DIV",{class:!0});var x=O(f);for(let M=0;M<h.length;M+=1)h[M].l(x);x.forEach(X),k.forEach(X),g.forEach(X),this.h()},h(){Y(c,"class","editor-container svelte-gwyvkn"),Y(f,"class","drawing-container svelte-gwyvkn"),W(f,"disabled",e[0].activeTool!=="pencil"),Y(r,"class","canvas-container svelte-gwyvkn"),Y(t,"class","page-container svelte-gwyvkn")},m(m,g){$(m,t,g),we(n,t,null),I(t,i),I(t,r),I(r,c);for(let k=0;k<d.length;k+=1)d[k]&&d[k].m(c,null);I(r,s),I(r,f);for(let k=0;k<h.length;k+=1)h[k]&&h[k].m(f,null);S=!0},p(m,g){const k={};g&2&&(k.onDrawingUndo=m[5]),n.$set(k),g&20&&(V=ke(Object.keys(m[4])),ve(),d=Ke(d,g,B,1,m,V,o,c,Qe,ht,null,gt),be()),g&23&&(y=ke(Object.keys(m[4])),ve(),h=Ke(h,g,w,1,m,y,P,f,Qe,mt,null,ft),be()),(!S||g&1)&&W(f,"disabled",m[0].activeTool!=="pencil")},i(m){if(!S){q(n.$$.fragment,m);for(let g=0;g<V.length;g+=1)q(d[g]);for(let g=0;g<y.length;g+=1)q(h[g]);S=!0}},o(m){F(n.$$.fragment,m);for(let g=0;g<d.length;g+=1)F(d[g]);for(let g=0;g<h.length;g+=1)F(h[g]);S=!1},d(m){m&&X(t),_e(n);for(let g=0;g<d.length;g+=1)d[g].d();for(let g=0;g<h.length;g+=1)h[g].d()}}}function ht(e,t){let n,i,r;return i=new rn({props:{disabled:t[7]!==t[2],tabID:t[7]}}),{key:e,first:null,c(){n=Le(),pe(i.$$.fragment),this.h()},l(c){n=Le(),ye(i.$$.fragment,c),this.h()},h(){this.first=n},m(c,d){$(c,n,d),we(i,c,d),r=!0},p(c,d){t=c;const o={};d&20&&(o.disabled=t[7]!==t[2]),d&16&&(o.tabID=t[7]),i.$set(o)},i(c){r||(q(i.$$.fragment,c),r=!0)},o(c){F(i.$$.fragment,c),r=!1},d(c){c&&X(n),_e(i,c)}}}function mt(e,t){let n,i,r,c={color:gn,stroke:dn,radius:un,smoothness:fn,tabID:t[7],hide:t[7]!==t[2],disabled:t[7]!==t[2]||t[0].activeTool!=="pencil"};return i=new Jt({props:c}),t[6](i),{key:e,first:null,c(){n=Le(),pe(i.$$.fragment),this.h()},l(d){n=Le(),ye(i.$$.fragment,d),this.h()},h(){this.first=n},m(d,o){$(d,n,o),we(i,d,o),r=!0},p(d,o){t=d;const s={};o&16&&(s.tabID=t[7]),o&20&&(s.hide=t[7]!==t[2]),o&21&&(s.disabled=t[7]!==t[2]||t[0].activeTool!=="pencil"),i.$set(s)},i(d){r||(q(i.$$.fragment,d),r=!0)},o(d){F(i.$$.fragment,d),r=!1},d(d){d&&X(n),t[6](null),_e(i,d)}}}function cn(e){let t,n,i,r;const c=[on,an],d=[];function o(s,f){return s[3].currentUser&&!s[3].isLoading?0:1}return t=o(e),n=d[t]=c[t](e),{c(){n.c(),i=Le()},l(s){n.l(s),i=Le()},m(s,f){d[t].m(s,f),$(s,i,f),r=!0},p(s,[f]){let h=t;t=o(s),t===h?d[t].p(s,f):(ve(),F(d[h],1,1,()=>{d[h]=null}),be(),n=d[t],n?n.p(s,f):(n=d[t]=c[t](s),n.c()),q(n,1),n.m(i.parentNode,i))},i(s){r||(q(n),r=!0)},o(s){F(n),r=!1},d(s){s&&X(i),d[t].d(s)}}}let dn=10,un=1,fn=3,gn="rgba(253, 221, 77, 0.2)";function hn(e,t,n){let i,r,c,d;se(e,me,h=>n(0,r=h)),se(e,bt,h=>n(3,c=h)),se(e,oe,h=>n(4,d=h));let o;const s=()=>o.undo();function f(h){ne[h?"unshift":"push"](()=>{o=h,n(1,o)})}return e.$$.update=()=>{e.$$.dirty&1&&n(2,i=r.order[r.activeIndex])},[r,o,i,c,d,s,f]}class Tn extends Ie{constructor(t){super(),Ye(this,t,hn,cn,Ce,{})}}export{Tn as component};
