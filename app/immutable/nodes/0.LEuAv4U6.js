import{s as T,d as E,u as I,g as k,e as x,c as A,o as C}from"../chunks/scheduler.CdDHOodP.js";import{S as F,i as L,e as _,s as M,B as U,c as h,d as m,f as j,a as v,w as p,h as b,g as y,n as O,l as R}from"../chunks/index.BdLLFpJ9.js";import{b as V,f as g,d as S,c as w,g as q,s as z}from"../chunks/firebaseStore.B73rKN3v.js";import{t as D}from"../chunks/tabsStore.DNrclrNc.js";import{g as B}from"../chunks/entry.BGoe4t2L.js";import{b as H}from"../chunks/paths.DPwBpV2U.js";const P=!0,$="always",Z=Object.freeze(Object.defineProperty({__proto__:null,prerender:P,trailingSlash:$},Symbol.toStringTag,{value:"Module"}));function G(r){let o,n,s,c,i;const l=r[3].default,t=E(l,r,r[2],null);return{c(){o=_("meta"),n=M(),s=_("div"),c=_("div"),t&&t.c(),this.h()},l(e){const a=U("svelte-1xk05yi",document.head);o=h(a,"META",{name:!0,content:!0}),a.forEach(m),n=j(e),s=h(e,"DIV",{class:!0});var d=v(s);c=h(d,"DIV",{class:!0});var u=v(c);t&&t.l(u),u.forEach(m),d.forEach(m),this.h()},h(){p(o,"name","viewport"),p(o,"content","width=device-width, user-scalable=0, initial-scale=1.0, maximum-scale=1.0, viewport-fit=cover"),p(c,"class","content svelte-hkf4i9"),p(s,"class","container svelte-hkf4i9")},m(e,a){b(document.head,o),y(e,n,a),y(e,s,a),b(s,c),t&&t.m(c,null),i=!0},p(e,[a]){t&&t.p&&(!i||a&4)&&I(t,l,e,e[2],i?x(l,e[2],a,null):k(e[2]),null)},i(e){i||(O(t,e),i=!0)},o(e){R(t,e),i=!1},d(e){e&&(m(n),m(s)),m(o),t&&t.d(e)}}}function J(r,o,n){let s;A(r,g,e=>n(1,s=e));let{$$slots:c={},$$scope:i}=o,l=!1;function t(e){e.length!==0&&e.forEach(a=>{try{D.newTabFromString(a)}catch(d){console.warn("Failed to parse tab!",a,d);return}})}return C(()=>{V.onAuthStateChanged(async e=>{if(!e){g.update(f=>({...f,isLoading:!1,currentUser:e})),n(0,l=!0);return}const a=S(w,"users",e.uid),d=await q(a);let u={tabs:[],activeIndex:0};if(d.exists())console.log("Fetching firestore user doc..."),u=d.data();else{console.log("Creating firestore user doc...");const f=S(w,"users",e.uid);await z(f,u,{merge:!0})}t(u.tabs),D.setActiveIndex(u.activeIndex),g.update(f=>({...f,isLoading:!1,currentUser:e,data:u})),n(0,l=!0)})}),r.$$set=e=>{"$$scope"in e&&n(2,i=e.$$scope)},r.$$.update=()=>{r.$$.dirty&3&&!s.currentUser&&l&&B(H+"/login")},[l,s,i,c]}class ee extends F{constructor(o){super(),L(this,o,J,G,T,{})}}export{ee as component,Z as universal};
