const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/quill.Bk4jDS0q.js","../chunks/core.CG__ofcG.js"])))=>i.map(i=>d[i]);
var Xt=Object.defineProperty;var Pt=(e,t,n)=>t in e?Xt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var N=(e,t,n)=>Pt(e,typeof t!="symbol"?t+"":t,n);import{s as Pe,n as ve,r as st,e as Ie,f as rt,c as se,a as he,o as lt,d as Q,z as Ht,A as ye,B as At}from"../chunks/scheduler.CNrmCPBX.js";import{S as He,i as Ae,e as A,b as Rt,c as R,d as U,f as qt,g as H,w as S,A as z,j as ne,k as I,x as ee,G as $e,l as Vt,s as W,v as ge,h as j,z as ot,a as F,o as we,t as G,n as _e,I as Se,C as ze,J as Bt,p as Ee,q as Te,r as Le,u as Ce,K as ke,m as Me}from"../chunks/index.Bx3bS2zy.js";import{e as xe,u as tt,o as nt}from"../chunks/each.BP2nLSrP.js";import{b as K}from"../chunks/paths.DIintr3B.js";import{m as pe,a as Tt,t as ce,f as Ot,d as ae,s as it}from"../chunks/firebaseStore.MdVwloKw.js";import{c as be,s as Ye,S as Ut}from"../chunks/Spinner.DU_sV4I5.js";import{_ as at}from"../chunks/preload-helper.D6kgxu3v.js";import{t as Nt}from"../chunks/themes.BTx5Q4mv.js";function Ft(e){let t,n,i,r,a,d;return{c(){t=A("div"),n=A("button"),i=A("span"),r=Rt(e[0]),this.h()},l(l){t=R(l,"DIV",{class:!0});var s=U(t);n=R(s,"BUTTON",{class:!0,draggable:!0});var v=U(n);i=R(v,"SPAN",{class:!0});var u=U(i);r=qt(u,e[0]),u.forEach(H),v.forEach(H),s.forEach(H),this.h()},h(){S(i,"class","title svelte-w1fi59"),S(n,"class","tab svelte-w1fi59"),S(n,"draggable","true"),z(n,"active",e[1]),S(t,"class","tab-container svelte-w1fi59"),z(t,"preventHover",e[2])},m(l,s){ne(l,t,s),I(t,n),I(n,i),I(i,r),a||(d=[ee(n,"mousedown",$e(function(){Ie(e[3])&&e[3].apply(this,arguments)})),ee(n,"touchstart",$e(function(){Ie(e[3])&&e[3].apply(this,arguments)})),ee(n,"dragstart",$e(function(){Ie(e[4])&&e[4].apply(this,arguments)}))],a=!0)},p(l,[s]){e=l,s&1&&Vt(r,e[0]),s&2&&z(n,"active",e[1]),s&4&&z(t,"preventHover",e[2])},i:ve,o:ve,d(l){l&&H(t),a=!1,st(d)}}}function zt(e,t,n){let{title:i=""}=t,{active:r=!1}=t,{preventHover:a=!1}=t,{onPointerdown:d=s=>{}}=t,{onDragstart:l=s=>{}}=t;return e.$$set=s=>{"title"in s&&n(0,i=s.title),"active"in s&&n(1,r=s.active),"preventHover"in s&&n(2,a=s.preventHover),"onPointerdown"in s&&n(3,d=s.onPointerdown),"onDragstart"in s&&n(4,l=s.onDragstart)},[i,r,a,d,l]}class Lt extends He{constructor(t){super(),Ae(this,t,zt,Ft,Pe,{title:0,active:1,preventHover:2,onPointerdown:3,onDragstart:4})}}const ct=(e,t)=>{const{duration:n=300,easing:i=be,onEnd:r=()=>{},onStep:a=()=>{},css:d}=t;let l;function s(v){if(!e){console.warn("Cannot find element to animate");return}l===void 0&&(l=v);const u=i((v-l)/n),k=1-u;u<1?(e.style.cssText=d(u,k),a(u,k),requestAnimationFrame(s)):(e.style.cssText="",r())}requestAnimationFrame(s)},et=e=>{const{duration:t=300,easing:n=be,onEnd:i=()=>{},onStep:r=()=>{}}=e;let a;function d(l){a===void 0&&(a=l);const s=n((l-a)/t),v=1-s;s<1?(r(s,v),requestAnimationFrame(d)):i()}requestAnimationFrame(d)};function ut(e){let t,n,i=`<span class="button-icon svelte-18u4svq" style="-webkit-mask: url(${K}/images/svg/undo.svg) no-repeat center / contain; mask: url(${K}/images/svg/undo.svg) no-repeat center / contain;"></span>`,r,a,d,l,s,v,u,k;return{c(){t=A("div"),n=A("button"),n.innerHTML=i,r=W(),a=A("input"),d=W(),l=A("input"),this.h()},l(_){t=R(_,"DIV",{class:!0});var E=U(t);n=R(E,"BUTTON",{class:!0,"data-svelte-h":!0}),ge(n)!=="svelte-1b4fip4"&&(n.innerHTML=i),r=j(E),a=R(E,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),d=j(E),l=R(E,"INPUT",{type:!0,class:!0}),E.forEach(H),this.h()},h(){S(n,"class","button svelte-18u4svq"),S(a,"type","range"),S(a,"min","2"),S(a,"max","20"),S(a,"step","2"),S(a,"class","slider svelte-18u4svq"),S(l,"type","color"),S(l,"class","color-picker svelte-18u4svq"),S(t,"class","pencil-tools svelte-18u4svq")},m(_,E){ne(_,t,E),I(t,n),I(t,r),I(t,a),ze(a,e[0]),I(t,d),I(t,l),ze(l,e[1]),v=!0,u||(k=[ee(n,"click",function(){Ie(e[4])&&e[4].apply(this,arguments)}),ee(a,"change",e[8]),ee(a,"input",e[8]),ee(l,"input",e[9])],u=!0)},p(_,E){e=_,E&1&&ze(a,e[0]),E&2&&ze(l,e[1])},i(_){v||(_&&rt(()=>{v&&(s||(s=Se(t,Ye,{duration:200,axis:"x"},!0)),s.run(1))}),v=!0)},o(_){_&&(s||(s=Se(t,Ye,{duration:200,axis:"x"},!1)),s.run(0)),v=!1},d(_){_&&H(t),_&&s&&s.end(),u=!1,st(k)}}}function Wt(e){let t,n,i=`<span class="button-icon svelte-18u4svq" style="-webkit-mask: url(${K}/images/svg/pencil.svg) no-repeat center / contain; mask: url(${K}/images/svg/pencil.svg) no-repeat center / contain;"></span>`,r,a,d,l,s,v=`<span class="button-icon svelte-18u4svq" style="-webkit-mask: url(${K}/images/svg/trash.svg) no-repeat center / contain; mask: url(${K}/images/svg/trash.svg) no-repeat center / contain;"></span>`,u,k,_,E,L,C,P=`<span class="button-icon svelte-18u4svq" style="-webkit-mask: url(${K}/images/svg/user.svg) no-repeat center / contain; mask: url(${K}/images/svg/user.svg) no-repeat center / contain;"></span>`,D,p,q=`<span class="button-icon svelte-18u4svq" style="-webkit-mask: url(${K}/images/svg/maximize.svg) no-repeat center / contain; mask: url(${K}/images/svg/maximize.svg) no-repeat center / contain;"></span>`,m,Y,b,c,g=e[5].activeTool==="pencil"&&ut(e);return{c(){t=A("div"),n=A("button"),n.innerHTML=i,r=W(),g&&g.c(),a=W(),d=A("div"),l=W(),s=A("button"),s.innerHTML=v,u=W(),k=A("button"),_=A("span"),L=W(),C=A("a"),C.innerHTML=P,D=W(),p=A("button"),p.innerHTML=q,this.h()},l(w){t=R(w,"DIV",{class:!0});var y=U(t);n=R(y,"BUTTON",{class:!0,"data-svelte-h":!0}),ge(n)!=="svelte-t1zbc2"&&(n.innerHTML=i),r=j(y),g&&g.l(y),a=j(y),d=R(y,"DIV",{class:!0}),U(d).forEach(H),l=j(y),s=R(y,"BUTTON",{class:!0,"data-svelte-h":!0}),ge(s)!=="svelte-cbr57k"&&(s.innerHTML=v),u=j(y),k=R(y,"BUTTON",{class:!0});var X=U(k);_=R(X,"SPAN",{class:!0,style:!0}),U(_).forEach(H),X.forEach(H),L=j(y),C=R(y,"A",{class:!0,href:!0,"data-svelte-h":!0}),ge(C)!=="svelte-1xuhzhs"&&(C.innerHTML=P),D=j(y),p=R(y,"BUTTON",{class:!0,"data-svelte-h":!0}),ge(p)!=="svelte-siuh87"&&(p.innerHTML=q),y.forEach(H),this.h()},h(){S(n,"class","pencil button svelte-18u4svq"),z(n,"selected",e[5].activeTool==="pencil"),S(d,"class","spacer svelte-18u4svq"),S(s,"class","close button svelte-18u4svq"),S(_,"class","button-icon svelte-18u4svq"),ot(_,"-webkit-mask","url("+K+"/images/svg/refresh.svg) no-repeat center / contain"),ot(_,"mask","url("+K+"/images/svg/refresh.svg) no-repeat center / contain"),S(k,"class","refresh button svelte-18u4svq"),k.disabled=E=e[6].savingStatus==="saving",S(C,"class","button svelte-18u4svq"),S(C,"href",K+"/profile"),S(p,"class","button svelte-18u4svq"),S(t,"class","toolbar-container svelte-18u4svq")},m(w,y){ne(w,t,y),I(t,n),I(t,r),g&&g.m(t,null),I(t,a),I(t,d),I(t,l),I(t,s),I(t,u),I(t,k),I(k,_),I(t,L),I(t,C),I(t,D),I(t,p),Y=!0,b||(c=[ee(n,"click",e[7]),ee(s,"click",function(){Ie(e[3])&&e[3].apply(this,arguments)}),ee(k,"click",function(){Ie(e[2])&&e[2].apply(this,arguments)}),ee(p,"click",e[10])],b=!0)},p(w,[y]){e=w,(!Y||y&32)&&z(n,"selected",e[5].activeTool==="pencil"),e[5].activeTool==="pencil"?g?(g.p(e,y),y&32&&F(g,1)):(g=ut(e),g.c(),F(g,1),g.m(t,a)):g&&(we(),G(g,1,1,()=>{g=null}),_e()),(!Y||y&64&&E!==(E=e[6].savingStatus==="saving"))&&(k.disabled=E)},i(w){Y||(F(g),w&&rt(()=>{Y&&(m||(m=Se(t,Ye,{duration:200},!0)),m.run(1))}),Y=!0)},o(w){G(g),w&&(m||(m=Se(t,Ye,{duration:200},!1)),m.run(0)),Y=!1},d(w){w&&H(t),g&&g.d(),w&&m&&m.end(),b=!1,st(c)}}}function jt(e,t,n){let i,r;se(e,pe,L=>n(5,i=L)),se(e,Tt,L=>n(6,r=L));let{onRefresh:a=()=>{}}=t,{onClose:d=()=>{}}=t,{drawingStroke:l}=t,{drawingColor:s}=t,{onDrawingUndo:v=()=>{}}=t;const u=()=>{he(pe,i.activeTool=i.activeTool==="pencil"?void 0:"pencil",i)};function k(){l=Bt(this.value),n(0,l)}function _(){s=this.value,n(1,s)}const E=()=>{he(pe,i.toolbarVisible=!1,i),he(pe,i.activeTool=void 0,i)};return e.$$set=L=>{"onRefresh"in L&&n(2,a=L.onRefresh),"onClose"in L&&n(3,d=L.onClose),"drawingStroke"in L&&n(0,l=L.drawingStroke),"drawingColor"in L&&n(1,s=L.drawingColor),"onDrawingUndo"in L&&n(4,v=L.onDrawingUndo)},[l,s,a,d,v,i,r,u,k,_,E]}class Gt extends He{constructor(t){super(),Ae(this,t,jt,Wt,Pe,{onRefresh:2,onClose:3,drawingStroke:0,drawingColor:1,onDrawingUndo:4})}}function dt(e,t,n){const i=e.slice();return i[46]=t[n],i[47]=t,i[48]=n,i}function ft(e,t){let n,i,r,a,d=t[48],l,s,v;function u(...C){return t[20](t[48],...C)}function k(C){t[21](C,t[46])}let _={active:t[12]==t[46],preventHover:t[11],onPointerdown:u,onDragstart:t[18]};t[14][t[46]].title!==void 0&&(_.title=t[14][t[46]].title),i=new Lt({props:_}),Q.push(()=>ke(i,"title",k));const E=()=>t[22](n,d),L=()=>t[22](null,d);return{key:e,first:null,c(){n=A("div"),Ee(i.$$.fragment),a=W(),this.h()},l(C){n=R(C,"DIV",{class:!0});var P=U(n);Te(i.$$.fragment,P),a=j(P),P.forEach(H),this.h()},h(){S(n,"class","tab-container svelte-6u8cf7"),z(n,"placeholder",t[13]==t[46]),this.first=n},m(C,P){ne(C,n,P),Le(i,n,null),I(n,a),E(),l=!0,s||(v=Ht(t[17].call(null,n)),s=!0)},p(C,P){t=C;const D={};P[0]&4112&&(D.active=t[12]==t[46]),P[0]&2048&&(D.preventHover=t[11]),P[0]&16&&(D.onPointerdown=u),!r&&P[0]&16400&&(r=!0,D.title=t[14][t[46]].title,ye(()=>r=!1)),i.$set(D),d!==t[48]&&(L(),d=t[48],E()),(!l||P[0]&8208)&&z(n,"placeholder",t[13]==t[46])},i(C){l||(F(i.$$.fragment,C),l=!0)},o(C){G(i.$$.fragment,C),l=!1},d(C){C&&H(n),Ce(i),L(),s=!1,v()}}}function gt(e){let t,n=`<span class="button-icon svelte-6u8cf7" style="-webkit-mask: url(${K}/images/svg/gear.svg) no-repeat center / contain; mask: url(${K}/images/svg/gear.svg) no-repeat center / contain;"></span>`,i,r,a,d;return{c(){t=A("button"),t.innerHTML=n,this.h()},l(l){t=R(l,"BUTTON",{class:!0,"data-svelte-h":!0}),ge(t)!=="svelte-1wioe5y"&&(t.innerHTML=n),this.h()},h(){S(t,"class","button svelte-6u8cf7")},m(l,s){ne(l,t,s),r=!0,a||(d=ee(t,"click",e[24]),a=!0)},p:ve,i(l){r||(l&&rt(()=>{r&&(i||(i=Se(t,Ye,{duration:200,axis:"x"},!0)),i.run(1))}),r=!0)},o(l){l&&(i||(i=Se(t,Ye,{duration:200,axis:"x"},!1)),i.run(0)),r=!1},d(l){l&&H(t),l&&i&&i.end(),a=!1,d()}}}function ht(e){let t,n,i,r;function a(s){e[27](s)}function d(s){e[28](s)}let l={onDrawingUndo:e[2],onRefresh:Ot.loadFromFirestore,onClose:e[26]};return e[1]!==void 0&&(l.drawingColor=e[1]),e[0]!==void 0&&(l.drawingStroke=e[0]),t=new Gt({props:l}),Q.push(()=>ke(t,"drawingColor",a)),Q.push(()=>ke(t,"drawingStroke",d)),{c(){Ee(t.$$.fragment)},l(s){Te(t.$$.fragment,s)},m(s,v){Le(t,s,v),r=!0},p(s,v){const u={};v[0]&4&&(u.onDrawingUndo=s[2]),v[0]&4096&&(u.onClose=s[26]),!n&&v[0]&2&&(n=!0,u.drawingColor=s[1],ye(()=>n=!1)),!i&&v[0]&1&&(i=!0,u.drawingStroke=s[0],ye(()=>i=!1)),t.$set(u)},i(s){r||(F(t.$$.fragment,s),r=!0)},o(s){G(t.$$.fragment,s),r=!1},d(s){Ce(t,s)}}}function Kt(e){let t,n,i,r=[],a=new Map,d,l,s,v=`<span class="button-icon svelte-6u8cf7" style="-webkit-mask: url(${K}/images/svg/plus.svg) no-repeat center / contain; mask: url(${K}/images/svg/plus.svg) no-repeat center / contain;"></span>`,u,k,_,E,L,C,P,D,p,q,m,Y=xe(e[4].order);const b=w=>w[46];for(let w=0;w<Y.length;w+=1){let y=dt(e,Y,w),X=b(y);a.set(X,r[w]=ft(X,y))}let c=!e[4].toolbarVisible&&gt(e);L=new Lt({props:{title:e[7],active:!e[9],preventHover:!0}});let g=e[4].toolbarVisible&&ht(e);return{c(){t=A("div"),n=A("div"),i=A("div");for(let w=0;w<r.length;w+=1)r[w].c();d=W(),l=A("div"),s=A("button"),s.innerHTML=v,u=W(),k=A("div"),c&&c.c(),_=W(),E=A("div"),Ee(L.$$.fragment),C=W(),P=A("div"),D=W(),g&&g.c(),this.h()},l(w){t=R(w,"DIV",{class:!0});var y=U(t);n=R(y,"DIV",{class:!0});var X=U(n);i=R(X,"DIV",{class:!0});var te=U(i);for(let ue=0;ue<r.length;ue+=1)r[ue].l(te);te.forEach(H),d=j(X),l=R(X,"DIV",{class:!0});var Z=U(l);s=R(Z,"BUTTON",{class:!0,"data-svelte-h":!0}),ge(s)!=="svelte-g0ls06"&&(s.innerHTML=v),Z.forEach(H),u=j(X),k=R(X,"DIV",{class:!0});var $=U(k);c&&c.l($),$.forEach(H),_=j(X),E=R(X,"DIV",{class:!0});var le=U(E);Te(L.$$.fragment,le),le.forEach(H),X.forEach(H),C=j(y),P=R(y,"DIV",{class:!0}),U(P).forEach(H),D=j(y),g&&g.l(y),y.forEach(H),this.h()},h(){S(i,"class","tabs svelte-6u8cf7"),S(s,"class","button svelte-6u8cf7"),S(l,"class","new-tab-container svelte-6u8cf7"),S(k,"class","buttons-container svelte-6u8cf7"),S(E,"class","clone svelte-6u8cf7"),z(E,"dragging",e[3]),S(n,"class","tabbar svelte-6u8cf7"),S(P,"class","divider svelte-6u8cf7"),S(t,"class","svelte-6u8cf7")},m(w,y){ne(w,t,y),I(t,n),I(n,i);for(let X=0;X<r.length;X+=1)r[X]&&r[X].m(i,null);e[23](i),I(n,d),I(n,l),I(l,s),I(n,u),I(n,k),c&&c.m(k,null),I(n,_),I(n,E),Le(L,E,null),e[25](E),I(t,C),I(t,P),I(t,D),g&&g.m(t,null),e[29](t),p=!0,q||(m=ee(s,"click",e[15]),q=!0)},p(w,y){y[0]&817232&&(Y=xe(w[4].order),we(),r=tt(r,y,b,1,w,Y,a,i,nt,ft,null,dt),_e()),w[4].toolbarVisible?c&&(we(),G(c,1,1,()=>{c=null}),_e()):c?(c.p(w,y),y[0]&16&&F(c,1)):(c=gt(w),c.c(),F(c,1),c.m(k,null));const X={};y[0]&128&&(X.title=w[7]),y[0]&512&&(X.active=!w[9]),L.$set(X),(!p||y[0]&8)&&z(E,"dragging",w[3]),w[4].toolbarVisible?g?(g.p(w,y),y[0]&16&&F(g,1)):(g=ht(w),g.c(),F(g,1),g.m(t,null)):g&&(we(),G(g,1,1,()=>{g=null}),_e())},i(w){if(!p){for(let y=0;y<Y.length;y+=1)F(r[y]);F(c),F(L.$$.fragment,w),F(g),p=!0}},o(w){for(let y=0;y<r.length;y+=1)G(r[y]);G(c),G(L.$$.fragment,w),G(g),p=!1},d(w){w&&H(t);for(let y=0;y<r.length;y+=1)r[y].d();e[23](null),c&&c.d(),Ce(L),e[25](null),g&&g.d(),e[29](null),q=!1,m()}}}const Qt=12,We=200,Oe=32,Ue=200,Jt=1600,vt=.3;function Zt(e,t,n){let i,r,a,d;se(e,pe,h=>n(4,a=h)),se(e,ce,h=>n(14,d=h));let{onDrawingUndo:l=()=>{}}=t,{drawingStroke:s}=t,{drawingColor:v}=t,u,k=[],_=0,E=null,L=-1,C="",P,D,p,q=!1,m=!1,Y=0,b=0,c,g=!1;const w=(h,x=300)=>{let B;return(...O)=>{clearTimeout(B),B=setTimeout(()=>{h.apply(void 0,O)},x)}};function y(){ae.newTab()}const X=h=>{const x=a.order.findIndex(B=>B===h);if(x<0||!k[x]){console.warn("Cannot close tab!");return}_=k[x].getBoundingClientRect().width,x<a.order.length-1&&(u.style.setProperty("--tab-max-width",`${_}px`),te()),x==a.activeIndex&&(x==a.order.length-1?ae.setActiveIndex(x-1):ae.setActiveIndex(x+1)),et({duration:Ue,easing:be,onStep:(B,O)=>{x==0?n(5,u.style.gridTemplateColumns=`minmax(${O*Oe}px, ${O*_}px)`,u):n(5,u.style.gridTemplateColumns=`repeat(${x}, minmax(var(--tab-min-width), var(--tab-max-width))) minmax(${O*Oe}px, ${O*_}px)`,u)},onEnd:()=>{n(5,u.style.gridTemplateColumns="",u),ae.removeTab(h)}})},te=w(()=>{u&&(u.style.setProperty("--tab-max-width",`${We}px`),et({duration:Ue,easing:be,onStep:(h,x)=>{u.style.setProperty("--tab-max-width",`${_+h*(We-_)}px`)},onEnd:()=>{u.style.setProperty("--tab-max-width",`${We}px`)}}))},Jt);function Z(h){if(!u)return;const x=h.getBoundingClientRect().width;et({duration:Ue,easing:be,onStep:(B,O)=>{a.order.length==1?n(5,u.style.gridTemplateColumns=`minmax(${B*Oe}px, ${B*x}px)`,u):n(5,u.style.gridTemplateColumns=`repeat(${a.order.length-1}, minmax(var(--tab-min-width), var(--tab-max-width))) minmax(${B*Oe}px, ${B*x}px)`,u),n(5,u.scrollLeft=u.scrollWidth,u)},onEnd:()=>{n(5,u.style.gridTemplateColumns="",u)}})}const $=(h,x)=>{const B=k[0].getBoundingClientRect().width;ae.moveTab(h,x,()=>{if(h>x)for(let O=x;O<h;O++)ct(k[O],{duration:Ue,easing:be,css:(Ve,oe)=>`transform: translateX(-${oe*B}px);`});if(h<x)for(let O=x;O>h;O--)ct(k[O],{duration:Ue,easing:be,css:(Ve,oe)=>`transform: translateX(${oe*B}px);`})})};function le(h){!h.target||!h.dataTransfer||(h.dataTransfer.setData("text/plain",i),h.dataTransfer.setDragImage(new Image,0,0))}function ue(h,x){if(h==0&&x==0){n(8,p.style.left="-1000px",p),n(8,p.style.top="-1000px",p);return}let B=c.getBoundingClientRect();if(h<B.left||h>B.right||x<B.top||x>B.bottom){m||(b=0),n(8,p.style.left=`${h+Y}px`,p),n(8,p.style.top=`${x-D.height/2}px`,p),n(9,m=!0);return}m&&n(9,m=!1),n(8,p.style.left=`${h+Y}px`,p),n(8,p.style.top=`${D.top}px`,p);const O=-u.scrollLeft,Ve=k[0].getBoundingClientRect().width;let oe=-1;if(h>O+a.order.length*Ve)oe=a.order.length-1;else for(let Be=0;Be<a.order.length;Be++)if(h>O+Be*Ve&&h<O+(Be+1)*Ve){oe=Be;break}h<20?(b=-vt,requestAnimationFrame(De)):h>u.clientWidth-10?(b=vt,requestAnimationFrame(De)):b=0,!(oe==-1||oe==a.placeholderIndex)&&$(a.placeholderIndex,oe)}let me=0;function De(h){if(!q||b==0){me=0;return}me==0&&(me=h);const x=h-me;me=h,u.scrollBy({left:b*x}),requestAnimationFrame(De)}function Re(h,x){if(!h.target)return;let B,O;h instanceof TouchEvent?(B=h.touches[0].clientX,O=h.touches[0].clientY):(B=h.clientX,O=h.clientY),window.addEventListener("touchmove",re,{passive:!1}),window.addEventListener("touchend",ie),window.addEventListener("mousemove",re),window.addEventListener("mouseup",ie),window.addEventListener("drag",re),window.addEventListener("dragend",ie),window.addEventListener("blur",ie),ae.setActiveIndex(x),P=h.target,D=P.getBoundingClientRect(),E=[B,O],Y=D.left-B,D.top-O,n(8,p.style.width=`${D.width}px`,p),n(8,p.style.left=`${D.left}px`,p),n(8,p.style.top=`${D.top}px`,p),L=x,n(7,C=d[a.order[x]].title)}function re(h){let x,B;if(h instanceof TouchEvent?(x=h.touches[0].clientX,B=h.touches[0].clientY,h.preventDefault()):(x=h.clientX,B=h.clientY),q){ue(x,B);return}E===null||Math.hypot(E[0]-x,E[1]-B)<Qt||(n(3,q=!0),ae.setPlaceholderIndex(L),ae.setActiveIndex(L))}function ie(){window.removeEventListener("touchmove",re),window.removeEventListener("touchend",ie),window.removeEventListener("mousemove",re),window.removeEventListener("mouseup",ie),window.removeEventListener("drag",re),window.removeEventListener("dragend",ie),window.removeEventListener("blur",ie),E=null,n(9,m=!1),L=-1,Y=0,ae.setPlaceholderIndex(),n(3,q=!1)}lt(()=>{u.style.setProperty("--tab-max-width",`${We}px`),u.style.setProperty("--tab-min-width",`${Oe}px`)});const Qe=(h,x)=>Re(x,h);function Je(h,x){e.$$.not_equal(d[x].title,h)&&(d[x].title=h,ce.set(d))}function Ze(h,x){Q[h?"unshift":"push"](()=>{k[x]=h,n(6,k)})}function T(h){Q[h?"unshift":"push"](()=>{u=h,n(5,u)})}const J=()=>{he(pe,a.toolbarVisible=!0,a)};function V(h){Q[h?"unshift":"push"](()=>{p=h,n(8,p)})}const de=()=>X(i);function qe(h){v=h,n(1,v)}function Fe(h){s=h,n(0,s)}function Yt(h){Q[h?"unshift":"push"](()=>{c=h,n(10,c)})}return e.$$set=h=>{"onDrawingUndo"in h&&n(2,l=h.onDrawingUndo),"drawingStroke"in h&&n(0,s=h.drawingStroke),"drawingColor"in h&&n(1,v=h.drawingColor)},e.$$.update=()=>{e.$$.dirty[0]&16&&n(12,i=a.order[a.activeIndex]),e.$$.dirty[0]&16&&n(13,r=a.order[a.placeholderIndex]),e.$$.dirty[0]&8&&(q?n(11,g=!0):setTimeout(()=>n(11,g=!1),20))},[s,v,l,q,a,u,k,C,p,m,c,g,i,r,d,y,X,Z,le,Re,Qe,Je,Ze,T,J,V,de,qe,Fe,Yt]}class $t extends He{constructor(t){super(),Ae(this,t,Zt,Kt,Pe,{onDrawingUndo:2,drawingStroke:0,drawingColor:1},null,[-1,-1])}}function en(e){let t,n;return{c(){t=A("div"),n=A("div"),this.h()},l(i){t=R(i,"DIV",{class:!0});var r=U(t);n=R(r,"DIV",{class:!0}),U(n).forEach(H),r.forEach(H),this.h()},h(){S(n,"class","quill-editor svelte-1zs6ve"),S(t,"class","quill-editor-wrapper svelte-1zs6ve"),z(t,"disabled",e[0])},m(i,r){ne(i,t,r),I(t,n),e[5](n)},p(i,[r]){r&1&&z(t,"disabled",i[0])},i:ve,o:ve,d(i){i&&H(t),e[5](null)}}}function tn(e,t,n){let i,r;se(e,ce,m=>n(6,i=m)),se(e,it,m=>n(4,r=m));let{tabID:a}=t,{disabled:d=!1}=t,l,s;const v=(m,Y=300)=>{let b;return(...c)=>{clearTimeout(b),b=setTimeout(()=>{m.apply(void 0,c)},Y)}};async function u(m){var g,w,y,X;if(!l)return;const{Delta:Y,Range:b}=await at(async()=>{const{Delta:te,Range:Z}=await import("../chunks/core.CG__ofcG.js").then($=>$.G);return{Delta:te,Range:Z}},[],import.meta.url);if(m.undo.length>0)for(var c=0;c<m.undo.length;c++){const te=(g=m.undo[c].range)==null?void 0:g.index,Z=(w=m.undo[c].range)==null?void 0:w.length,$={delta:new Y(m.undo[c].delta.ops),range:te!==void 0&&Z!==void 0?new b(te,Z):null};l.history.stack.undo.push($)}if(m.redo.length>0)for(var c=0;c<m.redo.length;c++){const Z=(y=m.redo[c].range)==null?void 0:y.index,$=(X=m.redo[c].range)==null?void 0:X.length,le={delta:new Y(m.redo[c].delta.ops),range:Z!==void 0&&$!==void 0?new b(Z,$):null};l.history.stack.redo.push(le)}}function k(m){var Y;l&&((Y=l.getSelection())==null?void 0:Y.length)===0&&window.open(m.target.href,"_blank")}function _(){if(!l||!i[a])return;const m=i[a].ops;l.setContents(m);const Y=i[a].history;u(Y)}function E(){if(!l||!i[a])return;he(ce,i[a].ops=l.getContents().ops,i);const m=structuredClone(l.history.stack);he(ce,i[a].history=m,i)}const L=v(E,500);function C(){if(!l)return;l.formatText(0,l.getLength(),"link",!1,"api");const m=l.getText(),Y=/https?:\/\/\S+/gi,b=m.matchAll(Y);for(const w of b)l.formatText(w.index,w[0].length,"link",w[0],"api");const c=/.+\@.+\..+/gi,g=m.matchAll(c);for(const w of g)l.formatText(w.index,w[0].length,"link","mailto:"+w[0],"api");document.querySelectorAll(".ql-editor a").forEach(w=>{w.addEventListener("click",k)})}const P=v(C,500);function D(m,Y,b){if(b==="user"){const c=l.getText().split(`
`)[0].trim();he(ce,i[a].title=c===""?"Untitled":c,i),P(),L()}}async function p(){const{default:m}=await at(async()=>{const{default:Y}=await import("../chunks/quill.Bk4jDS0q.js");return{default:Y}},__vite__mapDeps([0,1]),import.meta.url);n(3,l=new m(s,{formats:["bold","italic","underline","strike","code","link"],placeholder:"Enter text here"})),_(),C(),l.on("text-change",D),l.keyboard.addBinding({key:"/",altKey:!0},()=>{l.format("code",!l.getFormat().code)}),l.keyboard.addBinding({key:"-",altKey:!0},()=>{l.format("strike",!l.getFormat().strike)})}lt(()=>{p()});function q(m){Q[m?"unshift":"push"](()=>{s=m,n(1,s)})}return e.$$set=m=>{"tabID"in m&&n(2,a=m.tabID),"disabled"in m&&n(0,d=m.disabled)},e.$$.update=()=>{e.$$.dirty&9&&(d?l==null||l.disable():l==null||l.enable()),e.$$.dirty&24&&(l==null||l.root.setAttribute("spellcheck",r.spellCheck.toString()))},[d,s,a,l,r,q]}class nn extends He{constructor(t){super(),Ae(this,t,tn,en,Pe,{tabID:2,disabled:0})}}const mt=500,sn=300,bt=500,rn=300;class ln{constructor(){N(this,"isMoving",!1);N(this,"isLongclick",!1);N(this,"button",0);N(this,"lastX",0);N(this,"lastY",0);N(this,"consecutiveClicks",0);N(this,"lastMouseupTime",0);N(this,"activeElement",null);this.reset()}reset(){this.isMoving=!1,this.isLongclick=!1,this.button=0,this.lastX=0,this.lastY=0,this.consecutiveClicks=0,this.lastMouseupTime=0,this.activeElement=null}}class on{constructor(){N(this,"isDragging",!1);N(this,"isPinching",!1);N(this,"isLongpressed",!1);N(this,"consecutiveTaps",0);N(this,"lastTouchendTime",0);N(this,"lastCenterX",0);N(this,"lastCenterY",0);N(this,"identifier",0);N(this,"x",0);N(this,"y",0);N(this,"hypotenuse",0);N(this,"activeElement",null);this.reset()}reset(){this.isDragging=!1,this.isPinching=!1,this.isLongpressed=!1,this.consecutiveTaps=0,this.lastTouchendTime=0,this.lastCenterX=0,this.lastCenterY=0,this.identifier=0,this.x=0,this.y=0,this.hypotenuse=0,this.activeElement=null}}let fe=[],f=new ln,o=new on;const M=(e,t)=>{e!=null&&e.dispatchEvent(new CustomEvent("gesture",{detail:t,bubbles:!1,cancelable:!1}))},Ct=e=>{f.reset(),o.reset(),f.lastMouseupTime=Date.now(),window.removeEventListener("mousemove",je),window.removeEventListener("mouseup",Ge),window.removeEventListener("touchmove",Ke),window.removeEventListener("touchend",Xe)},Dt=e=>{if(window.removeEventListener("mousemove",je),window.removeEventListener("mouseup",Ge),window.removeEventListener("touchmove",Ke),window.removeEventListener("touchend",Xe),f.isMoving)if(f.isMoving=!1,f.isLongclick)f.isLongclick=!1,M(f.activeElement,{event:e,name:"longclick-drag-end",x:f.lastX,y:f.lastY,dx:0,dy:0});else switch(f.button){case 0:M(f.activeElement,{event:e,name:"left-click-drag-end",x:f.lastX,y:f.lastY,dx:0,dy:0});break;case 1:M(f.activeElement,{event:e,name:"middle-click-drag-end",x:f.lastX,y:f.lastY,dx:0,dy:0});break;case 2:M(f.activeElement,{event:e,name:"right-click-drag-end",x:f.lastX,y:f.lastY,dx:0,dy:0});break}f.isLongclick&&M(f.activeElement,{event:e,name:"longclick-release",x:f.lastX,y:f.lastY,dx:0,dy:0}),f.reset(),o.isDragging&&(o.isDragging=!1,o.isLongpressed?(o.isLongpressed=!1,M(o.activeElement,{event:e,name:"longpress-drag-end",x:o.lastCenterX,y:o.lastCenterY,dx:0,dy:0})):M(o.activeElement,{event:e,name:"touch-drag-end",x:o.lastCenterX,y:o.lastCenterY,dx:0,dy:0})),o.isLongpressed&&M(o.activeElement,{event:e,name:"longpress-release",x:o.lastCenterX,y:o.lastCenterY,dx:0,dy:0}),o.reset()},xt=e=>{M(e.target,{event:e,name:"wheel",x:e.clientX,y:e.clientY,dx:0,dy:0})},It=e=>{},St=e=>{document.activeElement!==e.target&&(window.addEventListener("mousemove",je),window.addEventListener("mouseup",Ge),f.activeElement=e.target,f.lastX=e.clientX,f.lastY=e.clientY,f.isMoving||(f.button=e.button),f.button===0&&window.setTimeout(()=>{Date.now()-f.lastMouseupTime>=bt&&!f.isMoving&&(f.isLongclick=!0,M(f.activeElement,{event:e,name:"longclick",x:e.clientX,y:e.clientY,dx:0,dy:0}))},bt))},je=e=>{if(e.movementX===0&&e.movementY===0)return;let t=e.clientX-f.lastX,n=e.clientY-f.lastY;if(!f.isMoving)if(f.isLongclick)M(f.activeElement,{event:e,name:"longclick-drag-start",x:e.clientX,y:e.clientY,dx:0,dy:0});else switch(f.button){case 0:M(f.activeElement,{event:e,name:"left-click-drag-start",x:e.clientX,y:e.clientY,dx:0,dy:0});break;case 1:M(f.activeElement,{event:e,name:"middle-click-drag-start",x:e.clientX,y:e.clientY,dx:0,dy:0});break;case 2:M(f.activeElement,{event:e,name:"right-click-drag-start",x:e.clientX,y:e.clientY,dx:0,dy:0});break}if(f.isMoving=!0,f.lastX=e.clientX,f.lastY=e.clientY,f.isLongclick)M(f.activeElement,{event:e,name:"longclick-dragging",x:e.clientX,y:e.clientY,dx:t,dy:n});else switch(f.button){case 0:M(f.activeElement,{event:e,name:"left-click-dragging",x:e.clientX,y:e.clientY,dx:t,dy:n});break;case 1:M(f.activeElement,{event:e,name:"middle-click-dragging",x:e.clientX,y:e.clientY,dx:t,dy:n});break;case 2:M(f.activeElement,{event:e,name:"right-click-dragging",x:e.clientX,y:e.clientY,dx:t,dy:n});break}},Ge=e=>{if(window.removeEventListener("mousemove",je),window.removeEventListener("mouseup",Ge),f.lastMouseupTime=Date.now(),f.isMoving)if(f.isMoving=!1,f.isLongclick)f.isLongclick=!1,M(f.activeElement,{event:e,name:"longclick-drag-end",x:f.lastX,y:f.lastY,dx:0,dy:0});else switch(f.button){case 0:M(f.activeElement,{event:e,name:"left-click-drag-end",x:f.lastX,y:f.lastY,dx:0,dy:0});break;case 1:M(f.activeElement,{event:e,name:"middle-click-drag-end",x:f.lastX,y:f.lastY,dx:0,dy:0});break;case 2:M(f.activeElement,{event:e,name:"right-click-drag-end",x:f.lastX,y:f.lastY,dx:0,dy:0});break}else f.isLongclick||(e.button===2?M(f.activeElement,{event:e,name:"right-click",x:e.clientX,y:e.clientY,dx:0,dy:0}):e.button===1?M(f.activeElement,{event:e,name:"middle-click",x:e.clientX,y:e.clientY,dx:0,dy:0}):(f.consecutiveClicks===0&&M(f.activeElement,{event:e,name:"left-click",x:e.clientX,y:e.clientY,dx:0,dy:0}),f.consecutiveClicks++,window.setTimeout(()=>{f.consecutiveClicks>1&&M(f.activeElement,{event:e,name:"double-click",x:e.clientX,y:e.clientY,dx:0,dy:0}),f.consecutiveClicks=0},rn)));f.isLongclick&&M(f.activeElement,{event:e,name:"longclick-release",x:e.clientX,y:e.clientY,dx:0,dy:0}),f.isLongclick=!1},Mt=e=>{if(e.touches.length>1,document.activeElement!==e.target){if(e.touches.length>1){if(e.touches[0].identifier===o.identifier)return;o.isPinching=!0}window.addEventListener("touchmove",Ke,{passive:!1}),window.addEventListener("touchend",Xe),window.addEventListener("touchcancel",Xe),o.identifier=e.touches[0].identifier,o.x=e.touches[0].clientX,o.y=e.touches[0].clientY,o.activeElement=e.target,window.setTimeout(()=>{o.isPinching||o.isDragging||Date.now()-o.lastTouchendTime>=mt&&(o.isDragging=!1,o.isPinching=!1,o.hypotenuse=null,o.isLongpressed=!0,M(o.activeElement,{event:e,name:"longpress",x:o.x,y:o.y,dx:0,dy:0}))},mt)}},Ke=e=>{if(o.isDragging){let t=o.x,n=o.y;o.x=e.touches[0].clientX,o.y=e.touches[0].clientY;let i=o.x-t,r=o.y-n;o.isLongpressed?M(o.activeElement,{event:e,name:"longpress-dragging",x:o.x,y:o.y,dx:i,dy:r,force:e.touches[0].force}):M(o.activeElement,{event:e,name:"touch-dragging",x:o.x,y:o.y,dx:i,dy:r,force:e.touches[0].force});return}else if(!o.isLongpressed&&(o.isPinching||e.touches.length>1)){o.x=e.touches[0].clientX,o.y=e.touches[0].clientY;let t={x:e.touches[1].clientX,y:e.touches[1].clientY},n={x:(o.x+t.x)/2,y:(o.y+t.y)/2},i=Math.hypot(o.x-t.x,o.y-t.y);o.hypotenuse===null&&(o.hypotenuse=i,o.lastCenterX=n.x,o.lastCenterY=n.y,M(o.activeElement,{event:e,name:"pinch-start",x:n.x,y:n.y,dx:0,dy:0})),o.isPinching=!0;let r=i/o.hypotenuse,a=n.x-o.lastCenterX,d=n.y-o.lastCenterY;M(o.activeElement,{event:e,name:"pinching",x:n.x,y:n.y,zoom:r,dx:a,dy:d}),o.hypotenuse=i,o.lastCenterX=n.x,o.lastCenterY=n.y;return}else o.isDragging=!0,o.isLongpressed?(M(o.activeElement,{event:e,name:"longpress-drag-start",x:o.x,y:o.y,dx:0,dy:0,force:e.touches[0].force}),o.x=e.touches[0].clientX,o.y=e.touches[0].clientY,M(o.activeElement,{event:e,name:"longpress-dragging",x:o.x,y:o.y,dx:0,dy:0,force:e.touches[0].force})):(M(o.activeElement,{event:e,name:"touch-drag-start",x:o.x,y:o.y,dx:0,dy:0,force:e.touches[0].force}),o.x=e.touches[0].clientX,o.y=e.touches[0].clientY,M(o.activeElement,{event:e,name:"touch-dragging",x:o.x,y:o.y,dx:0,dy:0,force:e.touches[0].force}))},Xe=e=>{o.isDragging&&e.touches.length>0&&e.touches[0].identifier===o.identifier||(o.lastTouchendTime=Date.now(),window.removeEventListener("touchmove",Ke),window.removeEventListener("touchend",Xe),window.removeEventListener("touchcancel",Xe),o.isDragging?(o.isDragging=!1,o.isLongpressed?(o.isLongpressed=!1,M(o.activeElement,{event:e,name:"longpress-drag-end",x:o.x,y:o.y,dx:0,dy:0})):M(o.activeElement,{event:e,name:"touch-drag-end",x:o.x,y:o.y,dx:0,dy:0})):o.isPinching?(o.isPinching=!1,o.hypotenuse=null,M(o.activeElement,{event:e,name:"pinch-end",x:o.lastCenterX,y:o.lastCenterY,dx:0,dy:0})):o.isLongpressed||(o.consecutiveTaps===0&&M(o.activeElement,{event:e,name:"tap",x:o.x,y:o.y,dx:0,dy:0}),o.consecutiveTaps++,window.setTimeout(()=>{o.consecutiveTaps>1&&M(o.activeElement,{event:e,name:"double-tap",x:o.x,y:o.y,dx:0,dy:0}),o.consecutiveTaps=0},sn)),o.isLongpressed&&M(o.activeElement,{event:e,name:"longpress-release",x:o.x,y:o.y,dx:0,dy:0}),o.isLongpressed=!1)};function an(...e){for(let t of e)fe.findIndex(n=>n===t)===-1&&(fe.length==0&&(window.addEventListener("blur",Dt),window.addEventListener("focus",Ct)),fe.push(t),t.addEventListener("touchstart",Mt,{passive:!1}),t.addEventListener("mousedown",St,{passive:!1}),t.addEventListener("contextmenu",It,{passive:!1}),t.addEventListener("wheel",xt,{passive:!1}))}function cn(...e){const t=n=>{n.removeEventListener("touchstart",Mt),n.removeEventListener("mousedown",St),n.removeEventListener("contextmenu",It),n.removeEventListener("wheel",xt)};if(e.length==0){for(let n of fe)t(n);fe=[]}else for(let n of e){let i=fe.findIndex(r=>r===n);i!==-1&&(t(n),fe.splice(i,1))}fe.length==0&&(window.removeEventListener("blur",Dt),window.removeEventListener("focus",Ct))}function un(e){let t,n,i,r,a,d,l="LOG";return{c(){t=A("div"),n=A("canvas"),i=W(),r=A("canvas"),a=W(),d=A("div"),d.textContent=l,this.h()},l(s){t=R(s,"DIV",{class:!0});var v=U(t);n=R(v,"CANVAS",{id:!0,class:!0}),U(n).forEach(H),i=j(v),r=R(v,"CANVAS",{id:!0,class:!0}),U(r).forEach(H),a=j(v),d=R(v,"DIV",{class:!0,"data-svelte-h":!0}),ge(d)!=="svelte-rtly9t"&&(d.textContent=l),v.forEach(H),this.h()},h(){S(n,"id","currentPath"),S(n,"class","svelte-mgp9tj"),z(n,"disabled",e[0]),S(r,"id","canvas"),S(r,"class","svelte-mgp9tj"),z(r,"disabled",e[0]),S(d,"class","log svelte-mgp9tj"),S(t,"class","canvas-container svelte-mgp9tj"),z(t,"hide",e[1])},m(s,v){ne(s,t,v),I(t,n),e[12](n),I(t,i),I(t,r),e[13](r),I(t,a),I(t,d),e[14](d)},p(s,v){v[0]&1&&z(n,"disabled",s[0]),v[0]&1&&z(r,"disabled",s[0]),v[0]&2&&z(t,"hide",s[1])},i:ve,o:ve,d(s){s&&H(t),e[12](null),e[13](null),e[14](null)}}}const dn=2,fn=178;function gn(e,t,n){var i=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),r=Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2)),a=Math.sqrt(Math.pow(n.x-e.x,2)+Math.pow(n.y-e.y,2)),d=Math.acos((r*r+i*i-a*a)/(2*r*i));return d*(180/Math.PI)}function pt(e){if(e.points.length<4)return e;for(let t=1;t<e.points.length-2;t++){const n=e.points[t-1],i=e.points[t],r=e.points[t+1];gn(n,i,r)>fn&&(e.points.splice(t,1),t--)}return e}async function Ne(e,t){if(t.lineWidth=e.lineWidth,t.lineCap="round",t.strokeStyle=e.color,e.points.length<2){t.beginPath(),t.moveTo(e.points[0].x,e.points[0].y),t.lineTo(e.points[0].x,e.points[0].y),t.stroke();return}t.beginPath();let n=e.points[0].x,i=e.points[0].y;for(let r=0;r<e.points.length-1;r++)t.moveTo(n,i),n=(e.points[r].x+e.points[r+1].x)/2,i=(e.points[r].y+e.points[r+1].y)/2,t.quadraticCurveTo(e.points[r].x,e.points[r].y,n,i);t.stroke()}function hn(e){return{x:wt(e.x),y:wt(e.y)}}function wt(e){const t=e.toFixed(dn);return Number(t)}function vn(e,t,n){let i;se(e,ce,T=>n(25,i=T));let{radius:r=3}=t,{smoothness:a=0}=t,{stroke:d=5}=t,{color:l="#000000"}=t,{disabled:s=!1}=t,{hide:v=!1}=t,{tabID:u=""}=t;function k(){L.clearRect(0,0,q/m,p/m),w=[]}function _(){if(w.length!=0){n(4,b.innerHTML="Undo",b),w.pop(),P.clearRect(0,0,q/m,p/m);for(let T=0;T<w.length;T++)Ne(w[T],P);ue()}}let E,L,C,P,D={x:0,y:0},p=0,q=0,m,Y=!1,b,c,g,w=[];function y(){E&&(an(E),window.addEventListener("keydown",ie))}function X(){E&&(cn(E),window.removeEventListener("keydown",ie))}const te=(T,J,V,de)=>{var qe=V-T,Fe=de-J;return Math.sqrt(qe*qe+Fe*Fe)},Z=(T,J=300)=>{let V;return(...de)=>{clearTimeout(V),V=setTimeout(()=>{T.apply(void 0,de)},J)}};function $(T,J){let V=E.getBoundingClientRect();return{x:T-V.left,y:J-V.top}}function le(){if(!E||!C)return;re(),m=window.devicePixelRatio;let T=E.getBoundingClientRect();p=T.height*m,q=T.width*m,n(2,E.width=q,E),n(2,E.height=p,E),n(3,C.width=q,C),n(3,C.height=p,C),L.scale(m,m),P.scale(m,m);for(let J=0;J<w.length;J++)Ne(w[J],P)}function ue(){i[u]&&he(ce,i[u].paths=w.filter(T=>pt(T)),i)}function me(){i[u]&&(w=i[u].paths,le())}function De(T,J){Y=!0,D=$(T,J),L.lineWidth=d,L.lineCap="round",L.strokeStyle=l,L.beginPath(),L.moveTo(D.x,D.y),L.stroke(),c={points:[],lineWidth:d,color:l}}function Re(T,J){if(!Y)return;let V=$(T,J);if(r>0){if(te(V.x,V.y,D.x,D.y)<=r){c.points.length===0&&(c.points.push(V),Ne(c,L));return}let de=Math.sqrt(V.x*V.x+V.y*V.y-2*V.x*D.x+D.x*D.x-2*V.y*D.y+D.y*D.y);if(V={x:V.x+r*((D.x-V.x)/de),y:V.y+r*((D.y-V.y)/de)},te(D.x,D.y,V.x,V.y)<=a)return}c.points.push(hn(V)),L.clearRect(0,0,q/m,p/m),Ne(c,L),D=V}function re(){Y&&(w.push(pt(c)),Ne(c,P),L.clearRect(0,0,q/m,p/m),ue()),Y=!1}const ie=function(T){T.ctrlKey&&T.key=="z"&&_(),T.preventDefault()};lt(()=>{L=E.getContext("2d"),L.imageSmoothingEnabled=!1,P=C.getContext("2d"),P.imageSmoothingEnabled=!1,E.addEventListener("gesture",T=>{switch(T.detail.name){case"left-click-drag-start":case"touch-drag-start":De(T.detail.x,T.detail.y);break;case"left-click-dragging":case"touch-dragging":T.detail.force>0&&n(4,b.innerHTML=T.detail.force,b),Re(T.detail.x,T.detail.y);break;case"left-click-drag-end":case"touch-drag-end":re();break;case"left-click":case"tap":De(T.detail.x,T.detail.y),Re(T.detail.x,T.detail.y),re();break}}),g=new ResizeObserver(Z(le,0)),g.observe(E),me(),s?X():y()}),At(()=>{g&&g.disconnect(),X()});function Qe(T){Q[T?"unshift":"push"](()=>{C=T,n(3,C)})}function Je(T){Q[T?"unshift":"push"](()=>{E=T,n(2,E)})}function Ze(T){Q[T?"unshift":"push"](()=>{b=T,n(4,b)})}return e.$$set=T=>{"radius"in T&&n(5,r=T.radius),"smoothness"in T&&n(6,a=T.smoothness),"stroke"in T&&n(7,d=T.stroke),"color"in T&&n(8,l=T.color),"disabled"in T&&n(0,s=T.disabled),"hide"in T&&n(1,v=T.hide),"tabID"in T&&n(9,u=T.tabID)},e.$$.update=()=>{e.$$.dirty[0]&1&&(s?X():y())},[s,v,E,C,b,r,a,d,l,u,k,_,Qe,Je,Ze]}class mn extends He{constructor(t){super(),Ae(this,t,vn,un,Pe,{radius:5,smoothness:6,stroke:7,color:8,disabled:0,hide:1,tabID:9,clear:10,undo:11},null,[-1,-1])}get clear(){return this.$$.ctx[10]}get undo(){return this.$$.ctx[11]}}function _t(e,t,n){const i=e.slice();return i[15]=t[n],i}function yt(e,t,n){const i=e.slice();return i[15]=t[n],i}function bn(e){let t,n;return t=new Ut({}),{c(){Ee(t.$$.fragment)},l(i){Te(t.$$.fragment,i)},m(i,r){Le(t,i,r),n=!0},p:ve,i(i){n||(F(t.$$.fragment,i),n=!0)},o(i){G(t.$$.fragment,i),n=!1},d(i){Ce(t,i)}}}function pn(e){let t,n,i,r,a,d,l,s=[],v=new Map,u,k,_=[],E=new Map,L;function C(b){e[9](b)}function P(b){e[10](b)}let D={onDrawingUndo:e[8]};e[2]!==void 0&&(D.drawingStroke=e[2]),e[0]!==void 0&&(D.drawingColor=e[0]),n=new $t({props:D}),Q.push(()=>ke(n,"drawingStroke",C)),Q.push(()=>ke(n,"drawingColor",P));let p=xe(Object.keys(e[7]));const q=b=>b[15];for(let b=0;b<p.length;b+=1){let c=yt(e,p,b),g=q(c);v.set(g,s[b]=kt(g,c))}let m=xe(Object.keys(e[7]));const Y=b=>b[15];for(let b=0;b<m.length;b+=1){let c=_t(e,m,b),g=Y(c);E.set(g,_[b]=Et(g,c))}return{c(){t=A("div"),Ee(n.$$.fragment),a=W(),d=A("div"),l=A("div");for(let b=0;b<s.length;b+=1)s[b].c();u=W(),k=A("div");for(let b=0;b<_.length;b+=1)_[b].c();this.h()},l(b){t=R(b,"DIV",{class:!0});var c=U(t);Te(n.$$.fragment,c),a=j(c),d=R(c,"DIV",{class:!0});var g=U(d);l=R(g,"DIV",{class:!0});var w=U(l);for(let X=0;X<s.length;X+=1)s[X].l(w);w.forEach(H),u=j(g),k=R(g,"DIV",{class:!0});var y=U(k);for(let X=0;X<_.length;X+=1)_[X].l(y);y.forEach(H),g.forEach(H),c.forEach(H),this.h()},h(){S(l,"class","editor-container svelte-gwyvkn"),S(k,"class","drawing-container svelte-gwyvkn"),z(k,"disabled",e[1].activeTool!=="pencil"),S(d,"class","canvas-container svelte-gwyvkn"),S(t,"class","page-container svelte-gwyvkn")},m(b,c){ne(b,t,c),Le(n,t,null),I(t,a),I(t,d),I(d,l);for(let g=0;g<s.length;g+=1)s[g]&&s[g].m(l,null);I(d,u),I(d,k);for(let g=0;g<_.length;g+=1)_[g]&&_[g].m(k,null);L=!0},p(b,c){const g={};c&8&&(g.onDrawingUndo=b[8]),!i&&c&4&&(i=!0,g.drawingStroke=b[2],ye(()=>i=!1)),!r&&c&1&&(r=!0,g.drawingColor=b[0],ye(()=>r=!1)),n.$set(g),c&160&&(p=xe(Object.keys(b[7])),we(),s=tt(s,c,q,1,b,p,v,l,nt,kt,null,yt),_e()),c&190&&(m=xe(Object.keys(b[7])),we(),_=tt(_,c,Y,1,b,m,E,k,nt,Et,null,_t),_e()),(!L||c&2)&&z(k,"disabled",b[1].activeTool!=="pencil")},i(b){if(!L){F(n.$$.fragment,b);for(let c=0;c<p.length;c+=1)F(s[c]);for(let c=0;c<m.length;c+=1)F(_[c]);L=!0}},o(b){G(n.$$.fragment,b);for(let c=0;c<s.length;c+=1)G(s[c]);for(let c=0;c<_.length;c+=1)G(_[c]);L=!1},d(b){b&&H(t),Ce(n);for(let c=0;c<s.length;c+=1)s[c].d();for(let c=0;c<_.length;c+=1)_[c].d()}}}function kt(e,t){let n,i,r;return i=new nn({props:{disabled:t[15]!==t[5],tabID:t[15]}}),{key:e,first:null,c(){n=Me(),Ee(i.$$.fragment),this.h()},l(a){n=Me(),Te(i.$$.fragment,a),this.h()},h(){this.first=n},m(a,d){ne(a,n,d),Le(i,a,d),r=!0},p(a,d){t=a;const l={};d&160&&(l.disabled=t[15]!==t[5]),d&128&&(l.tabID=t[15]),i.$set(l)},i(a){r||(F(i.$$.fragment,a),r=!0)},o(a){G(i.$$.fragment,a),r=!1},d(a){a&&H(n),Ce(i,a)}}}function Et(e,t){let n,i,r,a,d;function l(u){t[12](u)}function s(u){t[13](u)}let v={tabID:t[15],hide:t[15]!==t[5],disabled:t[15]!==t[5]||t[1].activeTool!=="pencil"};return t[4]!==void 0&&(v.color=t[4]),t[2]!==void 0&&(v.stroke=t[2]),i=new mn({props:v}),t[11](i),Q.push(()=>ke(i,"color",l)),Q.push(()=>ke(i,"stroke",s)),{key:e,first:null,c(){n=Me(),Ee(i.$$.fragment),this.h()},l(u){n=Me(),Te(i.$$.fragment,u),this.h()},h(){this.first=n},m(u,k){ne(u,n,k),Le(i,u,k),d=!0},p(u,k){t=u;const _={};k&128&&(_.tabID=t[15]),k&160&&(_.hide=t[15]!==t[5]),k&162&&(_.disabled=t[15]!==t[5]||t[1].activeTool!=="pencil"),!r&&k&16&&(r=!0,_.color=t[4],ye(()=>r=!1)),!a&&k&4&&(a=!0,_.stroke=t[2],ye(()=>a=!1)),i.$set(_)},i(u){d||(F(i.$$.fragment,u),d=!0)},o(u){G(i.$$.fragment,u),d=!1},d(u){u&&H(n),t[11](null),Ce(i,u)}}}function wn(e){let t,n,i,r;const a=[pn,bn],d=[];function l(s,v){return s[6].currentUser&&!s[6].isLoading?0:1}return t=l(e),n=d[t]=a[t](e),{c(){n.c(),i=Me()},l(s){n.l(s),i=Me()},m(s,v){d[t].m(s,v),ne(s,i,v),r=!0},p(s,[v]){let u=t;t=l(s),t===u?d[t].p(s,v):(we(),G(d[u],1,1,()=>{d[u]=null}),_e(),n=d[t],n?n.p(s,v):(n=d[t]=a[t](s),n.c()),F(n,1),n.m(i.parentNode,i))},i(s){r||(F(n),r=!0)},o(s){G(n),r=!1},d(s){s&&H(i),d[t].d(s)}}}function _n(e,t){var n=parseInt(e.slice(1,3),16),i=parseInt(e.slice(3,5),16),r=parseInt(e.slice(5,7),16);return"rgba("+n+", "+i+", "+r+", "+t+")"}function yn(e,t,n){let i,r,a,d,l,s;se(e,it,p=>n(14,a=p)),se(e,pe,p=>n(1,d=p)),se(e,Tt,p=>n(6,l=p)),se(e,ce,p=>n(7,s=p));let v="#000000";it.subscribe(()=>{var p;n(0,v=((p=Nt.find(q=>q.name===a.theme))==null?void 0:p.caret)||"#000000")});let u=10,k;const _=()=>k.undo();function E(p){u=p,n(2,u)}function L(p){v=p,n(0,v)}function C(p){Q[p?"unshift":"push"](()=>{k=p,n(3,k)})}function P(p){r=p,n(4,r),n(0,v)}function D(p){u=p,n(2,u)}return e.$$.update=()=>{e.$$.dirty&2&&n(5,i=d.order[d.activeIndex]),e.$$.dirty&1&&n(4,r=_n(v,.3))},[v,d,u,k,r,i,l,s,_,E,L,C,P,D]}class Mn extends He{constructor(t){super(),Ae(this,t,yn,wn,Pe,{})}}export{Mn as component};
