const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/quill.Bk4jDS0q.js","../chunks/core.CG__ofcG.js"])))=>i.map(i=>d[i]);
var Dt=Object.defineProperty;var Ct=(e,t,n)=>t in e?Dt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var U=(e,t,n)=>Ct(e,typeof t!="symbol"?t+"":t,n);import{s as Le,n as he,r as Fe,i as we,c as ie,o as et,d as K,A as It,B as He,a as de,C as Mt,e as bt}from"../chunks/scheduler.CE28Mlnp.js";import{S as xe,i as De,e as A,b as Yt,c as S,d as O,f as Pt,g as H,w as I,A as N,j as se,k as C,x as ee,F as Qe,l as Xt,s as F,p as ve,h as j,v as ue,q as me,r as be,o as ke,n as Ee,a as q,t as z,u as pe,G as Ae,z as tt,I as Ve,C as Be,J as Ht,m as Ne}from"../chunks/index.DI-vKZfI.js";import{e as ye,u as Ze,o as $e}from"../chunks/each.Ds53g4D-.js";import{b as W}from"../chunks/paths.CMBA6P4H.js";import{m as fe,t as ae,d as re,s as pt,a as _t,f as At}from"../chunks/firebaseStore.CSE5TQJ0.js";import{_ as nt}from"../chunks/preload-helper.D6kgxu3v.js";import{P as St}from"../chunks/ProgressBar.BImEwBUK.js";import{t as Rt}from"../chunks/themes.BTx5Q4mv.js";function Bt(e){let t,n,i,r,o,d;return{c(){t=A("div"),n=A("button"),i=A("span"),r=Yt(e[0]),this.h()},l(l){t=S(l,"DIV",{class:!0});var s=O(t);n=S(s,"BUTTON",{class:!0,draggable:!0});var g=O(n);i=S(g,"SPAN",{class:!0});var h=O(i);r=Pt(h,e[0]),h.forEach(H),g.forEach(H),s.forEach(H),this.h()},h(){I(i,"class","title svelte-1jmw20r"),I(n,"class","tab svelte-1jmw20r"),I(n,"draggable","true"),N(n,"active",e[1]),I(t,"class","tab-container svelte-1jmw20r"),N(t,"preventHover",e[2])},m(l,s){se(l,t,s),C(t,n),C(n,i),C(i,r),o||(d=[ee(n,"mousedown",Qe(function(){we(e[3])&&e[3].apply(this,arguments)})),ee(n,"touchstart",Qe(function(){we(e[3])&&e[3].apply(this,arguments)})),ee(n,"dragstart",Qe(function(){we(e[4])&&e[4].apply(this,arguments)}))],o=!0)},p(l,[s]){e=l,s&1&&Xt(r,e[0]),s&2&&N(n,"active",e[1]),s&4&&N(t,"preventHover",e[2])},i:he,o:he,d(l){l&&H(t),o=!1,Fe(d)}}}function Ot(e,t,n){let{title:i=""}=t,{active:r=!1}=t,{preventHover:o=!1}=t,{onPointerdown:d=s=>{}}=t,{onDragstart:l=s=>{}}=t;return e.$$set=s=>{"title"in s&&n(0,i=s.title),"active"in s&&n(1,r=s.active),"preventHover"in s&&n(2,o=s.preventHover),"onPointerdown"in s&&n(3,d=s.onPointerdown),"onDragstart"in s&&n(4,l=s.onDragstart)},[i,r,o,d,l]}class yt extends xe{constructor(t){super(),De(this,t,Ot,Bt,Le,{title:0,active:1,preventHover:2,onPointerdown:3,onDragstart:4})}}function ge(e){return e<.5?4*e*e*e:.5*Math.pow(2*e-2,3)+1}function Vt(e){const t=e-1;return t*t*t+1}const it=(e,t)=>{const{duration:n=300,easing:i=ge,onEnd:r=()=>{},onStep:o=()=>{},css:d}=t;let l;function s(g){if(!e){console.warn("Cannot find element to animate");return}l===void 0&&(l=g);const h=i((g-l)/n),D=1-h;h<1?(e.style.cssText=d(h,D),o(h,D),requestAnimationFrame(s)):(e.style.cssText="",r())}requestAnimationFrame(s)},Je=e=>{const{duration:t=300,easing:n=ge,onEnd:i=()=>{},onStep:r=()=>{}}=e;let o;function d(l){o===void 0&&(o=l);const s=n((l-o)/t),g=1-s;s<1?(r(s,g),requestAnimationFrame(d)):i()}requestAnimationFrame(d)};function st(e,t,n){const i=e.slice();return i[41]=t[n],i[42]=t,i[43]=n,i}function lt(e,t){let n,i,r,o,d=t[43],l,s,g;function h(...a){return t[17](t[43],...a)}function D(a){t[18](a,t[41])}let y={active:t[9]==t[41],preventHover:t[8],onPointerdown:h,onDragstart:t[14]};t[11][t[41]].title!==void 0&&(y.title=t[11][t[41]].title),i=new yt({props:y}),K.push(()=>Ae(i,"title",D));const b=()=>t[19](n,d),c=()=>t[19](null,d);return{key:e,first:null,c(){n=A("div"),ve(i.$$.fragment),o=F(),this.h()},l(a){n=S(a,"DIV",{class:!0});var v=O(n);me(i.$$.fragment,v),o=j(v),v.forEach(H),this.h()},h(){I(n,"class","tab-container svelte-1g5j5bc"),N(n,"placeholder",t[10]==t[41]),this.first=n},m(a,v){se(a,n,v),be(i,n,null),C(n,o),b(),l=!0,s||(g=It(t[13].call(null,n)),s=!0)},p(a,v){t=a;const E={};v[0]&514&&(E.active=t[9]==t[41]),v[0]&256&&(E.preventHover=t[8]),v[0]&2&&(E.onPointerdown=h),!r&&v[0]&2050&&(r=!0,E.title=t[11][t[41]].title,He(()=>r=!1)),i.$set(E),d!==t[43]&&(c(),d=t[43],b()),(!l||v[0]&1026)&&N(n,"placeholder",t[10]==t[41])},i(a){l||(q(i.$$.fragment,a),l=!0)},o(a){z(i.$$.fragment,a),l=!1},d(a){a&&H(n),pe(i),c(),s=!1,g()}}}function Nt(e){let t,n,i,r=[],o=new Map,d,l,s,g=`<span class="button-icon svelte-1g5j5bc" style="-webkit-mask: url(${W}/images/svg/plus.svg) no-repeat center / contain; mask: url(${W}/images/svg/plus.svg) no-repeat center / contain;"></span>`,h,D,y,b=`<span class="button-icon svelte-1g5j5bc" style="-webkit-mask: url(${W}/images/svg/gear.svg) no-repeat center / contain; mask: url(${W}/images/svg/gear.svg) no-repeat center / contain;"></span>`,c,a,v,E,Y,V,p,X,T=ye(e[1].order);const P=k=>k[41];for(let k=0;k<T.length;k+=1){let _=st(e,T,k),x=P(_);o.set(x,r[k]=lt(x,_))}return v=new yt({props:{title:e[4],active:!e[6],preventHover:!0}}),{c(){t=A("div"),n=A("div"),i=A("div");for(let k=0;k<r.length;k+=1)r[k].c();d=F(),l=A("div"),s=A("button"),s.innerHTML=g,h=F(),D=A("div"),y=A("button"),y.innerHTML=b,c=F(),a=A("div"),ve(v.$$.fragment),E=F(),Y=A("div"),this.h()},l(k){t=S(k,"DIV",{class:!0});var _=O(t);n=S(_,"DIV",{class:!0});var x=O(n);i=S(x,"DIV",{class:!0});var Q=O(i);for(let $=0;$<r.length;$+=1)r[$].l(Q);Q.forEach(H),d=j(x),l=S(x,"DIV",{class:!0});var te=O(l);s=S(te,"BUTTON",{class:!0,"data-svelte-h":!0}),ue(s)!=="svelte-g0ls06"&&(s.innerHTML=g),te.forEach(H),h=j(x),D=S(x,"DIV",{class:!0});var J=O(D);y=S(J,"BUTTON",{class:!0,"data-svelte-h":!0}),ue(y)!=="svelte-vdlv00"&&(y.innerHTML=b),J.forEach(H),c=j(x),a=S(x,"DIV",{class:!0});var Z=O(a);me(v.$$.fragment,Z),Z.forEach(H),x.forEach(H),E=j(_),Y=S(_,"DIV",{class:!0}),O(Y).forEach(H),_.forEach(H),this.h()},h(){I(i,"class","tabs svelte-1g5j5bc"),I(s,"class","button svelte-1g5j5bc"),I(l,"class","new-tab-container svelte-1g5j5bc"),I(y,"class","button svelte-1g5j5bc"),I(D,"class","buttons-container svelte-1g5j5bc"),I(a,"class","clone svelte-1g5j5bc"),N(a,"dragging",e[0]),I(n,"class","tabbar svelte-1g5j5bc"),I(Y,"class","divider svelte-1g5j5bc"),I(t,"class","svelte-1g5j5bc")},m(k,_){se(k,t,_),C(t,n),C(n,i);for(let x=0;x<r.length;x+=1)r[x]&&r[x].m(i,null);e[20](i),C(n,d),C(n,l),C(l,s),C(n,h),C(n,D),C(D,y),C(n,c),C(n,a),be(v,a,null),e[22](a),C(t,E),C(t,Y),e[23](t),V=!0,p||(X=[ee(s,"click",e[12]),ee(y,"click",e[21])],p=!0)},p(k,_){_[0]&53002&&(T=ye(k[1].order),ke(),r=Ze(r,_,P,1,k,T,o,i,$e,lt,null,st),Ee());const x={};_[0]&16&&(x.title=k[4]),_[0]&64&&(x.active=!k[6]),v.$set(x),(!V||_[0]&1)&&N(a,"dragging",k[0])},i(k){if(!V){for(let _=0;_<T.length;_+=1)q(r[_]);q(v.$$.fragment,k),V=!0}},o(k){for(let _=0;_<r.length;_+=1)z(r[_]);z(v.$$.fragment,k),V=!1},d(k){k&&H(t);for(let _=0;_<r.length;_+=1)r[_].d();e[20](null),pe(v),e[22](null),e[23](null),p=!1,Fe(X)}}}const Ut=12,Oe=200,Ye=32,Pe=200,Ft=1600,ot=.3;function jt(e,t,n){let i,r,o,d;ie(e,fe,f=>n(1,o=f)),ie(e,ae,f=>n(11,d=f));const l=()=>{_(o.order[o.activeIndex])};let s,g=[],h=0,D=null,y=-1,b="",c,a,v,E=!1,Y=!1,V=0,p=0,X,T=!1;const P=(f,L=300)=>{let R;return(...B)=>{clearTimeout(R),R=setTimeout(()=>{f.apply(void 0,B)},L)}};function k(){re.newTab()}const _=f=>{const L=o.order.findIndex(R=>R===f);if(L<0||!g[L]){console.warn("Cannot close tab!");return}h=g[L].getBoundingClientRect().width,L<o.order.length-1&&(s.style.setProperty("--tab-max-width",`${h}px`),x()),L==o.activeIndex&&(L==o.order.length-1?re.setActiveIndex(L-1):re.setActiveIndex(L+1)),Je({duration:Pe,easing:ge,onStep:(R,B)=>{L==0?n(2,s.style.gridTemplateColumns=`minmax(${B*Ye}px, ${B*h}px)`,s):n(2,s.style.gridTemplateColumns=`repeat(${L}, minmax(var(--tab-min-width), var(--tab-max-width))) minmax(${B*Ye}px, ${B*h}px)`,s)},onEnd:()=>{n(2,s.style.gridTemplateColumns="",s),re.removeTab(f)}})},x=P(()=>{s&&(s.style.setProperty("--tab-max-width",`${Oe}px`),Je({duration:Pe,easing:ge,onStep:(f,L)=>{s.style.setProperty("--tab-max-width",`${h+f*(Oe-h)}px`)},onEnd:()=>{s.style.setProperty("--tab-max-width",`${Oe}px`)}}))},Ft);function Q(f){if(!s)return;const L=f.getBoundingClientRect().width;Je({duration:Pe,easing:ge,onStep:(R,B)=>{o.order.length==1?n(2,s.style.gridTemplateColumns=`minmax(${R*Ye}px, ${R*L}px)`,s):n(2,s.style.gridTemplateColumns=`repeat(${o.order.length-1}, minmax(var(--tab-min-width), var(--tab-max-width))) minmax(${R*Ye}px, ${R*L}px)`,s),n(2,s.scrollLeft=s.scrollWidth,s)},onEnd:()=>{n(2,s.style.gridTemplateColumns="",s)}})}const te=(f,L)=>{const R=g[0].getBoundingClientRect().width;re.moveTab(f,L,()=>{if(f>L)for(let B=L;B<f;B++)it(g[B],{duration:Pe,easing:ge,css:(Ie,oe)=>`transform: translateX(-${oe*R}px);`});if(f<L)for(let B=L;B>f;B--)it(g[B],{duration:Pe,easing:ge,css:(Ie,oe)=>`transform: translateX(${oe*R}px);`})})};function J(f){!f.target||!f.dataTransfer||(f.dataTransfer.setData("text/plain",i),f.dataTransfer.setDragImage(new Image,0,0))}function Z(f,L){if(f==0&&L==0){n(5,v.style.left="-1000px",v),n(5,v.style.top="-1000px",v);return}let R=X.getBoundingClientRect();if(f<R.left||f>R.right||L<R.top||L>R.bottom){Y||(p=0),n(5,v.style.left=`${f+V}px`,v),n(5,v.style.top=`${L-a.height/2}px`,v),n(6,Y=!0);return}Y&&n(6,Y=!1),n(5,v.style.left=`${f+V}px`,v),n(5,v.style.top=`${a.top}px`,v);const B=-s.scrollLeft,Ie=g[0].getBoundingClientRect().width;let oe=-1;if(f>B+o.order.length*Ie)oe=o.order.length-1;else for(let Me=0;Me<o.order.length;Me++)if(f>B+Me*Ie&&f<B+(Me+1)*Ie){oe=Me;break}f<20?(p=-ot,requestAnimationFrame(_e)):f>s.clientWidth-10?(p=ot,requestAnimationFrame(_e)):p=0,!(oe==-1||oe==o.placeholderIndex)&&te(o.placeholderIndex,oe)}let $=0;function _e(f){if(!E||p==0){$=0;return}$==0&&($=f);const L=f-$;$=f,s.scrollBy({left:p*L}),requestAnimationFrame(_e)}function Se(f,L){if(!f.target)return;let R,B;f instanceof TouchEvent?(R=f.touches[0].clientX,B=f.touches[0].clientY):(R=f.clientX,B=f.clientY),window.addEventListener("touchmove",le,{passive:!1}),window.addEventListener("touchend",ne),window.addEventListener("mousemove",le),window.addEventListener("mouseup",ne),window.addEventListener("drag",le),window.addEventListener("dragend",ne),window.addEventListener("blur",ne),re.setActiveIndex(L),c=f.target,a=c.getBoundingClientRect(),D=[R,B],V=a.left-R,a.top-B,n(5,v.style.width=`${a.width}px`,v),n(5,v.style.left=`${a.left}px`,v),n(5,v.style.top=`${a.top}px`,v),y=L,n(4,b=d[o.order[L]].title)}function le(f){let L,R;if(f instanceof TouchEvent?(L=f.touches[0].clientX,R=f.touches[0].clientY,f.preventDefault()):(L=f.clientX,R=f.clientY),E){Z(L,R);return}D===null||Math.hypot(D[0]-L,D[1]-R)<Ut||(n(0,E=!0),re.setPlaceholderIndex(y),re.setActiveIndex(y))}function ne(){window.removeEventListener("touchmove",le),window.removeEventListener("touchend",ne),window.removeEventListener("mousemove",le),window.removeEventListener("mouseup",ne),window.removeEventListener("drag",le),window.removeEventListener("dragend",ne),window.removeEventListener("blur",ne),D=null,n(6,Y=!1),y=-1,V=0,re.setPlaceholderIndex(),n(0,E=!1)}et(()=>{s.style.setProperty("--tab-max-width",`${Oe}px`),s.style.setProperty("--tab-min-width",`${Ye}px`)});const Ce=(f,L)=>Se(L,f);function Re(f,L){e.$$.not_equal(d[L].title,f)&&(d[L].title=f,ae.set(d))}function ze(f,L){K[f?"unshift":"push"](()=>{g[L]=f,n(3,g)})}function Ge(f){K[f?"unshift":"push"](()=>{s=f,n(2,s)})}const Ke=()=>{de(fe,o.toolbarVisible=!o.toolbarVisible,o),o.toolbarVisible||de(fe,o.activeTool=void 0,o)};function w(f){K[f?"unshift":"push"](()=>{v=f,n(5,v)})}function G(f){K[f?"unshift":"push"](()=>{X=f,n(7,X)})}return e.$$.update=()=>{e.$$.dirty[0]&2&&n(9,i=o.order[o.activeIndex]),e.$$.dirty[0]&2&&n(10,r=o.order[o.placeholderIndex]),e.$$.dirty[0]&1&&(E?n(8,T=!0):setTimeout(()=>n(8,T=!1),20))},[E,o,s,g,b,v,Y,X,T,i,r,d,k,Q,J,Se,l,Ce,Re,ze,Ge,Ke,w,G]}class qt extends xe{constructor(t){super(),De(this,t,jt,Nt,Le,{closeActiveTab:16},null,[-1,-1])}get closeActiveTab(){return this.$$.ctx[16]}}function Wt(e){let t,n;return{c(){t=A("div"),n=A("div"),this.h()},l(i){t=S(i,"DIV",{class:!0});var r=O(t);n=S(r,"DIV",{class:!0}),O(n).forEach(H),r.forEach(H),this.h()},h(){I(n,"class","quill-editor svelte-763iug"),I(t,"class","quill-editor-wrapper svelte-763iug"),N(t,"disabled",e[0])},m(i,r){se(i,t,r),C(t,n),e[5](n)},p(i,[r]){r&1&&N(t,"disabled",i[0])},i:he,o:he,d(i){i&&H(t),e[5](null)}}}function zt(e,t,n){let i,r;ie(e,ae,p=>n(6,i=p)),ie(e,pt,p=>n(4,r=p));let{tabID:o}=t,{disabled:d=!1}=t,l,s;const g=(p,X=300)=>{let T;return(...P)=>{clearTimeout(T),T=setTimeout(()=>{p.apply(void 0,P)},X)}};async function h(p){var k,_,x,Q;if(!l)return;const{Delta:X,Range:T}=await nt(async()=>{const{Delta:te,Range:J}=await import("../chunks/core.CG__ofcG.js").then(Z=>Z.G);return{Delta:te,Range:J}},[],import.meta.url);if(p.undo.length>0)for(var P=0;P<p.undo.length;P++){const te=(k=p.undo[P].range)==null?void 0:k.index,J=(_=p.undo[P].range)==null?void 0:_.length,Z={delta:new X(p.undo[P].delta.ops),range:te!==void 0&&J!==void 0?new T(te,J):null};l.history.stack.undo.push(Z)}if(p.redo.length>0)for(var P=0;P<p.redo.length;P++){const J=(x=p.redo[P].range)==null?void 0:x.index,Z=(Q=p.redo[P].range)==null?void 0:Q.length,$={delta:new X(p.redo[P].delta.ops),range:J!==void 0&&Z!==void 0?new T(J,Z):null};l.history.stack.redo.push($)}}function D(p){var X;l&&((X=l.getSelection())==null?void 0:X.length)===0&&window.open(p.target.href,"_blank")}function y(){if(!l||!i[o])return;const p=i[o].ops;l.setContents(p);const X=i[o].history;h(X)}function b(){if(!l||!i[o])return;de(ae,i[o].ops=l.getContents().ops,i);const p=structuredClone(l.history.stack);de(ae,i[o].history=p,i)}const c=g(b,500);function a(){if(!l)return;l.formatText(0,l.getLength(),"link",!1,"api");const p=l.getText(),X=/https?:\/\/\S+/gi,T=p.matchAll(X);for(const _ of T)l.formatText(_.index,_[0].length,"link",_[0],"api");const P=/.+\@.+\..+/gi,k=p.matchAll(P);for(const _ of k)l.formatText(_.index,_[0].length,"link","mailto:"+_[0],"api");document.querySelectorAll(".ql-editor a").forEach(_=>{_.addEventListener("click",D)})}const v=g(a,500);function E(p,X,T){if(T==="user"){const P=l.getText().split(`
`)[0].trim();de(ae,i[o].title=P===""?"Untitled":P,i),v(),c()}}async function Y(){const{default:p}=await nt(async()=>{const{default:X}=await import("../chunks/quill.Bk4jDS0q.js");return{default:X}},__vite__mapDeps([0,1]),import.meta.url);n(3,l=new p(s,{formats:["bold","italic","underline","strike","code","link"],placeholder:"Enter text here"})),y(),a(),l.on("text-change",E),l.keyboard.addBinding({key:"/",altKey:!0},()=>{l.format("code",!l.getFormat().code)}),l.keyboard.addBinding({key:"-",altKey:!0},()=>{l.format("strike",!l.getFormat().strike)})}et(()=>{Y()});function V(p){K[p?"unshift":"push"](()=>{s=p,n(1,s)})}return e.$$set=p=>{"tabID"in p&&n(2,o=p.tabID),"disabled"in p&&n(0,d=p.disabled)},e.$$.update=()=>{e.$$.dirty&9&&(d?l==null||l.disable():l==null||l.enable()),e.$$.dirty&24&&(l==null||l.root.setAttribute("spellcheck",r.spellCheck.toString()))},[d,s,o,l,r,V]}class Gt extends xe{constructor(t){super(),De(this,t,zt,Wt,Le,{tabID:2,disabled:0})}}const rt=500,Kt=300,at=500,Qt=300;class Jt{constructor(){U(this,"isMoving",!1);U(this,"isLongclick",!1);U(this,"button",0);U(this,"lastX",0);U(this,"lastY",0);U(this,"consecutiveClicks",0);U(this,"lastMouseupTime",0);U(this,"activeElement",null);this.reset()}reset(){this.isMoving=!1,this.isLongclick=!1,this.button=0,this.lastX=0,this.lastY=0,this.consecutiveClicks=0,this.lastMouseupTime=0,this.activeElement=null}}class Zt{constructor(){U(this,"isDragging",!1);U(this,"isPinching",!1);U(this,"isLongpressed",!1);U(this,"consecutiveTaps",0);U(this,"lastTouchendTime",0);U(this,"lastCenterX",0);U(this,"lastCenterY",0);U(this,"identifier",0);U(this,"x",0);U(this,"y",0);U(this,"hypotenuse",0);U(this,"activeElement",null);this.reset()}reset(){this.isDragging=!1,this.isPinching=!1,this.isLongpressed=!1,this.consecutiveTaps=0,this.lastTouchendTime=0,this.lastCenterX=0,this.lastCenterY=0,this.identifier=0,this.x=0,this.y=0,this.hypotenuse=0,this.activeElement=null}}let ce=[],m=new Jt,u=new Zt;const M=(e,t)=>{e!=null&&e.dispatchEvent(new CustomEvent("gesture",{detail:t,bubbles:!1,cancelable:!1}))},wt=e=>{m.reset(),u.reset(),m.lastMouseupTime=Date.now(),window.removeEventListener("mousemove",je),window.removeEventListener("mouseup",qe),window.removeEventListener("touchmove",We),window.removeEventListener("touchend",Te)},kt=e=>{if(window.removeEventListener("mousemove",je),window.removeEventListener("mouseup",qe),window.removeEventListener("touchmove",We),window.removeEventListener("touchend",Te),m.isMoving)if(m.isMoving=!1,m.isLongclick)m.isLongclick=!1,M(m.activeElement,{event:e,name:"longclick-drag-end",x:m.lastX,y:m.lastY,dx:0,dy:0});else switch(m.button){case 0:M(m.activeElement,{event:e,name:"left-click-drag-end",x:m.lastX,y:m.lastY,dx:0,dy:0});break;case 1:M(m.activeElement,{event:e,name:"middle-click-drag-end",x:m.lastX,y:m.lastY,dx:0,dy:0});break;case 2:M(m.activeElement,{event:e,name:"right-click-drag-end",x:m.lastX,y:m.lastY,dx:0,dy:0});break}m.isLongclick&&M(m.activeElement,{event:e,name:"longclick-release",x:m.lastX,y:m.lastY,dx:0,dy:0}),m.reset(),u.isDragging&&(u.isDragging=!1,u.isLongpressed?(u.isLongpressed=!1,M(u.activeElement,{event:e,name:"longpress-drag-end",x:u.lastCenterX,y:u.lastCenterY,dx:0,dy:0})):M(u.activeElement,{event:e,name:"touch-drag-end",x:u.lastCenterX,y:u.lastCenterY,dx:0,dy:0})),u.isLongpressed&&M(u.activeElement,{event:e,name:"longpress-release",x:u.lastCenterX,y:u.lastCenterY,dx:0,dy:0}),u.reset()},Et=e=>{M(e.target,{event:e,name:"wheel",x:e.clientX,y:e.clientY,dx:0,dy:0})},Tt=e=>{},Lt=e=>{document.activeElement!==e.target&&(window.addEventListener("mousemove",je),window.addEventListener("mouseup",qe),m.activeElement=e.target,m.lastX=e.clientX,m.lastY=e.clientY,m.isMoving||(m.button=e.button),m.button===0&&window.setTimeout(()=>{Date.now()-m.lastMouseupTime>=at&&!m.isMoving&&(m.isLongclick=!0,M(m.activeElement,{event:e,name:"longclick",x:e.clientX,y:e.clientY,dx:0,dy:0}))},at))},je=e=>{if(e.movementX===0&&e.movementY===0)return;let t=e.clientX-m.lastX,n=e.clientY-m.lastY;if(!m.isMoving)if(m.isLongclick)M(m.activeElement,{event:e,name:"longclick-drag-start",x:e.clientX,y:e.clientY,dx:0,dy:0});else switch(m.button){case 0:M(m.activeElement,{event:e,name:"left-click-drag-start",x:e.clientX,y:e.clientY,dx:0,dy:0});break;case 1:M(m.activeElement,{event:e,name:"middle-click-drag-start",x:e.clientX,y:e.clientY,dx:0,dy:0});break;case 2:M(m.activeElement,{event:e,name:"right-click-drag-start",x:e.clientX,y:e.clientY,dx:0,dy:0});break}if(m.isMoving=!0,m.lastX=e.clientX,m.lastY=e.clientY,m.isLongclick)M(m.activeElement,{event:e,name:"longclick-dragging",x:e.clientX,y:e.clientY,dx:t,dy:n});else switch(m.button){case 0:M(m.activeElement,{event:e,name:"left-click-dragging",x:e.clientX,y:e.clientY,dx:t,dy:n});break;case 1:M(m.activeElement,{event:e,name:"middle-click-dragging",x:e.clientX,y:e.clientY,dx:t,dy:n});break;case 2:M(m.activeElement,{event:e,name:"right-click-dragging",x:e.clientX,y:e.clientY,dx:t,dy:n});break}},qe=e=>{if(window.removeEventListener("mousemove",je),window.removeEventListener("mouseup",qe),m.lastMouseupTime=Date.now(),m.isMoving)if(m.isMoving=!1,m.isLongclick)m.isLongclick=!1,M(m.activeElement,{event:e,name:"longclick-drag-end",x:m.lastX,y:m.lastY,dx:0,dy:0});else switch(m.button){case 0:M(m.activeElement,{event:e,name:"left-click-drag-end",x:m.lastX,y:m.lastY,dx:0,dy:0});break;case 1:M(m.activeElement,{event:e,name:"middle-click-drag-end",x:m.lastX,y:m.lastY,dx:0,dy:0});break;case 2:M(m.activeElement,{event:e,name:"right-click-drag-end",x:m.lastX,y:m.lastY,dx:0,dy:0});break}else m.isLongclick||(e.button===2?M(m.activeElement,{event:e,name:"right-click",x:e.clientX,y:e.clientY,dx:0,dy:0}):e.button===1?M(m.activeElement,{event:e,name:"middle-click",x:e.clientX,y:e.clientY,dx:0,dy:0}):(m.consecutiveClicks===0&&M(m.activeElement,{event:e,name:"left-click",x:e.clientX,y:e.clientY,dx:0,dy:0}),m.consecutiveClicks++,window.setTimeout(()=>{m.consecutiveClicks>1&&M(m.activeElement,{event:e,name:"double-click",x:e.clientX,y:e.clientY,dx:0,dy:0}),m.consecutiveClicks=0},Qt)));m.isLongclick&&M(m.activeElement,{event:e,name:"longclick-release",x:e.clientX,y:e.clientY,dx:0,dy:0}),m.isLongclick=!1},xt=e=>{if(e.touches.length>1,document.activeElement!==e.target){if(e.touches.length>1){if(e.touches[0].identifier===u.identifier)return;u.isPinching=!0}window.addEventListener("touchmove",We,{passive:!1}),window.addEventListener("touchend",Te),window.addEventListener("touchcancel",Te),u.identifier=e.touches[0].identifier,u.x=e.touches[0].clientX,u.y=e.touches[0].clientY,u.activeElement=e.target,window.setTimeout(()=>{u.isPinching||u.isDragging||Date.now()-u.lastTouchendTime>=rt&&(u.isDragging=!1,u.isPinching=!1,u.hypotenuse=null,u.isLongpressed=!0,M(u.activeElement,{event:e,name:"longpress",x:u.x,y:u.y,dx:0,dy:0}))},rt)}},We=e=>{if(u.isDragging){let t=u.x,n=u.y;u.x=e.touches[0].clientX,u.y=e.touches[0].clientY;let i=u.x-t,r=u.y-n;u.isLongpressed?M(u.activeElement,{event:e,name:"longpress-dragging",x:u.x,y:u.y,dx:i,dy:r,force:e.touches[0].force}):M(u.activeElement,{event:e,name:"touch-dragging",x:u.x,y:u.y,dx:i,dy:r,force:e.touches[0].force});return}else if(!u.isLongpressed&&(u.isPinching||e.touches.length>1)){u.x=e.touches[0].clientX,u.y=e.touches[0].clientY;let t={x:e.touches[1].clientX,y:e.touches[1].clientY},n={x:(u.x+t.x)/2,y:(u.y+t.y)/2},i=Math.hypot(u.x-t.x,u.y-t.y);u.hypotenuse===null&&(u.hypotenuse=i,u.lastCenterX=n.x,u.lastCenterY=n.y,M(u.activeElement,{event:e,name:"pinch-start",x:n.x,y:n.y,dx:0,dy:0})),u.isPinching=!0;let r=i/u.hypotenuse,o=n.x-u.lastCenterX,d=n.y-u.lastCenterY;M(u.activeElement,{event:e,name:"pinching",x:n.x,y:n.y,zoom:r,dx:o,dy:d}),u.hypotenuse=i,u.lastCenterX=n.x,u.lastCenterY=n.y;return}else u.isDragging=!0,u.isLongpressed?(M(u.activeElement,{event:e,name:"longpress-drag-start",x:u.x,y:u.y,dx:0,dy:0,force:e.touches[0].force}),u.x=e.touches[0].clientX,u.y=e.touches[0].clientY,M(u.activeElement,{event:e,name:"longpress-dragging",x:u.x,y:u.y,dx:0,dy:0,force:e.touches[0].force})):(M(u.activeElement,{event:e,name:"touch-drag-start",x:u.x,y:u.y,dx:0,dy:0,force:e.touches[0].force}),u.x=e.touches[0].clientX,u.y=e.touches[0].clientY,M(u.activeElement,{event:e,name:"touch-dragging",x:u.x,y:u.y,dx:0,dy:0,force:e.touches[0].force}))},Te=e=>{u.isDragging&&e.touches.length>0&&e.touches[0].identifier===u.identifier||(u.lastTouchendTime=Date.now(),window.removeEventListener("touchmove",We),window.removeEventListener("touchend",Te),window.removeEventListener("touchcancel",Te),u.isDragging?(u.isDragging=!1,u.isLongpressed?(u.isLongpressed=!1,M(u.activeElement,{event:e,name:"longpress-drag-end",x:u.x,y:u.y,dx:0,dy:0})):M(u.activeElement,{event:e,name:"touch-drag-end",x:u.x,y:u.y,dx:0,dy:0})):u.isPinching?(u.isPinching=!1,u.hypotenuse=null,M(u.activeElement,{event:e,name:"pinch-end",x:u.lastCenterX,y:u.lastCenterY,dx:0,dy:0})):u.isLongpressed||(u.consecutiveTaps===0&&M(u.activeElement,{event:e,name:"tap",x:u.x,y:u.y,dx:0,dy:0}),u.consecutiveTaps++,window.setTimeout(()=>{u.consecutiveTaps>1&&M(u.activeElement,{event:e,name:"double-tap",x:u.x,y:u.y,dx:0,dy:0}),u.consecutiveTaps=0},Kt)),u.isLongpressed&&M(u.activeElement,{event:e,name:"longpress-release",x:u.x,y:u.y,dx:0,dy:0}),u.isLongpressed=!1)};function $t(...e){for(let t of e)ce.findIndex(n=>n===t)===-1&&(ce.length==0&&(window.addEventListener("blur",kt),window.addEventListener("focus",wt)),ce.push(t),t.addEventListener("touchstart",xt,{passive:!1}),t.addEventListener("mousedown",Lt,{passive:!1}),t.addEventListener("contextmenu",Tt,{passive:!1}),t.addEventListener("wheel",Et,{passive:!1}))}function en(...e){const t=n=>{n.removeEventListener("touchstart",xt),n.removeEventListener("mousedown",Lt),n.removeEventListener("contextmenu",Tt),n.removeEventListener("wheel",Et)};if(e.length==0){for(let n of ce)t(n);ce=[]}else for(let n of e){let i=ce.findIndex(r=>r===n);i!==-1&&(t(n),ce.splice(i,1))}ce.length==0&&(window.removeEventListener("blur",kt),window.removeEventListener("focus",wt))}function tn(e){let t,n,i,r,o,d,l="LOG";return{c(){t=A("div"),n=A("canvas"),i=F(),r=A("canvas"),o=F(),d=A("div"),d.textContent=l,this.h()},l(s){t=S(s,"DIV",{class:!0});var g=O(t);n=S(g,"CANVAS",{id:!0,class:!0}),O(n).forEach(H),i=j(g),r=S(g,"CANVAS",{id:!0,class:!0}),O(r).forEach(H),o=j(g),d=S(g,"DIV",{class:!0,"data-svelte-h":!0}),ue(d)!=="svelte-rtly9t"&&(d.textContent=l),g.forEach(H),this.h()},h(){I(n,"id","currentPath"),I(n,"class","svelte-1b93g54"),N(n,"disabled",e[0]),I(r,"id","canvas"),I(r,"class","svelte-1b93g54"),N(r,"disabled",e[0]),I(d,"class","log svelte-1b93g54"),I(t,"class","canvas-container svelte-1b93g54"),N(t,"hide",e[1])},m(s,g){se(s,t,g),C(t,n),e[12](n),C(t,i),C(t,r),e[13](r),C(t,o),C(t,d),e[14](d)},p(s,g){g[0]&1&&N(n,"disabled",s[0]),g[0]&1&&N(r,"disabled",s[0]),g[0]&2&&N(t,"hide",s[1])},i:he,o:he,d(s){s&&H(t),e[12](null),e[13](null),e[14](null)}}}const nn=2,sn=178;function ln(e,t,n){var i=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),r=Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2)),o=Math.sqrt(Math.pow(n.x-e.x,2)+Math.pow(n.y-e.y,2)),d=Math.acos((r*r+i*i-o*o)/(2*r*i));return d*(180/Math.PI)}function ct(e){if(e.points.length<4)return e;for(let t=1;t<e.points.length-2;t++){const n=e.points[t-1],i=e.points[t],r=e.points[t+1];ln(n,i,r)>sn&&(e.points.splice(t,1),t--)}return e}async function Xe(e,t){if(t.lineWidth=e.lineWidth,t.lineCap="round",t.strokeStyle=e.color,e.points.length<2){t.beginPath(),t.moveTo(e.points[0].x,e.points[0].y),t.lineTo(e.points[0].x,e.points[0].y),t.stroke();return}t.beginPath();let n=e.points[0].x,i=e.points[0].y;for(let r=0;r<e.points.length-1;r++)t.moveTo(n,i),n=(e.points[r].x+e.points[r+1].x)/2,i=(e.points[r].y+e.points[r+1].y)/2,t.quadraticCurveTo(e.points[r].x,e.points[r].y,n,i);t.stroke()}function on(e){return{x:ut(e.x),y:ut(e.y)}}function ut(e){const t=e.toFixed(nn);return Number(t)}function rn(e,t,n){let i;ie(e,ae,w=>n(25,i=w));let{radius:r=3}=t,{smoothness:o=0}=t,{stroke:d=5}=t,{color:l="#000000"}=t,{disabled:s=!1}=t,{hide:g=!1}=t,{tabID:h=""}=t;function D(){c.clearRect(0,0,V/p,Y/p),_=[]}function y(){if(_.length!=0){n(4,T.innerHTML="Undo",T),_.pop(),v.clearRect(0,0,V/p,Y/p);for(let w=0;w<_.length;w++)Xe(_[w],v);_e()}}let b,c,a,v,E={x:0,y:0},Y=0,V=0,p,X=!1,T,P,k,_=[];function x(){b&&($t(b),window.addEventListener("keydown",Re))}function Q(){b&&(en(b),window.removeEventListener("keydown",Re))}const te=(w,G,f,L)=>{var R=f-w,B=L-G;return Math.sqrt(R*R+B*B)},J=(w,G=300)=>{let f;return(...L)=>{clearTimeout(f),f=setTimeout(()=>{w.apply(void 0,L)},G)}};function Z(w,G){let f=b.getBoundingClientRect();return{x:w-f.left,y:G-f.top}}function $(){if(!b||!a)return;Ce(),p=window.devicePixelRatio;let w=b.getBoundingClientRect();Y=w.height*p,V=w.width*p,n(2,b.width=V,b),n(2,b.height=Y,b),n(3,a.width=V,a),n(3,a.height=Y,a),c.scale(p,p),v.scale(p,p);for(let G=0;G<_.length;G++)Xe(_[G],v)}function _e(){i[h]&&de(ae,i[h].paths=_.filter(w=>ct(w)),i)}function Se(){i[h]&&(_=i[h].paths,$())}function le(w,G){X=!0,E=Z(w,G),c.lineWidth=d,c.lineCap="round",c.strokeStyle=l,c.beginPath(),c.moveTo(E.x,E.y),c.stroke(),P={points:[],lineWidth:d,color:l}}function ne(w,G){if(!X)return;let f=Z(w,G);if(r>0){if(te(f.x,f.y,E.x,E.y)<=r){P.points.length===0&&(P.points.push(f),Xe(P,c));return}let L=Math.sqrt(f.x*f.x+f.y*f.y-2*f.x*E.x+E.x*E.x-2*f.y*E.y+E.y*E.y);if(f={x:f.x+r*((E.x-f.x)/L),y:f.y+r*((E.y-f.y)/L)},te(E.x,E.y,f.x,f.y)<=o)return}P.points.push(on(f)),c.clearRect(0,0,V/p,Y/p),Xe(P,c),E=f}function Ce(){X&&(_.push(ct(P)),Xe(P,v),c.clearRect(0,0,V/p,Y/p),_e()),X=!1}const Re=function(w){w.ctrlKey&&w.key=="z"&&y(),w.preventDefault()};et(()=>{c=b.getContext("2d"),c.imageSmoothingEnabled=!1,v=a.getContext("2d"),v.imageSmoothingEnabled=!1,b.addEventListener("gesture",w=>{switch(w.detail.name){case"left-click-drag-start":case"touch-drag-start":le(w.detail.x,w.detail.y);break;case"left-click-dragging":case"touch-dragging":w.detail.force>0&&n(4,T.innerHTML=w.detail.force,T),ne(w.detail.x,w.detail.y);break;case"left-click-drag-end":case"touch-drag-end":Ce();break;case"left-click":case"tap":le(w.detail.x,w.detail.y),ne(w.detail.x,w.detail.y),Ce();break}}),k=new ResizeObserver(J($,0)),k.observe(b),Se(),s?Q():x()}),Mt(()=>{k&&k.disconnect(),Q()});function ze(w){K[w?"unshift":"push"](()=>{a=w,n(3,a)})}function Ge(w){K[w?"unshift":"push"](()=>{b=w,n(2,b)})}function Ke(w){K[w?"unshift":"push"](()=>{T=w,n(4,T)})}return e.$$set=w=>{"radius"in w&&n(5,r=w.radius),"smoothness"in w&&n(6,o=w.smoothness),"stroke"in w&&n(7,d=w.stroke),"color"in w&&n(8,l=w.color),"disabled"in w&&n(0,s=w.disabled),"hide"in w&&n(1,g=w.hide),"tabID"in w&&n(9,h=w.tabID)},e.$$.update=()=>{e.$$.dirty[0]&1&&(s?Q():x())},[s,g,b,a,T,r,o,d,l,h,D,y,ze,Ge,Ke]}class an extends xe{constructor(t){super(),De(this,t,rn,tn,Le,{radius:5,smoothness:6,stroke:7,color:8,disabled:0,hide:1,tabID:9,clear:10,undo:11},null,[-1,-1])}get clear(){return this.$$.ctx[10]}get undo(){return this.$$.ctx[11]}}function Ue(e,{delay:t=0,duration:n=400,easing:i=Vt,axis:r="y"}={}){const o=getComputedStyle(e),d=+o.opacity,l=r==="y"?"height":"width",s=parseFloat(o[l]),g=r==="y"?["top","bottom"]:["left","right"],h=g.map(E=>`${E[0].toUpperCase()}${E.slice(1)}`),D=parseFloat(o[`padding${h[0]}`]),y=parseFloat(o[`padding${h[1]}`]),b=parseFloat(o[`margin${h[0]}`]),c=parseFloat(o[`margin${h[1]}`]),a=parseFloat(o[`border${h[0]}Width`]),v=parseFloat(o[`border${h[1]}Width`]);return{delay:t,duration:n,easing:i,css:E=>`overflow: hidden;opacity: ${Math.min(E*20,1)*d};${l}: ${E*s}px;padding-${g[0]}: ${E*D}px;padding-${g[1]}: ${E*y}px;margin-${g[0]}: ${E*b}px;margin-${g[1]}: ${E*c}px;border-${g[0]}-width: ${E*a}px;border-${g[1]}-width: ${E*v}px;`}}function dt(e){let t,n,i=`<span class="button-icon svelte-lafg0f" style="-webkit-mask: url(${W}/images/svg/undo.svg) no-repeat center / contain; mask: url(${W}/images/svg/undo.svg) no-repeat center / contain;"></span>`,r,o,d,l,s,g,h,D;return{c(){t=A("div"),n=A("button"),n.innerHTML=i,r=F(),o=A("input"),d=F(),l=A("input"),this.h()},l(y){t=S(y,"DIV",{class:!0});var b=O(t);n=S(b,"BUTTON",{class:!0,"data-svelte-h":!0}),ue(n)!=="svelte-1b4fip4"&&(n.innerHTML=i),r=j(b),o=S(b,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),d=j(b),l=S(b,"INPUT",{type:!0,class:!0}),b.forEach(H),this.h()},h(){I(n,"class","button svelte-lafg0f"),I(o,"type","range"),I(o,"min","2"),I(o,"max","20"),I(o,"step","2"),I(o,"class","slider svelte-lafg0f"),I(l,"type","color"),I(l,"class","color-picker svelte-lafg0f"),I(t,"class","pencil-tools svelte-lafg0f")},m(y,b){se(y,t,b),C(t,n),C(t,r),C(t,o),Be(o,e[0]),C(t,d),C(t,l),Be(l,e[1]),g=!0,h||(D=[ee(n,"click",function(){we(e[4])&&e[4].apply(this,arguments)}),ee(o,"change",e[9]),ee(o,"input",e[9]),ee(l,"input",e[10])],h=!0)},p(y,b){e=y,b&1&&Be(o,e[0]),b&2&&Be(l,e[1])},i(y){g||(y&&bt(()=>{g&&(s||(s=Ve(t,Ue,{duration:200,axis:"x"},!0)),s.run(1))}),g=!0)},o(y){y&&(s||(s=Ve(t,Ue,{duration:200,axis:"x"},!1)),s.run(0)),g=!1},d(y){y&&H(t),y&&s&&s.end(),h=!1,Fe(D)}}}function cn(e){let t,n,i=`<span class="button-icon svelte-lafg0f" style="-webkit-mask: url(${W}/images/svg/pencil.svg) no-repeat center / contain; mask: url(${W}/images/svg/pencil.svg) no-repeat center / contain;"></span>`,r,o,d=`<span class="button-icon svelte-lafg0f" style="-webkit-mask: url(${W}/images/svg/highlighter.svg) no-repeat center / contain; mask: url(${W}/images/svg/highlighter.svg) no-repeat center / contain;"></span>`,l,s,g,h,D,y=`<span class="button-icon svelte-lafg0f" style="-webkit-mask: url(${W}/images/svg/trash.svg) no-repeat center / contain; mask: url(${W}/images/svg/trash.svg) no-repeat center / contain;"></span>`,b,c,a,v,E,Y,V=`<span class="button-icon svelte-lafg0f" style="-webkit-mask: url(${W}/images/svg/user.svg) no-repeat center / contain; mask: url(${W}/images/svg/user.svg) no-repeat center / contain;"></span>`,p,X,T,P,k=(e[5].activeTool==="pencil"||e[5].activeTool==="highlighter")&&dt(e);return{c(){t=A("div"),n=A("button"),n.innerHTML=i,r=F(),o=A("button"),o.innerHTML=d,l=F(),k&&k.c(),s=F(),g=A("div"),h=F(),D=A("button"),D.innerHTML=y,b=F(),c=A("button"),a=A("span"),E=F(),Y=A("a"),Y.innerHTML=V,this.h()},l(_){t=S(_,"DIV",{class:!0});var x=O(t);n=S(x,"BUTTON",{class:!0,"data-svelte-h":!0}),ue(n)!=="svelte-t1zbc2"&&(n.innerHTML=i),r=j(x),o=S(x,"BUTTON",{class:!0,"data-svelte-h":!0}),ue(o)!=="svelte-113qxbd"&&(o.innerHTML=d),l=j(x),k&&k.l(x),s=j(x),g=S(x,"DIV",{class:!0}),O(g).forEach(H),h=j(x),D=S(x,"BUTTON",{class:!0,"data-svelte-h":!0}),ue(D)!=="svelte-cbr57k"&&(D.innerHTML=y),b=j(x),c=S(x,"BUTTON",{class:!0});var Q=O(c);a=S(Q,"SPAN",{class:!0,style:!0}),O(a).forEach(H),Q.forEach(H),E=j(x),Y=S(x,"A",{class:!0,href:!0,"data-svelte-h":!0}),ue(Y)!=="svelte-1xuhzhs"&&(Y.innerHTML=V),x.forEach(H),this.h()},h(){I(n,"class","pencil button svelte-lafg0f"),N(n,"selected",e[5].activeTool==="pencil"),I(o,"class","button svelte-lafg0f"),N(o,"selected",e[5].activeTool==="highlighter"),I(g,"class","spacer svelte-lafg0f"),I(D,"class","close button svelte-lafg0f"),I(a,"class","button-icon svelte-lafg0f"),tt(a,"-webkit-mask","url("+W+"/images/svg/refresh.svg) no-repeat center / contain"),tt(a,"mask","url("+W+"/images/svg/refresh.svg) no-repeat center / contain"),I(c,"class","refresh button svelte-lafg0f"),c.disabled=v=e[6].savingStatus==="saving",I(Y,"class","button svelte-lafg0f"),I(Y,"href",W+"/profile"),I(t,"class","toolbar-container svelte-lafg0f")},m(_,x){se(_,t,x),C(t,n),C(t,r),C(t,o),C(t,l),k&&k.m(t,null),C(t,s),C(t,g),C(t,h),C(t,D),C(t,b),C(t,c),C(c,a),C(t,E),C(t,Y),X=!0,T||(P=[ee(n,"click",e[7]),ee(o,"click",e[8]),ee(D,"click",function(){we(e[3])&&e[3].apply(this,arguments)}),ee(c,"click",function(){we(e[2])&&e[2].apply(this,arguments)})],T=!0)},p(_,[x]){e=_,(!X||x&32)&&N(n,"selected",e[5].activeTool==="pencil"),(!X||x&32)&&N(o,"selected",e[5].activeTool==="highlighter"),e[5].activeTool==="pencil"||e[5].activeTool==="highlighter"?k?(k.p(e,x),x&32&&q(k,1)):(k=dt(e),k.c(),q(k,1),k.m(t,s)):k&&(ke(),z(k,1,1,()=>{k=null}),Ee()),(!X||x&64&&v!==(v=e[6].savingStatus==="saving"))&&(c.disabled=v)},i(_){X||(q(k),_&&bt(()=>{X&&(p||(p=Ve(t,Ue,{duration:200},!0)),p.run(1))}),X=!0)},o(_){z(k),_&&(p||(p=Ve(t,Ue,{duration:200},!1)),p.run(0)),X=!1},d(_){_&&H(t),k&&k.d(),_&&p&&p.end(),T=!1,Fe(P)}}}function un(e,t,n){let i,r;ie(e,fe,c=>n(5,i=c)),ie(e,_t,c=>n(6,r=c));let{onRefresh:o=()=>{}}=t,{onClose:d=()=>{}}=t,{onDrawingUndo:l=()=>{}}=t,{stroke:s}=t,{color:g}=t;const h=()=>{de(fe,i.activeTool=i.activeTool==="pencil"?void 0:"pencil",i)},D=()=>{de(fe,i.activeTool=i.activeTool==="highlighter"?void 0:"highlighter",i)};function y(){s=Ht(this.value),n(0,s)}function b(){g=this.value,n(1,g)}return e.$$set=c=>{"onRefresh"in c&&n(2,o=c.onRefresh),"onClose"in c&&n(3,d=c.onClose),"onDrawingUndo"in c&&n(4,l=c.onDrawingUndo),"stroke"in c&&n(0,s=c.stroke),"color"in c&&n(1,g=c.color)},[s,g,o,d,l,i,r,h,D,y,b]}class dn extends xe{constructor(t){super(),De(this,t,un,cn,Le,{onRefresh:2,onClose:3,onDrawingUndo:4,stroke:0,color:1})}}function ft(e,t,n){const i=e.slice();return i[19]=t[n],i[20]=t,i[21]=n,i}function gt(e,t,n){const i=e.slice();return i[19]=t[n],i}function ht(e){let t,n,i,r;function o(s){e[13](s)}function d(s){e[14](s)}let l={onClose:e[10],onDrawingUndo:e[11],onRefresh:e[12]};return e[3]!==void 0&&(l.stroke=e[3]),e[0]!==void 0&&(l.color=e[0]),t=new dn({props:l}),K.push(()=>Ae(t,"stroke",o)),K.push(()=>Ae(t,"color",d)),{c(){ve(t.$$.fragment)},l(s){me(t.$$.fragment,s)},m(s,g){be(t,s,g),r=!0},p(s,g){const h={};g&16&&(h.onClose=s[10]),g&96&&(h.onDrawingUndo=s[11]),!n&&g&8&&(n=!0,h.stroke=s[3],He(()=>n=!1)),!i&&g&1&&(i=!0,h.color=s[0],He(()=>i=!1)),t.$set(h)},i(s){r||(q(t.$$.fragment,s),r=!0)},o(s){z(t.$$.fragment,s),r=!1},d(s){pe(t,s)}}}function fn(e){let t,n;return t=new St({}),{c(){ve(t.$$.fragment)},l(i){me(t.$$.fragment,i)},m(i,r){be(t,i,r),n=!0},p:he,i(i){n||(q(t.$$.fragment,i),n=!0)},o(i){z(t.$$.fragment,i),n=!1},d(i){pe(t,i)}}}function gn(e){let t,n,i=[],r=new Map,o,d,l=[],s=new Map,g,h=ye(Object.keys(e[8]));const D=c=>c[19];for(let c=0;c<h.length;c+=1){let a=gt(e,h,c),v=D(a);r.set(v,i[c]=vt(v,a))}let y=ye(Object.keys(e[8]));const b=c=>c[19];for(let c=0;c<y.length;c+=1){let a=ft(e,y,c),v=b(a);s.set(v,l[c]=mt(v,a))}return{c(){t=A("div"),n=A("div");for(let c=0;c<i.length;c+=1)i[c].c();o=F(),d=A("div");for(let c=0;c<l.length;c+=1)l[c].c();this.h()},l(c){t=S(c,"DIV",{class:!0});var a=O(t);n=S(a,"DIV",{class:!0});var v=O(n);for(let Y=0;Y<i.length;Y+=1)i[Y].l(v);v.forEach(H),o=j(a),d=S(a,"DIV",{class:!0});var E=O(d);for(let Y=0;Y<l.length;Y+=1)l[Y].l(E);E.forEach(H),a.forEach(H),this.h()},h(){I(n,"class","editor-container svelte-11mfkf2"),I(d,"class","drawing-container svelte-11mfkf2"),N(d,"disabled",e[1].activeTool===void 0),I(t,"class","canvas-container svelte-11mfkf2")},m(c,a){se(c,t,a),C(t,n);for(let v=0;v<i.length;v+=1)i[v]&&i[v].m(n,null);C(t,o),C(t,d);for(let v=0;v<l.length;v+=1)l[v]&&l[v].m(d,null);g=!0},p(c,a){a&320&&(h=ye(Object.keys(c[8])),ke(),i=Ze(i,a,D,1,c,h,r,n,$e,vt,null,gt),Ee()),a&366&&(y=ye(Object.keys(c[8])),ke(),l=Ze(l,a,b,1,c,y,s,d,$e,mt,null,ft),Ee()),(!g||a&2)&&N(d,"disabled",c[1].activeTool===void 0)},i(c){if(!g){for(let a=0;a<h.length;a+=1)q(i[a]);for(let a=0;a<y.length;a+=1)q(l[a]);g=!0}},o(c){for(let a=0;a<i.length;a+=1)z(i[a]);for(let a=0;a<l.length;a+=1)z(l[a]);g=!1},d(c){c&&H(t);for(let a=0;a<i.length;a+=1)i[a].d();for(let a=0;a<l.length;a+=1)l[a].d()}}}function vt(e,t){let n,i,r;return i=new Gt({props:{disabled:t[19]!==t[6],tabID:t[19]}}),{key:e,first:null,c(){n=Ne(),ve(i.$$.fragment),this.h()},l(o){n=Ne(),me(i.$$.fragment,o),this.h()},h(){this.first=n},m(o,d){se(o,n,d),be(i,o,d),r=!0},p(o,d){t=o;const l={};d&320&&(l.disabled=t[19]!==t[6]),d&256&&(l.tabID=t[19]),i.$set(l)},i(o){r||(q(i.$$.fragment,o),r=!0)},o(o){z(i.$$.fragment,o),r=!1},d(o){o&&H(n),pe(i,o)}}}function mt(e,t){let n,i,r=t[19],o,d,l;const s=()=>t[15](i,r),g=()=>t[15](null,r);function h(b){t[16](b)}function D(b){t[17](b)}let y={tabID:t[19],hide:t[19]!==t[6],disabled:t[19]!==t[6]||t[1].activeTool===void 0};return t[2]!==void 0&&(y.color=t[2]),t[3]!==void 0&&(y.stroke=t[3]),i=new an({props:y}),s(),K.push(()=>Ae(i,"color",h)),K.push(()=>Ae(i,"stroke",D)),{key:e,first:null,c(){n=Ne(),ve(i.$$.fragment),this.h()},l(b){n=Ne(),me(i.$$.fragment,b),this.h()},h(){this.first=n},m(b,c){se(b,n,c),be(i,b,c),l=!0},p(b,c){t=b,r!==t[19]&&(g(),r=t[19],s());const a={};c&256&&(a.tabID=t[19]),c&320&&(a.hide=t[19]!==t[6]),c&322&&(a.disabled=t[19]!==t[6]||t[1].activeTool===void 0),!o&&c&4&&(o=!0,a.color=t[2],He(()=>o=!1)),!d&&c&8&&(d=!0,a.stroke=t[3],He(()=>d=!1)),i.$set(a)},i(b){l||(q(i.$$.fragment,b),l=!0)},o(b){z(i.$$.fragment,b),l=!1},d(b){b&&H(n),g(),pe(i,b)}}}function hn(e){let t,n,i,r,o,d,l,s,g={};n=new qt({props:g}),e[9](n);let h=e[1].toolbarVisible&&e[1].order.length>0&&ht(e);const D=[gn,fn],y=[];function b(c,a){return c[7].currentUser&&!c[7].isLoading?0:1}return d=b(e),l=y[d]=D[d](e),{c(){t=A("div"),ve(n.$$.fragment),i=F(),r=A("div"),h&&h.c(),o=F(),l.c(),this.h()},l(c){t=S(c,"DIV",{class:!0});var a=O(t);me(n.$$.fragment,a),i=j(a),r=S(a,"DIV",{class:!0});var v=O(r);h&&h.l(v),v.forEach(H),o=j(a),l.l(a),a.forEach(H),this.h()},h(){I(r,"class","toolbar"),I(t,"class","page-container svelte-11mfkf2")},m(c,a){se(c,t,a),be(n,t,null),C(t,i),C(t,r),h&&h.m(r,null),C(t,o),y[d].m(t,null),s=!0},p(c,[a]){const v={};n.$set(v),c[1].toolbarVisible&&c[1].order.length>0?h?(h.p(c,a),a&2&&q(h,1)):(h=ht(c),h.c(),q(h,1),h.m(r,null)):h&&(ke(),z(h,1,1,()=>{h=null}),Ee());let E=d;d=b(c),d===E?y[d].p(c,a):(ke(),z(y[E],1,1,()=>{y[E]=null}),Ee(),l=y[d],l?l.p(c,a):(l=y[d]=D[d](c),l.c()),q(l,1),l.m(t,null))},i(c){s||(q(n.$$.fragment,c),q(h),q(l),s=!0)},o(c){z(n.$$.fragment,c),z(h),z(l),s=!1},d(c){c&&H(t),e[9](null),pe(n),h&&h.d(),y[d].d()}}}function vn(e,t){var n=parseInt(e.slice(1,3),16),i=parseInt(e.slice(3,5),16),r=parseInt(e.slice(5,7),16);return"rgba("+n+", "+i+", "+r+", "+t+")"}function mn(e,t,n){let i,r,o,d,l;ie(e,fe,T=>n(1,r=T)),ie(e,pt,T=>n(18,o=T)),ie(e,_t,T=>n(7,d=T)),ie(e,ae,T=>n(8,l=T));let s="#000000",g="rgba(0, 0, 0, 1)",h=10,D,y={};fe.subscribe(T=>{if(T.activeTool==="highlighter")n(0,s="#ffdd33");else if(T.activeTool==="pencil"){const P=Rt.find(k=>k.name===o.theme);P&&n(0,s=P.caret)}});function b(T){K[T?"unshift":"push"](()=>{D=T,n(4,D)})}const c=()=>D.closeActiveTab(),a=()=>y[i].undo(),v=()=>At.loadFromFirestore();function E(T){h=T,n(3,h)}function Y(T){s=T,n(0,s)}function V(T,P){K[T?"unshift":"push"](()=>{y[P]=T,n(5,y)})}function p(T){g=T,n(2,g),n(1,r),n(0,s)}function X(T){h=T,n(3,h)}return e.$$.update=()=>{e.$$.dirty&2&&n(6,i=r.order[r.activeIndex]),e.$$.dirty&3&&n(2,g=r.activeTool==="highlighter"?vn(s,.3):s)},[s,r,g,h,D,y,i,d,l,b,c,a,v,E,Y,V,p,X]}class xn extends xe{constructor(t){super(),De(this,t,mn,hn,Le,{})}}export{xn as component};
