import{s as H,v as W,w as B,x as G,y as K,c as h,n as M,o as se,a as F,d as ae}from"../chunks/scheduler.CIGC0wka.js";import{S as j,i as x,H as ne,s as L,D as re,h as O,j as C,a as w,t as E,g as d,e as k,c as T,v as oe,w as y,A as _,p as Q,E as ie,q as X,k as I,r as Y,u as Z,d as R}from"../chunks/index.Dl2TOe6M.js";import{s as $,a as v,c as le,d as U,e as V,g as ce,h as ue,b as q,f as me}from"../chunks/firebaseStore.DKlrhaPz.js";import{t as z,a as J,m as fe}from"../chunks/tabsStore.6AqkvJqk.js";import{g as de}from"../chunks/entry.Czyx2gTZ.js";import{b as P}from"../chunks/paths.C2n6Hu4f.js";import{t as pe}from"../chunks/themes.BTx5Q4mv.js";const he=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global,ge=!0,_e="always",Oe=Object.freeze(Object.defineProperty({__proto__:null,prerender:ge,trailingSlash:_e},Symbol.toStringTag,{value:"Module"}));function be(n){let e,r,t;const o=n[3].default,s=W(o,n,n[2],null);return{c(){e=new ne(!1),r=L(),s&&s.c(),this.h()},l(a){e=re(a,!1),r=O(a),s&&s.l(a),this.h()},h(){e.a=r},m(a,i){e.m(n[0],a,i),C(a,r,i),s&&s.m(a,i),t=!0},p(a,[i]){(!t||i&1)&&e.p(a[0]),s&&s.p&&(!t||i&4)&&B(s,o,a,a[2],t?K(o,a[2],i,null):G(a[2]),null)},i(a){t||(w(s,a),t=!0)},o(a){E(s,a),t=!1},d(a){a&&(e.d(),d(r)),s&&s.d(a)}}}function ve(n,e,r){let t,o;h(n,$,c=>r(1,o=c));let{$$slots:s={},$$scope:a}=e;function i(c){const u=pe.find(p=>p.name===c);return u?`<style>
    :root {
    --bg: ${u.bg};
    --bg-alt: ${u.bgAlt};
    --main: ${u.main};
    --caret: ${u.caret};
    --error: ${u.error};
    --sub: ${u.sub};
    --text: ${u.text};
    }
    </style>`:""}return n.$$set=c=>{"$$scope"in c&&r(2,a=c.$$scope)},n.$$.update=()=>{n.$$.dirty&2&&r(0,t=i(o.theme))},[t,o,a,s]}class ye extends j{constructor(e){super(),x(this,e,ve,be,H,{})}}function Se(n){let e,r=`<span class="status-icon svelte-1mx6eh7" style="-webkit-mask: url(${P}/images/svg/double-checkmark.svg) no-repeat center / contain; mask: url(${P}/images/svg/double-checkmark.svg) no-repeat center / contain;"></span>`;return{c(){e=k("div"),e.innerHTML=r,this.h()},l(t){e=T(t,"DIV",{class:!0,"data-svelte-h":!0}),oe(e)!=="svelte-jbp3id"&&(e.innerHTML=r),this.h()},h(){y(e,"class","status svelte-1mx6eh7"),_(e,"saving",n[0].savingStatus==="saving"),_(e,"saved",n[0].savingStatus==="saved"),_(e,"error",n[0].savingStatus==="error")},m(t,o){C(t,e,o)},p(t,[o]){o&1&&_(e,"saving",t[0].savingStatus==="saving"),o&1&&_(e,"saved",t[0].savingStatus==="saved"),o&1&&_(e,"error",t[0].savingStatus==="error")},i:M,o:M,d(t){t&&d(e)}}}function $e(n,e,r){let t;return h(n,v,o=>r(0,t=o)),[t]}class we extends j{constructor(e){super(),x(this,e,$e,Se,H,{})}}const{document:N}=he;function Ee(n){let e,r,t,o,s;const a=n[3].default,i=W(a,n,n[5],null);return o=new we({}),{c(){e=k("div"),i&&i.c(),r=L(),t=k("div"),Q(o.$$.fragment),this.h()},l(c){e=T(c,"DIV",{class:!0});var u=R(e);i&&i.l(u),r=O(u),t=T(u,"DIV",{class:!0});var p=R(t);X(o.$$.fragment,p),p.forEach(d),u.forEach(d),this.h()},h(){y(t,"class","sync-status svelte-s472a6"),y(e,"class","layout-container svelte-s472a6")},m(c,u){C(c,e,u),i&&i.m(e,null),I(e,r),I(e,t),Y(o,t,null),n[4](e),s=!0},p(c,u){i&&i.p&&(!s||u&32)&&B(i,a,c,c[5],s?K(a,c[5],u,null):G(c[5]),null)},i(c){s||(w(i,c),w(o.$$.fragment,c),s=!0)},o(c){E(i,c),E(o.$$.fragment,c),s=!1},d(c){c&&d(e),i&&i.d(c),Z(o),n[4](null)}}}function ke(n){let e,r,t,o;return t=new ye({props:{$$slots:{default:[Ee]},$$scope:{ctx:n}}}),{c(){e=k("meta"),r=L(),Q(t.$$.fragment),this.h()},l(s){const a=ie("svelte-1xk05yi",N.head);e=T(a,"META",{name:!0,content:!0}),a.forEach(d),r=O(s),X(t.$$.fragment,s),this.h()},h(){y(e,"name","viewport"),y(e,"content","width=device-width, user-scalable=0, initial-scale=1.0, maximum-scale=1.0, viewport-fit=cover")},m(s,a){I(N.head,e),C(s,r,a),Y(t,s,a),o=!0},p(s,[a]){const i={};a&33&&(i.$$scope={dirty:a,ctx:s}),t.$set(i)},i(s){o||(w(t.$$.fragment,s),o=!0)},o(s){E(t.$$.fragment,s),o=!1},d(s){s&&d(r),d(e),Z(t,s)}}}function Te(){switch(screen.orientation.type){case"portrait-primary":document.documentElement.style.setProperty("--safe-area-top","env(safe-area-inset-top)"),document.documentElement.style.setProperty("--safe-area-left","0px"),document.documentElement.style.setProperty("--safe-area-right","0px");break;case"landscape-primary":document.documentElement.style.setProperty("--safe-area-top","0px"),document.documentElement.style.setProperty("--safe-area-left","env(safe-area-inset-left)"),document.documentElement.style.setProperty("--safe-area-right","0px");break;case"landscape-secondary":document.documentElement.style.setProperty("--safe-area-top","0px"),document.documentElement.style.setProperty("--safe-area-left","0px"),document.documentElement.style.setProperty("--safe-area-right","env(safe-area-inset-right)");break}}function Pe(n,e,r){let t,o,s,a,i;h(n,$,l=>r(7,t=l)),h(n,q,l=>r(8,o=l)),h(n,v,l=>r(2,s=l)),h(n,fe,l=>r(9,a=l)),h(n,z,l=>r(10,i=l));let{$$slots:c={},$$scope:u}=e,p=!0,D;function A(){if(p)return;let l={};Object.entries(i).forEach(([f,m])=>{l[f]=JSON.stringify(m)});const b={activeIndex:a.activeIndex,settings:t,tabs:l};v.update(f=>({...f,data:b})),me.publish()}z.subscribe(A),$.subscribe(A);function ee(l){l&&Object.entries(l).forEach(([b,f])=>{try{J.newTabFromString(b,f)}catch(m){console.warn("Failed to parse tab!",f,m);return}})}let S=!1;se(()=>{screen.orientation.addEventListener("change",Te),le.onAuthStateChanged(async l=>{if(!l){v.update(g=>({...g,isLoading:!1,currentUser:l})),r(1,S=!0);return}const b=U(V,"users",l.uid),f=await ce(b);let m={tabs:{},activeIndex:0,settings:{theme:"Canvas",spellCheck:!0}};if(f.exists())console.log("Fetching firestore user doc..."),m=f.data();else{console.log("Creating firestore user doc...");const g=U(V,"users",l.uid);await ue(g,m,{merge:!0})}ee(m.tabs),J.setActiveIndex(m.activeIndex),F($,t=m.settings,t),v.update(g=>({...g,isLoading:!1,currentUser:l,data:m})),r(1,S=!0),p=!1})});function te(l){ae[l?"unshift":"push"](()=>{D=l,r(0,D)})}return n.$$set=l=>{"$$scope"in l&&r(5,u=l.$$scope)},n.$$.update=()=>{n.$$.dirty&6&&!s.currentUser&&S&&(F(q,o=window.location.pathname.slice(P.length),o),de(P+"/login"))},[D,S,s,c,te,u]}class Ae extends j{constructor(e){super(),x(this,e,Pe,ke,H,{})}}export{Ae as component,Oe as universal};
