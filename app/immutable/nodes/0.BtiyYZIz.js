import{s as T,d as E,u as I,g as k,e as x,c as A,o as C}from"../chunks/scheduler.CdDHOodP.js";import{S as F,i as L,e as _,s as M,B as U,c as h,d as f,f as j,a as v,w as p,h as b,g as y,n as O,l as R}from"../chunks/index.BdLLFpJ9.js";import{b as V,f as g,d as S,c as w,g as q,s as z}from"../chunks/firebaseStore.B73rKN3v.js";import{t as D}from"../chunks/tabsStore.DNrclrNc.js";import{g as B}from"../chunks/entry.PTr-rEKu.js";import{b as H}from"../chunks/paths.CYZ_8d8l.js";const P=!0,$="always",Z=Object.freeze(Object.defineProperty({__proto__:null,prerender:P,trailingSlash:$},Symbol.toStringTag,{value:"Module"}));function G(r){let o,n,s,c,i;const m=r[3].default,t=E(m,r,r[2],null);return{c(){o=_("meta"),n=M(),s=_("div"),c=_("div"),t&&t.c(),this.h()},l(e){const a=U("svelte-1xk05yi",document.head);o=h(a,"META",{name:!0,content:!0}),a.forEach(f),n=j(e),s=h(e,"DIV",{class:!0});var u=v(s);c=h(u,"DIV",{class:!0});var l=v(c);t&&t.l(l),l.forEach(f),u.forEach(f),this.h()},h(){p(o,"name","viewport"),p(o,"content","width=device-width, user-scalable=0, initial-scale=1.0, maximum-scale=1.0, viewport-fit=cover"),p(c,"class","content svelte-hkf4i9"),p(s,"class","container svelte-hkf4i9")},m(e,a){b(document.head,o),y(e,n,a),y(e,s,a),b(s,c),t&&t.m(c,null),i=!0},p(e,[a]){t&&t.p&&(!i||a&4)&&I(t,m,e,e[2],i?x(m,e[2],a,null):k(e[2]),null)},i(e){i||(O(t,e),i=!0)},o(e){R(t,e),i=!1},d(e){e&&(f(n),f(s)),f(o),t&&t.d(e)}}}function J(r,o,n){let s;A(r,g,e=>n(1,s=e));let{$$slots:c={},$$scope:i}=o;function m(e){e.length!==0&&e.forEach(a=>{try{D.newTabFromString(a)}catch(u){console.warn("Failed to parse tab!",a,u);return}})}let t=!1;return C(()=>{V.onAuthStateChanged(async e=>{if(!e){g.update(d=>({...d,isLoading:!1,currentUser:e})),n(0,t=!0);return}const a=S(w,"users",e.uid),u=await q(a);let l={tabs:[],activeIndex:0};if(u.exists())console.log("Fetching firestore user doc..."),l=u.data();else{console.log("Creating firestore user doc...");const d=S(w,"users",e.uid);await z(d,l,{merge:!0})}m(l.tabs),D.setActiveIndex(l.activeIndex),g.update(d=>({...d,isLoading:!1,currentUser:e,data:l})),n(0,t=!0)})}),r.$$set=e=>{"$$scope"in e&&n(2,i=e.$$scope)},r.$$.update=()=>{r.$$.dirty&3&&!s.currentUser&&t&&B(H+"/login")},[t,s,i,c]}class ee extends F{constructor(o){super(),L(this,o,J,G,T,{})}}export{ee as component,Z as universal};
