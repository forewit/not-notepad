const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/quill.Bk4jDS0q.js","../chunks/core.CG__ofcG.js"])))=>i.map(i=>d[i]);
var wt=Object.defineProperty;var kt=(e,t,n)=>t in e?wt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var U=(e,t,n)=>kt(e,typeof t!="symbol"?t+"":t,n);import{s as _e,n as ge,r as Ue,i as Ee,c as re,o as Qe,d as J,A as Et,B as He,a as ue,C as Tt,e as Je}from"../chunks/scheduler.CE28Mlnp.js";import{S as Le,i as xe,e as H,t as Lt,c as A,a as O,b as xt,d as Y,w as C,A as q,g as oe,h as I,x as te,F as Ke,j as Dt,s as z,p as me,f as G,v as ve,q as pe,r as be,o as Ae,m as Se,n as F,l as K,u as ye,G as Re,z as Ze,I as Ne,C as Be,J as Ct,K as It}from"../chunks/index.CblOyuwr.js";import{e as $e,u as Pt,o as Mt,t as Yt}from"../chunks/themes.CBFgFqeR.js";import{b as W}from"../chunks/paths.DvnvJdTI.js";import{m as fe,t as de,d as ae,s as ft,a as gt,f as Xt}from"../chunks/firebaseStore.CepNM4F1.js";import{_ as et}from"../chunks/preload-helper.D6kgxu3v.js";import{P as Ht}from"../chunks/ProgressBar.Cdh5Uk4U.js";function At(e){let t,n,i,l,o,d;return{c(){t=H("div"),n=H("button"),i=H("span"),l=Lt(e[0]),this.h()},l(r){t=A(r,"DIV",{class:!0});var s=O(t);n=A(s,"BUTTON",{class:!0,draggable:!0});var g=O(n);i=A(g,"SPAN",{class:!0});var c=O(i);l=xt(c,e[0]),c.forEach(Y),g.forEach(Y),s.forEach(Y),this.h()},h(){C(i,"class","title svelte-1jmw20r"),C(n,"class","tab svelte-1jmw20r"),C(n,"draggable","true"),q(n,"active",e[1]),C(t,"class","tab-container svelte-1jmw20r"),q(t,"preventHover",e[2])},m(r,s){oe(r,t,s),I(t,n),I(n,i),I(i,l),o||(d=[te(n,"mousedown",Ke(function(){Ee(e[3])&&e[3].apply(this,arguments)})),te(n,"touchstart",Ke(function(){Ee(e[3])&&e[3].apply(this,arguments)})),te(n,"dragstart",Ke(function(){Ee(e[4])&&e[4].apply(this,arguments)}))],o=!0)},p(r,[s]){e=r,s&1&&Dt(l,e[0]),s&2&&q(n,"active",e[1]),s&4&&q(t,"preventHover",e[2])},i:ge,o:ge,d(r){r&&Y(t),o=!1,Ue(d)}}}function St(e,t,n){let{title:i=""}=t,{active:l=!1}=t,{preventHover:o=!1}=t,{onPointerdown:d=s=>{}}=t,{onDragstart:r=s=>{}}=t;return e.$$set=s=>{"title"in s&&n(0,i=s.title),"active"in s&&n(1,l=s.active),"preventHover"in s&&n(2,o=s.preventHover),"onPointerdown"in s&&n(3,d=s.onPointerdown),"onDragstart"in s&&n(4,r=s.onDragstart)},[i,l,o,d,r]}class ht extends Le{constructor(t){super(),xe(this,t,St,At,_e,{title:0,active:1,preventHover:2,onPointerdown:3,onDragstart:4})}}function he(e){return e<.5?4*e*e*e:.5*Math.pow(2*e-2,3)+1}function Rt(e){const t=e-1;return t*t*t+1}const tt=(e,t)=>{const{duration:n=300,easing:i=he,onEnd:l=()=>{},onStep:o=()=>{},css:d}=t;let r;function s(g){if(!e){console.warn("Cannot find element to animate");return}r===void 0&&(r=g);const c=i((g-r)/n),E=1-c;c<1?(e.style.cssText=d(c,E),o(c,E),requestAnimationFrame(s)):(e.style.cssText="",l())}requestAnimationFrame(s)},je=e=>{const{duration:t=300,easing:n=he,onEnd:i=()=>{},onStep:l=()=>{}}=e;let o;function d(r){o===void 0&&(o=r);const s=n((r-o)/t),g=1-s;s<1?(l(s,g),requestAnimationFrame(d)):i()}requestAnimationFrame(d)};function nt(e,t,n){const i=e.slice();return i[41]=t[n],i[42]=t,i[43]=n,i}function it(e,t){let n,i,l,o,d=t[43],r,s,g;function c(...h){return t[17](t[43],...h)}function E(h){t[18](h,t[41])}let _={active:t[9]==t[41],preventHover:t[8],onPointerdown:c,onDragstart:t[14]};t[11][t[41]].title!==void 0&&(_.title=t[11][t[41]].title),i=new ht({props:_}),J.push(()=>Re(i,"title",E));const w=()=>t[19](n,d),f=()=>t[19](null,d);return{key:e,first:null,c(){n=H("div"),me(i.$$.fragment),o=z(),this.h()},l(h){n=A(h,"DIV",{class:!0});var b=O(n);pe(i.$$.fragment,b),o=G(b),b.forEach(Y),this.h()},h(){C(n,"class","tab-container svelte-17fp8fv"),q(n,"placeholder",t[10]==t[41]),this.first=n},m(h,b){oe(h,n,b),be(i,n,null),I(n,o),w(),r=!0,s||(g=Et(t[13].call(null,n)),s=!0)},p(h,b){t=h;const k={};b[0]&514&&(k.active=t[9]==t[41]),b[0]&256&&(k.preventHover=t[8]),b[0]&2&&(k.onPointerdown=c),!l&&b[0]&2050&&(l=!0,k.title=t[11][t[41]].title,He(()=>l=!1)),i.$set(k),d!==t[43]&&(f(),d=t[43],w()),(!r||b[0]&1026)&&q(n,"placeholder",t[10]==t[41])},i(h){r||(F(i.$$.fragment,h),r=!0)},o(h){K(i.$$.fragment,h),r=!1},d(h){h&&Y(n),ye(i),f(),s=!1,g()}}}function Bt(e){let t,n,i,l=[],o=new Map,d,r,s,g=`<span class="button-icon svelte-17fp8fv" style="-webkit-mask: url(${W}/images/svg/plus.svg) no-repeat center / contain; mask: url(${W}/images/svg/plus.svg) no-repeat center / contain;"></span>`,c,E,_,w=`<span class="button-icon svelte-17fp8fv" style="-webkit-mask: url(${W}/images/svg/gear.svg) no-repeat center / contain; mask: url(${W}/images/svg/gear.svg) no-repeat center / contain;"></span>`,f,h,b,k,S,B,v,M,X=$e(e[1].order);const L=p=>p[41];for(let p=0;p<X.length;p+=1){let y=nt(e,X,p),x=L(y);o.set(x,l[p]=it(x,y))}return b=new ht({props:{title:e[4],active:!e[6],preventHover:!0}}),{c(){t=H("div"),n=H("div"),i=H("div");for(let p=0;p<l.length;p+=1)l[p].c();d=z(),r=H("div"),s=H("button"),s.innerHTML=g,c=z(),E=H("div"),_=H("button"),_.innerHTML=w,f=z(),h=H("div"),me(b.$$.fragment),k=z(),S=H("div"),this.h()},l(p){t=A(p,"DIV",{class:!0});var y=O(t);n=A(y,"DIV",{class:!0});var x=O(n);i=A(x,"DIV",{class:!0});var Z=O(i);for(let $=0;$<l.length;$+=1)l[$].l(Z);Z.forEach(Y),d=G(x),r=A(x,"DIV",{class:!0});var ne=O(r);s=A(ne,"BUTTON",{class:!0,"data-svelte-h":!0}),ve(s)!=="svelte-g0ls06"&&(s.innerHTML=g),ne.forEach(Y),c=G(x),E=A(x,"DIV",{class:!0});var j=O(E);_=A(j,"BUTTON",{class:!0,"data-svelte-h":!0}),ve(_)!=="svelte-4x2iay"&&(_.innerHTML=w),j.forEach(Y),f=G(x),h=A(x,"DIV",{class:!0});var Q=O(h);pe(b.$$.fragment,Q),Q.forEach(Y),x.forEach(Y),k=G(y),S=A(y,"DIV",{class:!0}),O(S).forEach(Y),y.forEach(Y),this.h()},h(){C(i,"class","tabs svelte-17fp8fv"),C(s,"class","button svelte-17fp8fv"),C(r,"class","new-tab-container svelte-17fp8fv"),C(_,"class","button svelte-17fp8fv"),C(E,"class","buttons-container svelte-17fp8fv"),C(h,"class","clone svelte-17fp8fv"),q(h,"dragging",e[0]),C(n,"class","tabbar svelte-17fp8fv"),C(S,"class","divider svelte-17fp8fv"),C(t,"class","svelte-17fp8fv")},m(p,y){oe(p,t,y),I(t,n),I(n,i);for(let x=0;x<l.length;x+=1)l[x]&&l[x].m(i,null);e[20](i),I(n,d),I(n,r),I(r,s),I(n,c),I(n,E),I(E,_),I(n,f),I(n,h),be(b,h,null),e[22](h),I(t,k),I(t,S),e[23](t),B=!0,v||(M=[te(s,"click",e[12]),te(_,"click",e[21])],v=!0)},p(p,y){y[0]&53002&&(X=$e(p[1].order),Ae(),l=Pt(l,y,L,1,p,X,o,i,Mt,it,null,nt),Se());const x={};y[0]&16&&(x.title=p[4]),y[0]&64&&(x.active=!p[6]),b.$set(x),(!B||y[0]&1)&&q(h,"dragging",p[0])},i(p){if(!B){for(let y=0;y<X.length;y+=1)F(l[y]);F(b.$$.fragment,p),B=!0}},o(p){for(let y=0;y<l.length;y+=1)K(l[y]);K(b.$$.fragment,p),B=!1},d(p){p&&Y(t);for(let y=0;y<l.length;y+=1)l[y].d();e[20](null),ye(b),e[22](null),e[23](null),v=!1,Ue(M)}}}const Vt=12,Ve=200,Me=32,Ye=200,Nt=1600,st=.3;function Ot(e,t,n){let i,l,o,d;re(e,fe,m=>n(1,o=m)),re(e,de,m=>n(11,d=m));const r=()=>{y(o.order[o.activeIndex])};let s,g=[],c=0,E=null,_=-1,w="",f,h,b,k=!1,S=!1,B=0,v=0,M,X=!1;const L=(m,D=300)=>{let R;return(...N)=>{clearTimeout(R),R=setTimeout(()=>{m.apply(void 0,N)},D)}};function p(){ae.newTab()}const y=m=>{const D=o.order.findIndex(R=>R===m);if(D<0||!g[D]){console.warn("Cannot close tab!");return}c=g[D].getBoundingClientRect().width,D<o.order.length-1&&(s.style.setProperty("--tab-max-width",`${c}px`),x()),D==o.activeIndex&&(D==o.order.length-1?ae.setActiveIndex(D-1):ae.setActiveIndex(D+1)),je({duration:Ye,easing:he,onStep:(R,N)=>{D==0?n(2,s.style.gridTemplateColumns=`minmax(${N*Me}px, ${N*c}px)`,s):n(2,s.style.gridTemplateColumns=`repeat(${D}, minmax(var(--tab-min-width), var(--tab-max-width))) minmax(${N*Me}px, ${N*c}px)`,s)},onEnd:()=>{n(2,s.style.gridTemplateColumns="",s),ae.removeTab(m)}})},x=L(()=>{s&&(s.style.setProperty("--tab-max-width",`${Ve}px`),je({duration:Ye,easing:he,onStep:(m,D)=>{s.style.setProperty("--tab-max-width",`${c+m*(Ve-c)}px`)},onEnd:()=>{s.style.setProperty("--tab-max-width",`${Ve}px`)}}))},Nt);function Z(m){if(!s)return;const D=m.getBoundingClientRect().width;je({duration:Ye,easing:he,onStep:(R,N)=>{o.order.length==1?n(2,s.style.gridTemplateColumns=`minmax(${R*Me}px, ${R*D}px)`,s):n(2,s.style.gridTemplateColumns=`repeat(${o.order.length-1}, minmax(var(--tab-min-width), var(--tab-max-width))) minmax(${R*Me}px, ${R*D}px)`,s),n(2,s.scrollLeft=s.scrollWidth,s)},onEnd:()=>{n(2,s.style.gridTemplateColumns="",s)}})}const ne=(m,D)=>{const R=g[0].getBoundingClientRect().width;ae.moveTab(m,D,()=>{if(m>D)for(let N=D;N<m;N++)tt(g[N],{duration:Ye,easing:he,css:(Ie,le)=>`transform: translateX(-${le*R}px);`});if(m<D)for(let N=D;N>m;N--)tt(g[N],{duration:Ye,easing:he,css:(Ie,le)=>`transform: translateX(${le*R}px);`})})};function j(m){!m.target||!m.dataTransfer||(m.dataTransfer.setData("text/plain",i),m.dataTransfer.setDragImage(new Image,0,0))}function Q(m,D){if(m==0&&D==0){n(5,b.style.left="-1000px",b),n(5,b.style.top="-1000px",b);return}let R=M.getBoundingClientRect();if(m<R.left||m>R.right||D<R.top||D>R.bottom){S||(v=0),n(5,b.style.left=`${m+B}px`,b),n(5,b.style.top=`${D-h.height/2}px`,b),n(6,S=!0);return}S&&n(6,S=!1),n(5,b.style.left=`${m+B}px`,b),n(5,b.style.top=`${h.top}px`,b);const N=-s.scrollLeft,Ie=g[0].getBoundingClientRect().width;let le=-1;if(m>N+o.order.length*Ie)le=o.order.length-1;else for(let Pe=0;Pe<o.order.length;Pe++)if(m>N+Pe*Ie&&m<N+(Pe+1)*Ie){le=Pe;break}m<20?(v=-st,requestAnimationFrame(we)):m>s.clientWidth-10?(v=st,requestAnimationFrame(we)):v=0,!(le==-1||le==o.placeholderIndex)&&ne(o.placeholderIndex,le)}let $=0;function we(m){if(!k||v==0){$=0;return}$==0&&($=m);const D=m-$;$=m,s.scrollBy({left:v*D}),requestAnimationFrame(we)}function De(m,D){if(!m.target)return;let R,N;m instanceof TouchEvent?(R=m.touches[0].clientX,N=m.touches[0].clientY):(R=m.clientX,N=m.clientY),window.addEventListener("touchmove",se,{passive:!1}),window.addEventListener("touchend",ie),window.addEventListener("mousemove",se),window.addEventListener("mouseup",ie),window.addEventListener("drag",se),window.addEventListener("dragend",ie),window.addEventListener("blur",ie),ae.setActiveIndex(D),f=m.target,h=f.getBoundingClientRect(),E=[R,N],B=h.left-R,h.top-N,n(5,b.style.width=`${h.width}px`,b),n(5,b.style.left=`${h.left}px`,b),n(5,b.style.top=`${h.top}px`,b),_=D,n(4,w=d[o.order[D]].title)}function se(m){let D,R;if(m instanceof TouchEvent?(D=m.touches[0].clientX,R=m.touches[0].clientY,m.preventDefault()):(D=m.clientX,R=m.clientY),k){Q(D,R);return}E===null||Math.hypot(E[0]-D,E[1]-R)<Vt||(n(0,k=!0),ae.setPlaceholderIndex(_),ae.setActiveIndex(_))}function ie(){window.removeEventListener("touchmove",se),window.removeEventListener("touchend",ie),window.removeEventListener("mousemove",se),window.removeEventListener("mouseup",ie),window.removeEventListener("drag",se),window.removeEventListener("dragend",ie),window.removeEventListener("blur",ie),E=null,n(6,S=!1),_=-1,B=0,ae.setPlaceholderIndex(),n(0,k=!1)}Qe(()=>{s.style.setProperty("--tab-max-width",`${Ve}px`),s.style.setProperty("--tab-min-width",`${Me}px`)});const ze=(m,D)=>De(D,m);function Ge(m,D){e.$$.not_equal(d[D].title,m)&&(d[D].title=m,de.set(d))}function T(m,D){J[m?"unshift":"push"](()=>{g[D]=m,n(3,g)})}function ee(m){J[m?"unshift":"push"](()=>{s=m,n(2,s)})}const V=()=>{ue(fe,o.toolbarVisible=!o.toolbarVisible,o),o.toolbarVisible||ue(fe,o.activeTool=void 0,o)};function ke(m){J[m?"unshift":"push"](()=>{b=m,n(5,b)})}function Ce(m){J[m?"unshift":"push"](()=>{M=m,n(7,M)})}return e.$$.update=()=>{e.$$.dirty[0]&2&&n(9,i=o.order[o.activeIndex]),e.$$.dirty[0]&2&&n(10,l=o.order[o.placeholderIndex]),e.$$.dirty[0]&1&&(k?n(8,X=!0):setTimeout(()=>n(8,X=!1),20))},[k,o,s,g,w,b,S,M,X,i,l,d,p,Z,j,De,r,ze,Ge,T,ee,V,ke,Ce]}class Ut extends Le{constructor(t){super(),xe(this,t,Ot,Bt,_e,{closeActiveTab:16},null,[-1,-1])}get closeActiveTab(){return this.$$.ctx[16]}}function Ft(e){let t,n;return{c(){t=H("div"),n=H("div"),this.h()},l(i){t=A(i,"DIV",{class:!0});var l=O(t);n=A(l,"DIV",{class:!0}),O(n).forEach(Y),l.forEach(Y),this.h()},h(){C(n,"class","quill-editor"),C(t,"class","quill-editor-container svelte-16m16ue"),q(t,"disabled",e[0])},m(i,l){oe(i,t,l),I(t,n),e[5](n)},p(i,[l]){l&1&&q(t,"disabled",i[0])},i:ge,o:ge,d(i){i&&Y(t),e[5](null)}}}function qt(e,t,n){let i,l;re(e,de,v=>n(6,i=v)),re(e,ft,v=>n(4,l=v));let{tabID:o}=t,{disabled:d=!1}=t,r,s;const g=(v,M=300)=>{let X;return(...L)=>{clearTimeout(X),X=setTimeout(()=>{v.apply(void 0,L)},M)}};async function c(v){var p,y,x,Z;if(!r)return;const{Delta:M,Range:X}=await et(async()=>{const{Delta:ne,Range:j}=await import("../chunks/core.CG__ofcG.js").then(Q=>Q.G);return{Delta:ne,Range:j}},[],import.meta.url);if(v.undo.length>0)for(var L=0;L<v.undo.length;L++){const ne=(p=v.undo[L].range)==null?void 0:p.index,j=(y=v.undo[L].range)==null?void 0:y.length,Q={delta:new M(v.undo[L].delta.ops),range:ne!==void 0&&j!==void 0?new X(ne,j):null};r.history.stack.undo.push(Q)}if(v.redo.length>0)for(var L=0;L<v.redo.length;L++){const j=(x=v.redo[L].range)==null?void 0:x.index,Q=(Z=v.redo[L].range)==null?void 0:Z.length,$={delta:new M(v.redo[L].delta.ops),range:j!==void 0&&Q!==void 0?new X(j,Q):null};r.history.stack.redo.push($)}}function E(v){var M;r&&((M=r.getSelection())==null?void 0:M.length)===0&&window.open(v.target.href,"_blank")}function _(){if(!r||!i[o])return;const v=i[o].ops;r.setContents(v);const M=i[o].history;c(M)}function w(){if(!r||!i[o])return;ue(de,i[o].ops=r.getContents().ops,i);const v=structuredClone(r.history.stack);ue(de,i[o].history=v,i)}const f=g(w,500);function h(){if(!r)return;r.formatText(0,r.getLength(),"link",!1,"api");const v=r.getText(),M=/https?:\/\/\S+/gi,X=v.matchAll(M);for(const y of X)r.formatText(y.index,y[0].length,"link",y[0],"api");const L=/.+\@.+\..+/gi,p=v.matchAll(L);for(const y of p)r.formatText(y.index,y[0].length,"link","mailto:"+y[0],"api");document.querySelectorAll(".ql-editor a").forEach(y=>{y.addEventListener("click",E)})}const b=g(h,500);function k(v,M,X){if(X==="user"){const L=r.getText().split(`
`)[0].trim();ue(de,i[o].title=L===""?"Untitled":L,i),b(),f()}}async function S(){const{default:v}=await et(async()=>{const{default:M}=await import("../chunks/quill.Bk4jDS0q.js");return{default:M}},__vite__mapDeps([0,1]),import.meta.url);n(3,r=new v(s,{formats:["bold","italic","underline","strike","code","link"],placeholder:"Enter text here"})),_(),h(),r.on("text-change",k),r.keyboard.addBinding({key:"/",altKey:!0},()=>{r.format("code",!r.getFormat().code)}),r.keyboard.addBinding({key:"-",altKey:!0},()=>{r.format("strike",!r.getFormat().strike)})}Qe(()=>{S()});function B(v){J[v?"unshift":"push"](()=>{s=v,n(1,s)})}return e.$$set=v=>{"tabID"in v&&n(2,o=v.tabID),"disabled"in v&&n(0,d=v.disabled)},e.$$.update=()=>{e.$$.dirty&9&&(d?r==null||r.disable():r==null||r.enable()),e.$$.dirty&24&&(r==null||r.root.setAttribute("spellcheck",l.spellCheck.toString()))},[d,s,o,r,l,B]}class Wt extends Le{constructor(t){super(),xe(this,t,qt,Ft,_e,{tabID:2,disabled:0})}}const rt=500,zt=300,ot=500,Gt=300;class Kt{constructor(){U(this,"isMoving",!1);U(this,"isLongclick",!1);U(this,"button",0);U(this,"lastX",0);U(this,"lastY",0);U(this,"consecutiveClicks",0);U(this,"lastMouseupTime",0);U(this,"activeElement",null);this.reset()}reset(){this.isMoving=!1,this.isLongclick=!1,this.button=0,this.lastX=0,this.lastY=0,this.consecutiveClicks=0,this.lastMouseupTime=0,this.activeElement=null}}class jt{constructor(){U(this,"isDragging",!1);U(this,"isPinching",!1);U(this,"isLongpressed",!1);U(this,"consecutiveTaps",0);U(this,"lastTouchendTime",0);U(this,"lastCenterX",0);U(this,"lastCenterY",0);U(this,"identifier",0);U(this,"x",0);U(this,"y",0);U(this,"hypotenuse",0);U(this,"activeElement",null);this.reset()}reset(){this.isDragging=!1,this.isPinching=!1,this.isLongpressed=!1,this.consecutiveTaps=0,this.lastTouchendTime=0,this.lastCenterX=0,this.lastCenterY=0,this.identifier=0,this.x=0,this.y=0,this.hypotenuse=0,this.activeElement=null}}let ce=[],u=new Kt,a=new jt;const P=(e,t)=>{e!=null&&e.dispatchEvent(new CustomEvent("gesture",{detail:t,bubbles:!1,cancelable:!1}))},vt=e=>{u.reset(),a.reset(),u.lastMouseupTime=Date.now(),window.removeEventListener("mousemove",Fe),window.removeEventListener("mouseup",qe),window.removeEventListener("touchmove",We),window.removeEventListener("touchend",Te)},mt=e=>{if(window.removeEventListener("mousemove",Fe),window.removeEventListener("mouseup",qe),window.removeEventListener("touchmove",We),window.removeEventListener("touchend",Te),u.isMoving)if(u.isMoving=!1,u.isLongclick)u.isLongclick=!1,P(u.activeElement,{event:e,name:"longclick-drag-end",x:u.lastX,y:u.lastY,dx:0,dy:0});else switch(u.button){case 0:P(u.activeElement,{event:e,name:"left-click-drag-end",x:u.lastX,y:u.lastY,dx:0,dy:0});break;case 1:P(u.activeElement,{event:e,name:"middle-click-drag-end",x:u.lastX,y:u.lastY,dx:0,dy:0});break;case 2:P(u.activeElement,{event:e,name:"right-click-drag-end",x:u.lastX,y:u.lastY,dx:0,dy:0});break}u.isLongclick&&P(u.activeElement,{event:e,name:"longclick-release",x:u.lastX,y:u.lastY,dx:0,dy:0}),u.reset(),a.isDragging&&(a.isDragging=!1,a.isLongpressed?(a.isLongpressed=!1,P(a.activeElement,{event:e,name:"longpress-drag-end",x:a.lastCenterX,y:a.lastCenterY,dx:0,dy:0})):P(a.activeElement,{event:e,name:"touch-drag-end",x:a.lastCenterX,y:a.lastCenterY,dx:0,dy:0})),a.isLongpressed&&P(a.activeElement,{event:e,name:"longpress-release",x:a.lastCenterX,y:a.lastCenterY,dx:0,dy:0}),a.reset()},pt=e=>{P(e.target,{event:e,name:"wheel",x:e.clientX,y:e.clientY,dx:0,dy:0})},bt=e=>{},yt=e=>{document.activeElement!==e.target&&(window.addEventListener("mousemove",Fe),window.addEventListener("mouseup",qe),u.activeElement=e.target,u.lastX=e.clientX,u.lastY=e.clientY,u.isMoving||(u.button=e.button),u.button===0&&window.setTimeout(()=>{Date.now()-u.lastMouseupTime>=ot&&!u.isMoving&&(u.isLongclick=!0,P(u.activeElement,{event:e,name:"longclick",x:e.clientX,y:e.clientY,dx:0,dy:0}))},ot))},Fe=e=>{if(e.movementX===0&&e.movementY===0)return;let t=e.clientX-u.lastX,n=e.clientY-u.lastY;if(!u.isMoving)if(u.isLongclick)P(u.activeElement,{event:e,name:"longclick-drag-start",x:e.clientX,y:e.clientY,dx:0,dy:0});else switch(u.button){case 0:P(u.activeElement,{event:e,name:"left-click-drag-start",x:e.clientX,y:e.clientY,dx:0,dy:0});break;case 1:P(u.activeElement,{event:e,name:"middle-click-drag-start",x:e.clientX,y:e.clientY,dx:0,dy:0});break;case 2:P(u.activeElement,{event:e,name:"right-click-drag-start",x:e.clientX,y:e.clientY,dx:0,dy:0});break}if(u.isMoving=!0,u.lastX=e.clientX,u.lastY=e.clientY,u.isLongclick)P(u.activeElement,{event:e,name:"longclick-dragging",x:e.clientX,y:e.clientY,dx:t,dy:n});else switch(u.button){case 0:P(u.activeElement,{event:e,name:"left-click-dragging",x:e.clientX,y:e.clientY,dx:t,dy:n});break;case 1:P(u.activeElement,{event:e,name:"middle-click-dragging",x:e.clientX,y:e.clientY,dx:t,dy:n});break;case 2:P(u.activeElement,{event:e,name:"right-click-dragging",x:e.clientX,y:e.clientY,dx:t,dy:n});break}},qe=e=>{if(window.removeEventListener("mousemove",Fe),window.removeEventListener("mouseup",qe),u.lastMouseupTime=Date.now(),u.isMoving)if(u.isMoving=!1,u.isLongclick)u.isLongclick=!1,P(u.activeElement,{event:e,name:"longclick-drag-end",x:u.lastX,y:u.lastY,dx:0,dy:0});else switch(u.button){case 0:P(u.activeElement,{event:e,name:"left-click-drag-end",x:u.lastX,y:u.lastY,dx:0,dy:0});break;case 1:P(u.activeElement,{event:e,name:"middle-click-drag-end",x:u.lastX,y:u.lastY,dx:0,dy:0});break;case 2:P(u.activeElement,{event:e,name:"right-click-drag-end",x:u.lastX,y:u.lastY,dx:0,dy:0});break}else u.isLongclick||(e.button===2?P(u.activeElement,{event:e,name:"right-click",x:e.clientX,y:e.clientY,dx:0,dy:0}):e.button===1?P(u.activeElement,{event:e,name:"middle-click",x:e.clientX,y:e.clientY,dx:0,dy:0}):(u.consecutiveClicks===0&&P(u.activeElement,{event:e,name:"left-click",x:e.clientX,y:e.clientY,dx:0,dy:0}),u.consecutiveClicks++,window.setTimeout(()=>{u.consecutiveClicks>1&&P(u.activeElement,{event:e,name:"double-click",x:e.clientX,y:e.clientY,dx:0,dy:0}),u.consecutiveClicks=0},Gt)));u.isLongclick&&P(u.activeElement,{event:e,name:"longclick-release",x:e.clientX,y:e.clientY,dx:0,dy:0}),u.isLongclick=!1},_t=e=>{if(document.activeElement!==e.target){if(e.preventDefault(),e.stopPropagation(),e.touches.length>1){if(e.touches[0].identifier===a.identifier)return;a.isPinching=!0}window.addEventListener("touchmove",We,{passive:!1}),window.addEventListener("touchend",Te),window.addEventListener("touchcancel",Te),a.identifier=e.touches[0].identifier,a.x=e.touches[0].clientX,a.y=e.touches[0].clientY,a.activeElement=e.target,window.setTimeout(()=>{a.isPinching||a.isDragging||Date.now()-a.lastTouchendTime>=rt&&(a.isDragging=!1,a.isPinching=!1,a.hypotenuse=null,a.isLongpressed=!0,P(a.activeElement,{event:e,name:"longpress",x:a.x,y:a.y,dx:0,dy:0}))},rt)}},We=e=>{if(a.isDragging){let t=a.x,n=a.y;a.x=e.touches[0].clientX,a.y=e.touches[0].clientY;let i=a.x-t,l=a.y-n;a.isLongpressed?P(a.activeElement,{event:e,name:"longpress-dragging",x:a.x,y:a.y,dx:i,dy:l,force:e.touches[0].force}):P(a.activeElement,{event:e,name:"touch-dragging",x:a.x,y:a.y,dx:i,dy:l,force:e.touches[0].force});return}else if(!a.isLongpressed&&(a.isPinching||e.touches.length>1)){a.x=e.touches[0].clientX,a.y=e.touches[0].clientY;let t={x:e.touches[1].clientX,y:e.touches[1].clientY},n={x:(a.x+t.x)/2,y:(a.y+t.y)/2},i=Math.hypot(a.x-t.x,a.y-t.y);a.hypotenuse===null&&(a.hypotenuse=i,a.lastCenterX=n.x,a.lastCenterY=n.y,P(a.activeElement,{event:e,name:"pinch-start",x:n.x,y:n.y,dx:0,dy:0})),a.isPinching=!0;let l=i/a.hypotenuse,o=n.x-a.lastCenterX,d=n.y-a.lastCenterY;P(a.activeElement,{event:e,name:"pinching",x:n.x,y:n.y,zoom:l,dx:o,dy:d}),a.hypotenuse=i,a.lastCenterX=n.x,a.lastCenterY=n.y;return}else a.isDragging=!0,a.isLongpressed?(P(a.activeElement,{event:e,name:"longpress-drag-start",x:a.x,y:a.y,dx:0,dy:0,force:e.touches[0].force}),a.x=e.touches[0].clientX,a.y=e.touches[0].clientY,P(a.activeElement,{event:e,name:"longpress-dragging",x:a.x,y:a.y,dx:0,dy:0,force:e.touches[0].force})):(P(a.activeElement,{event:e,name:"touch-drag-start",x:a.x,y:a.y,dx:0,dy:0,force:e.touches[0].force}),a.x=e.touches[0].clientX,a.y=e.touches[0].clientY,P(a.activeElement,{event:e,name:"touch-dragging",x:a.x,y:a.y,dx:0,dy:0,force:e.touches[0].force}))},Te=e=>{a.isDragging&&e.touches.length>0&&e.touches[0].identifier===a.identifier||(a.lastTouchendTime=Date.now(),window.removeEventListener("touchmove",We),window.removeEventListener("touchend",Te),window.removeEventListener("touchcancel",Te),a.isDragging?(a.isDragging=!1,a.isLongpressed?(a.isLongpressed=!1,P(a.activeElement,{event:e,name:"longpress-drag-end",x:a.x,y:a.y,dx:0,dy:0})):P(a.activeElement,{event:e,name:"touch-drag-end",x:a.x,y:a.y,dx:0,dy:0})):a.isPinching?(a.isPinching=!1,a.hypotenuse=null,P(a.activeElement,{event:e,name:"pinch-end",x:a.lastCenterX,y:a.lastCenterY,dx:0,dy:0})):a.isLongpressed||(a.consecutiveTaps===0&&P(a.activeElement,{event:e,name:"tap",x:a.x,y:a.y,dx:0,dy:0}),a.consecutiveTaps++,window.setTimeout(()=>{a.consecutiveTaps>1&&P(a.activeElement,{event:e,name:"double-tap",x:a.x,y:a.y,dx:0,dy:0}),a.consecutiveTaps=0},zt)),a.isLongpressed&&P(a.activeElement,{event:e,name:"longpress-release",x:a.x,y:a.y,dx:0,dy:0}),a.isLongpressed=!1)};function Qt(...e){for(let t of e)ce.findIndex(n=>n===t)===-1&&(ce.length==0&&(window.addEventListener("blur",mt),window.addEventListener("focus",vt)),ce.push(t),t.addEventListener("touchstart",_t,{passive:!1}),t.addEventListener("mousedown",yt,{passive:!1}),t.addEventListener("contextmenu",bt,{passive:!1}),t.addEventListener("wheel",pt,{passive:!1}))}function Jt(...e){const t=n=>{n.removeEventListener("touchstart",_t),n.removeEventListener("mousedown",yt),n.removeEventListener("contextmenu",bt),n.removeEventListener("wheel",pt)};if(e.length==0){for(let n of ce)t(n);ce=[]}else for(let n of e){let i=ce.findIndex(l=>l===n);i!==-1&&(t(n),ce.splice(i,1))}ce.length==0&&(window.removeEventListener("blur",mt),window.removeEventListener("focus",vt))}function Zt(e){let t,n,i,l;return{c(){t=H("div"),n=H("canvas"),i=z(),l=H("canvas"),this.h()},l(o){t=A(o,"DIV",{class:!0});var d=O(t);n=A(d,"CANVAS",{id:!0,class:!0}),O(n).forEach(Y),i=G(d),l=A(d,"CANVAS",{id:!0,class:!0}),O(l).forEach(Y),d.forEach(Y),this.h()},h(){C(n,"id","currentPath"),C(n,"class","svelte-1d1danm"),C(l,"id","canvas"),C(l,"class","svelte-1d1danm"),C(t,"class","drawing-container svelte-1d1danm"),q(t,"hide",e[1]),q(t,"disabled",e[0])},m(o,d){oe(o,t,d),I(t,n),e[11](n),I(t,i),I(t,l),e[12](l)},p(o,d){d[0]&2&&q(t,"hide",o[1]),d[0]&1&&q(t,"disabled",o[0])},i:ge,o:ge,d(o){o&&Y(t),e[11](null),e[12](null)}}}const $t=2,en=178;function tn(e,t,n){var i=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),l=Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2)),o=Math.sqrt(Math.pow(n.x-e.x,2)+Math.pow(n.y-e.y,2)),d=Math.acos((l*l+i*i-o*o)/(2*l*i));return d*(180/Math.PI)}function lt(e){if(e.points.length<4)return e;for(let t=1;t<e.points.length-2;t++){const n=e.points[t-1],i=e.points[t],l=e.points[t+1];tn(n,i,l)>en&&(e.points.splice(t,1),t--)}return e}async function Xe(e,t){if(t.lineWidth=e.lineWidth,t.lineCap="round",t.strokeStyle=e.color,e.points.length<2){t.beginPath(),t.moveTo(e.points[0].x,e.points[0].y),t.lineTo(e.points[0].x,e.points[0].y),t.stroke();return}t.beginPath();let n=e.points[0].x,i=e.points[0].y;for(let l=0;l<e.points.length-1;l++)t.moveTo(n,i),n=(e.points[l].x+e.points[l+1].x)/2,i=(e.points[l].y+e.points[l+1].y)/2,t.quadraticCurveTo(e.points[l].x,e.points[l].y,n,i);t.stroke()}function nn(e){return{x:at(e.x),y:at(e.y)}}function at(e){const t=e.toFixed($t);return Number(t)}function sn(e,t,n){let i;re(e,de,T=>n(23,i=T));let{radius:l=3}=t,{smoothness:o=0}=t,{stroke:d=5}=t,{color:r="#000000"}=t,{disabled:s=!1}=t,{hide:g=!1}=t,{tabID:c=""}=t;function E(){f.clearRect(0,0,B/v,S/v),p=[]}function _(){if(p.length!=0){p.pop(),b.clearRect(0,0,B/v,S/v);for(let T=0;T<p.length;T++)Xe(p[T],b);Q()}}let w,f,h,b,k={x:0,y:0},S=0,B=0,v,M=!1,X,L,p=[];function y(){w&&(Qt(w),window.addEventListener("keydown",ie))}function x(){w&&(Jt(w),window.removeEventListener("keydown",ie))}const Z=(T,ee,V,ke)=>{var Ce=V-T,m=ke-ee;return Math.sqrt(Ce*Ce+m*m)};function ne(T,ee){let V=w.getBoundingClientRect();return{x:T-V.left,y:ee-V.top}}function j(){if(!w||!h)return;se(),v=window.devicePixelRatio;let T=w.getBoundingClientRect();S=T.height*v,B=T.width*v,n(2,w.width=B,w),n(2,w.height=S,w),n(3,h.width=B,h),n(3,h.height=S,h),f.scale(v,v),b.scale(v,v);for(let ee=0;ee<p.length;ee++)Xe(p[ee],b)}function Q(){i[c]&&ue(de,i[c].paths=p.filter(T=>lt(T)),i)}function $(){i[c]&&(p=i[c].paths,j())}function we(T,ee){M=!0,k=ne(T,ee),f.lineWidth=d,f.lineCap="round",f.strokeStyle=r,f.beginPath(),f.moveTo(k.x,k.y),f.stroke(),X={points:[],lineWidth:d,color:r}}function De(T,ee){if(!M)return;let V=ne(T,ee);if(l>0){if(Z(V.x,V.y,k.x,k.y)<=l){X.points.length===0&&(X.points.push(V),Xe(X,f));return}let ke=Math.sqrt(V.x*V.x+V.y*V.y-2*V.x*k.x+k.x*k.x-2*V.y*k.y+k.y*k.y);if(V={x:V.x+l*((k.x-V.x)/ke),y:V.y+l*((k.y-V.y)/ke)},Z(k.x,k.y,V.x,V.y)<=o)return}X.points.push(nn(V)),f.clearRect(0,0,B/v,S/v),Xe(X,f),k=V}function se(){M&&(p.push(lt(X)),Xe(X,b),f.clearRect(0,0,B/v,S/v),Q()),M=!1}const ie=function(T){T.ctrlKey&&T.key=="z"&&_(),T.preventDefault()};Qe(()=>{f=w.getContext("2d"),f.imageSmoothingEnabled=!1,b=h.getContext("2d"),b.imageSmoothingEnabled=!1,w.addEventListener("gesture",T=>{switch(T.detail.name){case"left-click-drag-start":case"touch-drag-start":we(T.detail.x,T.detail.y);break;case"left-click-dragging":case"touch-dragging":De(T.detail.x,T.detail.y);break;case"left-click-drag-end":case"touch-drag-end":se();break;case"left-click":case"tap":we(T.detail.x,T.detail.y),De(T.detail.x,T.detail.y),se();break}}),L=new ResizeObserver(j),L.observe(w),$(),s?x():y()}),Tt(()=>{L&&L.disconnect(),x()});function ze(T){J[T?"unshift":"push"](()=>{h=T,n(3,h)})}function Ge(T){J[T?"unshift":"push"](()=>{w=T,n(2,w)})}return e.$$set=T=>{"radius"in T&&n(4,l=T.radius),"smoothness"in T&&n(5,o=T.smoothness),"stroke"in T&&n(6,d=T.stroke),"color"in T&&n(7,r=T.color),"disabled"in T&&n(0,s=T.disabled),"hide"in T&&n(1,g=T.hide),"tabID"in T&&n(8,c=T.tabID)},e.$$.update=()=>{e.$$.dirty[0]&1&&(s?x():y())},[s,g,w,h,l,o,d,r,c,E,_,ze,Ge]}class rn extends Le{constructor(t){super(),xe(this,t,sn,Zt,_e,{radius:4,smoothness:5,stroke:6,color:7,disabled:0,hide:1,tabID:8,clear:9,undo:10},null,[-1,-1])}get clear(){return this.$$.ctx[9]}get undo(){return this.$$.ctx[10]}}function Oe(e,{delay:t=0,duration:n=400,easing:i=Rt,axis:l="y"}={}){const o=getComputedStyle(e),d=+o.opacity,r=l==="y"?"height":"width",s=parseFloat(o[r]),g=l==="y"?["top","bottom"]:["left","right"],c=g.map(k=>`${k[0].toUpperCase()}${k.slice(1)}`),E=parseFloat(o[`padding${c[0]}`]),_=parseFloat(o[`padding${c[1]}`]),w=parseFloat(o[`margin${c[0]}`]),f=parseFloat(o[`margin${c[1]}`]),h=parseFloat(o[`border${c[0]}Width`]),b=parseFloat(o[`border${c[1]}Width`]);return{delay:t,duration:n,easing:i,css:k=>`overflow: hidden;opacity: ${Math.min(k*20,1)*d};${r}: ${k*s}px;padding-${g[0]}: ${k*E}px;padding-${g[1]}: ${k*_}px;margin-${g[0]}: ${k*w}px;margin-${g[1]}: ${k*f}px;border-${g[0]}-width: ${k*h}px;border-${g[1]}-width: ${k*b}px;`}}function ct(e){let t,n,i=`<span class="button-icon svelte-lafg0f" style="-webkit-mask: url(${W}/images/svg/undo.svg) no-repeat center / contain; mask: url(${W}/images/svg/undo.svg) no-repeat center / contain;"></span>`,l,o,d,r,s,g,c,E;return{c(){t=H("div"),n=H("button"),n.innerHTML=i,l=z(),o=H("input"),d=z(),r=H("input"),this.h()},l(_){t=A(_,"DIV",{class:!0});var w=O(t);n=A(w,"BUTTON",{class:!0,"data-svelte-h":!0}),ve(n)!=="svelte-1b4fip4"&&(n.innerHTML=i),l=G(w),o=A(w,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),d=G(w),r=A(w,"INPUT",{type:!0,class:!0}),w.forEach(Y),this.h()},h(){C(n,"class","button svelte-lafg0f"),C(o,"type","range"),C(o,"min","2"),C(o,"max","20"),C(o,"step","2"),C(o,"class","slider svelte-lafg0f"),C(r,"type","color"),C(r,"class","color-picker svelte-lafg0f"),C(t,"class","pencil-tools svelte-lafg0f")},m(_,w){oe(_,t,w),I(t,n),I(t,l),I(t,o),Be(o,e[0]),I(t,d),I(t,r),Be(r,e[1]),g=!0,c||(E=[te(n,"click",function(){Ee(e[4])&&e[4].apply(this,arguments)}),te(o,"change",e[9]),te(o,"input",e[9]),te(r,"input",e[10])],c=!0)},p(_,w){e=_,w&1&&Be(o,e[0]),w&2&&Be(r,e[1])},i(_){g||(_&&Je(()=>{g&&(s||(s=Ne(t,Oe,{duration:200,axis:"x"},!0)),s.run(1))}),g=!0)},o(_){_&&(s||(s=Ne(t,Oe,{duration:200,axis:"x"},!1)),s.run(0)),g=!1},d(_){_&&Y(t),_&&s&&s.end(),c=!1,Ue(E)}}}function on(e){let t,n,i=`<span class="button-icon svelte-lafg0f" style="-webkit-mask: url(${W}/images/svg/pencil.svg) no-repeat center / contain; mask: url(${W}/images/svg/pencil.svg) no-repeat center / contain;"></span>`,l,o,d=`<span class="button-icon svelte-lafg0f" style="-webkit-mask: url(${W}/images/svg/highlighter.svg) no-repeat center / contain; mask: url(${W}/images/svg/highlighter.svg) no-repeat center / contain;"></span>`,r,s,g,c,E,_=`<span class="button-icon svelte-lafg0f" style="-webkit-mask: url(${W}/images/svg/trash.svg) no-repeat center / contain; mask: url(${W}/images/svg/trash.svg) no-repeat center / contain;"></span>`,w,f,h,b,k,S,B=`<span class="button-icon svelte-lafg0f" style="-webkit-mask: url(${W}/images/svg/user.svg) no-repeat center / contain; mask: url(${W}/images/svg/user.svg) no-repeat center / contain;"></span>`,v,M,X,L,p=(e[5].activeTool==="pencil"||e[5].activeTool==="highlighter")&&ct(e);return{c(){t=H("div"),n=H("button"),n.innerHTML=i,l=z(),o=H("button"),o.innerHTML=d,r=z(),p&&p.c(),s=z(),g=H("div"),c=z(),E=H("button"),E.innerHTML=_,w=z(),f=H("button"),h=H("span"),k=z(),S=H("a"),S.innerHTML=B,this.h()},l(y){t=A(y,"DIV",{class:!0});var x=O(t);n=A(x,"BUTTON",{class:!0,"data-svelte-h":!0}),ve(n)!=="svelte-t1zbc2"&&(n.innerHTML=i),l=G(x),o=A(x,"BUTTON",{class:!0,"data-svelte-h":!0}),ve(o)!=="svelte-113qxbd"&&(o.innerHTML=d),r=G(x),p&&p.l(x),s=G(x),g=A(x,"DIV",{class:!0}),O(g).forEach(Y),c=G(x),E=A(x,"BUTTON",{class:!0,"data-svelte-h":!0}),ve(E)!=="svelte-cbr57k"&&(E.innerHTML=_),w=G(x),f=A(x,"BUTTON",{class:!0});var Z=O(f);h=A(Z,"SPAN",{class:!0,style:!0}),O(h).forEach(Y),Z.forEach(Y),k=G(x),S=A(x,"A",{class:!0,href:!0,"data-svelte-h":!0}),ve(S)!=="svelte-1xuhzhs"&&(S.innerHTML=B),x.forEach(Y),this.h()},h(){C(n,"class","pencil button svelte-lafg0f"),q(n,"selected",e[5].activeTool==="pencil"),C(o,"class","button svelte-lafg0f"),q(o,"selected",e[5].activeTool==="highlighter"),C(g,"class","spacer svelte-lafg0f"),C(E,"class","close button svelte-lafg0f"),C(h,"class","button-icon svelte-lafg0f"),Ze(h,"-webkit-mask","url("+W+"/images/svg/refresh.svg) no-repeat center / contain"),Ze(h,"mask","url("+W+"/images/svg/refresh.svg) no-repeat center / contain"),C(f,"class","refresh button svelte-lafg0f"),f.disabled=b=e[6].savingStatus==="saving",C(S,"class","button svelte-lafg0f"),C(S,"href",W+"/profile"),C(t,"class","toolbar-container svelte-lafg0f")},m(y,x){oe(y,t,x),I(t,n),I(t,l),I(t,o),I(t,r),p&&p.m(t,null),I(t,s),I(t,g),I(t,c),I(t,E),I(t,w),I(t,f),I(f,h),I(t,k),I(t,S),M=!0,X||(L=[te(n,"click",e[7]),te(o,"click",e[8]),te(E,"click",function(){Ee(e[3])&&e[3].apply(this,arguments)}),te(f,"click",function(){Ee(e[2])&&e[2].apply(this,arguments)})],X=!0)},p(y,[x]){e=y,(!M||x&32)&&q(n,"selected",e[5].activeTool==="pencil"),(!M||x&32)&&q(o,"selected",e[5].activeTool==="highlighter"),e[5].activeTool==="pencil"||e[5].activeTool==="highlighter"?p?(p.p(e,x),x&32&&F(p,1)):(p=ct(e),p.c(),F(p,1),p.m(t,s)):p&&(Ae(),K(p,1,1,()=>{p=null}),Se()),(!M||x&64&&b!==(b=e[6].savingStatus==="saving"))&&(f.disabled=b)},i(y){M||(F(p),y&&Je(()=>{M&&(v||(v=Ne(t,Oe,{duration:200},!0)),v.run(1))}),M=!0)},o(y){K(p),y&&(v||(v=Ne(t,Oe,{duration:200},!1)),v.run(0)),M=!1},d(y){y&&Y(t),p&&p.d(),y&&v&&v.end(),X=!1,Ue(L)}}}function ln(e,t,n){let i,l;re(e,fe,f=>n(5,i=f)),re(e,gt,f=>n(6,l=f));let{onRefresh:o=()=>{}}=t,{onClose:d=()=>{}}=t,{onDrawingUndo:r=()=>{}}=t,{stroke:s}=t,{color:g}=t;const c=()=>{ue(fe,i.activeTool=i.activeTool==="pencil"?void 0:"pencil",i)},E=()=>{ue(fe,i.activeTool=i.activeTool==="highlighter"?void 0:"highlighter",i)};function _(){s=Ct(this.value),n(0,s)}function w(){g=this.value,n(1,g)}return e.$$set=f=>{"onRefresh"in f&&n(2,o=f.onRefresh),"onClose"in f&&n(3,d=f.onClose),"onDrawingUndo"in f&&n(4,r=f.onDrawingUndo),"stroke"in f&&n(0,s=f.stroke),"color"in f&&n(1,g=f.color)},[s,g,o,d,r,i,l,c,E,_,w]}class an extends Le{constructor(t){super(),xe(this,t,ln,on,_e,{onRefresh:2,onClose:3,onDrawingUndo:4,stroke:0,color:1})}}function dt(e){let t,n,i,l;function o(s){e[13](s)}function d(s){e[14](s)}let r={onClose:e[10],onDrawingUndo:e[11],onRefresh:e[12]};return e[4]!==void 0&&(r.stroke=e[4]),e[0]!==void 0&&(r.color=e[0]),t=new an({props:r}),J.push(()=>Re(t,"stroke",o)),J.push(()=>Re(t,"color",d)),{c(){me(t.$$.fragment)},l(s){pe(t.$$.fragment,s)},m(s,g){be(t,s,g),l=!0},p(s,g){const c={};g&32&&(c.onClose=s[10]),g&64&&(c.onDrawingUndo=s[11]),!n&&g&16&&(n=!0,c.stroke=s[4],He(()=>n=!1)),!i&&g&1&&(i=!0,c.color=s[0],He(()=>i=!1)),t.$set(c)},i(s){l||(F(t.$$.fragment,s),l=!0)},o(s){K(t.$$.fragment,s),l=!1},d(s){ye(t,s)}}}function cn(e){let t,n;return t=new Ht({}),{c(){me(t.$$.fragment)},l(i){pe(t.$$.fragment,i)},m(i,l){be(t,i,l),n=!0},p:ge,i(i){n||(F(t.$$.fragment,i),n=!0)},o(i){K(t.$$.fragment,i),n=!1},d(i){ye(t,i)}}}function dn(e){let t,n,i=e[7],l,o,d=ut(e);return{c(){t=H("div"),n=H("div"),d.c(),this.h()},l(r){t=A(r,"DIV",{class:!0});var s=O(t);n=A(s,"DIV",{class:!0});var g=O(n);d.l(g),g.forEach(Y),s.forEach(Y),this.h()},h(){C(n,"class","editor-container svelte-140gvmn"),C(t,"class","scrollable-canvas svelte-140gvmn"),Je(()=>e[18].call(t))},m(r,s){oe(r,t,s),I(t,n),d.m(n,null),l=It(t,e[18].bind(t)),o=!0},p(r,s){s&128&&_e(i,i=r[7])?(Ae(),K(d,1,1,ge),Se(),d=ut(r),d.c(),F(d,1),d.m(n,null)):d.p(r,s)},i(r){o||(F(d),o=!0)},o(r){K(d),o=!1},d(r){r&&Y(t),d.d(r),l()}}}function ut(e){let t,n,i,l,o,d;t=new Wt({props:{tabID:e[7]}});function r(c){e[16](c)}function s(c){e[17](c)}let g={tabID:e[7],disabled:e[2].activeTool===void 0};return e[3]!==void 0&&(g.color=e[3]),e[4]!==void 0&&(g.stroke=e[4]),i=new rn({props:g}),e[15](i),J.push(()=>Re(i,"color",r)),J.push(()=>Re(i,"stroke",s)),{c(){me(t.$$.fragment),n=z(),me(i.$$.fragment)},l(c){pe(t.$$.fragment,c),n=G(c),pe(i.$$.fragment,c)},m(c,E){be(t,c,E),oe(c,n,E),be(i,c,E),d=!0},p(c,E){const _={};E&128&&(_.tabID=c[7]),t.$set(_);const w={};E&128&&(w.tabID=c[7]),E&4&&(w.disabled=c[2].activeTool===void 0),!l&&E&8&&(l=!0,w.color=c[3],He(()=>l=!1)),!o&&E&16&&(o=!0,w.stroke=c[4],He(()=>o=!1)),i.$set(w)},i(c){d||(F(t.$$.fragment,c),F(i.$$.fragment,c),d=!0)},o(c){K(t.$$.fragment,c),K(i.$$.fragment,c),d=!1},d(c){c&&Y(n),ye(t,c),e[15](null),ye(i,c)}}}function un(e){let t,n,i,l,o,d,r,s,g={};n=new Ut({props:g}),e[9](n);let c=e[2].toolbarVisible&&e[2].order.length>0&&dt(e);const E=[dn,cn],_=[];function w(f,h){return f[8].currentUser&&!f[8].isLoading?0:1}return d=w(e),r=_[d]=E[d](e),{c(){t=H("div"),me(n.$$.fragment),i=z(),l=H("div"),c&&c.c(),o=z(),r.c(),this.h()},l(f){t=A(f,"DIV",{class:!0});var h=O(t);pe(n.$$.fragment,h),i=G(h),l=A(h,"DIV",{class:!0});var b=O(l);c&&c.l(b),b.forEach(Y),o=G(h),r.l(h),h.forEach(Y),this.h()},h(){C(l,"class","toolbar"),C(t,"class","page-container svelte-140gvmn")},m(f,h){oe(f,t,h),be(n,t,null),I(t,i),I(t,l),c&&c.m(l,null),I(t,o),_[d].m(t,null),s=!0},p(f,[h]){const b={};n.$set(b),f[2].toolbarVisible&&f[2].order.length>0?c?(c.p(f,h),h&4&&F(c,1)):(c=dt(f),c.c(),F(c,1),c.m(l,null)):c&&(Ae(),K(c,1,1,()=>{c=null}),Se());let k=d;d=w(f),d===k?_[d].p(f,h):(Ae(),K(_[k],1,1,()=>{_[k]=null}),Se(),r=_[d],r?r.p(f,h):(r=_[d]=E[d](f),r.c()),F(r,1),r.m(t,null))},i(f){s||(F(n.$$.fragment,f),F(c),F(r),s=!0)},o(f){K(n.$$.fragment,f),K(c),K(r),s=!1},d(f){f&&Y(t),e[9](null),ye(n),c&&c.d(),_[d].d()}}}function fn(e,t){var n=parseInt(e.slice(1,3),16),i=parseInt(e.slice(3,5),16),l=parseInt(e.slice(5,7),16);return"rgba("+n+", "+i+", "+l+", "+t+")"}function gn(e,t,n){let i,l,o,d;re(e,fe,L=>n(2,l=L)),re(e,ft,L=>n(19,o=L)),re(e,gt,L=>n(8,d=L));let r="#000000",s="rgba(0, 0, 0, 1)",g=10,c,E;fe.subscribe(L=>{if(L.activeTool==="highlighter")n(0,r="#ffdd33");else if(L.activeTool==="pencil"){const p=Yt.find(y=>y.name===o.theme);p&&n(0,r=p.caret)}});let _=0;function w(L){J[L?"unshift":"push"](()=>{c=L,n(5,c)})}const f=()=>c.closeActiveTab(),h=()=>E.undo(),b=()=>Xt.loadFromFirestore();function k(L){g=L,n(4,g)}function S(L){r=L,n(0,r)}function B(L){J[L?"unshift":"push"](()=>{E=L,n(6,E)})}function v(L){s=L,n(3,s),n(2,l),n(0,r)}function M(L){g=L,n(4,g)}function X(){_=this.clientHeight,n(1,_)}return e.$$.update=()=>{e.$$.dirty&4&&n(7,i=l.order[l.activeIndex]),e.$$.dirty&5&&n(3,s=l.activeTool==="highlighter"?fn(r,.3):r),e.$$.dirty&2&&_>0&&document.documentElement.style.setProperty("--canvas-height",_+"px")},[r,_,l,s,g,c,E,i,d,w,f,h,b,k,S,B,v,M,X]}class kn extends Le{constructor(t){super(),xe(this,t,gn,un,_e,{})}}export{kn as component};
