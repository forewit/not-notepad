const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/quill.Bk4jDS0q.js","../chunks/core.CG__ofcG.js"])))=>i.map(i=>d[i]);
var Dt=Object.defineProperty;var Ct=(e,t,n)=>t in e?Dt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var F=(e,t,n)=>Ct(e,typeof t!="symbol"?t+"":t,n);import{s as xe,n as me,r as qe,i as ke,c as se,o as et,d as $,A as It,B as Se,a as fe,C as Mt,e as pt}from"../chunks/scheduler.CE28Mlnp.js";import{S as De,i as Ce,e as H,b as Yt,c as S,d as O,f as Pt,g as X,w as I,A as U,j as le,k as C,x as te,F as Qe,l as Xt,s as j,p as pe,h as z,v as ve,q as be,r as _e,o as Ee,n as Te,a as q,t as G,u as ye,G as Re,z as tt,I as Ne,C as Oe,J as At,m as Ue}from"../chunks/index.DI-vKZfI.js";import{e as we,u as Ze,o as $e}from"../chunks/each.Ds53g4D-.js";import{b as W}from"../chunks/paths.Djz1CiA5.js";import{m as ge,t as ce,d as ae,s as bt,a as _t,f as Ht}from"../chunks/firebaseStore.Co5T5DUW.js";import{_ as nt}from"../chunks/preload-helper.D6kgxu3v.js";import{P as St}from"../chunks/ProgressBar.BImEwBUK.js";import{t as Rt}from"../chunks/themes.BTx5Q4mv.js";function Bt(e){let t,n,i,r,s,u;return{c(){t=H("div"),n=H("button"),i=H("span"),r=Yt(e[0]),this.h()},l(o){t=S(o,"DIV",{class:!0});var l=O(t);n=S(l,"BUTTON",{class:!0,draggable:!0});var v=O(n);i=S(v,"SPAN",{class:!0});var f=O(i);r=Pt(f,e[0]),f.forEach(X),v.forEach(X),l.forEach(X),this.h()},h(){I(i,"class","title svelte-1jmw20r"),I(n,"class","tab svelte-1jmw20r"),I(n,"draggable","true"),U(n,"active",e[1]),I(t,"class","tab-container svelte-1jmw20r"),U(t,"preventHover",e[2])},m(o,l){le(o,t,l),C(t,n),C(n,i),C(i,r),s||(u=[te(n,"mousedown",Qe(function(){ke(e[3])&&e[3].apply(this,arguments)})),te(n,"touchstart",Qe(function(){ke(e[3])&&e[3].apply(this,arguments)})),te(n,"dragstart",Qe(function(){ke(e[4])&&e[4].apply(this,arguments)}))],s=!0)},p(o,[l]){e=o,l&1&&Xt(r,e[0]),l&2&&U(n,"active",e[1]),l&4&&U(t,"preventHover",e[2])},i:me,o:me,d(o){o&&X(t),s=!1,qe(u)}}}function Ot(e,t,n){let{title:i=""}=t,{active:r=!1}=t,{preventHover:s=!1}=t,{onPointerdown:u=l=>{}}=t,{onDragstart:o=l=>{}}=t;return e.$$set=l=>{"title"in l&&n(0,i=l.title),"active"in l&&n(1,r=l.active),"preventHover"in l&&n(2,s=l.preventHover),"onPointerdown"in l&&n(3,u=l.onPointerdown),"onDragstart"in l&&n(4,o=l.onDragstart)},[i,r,s,u,o]}class yt extends De{constructor(t){super(),Ce(this,t,Ot,Bt,xe,{title:0,active:1,preventHover:2,onPointerdown:3,onDragstart:4})}}function he(e){return e<.5?4*e*e*e:.5*Math.pow(2*e-2,3)+1}function Vt(e){const t=e-1;return t*t*t+1}const it=(e,t)=>{const{duration:n=300,easing:i=he,onEnd:r=()=>{},onStep:s=()=>{},css:u}=t;let o;function l(v){if(!e){console.warn("Cannot find element to animate");return}o===void 0&&(o=v);const f=i((v-o)/n),x=1-f;f<1?(e.style.cssText=u(f,x),s(f,x),requestAnimationFrame(l)):(e.style.cssText="",r())}requestAnimationFrame(l)},Je=e=>{const{duration:t=300,easing:n=he,onEnd:i=()=>{},onStep:r=()=>{}}=e;let s;function u(o){s===void 0&&(s=o);const l=n((o-s)/t),v=1-l;l<1?(r(l,v),requestAnimationFrame(u)):i()}requestAnimationFrame(u)};function st(e,t,n){const i=e.slice();return i[41]=t[n],i[42]=t,i[43]=n,i}function lt(e,t){let n,i,r,s,u=t[43],o,l,v;function f(...a){return t[17](t[43],...a)}function x(a){t[18](a,t[41])}let y={active:t[9]==t[41],preventHover:t[8],onPointerdown:f,onDragstart:t[14]};t[11][t[41]].title!==void 0&&(y.title=t[11][t[41]].title),i=new yt({props:y}),$.push(()=>Re(i,"title",x));const m=()=>t[19](n,u),c=()=>t[19](null,u);return{key:e,first:null,c(){n=H("div"),pe(i.$$.fragment),s=j(),this.h()},l(a){n=S(a,"DIV",{class:!0});var g=O(n);be(i.$$.fragment,g),s=z(g),g.forEach(X),this.h()},h(){I(n,"class","tab-container svelte-17fp8fv"),U(n,"placeholder",t[10]==t[41]),this.first=n},m(a,g){le(a,n,g),_e(i,n,null),C(n,s),m(),o=!0,l||(v=It(t[13].call(null,n)),l=!0)},p(a,g){t=a;const w={};g[0]&514&&(w.active=t[9]==t[41]),g[0]&256&&(w.preventHover=t[8]),g[0]&2&&(w.onPointerdown=f),!r&&g[0]&2050&&(r=!0,w.title=t[11][t[41]].title,Se(()=>r=!1)),i.$set(w),u!==t[43]&&(c(),u=t[43],m()),(!o||g[0]&1026)&&U(n,"placeholder",t[10]==t[41])},i(a){o||(q(i.$$.fragment,a),o=!0)},o(a){G(i.$$.fragment,a),o=!1},d(a){a&&X(n),ye(i),c(),l=!1,v()}}}function Nt(e){let t,n,i,r=[],s=new Map,u,o,l,v=`<span class="button-icon svelte-17fp8fv" style="-webkit-mask: url(${W}/images/svg/plus.svg) no-repeat center / contain; mask: url(${W}/images/svg/plus.svg) no-repeat center / contain;"></span>`,f,x,y,m=`<span class="button-icon svelte-17fp8fv" style="-webkit-mask: url(${W}/images/svg/gear.svg) no-repeat center / contain; mask: url(${W}/images/svg/gear.svg) no-repeat center / contain;"></span>`,c,a,g,w,Y,V,p,P,E=we(e[1].order);const A=_=>_[41];for(let _=0;_<E.length;_+=1){let k=st(e,E,_),L=A(k);s.set(L,r[_]=lt(L,k))}return g=new yt({props:{title:e[4],active:!e[6],preventHover:!0}}),{c(){t=H("div"),n=H("div"),i=H("div");for(let _=0;_<r.length;_+=1)r[_].c();u=j(),o=H("div"),l=H("button"),l.innerHTML=v,f=j(),x=H("div"),y=H("button"),y.innerHTML=m,c=j(),a=H("div"),pe(g.$$.fragment),w=j(),Y=H("div"),this.h()},l(_){t=S(_,"DIV",{class:!0});var k=O(t);n=S(k,"DIV",{class:!0});var L=O(n);i=S(L,"DIV",{class:!0});var ee=O(i);for(let Z=0;Z<r.length;Z+=1)r[Z].l(ee);ee.forEach(X),u=z(L),o=S(L,"DIV",{class:!0});var ie=O(o);l=S(ie,"BUTTON",{class:!0,"data-svelte-h":!0}),ve(l)!=="svelte-g0ls06"&&(l.innerHTML=v),ie.forEach(X),f=z(L),x=S(L,"DIV",{class:!0});var K=O(x);y=S(K,"BUTTON",{class:!0,"data-svelte-h":!0}),ve(y)!=="svelte-4x2iay"&&(y.innerHTML=m),K.forEach(X),c=z(L),a=S(L,"DIV",{class:!0});var J=O(a);be(g.$$.fragment,J),J.forEach(X),L.forEach(X),w=z(k),Y=S(k,"DIV",{class:!0}),O(Y).forEach(X),k.forEach(X),this.h()},h(){I(i,"class","tabs svelte-17fp8fv"),I(l,"class","button svelte-17fp8fv"),I(o,"class","new-tab-container svelte-17fp8fv"),I(y,"class","button svelte-17fp8fv"),I(x,"class","buttons-container svelte-17fp8fv"),I(a,"class","clone svelte-17fp8fv"),U(a,"dragging",e[0]),I(n,"class","tabbar svelte-17fp8fv"),I(Y,"class","divider svelte-17fp8fv"),I(t,"class","svelte-17fp8fv")},m(_,k){le(_,t,k),C(t,n),C(n,i);for(let L=0;L<r.length;L+=1)r[L]&&r[L].m(i,null);e[20](i),C(n,u),C(n,o),C(o,l),C(n,f),C(n,x),C(x,y),C(n,c),C(n,a),_e(g,a,null),e[22](a),C(t,w),C(t,Y),e[23](t),V=!0,p||(P=[te(l,"click",e[12]),te(y,"click",e[21])],p=!0)},p(_,k){k[0]&53002&&(E=we(_[1].order),Ee(),r=Ze(r,k,A,1,_,E,s,i,$e,lt,null,st),Te());const L={};k[0]&16&&(L.title=_[4]),k[0]&64&&(L.active=!_[6]),g.$set(L),(!V||k[0]&1)&&U(a,"dragging",_[0])},i(_){if(!V){for(let k=0;k<E.length;k+=1)q(r[k]);q(g.$$.fragment,_),V=!0}},o(_){for(let k=0;k<r.length;k+=1)G(r[k]);G(g.$$.fragment,_),V=!1},d(_){_&&X(t);for(let k=0;k<r.length;k+=1)r[k].d();e[20](null),ye(g),e[22](null),e[23](null),p=!1,qe(P)}}}const Ut=12,Ve=200,Xe=32,Ae=200,Ft=1600,ot=.3;function qt(e,t,n){let i,r,s,u;se(e,ge,b=>n(1,s=b)),se(e,ce,b=>n(11,u=b));const o=()=>{k(s.order[s.activeIndex])};let l,v=[],f=0,x=null,y=-1,m="",c,a,g,w=!1,Y=!1,V=0,p=0,P,E=!1;const A=(b,D=300)=>{let B;return(...N)=>{clearTimeout(B),B=setTimeout(()=>{b.apply(void 0,N)},D)}};function _(){ae.newTab()}const k=b=>{const D=s.order.findIndex(B=>B===b);if(D<0||!v[D]){console.warn("Cannot close tab!");return}f=v[D].getBoundingClientRect().width,D<s.order.length-1&&(l.style.setProperty("--tab-max-width",`${f}px`),L()),D==s.activeIndex&&(D==s.order.length-1?ae.setActiveIndex(D-1):ae.setActiveIndex(D+1)),Je({duration:Ae,easing:he,onStep:(B,N)=>{D==0?n(2,l.style.gridTemplateColumns=`minmax(${N*Xe}px, ${N*f}px)`,l):n(2,l.style.gridTemplateColumns=`repeat(${D}, minmax(var(--tab-min-width), var(--tab-max-width))) minmax(${N*Xe}px, ${N*f}px)`,l)},onEnd:()=>{n(2,l.style.gridTemplateColumns="",l),ae.removeTab(b)}})},L=A(()=>{l&&(l.style.setProperty("--tab-max-width",`${Ve}px`),Je({duration:Ae,easing:he,onStep:(b,D)=>{l.style.setProperty("--tab-max-width",`${f+b*(Ve-f)}px`)},onEnd:()=>{l.style.setProperty("--tab-max-width",`${Ve}px`)}}))},Ft);function ee(b){if(!l)return;const D=b.getBoundingClientRect().width;Je({duration:Ae,easing:he,onStep:(B,N)=>{s.order.length==1?n(2,l.style.gridTemplateColumns=`minmax(${B*Xe}px, ${B*D}px)`,l):n(2,l.style.gridTemplateColumns=`repeat(${s.order.length-1}, minmax(var(--tab-min-width), var(--tab-max-width))) minmax(${B*Xe}px, ${B*D}px)`,l),n(2,l.scrollLeft=l.scrollWidth,l)},onEnd:()=>{n(2,l.style.gridTemplateColumns="",l)}})}const ie=(b,D)=>{const B=v[0].getBoundingClientRect().width;ae.moveTab(b,D,()=>{if(b>D)for(let N=D;N<b;N++)it(v[N],{duration:Ae,easing:he,css:(Ye,re)=>`transform: translateX(-${re*B}px);`});if(b<D)for(let N=D;N>b;N--)it(v[N],{duration:Ae,easing:he,css:(Ye,re)=>`transform: translateX(${re*B}px);`})})};function K(b){!b.target||!b.dataTransfer||(b.dataTransfer.setData("text/plain",i),b.dataTransfer.setDragImage(new Image,0,0))}function J(b,D){if(b==0&&D==0){n(5,g.style.left="-1000px",g),n(5,g.style.top="-1000px",g);return}let B=P.getBoundingClientRect();if(b<B.left||b>B.right||D<B.top||D>B.bottom){Y||(p=0),n(5,g.style.left=`${b+V}px`,g),n(5,g.style.top=`${D-a.height/2}px`,g),n(6,Y=!0);return}Y&&n(6,Y=!1),n(5,g.style.left=`${b+V}px`,g),n(5,g.style.top=`${a.top}px`,g);const N=-l.scrollLeft,Ye=v[0].getBoundingClientRect().width;let re=-1;if(b>N+s.order.length*Ye)re=s.order.length-1;else for(let Pe=0;Pe<s.order.length;Pe++)if(b>N+Pe*Ye&&b<N+(Pe+1)*Ye){re=Pe;break}b<20?(p=-ot,requestAnimationFrame(Ie)):b>l.clientWidth-10?(p=ot,requestAnimationFrame(Ie)):p=0,!(re==-1||re==s.placeholderIndex)&&ie(s.placeholderIndex,re)}let Z=0;function Ie(b){if(!w||p==0){Z=0;return}Z==0&&(Z=b);const D=b-Z;Z=b,l.scrollBy({left:p*D}),requestAnimationFrame(Ie)}function Me(b,D){if(!b.target)return;let B,N;b instanceof TouchEvent?(B=b.touches[0].clientX,N=b.touches[0].clientY):(B=b.clientX,N=b.clientY),window.addEventListener("touchmove",oe,{passive:!1}),window.addEventListener("touchend",ne),window.addEventListener("mousemove",oe),window.addEventListener("mouseup",ne),window.addEventListener("drag",oe),window.addEventListener("dragend",ne),window.addEventListener("blur",ne),ae.setActiveIndex(D),c=b.target,a=c.getBoundingClientRect(),x=[B,N],V=a.left-B,a.top-N,n(5,g.style.width=`${a.width}px`,g),n(5,g.style.left=`${a.left}px`,g),n(5,g.style.top=`${a.top}px`,g),y=D,n(4,m=u[s.order[D]].title)}function oe(b){let D,B;if(b instanceof TouchEvent?(D=b.touches[0].clientX,B=b.touches[0].clientY,b.preventDefault()):(D=b.clientX,B=b.clientY),w){J(D,B);return}x===null||Math.hypot(x[0]-D,x[1]-B)<Ut||(n(0,w=!0),ae.setPlaceholderIndex(y),ae.setActiveIndex(y))}function ne(){window.removeEventListener("touchmove",oe),window.removeEventListener("touchend",ne),window.removeEventListener("mousemove",oe),window.removeEventListener("mouseup",ne),window.removeEventListener("drag",oe),window.removeEventListener("dragend",ne),window.removeEventListener("blur",ne),x=null,n(6,Y=!1),y=-1,V=0,ae.setPlaceholderIndex(),n(0,w=!1)}et(()=>{l.style.setProperty("--tab-max-width",`${Ve}px`),l.style.setProperty("--tab-min-width",`${Xe}px`)});const Be=(b,D)=>Me(D,b);function Ge(b,D){e.$$.not_equal(u[D].title,b)&&(u[D].title=b,ce.set(u))}function Ke(b,D){$[b?"unshift":"push"](()=>{v[D]=b,n(3,v)})}function T(b){$[b?"unshift":"push"](()=>{l=b,n(2,l)})}const Q=()=>{fe(ge,s.toolbarVisible=!s.toolbarVisible,s),s.toolbarVisible||fe(ge,s.activeTool=void 0,s)};function R(b){$[b?"unshift":"push"](()=>{g=b,n(5,g)})}function de(b){$[b?"unshift":"push"](()=>{P=b,n(7,P)})}return e.$$.update=()=>{e.$$.dirty[0]&2&&n(9,i=s.order[s.activeIndex]),e.$$.dirty[0]&2&&n(10,r=s.order[s.placeholderIndex]),e.$$.dirty[0]&1&&(w?n(8,E=!0):setTimeout(()=>n(8,E=!1),20))},[w,s,l,v,m,g,Y,P,E,i,r,u,_,ee,K,Me,o,Be,Ge,Ke,T,Q,R,de]}class Wt extends De{constructor(t){super(),Ce(this,t,qt,Nt,xe,{closeActiveTab:16},null,[-1,-1])}get closeActiveTab(){return this.$$.ctx[16]}}function jt(e){let t,n;return{c(){t=H("div"),n=H("div"),this.h()},l(i){t=S(i,"DIV",{class:!0});var r=O(t);n=S(r,"DIV",{}),O(n).forEach(X),r.forEach(X),this.h()},h(){I(t,"class","quill-editor-container svelte-5ttjzj"),U(t,"disabled",e[0])},m(i,r){le(i,t,r),C(t,n),e[5](n)},p(i,[r]){r&1&&U(t,"disabled",i[0])},i:me,o:me,d(i){i&&X(t),e[5](null)}}}function zt(e,t,n){let i,r;se(e,ce,p=>n(6,i=p)),se(e,bt,p=>n(4,r=p));let{tabID:s}=t,{disabled:u=!1}=t,o,l;const v=(p,P=300)=>{let E;return(...A)=>{clearTimeout(E),E=setTimeout(()=>{p.apply(void 0,A)},P)}};async function f(p){var _,k,L,ee;if(!o)return;const{Delta:P,Range:E}=await nt(async()=>{const{Delta:ie,Range:K}=await import("../chunks/core.CG__ofcG.js").then(J=>J.G);return{Delta:ie,Range:K}},[],import.meta.url);if(p.undo.length>0)for(var A=0;A<p.undo.length;A++){const ie=(_=p.undo[A].range)==null?void 0:_.index,K=(k=p.undo[A].range)==null?void 0:k.length,J={delta:new P(p.undo[A].delta.ops),range:ie!==void 0&&K!==void 0?new E(ie,K):null};o.history.stack.undo.push(J)}if(p.redo.length>0)for(var A=0;A<p.redo.length;A++){const K=(L=p.redo[A].range)==null?void 0:L.index,J=(ee=p.redo[A].range)==null?void 0:ee.length,Z={delta:new P(p.redo[A].delta.ops),range:K!==void 0&&J!==void 0?new E(K,J):null};o.history.stack.redo.push(Z)}}function x(p){var P;o&&((P=o.getSelection())==null?void 0:P.length)===0&&window.open(p.target.href,"_blank")}function y(){if(!o||!i[s])return;const p=i[s].ops;o.setContents(p);const P=i[s].history;f(P)}function m(){if(!o||!i[s])return;fe(ce,i[s].ops=o.getContents().ops,i);const p=structuredClone(o.history.stack);fe(ce,i[s].history=p,i)}const c=v(m,500);function a(){if(!o)return;o.formatText(0,o.getLength(),"link",!1,"api");const p=o.getText(),P=/https?:\/\/\S+/gi,E=p.matchAll(P);for(const k of E)o.formatText(k.index,k[0].length,"link",k[0],"api");const A=/.+\@.+\..+/gi,_=p.matchAll(A);for(const k of _)o.formatText(k.index,k[0].length,"link","mailto:"+k[0],"api");document.querySelectorAll(".ql-editor a").forEach(k=>{k.addEventListener("click",x)})}const g=v(a,500);function w(p,P,E){if(E==="user"){const A=o.getText().split(`
`)[0].trim();fe(ce,i[s].title=A===""?"Untitled":A,i),g(),c()}}async function Y(){const{default:p}=await nt(async()=>{const{default:P}=await import("../chunks/quill.Bk4jDS0q.js");return{default:P}},__vite__mapDeps([0,1]),import.meta.url);n(3,o=new p(l,{formats:["bold","italic","underline","strike","code","link"],placeholder:"Enter text here"})),y(),a(),o.on("text-change",w),o.keyboard.addBinding({key:"/",altKey:!0},()=>{o.format("code",!o.getFormat().code)}),o.keyboard.addBinding({key:"-",altKey:!0},()=>{o.format("strike",!o.getFormat().strike)})}et(()=>{Y()});function V(p){$[p?"unshift":"push"](()=>{l=p,n(1,l)})}return e.$$set=p=>{"tabID"in p&&n(2,s=p.tabID),"disabled"in p&&n(0,u=p.disabled)},e.$$.update=()=>{e.$$.dirty&9&&(u?o==null||o.disable():o==null||o.enable()),e.$$.dirty&24&&(o==null||o.root.setAttribute("spellcheck",r.spellCheck.toString()))},[u,l,s,o,r,V]}class Gt extends De{constructor(t){super(),Ce(this,t,zt,jt,xe,{tabID:2,disabled:0})}}const rt=500,Kt=300,at=500,Qt=300;class Jt{constructor(){F(this,"isMoving",!1);F(this,"isLongclick",!1);F(this,"button",0);F(this,"lastX",0);F(this,"lastY",0);F(this,"consecutiveClicks",0);F(this,"lastMouseupTime",0);F(this,"activeElement",null);this.reset()}reset(){this.isMoving=!1,this.isLongclick=!1,this.button=0,this.lastX=0,this.lastY=0,this.consecutiveClicks=0,this.lastMouseupTime=0,this.activeElement=null}}class Zt{constructor(){F(this,"isDragging",!1);F(this,"isPinching",!1);F(this,"isLongpressed",!1);F(this,"consecutiveTaps",0);F(this,"lastTouchendTime",0);F(this,"lastCenterX",0);F(this,"lastCenterY",0);F(this,"identifier",0);F(this,"x",0);F(this,"y",0);F(this,"hypotenuse",0);F(this,"activeElement",null);this.reset()}reset(){this.isDragging=!1,this.isPinching=!1,this.isLongpressed=!1,this.consecutiveTaps=0,this.lastTouchendTime=0,this.lastCenterX=0,this.lastCenterY=0,this.identifier=0,this.x=0,this.y=0,this.hypotenuse=0,this.activeElement=null}}let ue=[],h=new Jt,d=new Zt;const M=(e,t)=>{e!=null&&e.dispatchEvent(new CustomEvent("gesture",{detail:t,bubbles:!1,cancelable:!1}))},wt=e=>{h.reset(),d.reset(),h.lastMouseupTime=Date.now(),window.removeEventListener("mousemove",We),window.removeEventListener("mouseup",je),window.removeEventListener("touchmove",ze),window.removeEventListener("touchend",Le)},kt=e=>{if(window.removeEventListener("mousemove",We),window.removeEventListener("mouseup",je),window.removeEventListener("touchmove",ze),window.removeEventListener("touchend",Le),h.isMoving)if(h.isMoving=!1,h.isLongclick)h.isLongclick=!1,M(h.activeElement,{event:e,name:"longclick-drag-end",x:h.lastX,y:h.lastY,dx:0,dy:0});else switch(h.button){case 0:M(h.activeElement,{event:e,name:"left-click-drag-end",x:h.lastX,y:h.lastY,dx:0,dy:0});break;case 1:M(h.activeElement,{event:e,name:"middle-click-drag-end",x:h.lastX,y:h.lastY,dx:0,dy:0});break;case 2:M(h.activeElement,{event:e,name:"right-click-drag-end",x:h.lastX,y:h.lastY,dx:0,dy:0});break}h.isLongclick&&M(h.activeElement,{event:e,name:"longclick-release",x:h.lastX,y:h.lastY,dx:0,dy:0}),h.reset(),d.isDragging&&(d.isDragging=!1,d.isLongpressed?(d.isLongpressed=!1,M(d.activeElement,{event:e,name:"longpress-drag-end",x:d.lastCenterX,y:d.lastCenterY,dx:0,dy:0})):M(d.activeElement,{event:e,name:"touch-drag-end",x:d.lastCenterX,y:d.lastCenterY,dx:0,dy:0})),d.isLongpressed&&M(d.activeElement,{event:e,name:"longpress-release",x:d.lastCenterX,y:d.lastCenterY,dx:0,dy:0}),d.reset()},Et=e=>{M(e.target,{event:e,name:"wheel",x:e.clientX,y:e.clientY,dx:0,dy:0})},Tt=e=>{},Lt=e=>{document.activeElement!==e.target&&(window.addEventListener("mousemove",We),window.addEventListener("mouseup",je),h.activeElement=e.target,h.lastX=e.clientX,h.lastY=e.clientY,h.isMoving||(h.button=e.button),h.button===0&&window.setTimeout(()=>{Date.now()-h.lastMouseupTime>=at&&!h.isMoving&&(h.isLongclick=!0,M(h.activeElement,{event:e,name:"longclick",x:e.clientX,y:e.clientY,dx:0,dy:0}))},at))},We=e=>{if(e.movementX===0&&e.movementY===0)return;let t=e.clientX-h.lastX,n=e.clientY-h.lastY;if(!h.isMoving)if(h.isLongclick)M(h.activeElement,{event:e,name:"longclick-drag-start",x:e.clientX,y:e.clientY,dx:0,dy:0});else switch(h.button){case 0:M(h.activeElement,{event:e,name:"left-click-drag-start",x:e.clientX,y:e.clientY,dx:0,dy:0});break;case 1:M(h.activeElement,{event:e,name:"middle-click-drag-start",x:e.clientX,y:e.clientY,dx:0,dy:0});break;case 2:M(h.activeElement,{event:e,name:"right-click-drag-start",x:e.clientX,y:e.clientY,dx:0,dy:0});break}if(h.isMoving=!0,h.lastX=e.clientX,h.lastY=e.clientY,h.isLongclick)M(h.activeElement,{event:e,name:"longclick-dragging",x:e.clientX,y:e.clientY,dx:t,dy:n});else switch(h.button){case 0:M(h.activeElement,{event:e,name:"left-click-dragging",x:e.clientX,y:e.clientY,dx:t,dy:n});break;case 1:M(h.activeElement,{event:e,name:"middle-click-dragging",x:e.clientX,y:e.clientY,dx:t,dy:n});break;case 2:M(h.activeElement,{event:e,name:"right-click-dragging",x:e.clientX,y:e.clientY,dx:t,dy:n});break}},je=e=>{if(window.removeEventListener("mousemove",We),window.removeEventListener("mouseup",je),h.lastMouseupTime=Date.now(),h.isMoving)if(h.isMoving=!1,h.isLongclick)h.isLongclick=!1,M(h.activeElement,{event:e,name:"longclick-drag-end",x:h.lastX,y:h.lastY,dx:0,dy:0});else switch(h.button){case 0:M(h.activeElement,{event:e,name:"left-click-drag-end",x:h.lastX,y:h.lastY,dx:0,dy:0});break;case 1:M(h.activeElement,{event:e,name:"middle-click-drag-end",x:h.lastX,y:h.lastY,dx:0,dy:0});break;case 2:M(h.activeElement,{event:e,name:"right-click-drag-end",x:h.lastX,y:h.lastY,dx:0,dy:0});break}else h.isLongclick||(e.button===2?M(h.activeElement,{event:e,name:"right-click",x:e.clientX,y:e.clientY,dx:0,dy:0}):e.button===1?M(h.activeElement,{event:e,name:"middle-click",x:e.clientX,y:e.clientY,dx:0,dy:0}):(h.consecutiveClicks===0&&M(h.activeElement,{event:e,name:"left-click",x:e.clientX,y:e.clientY,dx:0,dy:0}),h.consecutiveClicks++,window.setTimeout(()=>{h.consecutiveClicks>1&&M(h.activeElement,{event:e,name:"double-click",x:e.clientX,y:e.clientY,dx:0,dy:0}),h.consecutiveClicks=0},Qt)));h.isLongclick&&M(h.activeElement,{event:e,name:"longclick-release",x:e.clientX,y:e.clientY,dx:0,dy:0}),h.isLongclick=!1},xt=e=>{if(e.touches.length>1,document.activeElement!==e.target){if(e.touches.length>1){if(e.touches[0].identifier===d.identifier)return;d.isPinching=!0}window.addEventListener("touchmove",ze,{passive:!1}),window.addEventListener("touchend",Le),window.addEventListener("touchcancel",Le),d.identifier=e.touches[0].identifier,d.x=e.touches[0].clientX,d.y=e.touches[0].clientY,d.activeElement=e.target,window.setTimeout(()=>{d.isPinching||d.isDragging||Date.now()-d.lastTouchendTime>=rt&&(d.isDragging=!1,d.isPinching=!1,d.hypotenuse=null,d.isLongpressed=!0,M(d.activeElement,{event:e,name:"longpress",x:d.x,y:d.y,dx:0,dy:0}))},rt)}},ze=e=>{if(d.isDragging){let t=d.x,n=d.y;d.x=e.touches[0].clientX,d.y=e.touches[0].clientY;let i=d.x-t,r=d.y-n;d.isLongpressed?M(d.activeElement,{event:e,name:"longpress-dragging",x:d.x,y:d.y,dx:i,dy:r,force:e.touches[0].force}):M(d.activeElement,{event:e,name:"touch-dragging",x:d.x,y:d.y,dx:i,dy:r,force:e.touches[0].force});return}else if(!d.isLongpressed&&(d.isPinching||e.touches.length>1)){d.x=e.touches[0].clientX,d.y=e.touches[0].clientY;let t={x:e.touches[1].clientX,y:e.touches[1].clientY},n={x:(d.x+t.x)/2,y:(d.y+t.y)/2},i=Math.hypot(d.x-t.x,d.y-t.y);d.hypotenuse===null&&(d.hypotenuse=i,d.lastCenterX=n.x,d.lastCenterY=n.y,M(d.activeElement,{event:e,name:"pinch-start",x:n.x,y:n.y,dx:0,dy:0})),d.isPinching=!0;let r=i/d.hypotenuse,s=n.x-d.lastCenterX,u=n.y-d.lastCenterY;M(d.activeElement,{event:e,name:"pinching",x:n.x,y:n.y,zoom:r,dx:s,dy:u}),d.hypotenuse=i,d.lastCenterX=n.x,d.lastCenterY=n.y;return}else d.isDragging=!0,d.isLongpressed?(M(d.activeElement,{event:e,name:"longpress-drag-start",x:d.x,y:d.y,dx:0,dy:0,force:e.touches[0].force}),d.x=e.touches[0].clientX,d.y=e.touches[0].clientY,M(d.activeElement,{event:e,name:"longpress-dragging",x:d.x,y:d.y,dx:0,dy:0,force:e.touches[0].force})):(M(d.activeElement,{event:e,name:"touch-drag-start",x:d.x,y:d.y,dx:0,dy:0,force:e.touches[0].force}),d.x=e.touches[0].clientX,d.y=e.touches[0].clientY,M(d.activeElement,{event:e,name:"touch-dragging",x:d.x,y:d.y,dx:0,dy:0,force:e.touches[0].force}))},Le=e=>{d.isDragging&&e.touches.length>0&&e.touches[0].identifier===d.identifier||(d.lastTouchendTime=Date.now(),window.removeEventListener("touchmove",ze),window.removeEventListener("touchend",Le),window.removeEventListener("touchcancel",Le),d.isDragging?(d.isDragging=!1,d.isLongpressed?(d.isLongpressed=!1,M(d.activeElement,{event:e,name:"longpress-drag-end",x:d.x,y:d.y,dx:0,dy:0})):M(d.activeElement,{event:e,name:"touch-drag-end",x:d.x,y:d.y,dx:0,dy:0})):d.isPinching?(d.isPinching=!1,d.hypotenuse=null,M(d.activeElement,{event:e,name:"pinch-end",x:d.lastCenterX,y:d.lastCenterY,dx:0,dy:0})):d.isLongpressed||(d.consecutiveTaps===0&&M(d.activeElement,{event:e,name:"tap",x:d.x,y:d.y,dx:0,dy:0}),d.consecutiveTaps++,window.setTimeout(()=>{d.consecutiveTaps>1&&M(d.activeElement,{event:e,name:"double-tap",x:d.x,y:d.y,dx:0,dy:0}),d.consecutiveTaps=0},Kt)),d.isLongpressed&&M(d.activeElement,{event:e,name:"longpress-release",x:d.x,y:d.y,dx:0,dy:0}),d.isLongpressed=!1)};function $t(...e){for(let t of e)ue.findIndex(n=>n===t)===-1&&(ue.length==0&&(window.addEventListener("blur",kt),window.addEventListener("focus",wt)),ue.push(t),t.addEventListener("touchstart",xt,{passive:!1}),t.addEventListener("mousedown",Lt,{passive:!1}),t.addEventListener("contextmenu",Tt,{passive:!1}),t.addEventListener("wheel",Et,{passive:!1}))}function en(...e){const t=n=>{n.removeEventListener("touchstart",xt),n.removeEventListener("mousedown",Lt),n.removeEventListener("contextmenu",Tt),n.removeEventListener("wheel",Et)};if(e.length==0){for(let n of ue)t(n);ue=[]}else for(let n of e){let i=ue.findIndex(r=>r===n);i!==-1&&(t(n),ue.splice(i,1))}ue.length==0&&(window.removeEventListener("blur",kt),window.removeEventListener("focus",wt))}function tn(e){let t,n,i,r;return{c(){t=H("div"),n=H("canvas"),i=j(),r=H("canvas"),this.h()},l(s){t=S(s,"DIV",{class:!0});var u=O(t);n=S(u,"CANVAS",{id:!0,class:!0}),O(n).forEach(X),i=z(u),r=S(u,"CANVAS",{id:!0,class:!0}),O(r).forEach(X),u.forEach(X),this.h()},h(){I(n,"id","currentPath"),I(n,"class","svelte-19x0wjt"),U(n,"disabled",e[0]),I(r,"id","canvas"),I(r,"class","svelte-19x0wjt"),U(r,"disabled",e[0]),I(t,"class","canvas-container svelte-19x0wjt"),U(t,"hide",e[1])},m(s,u){le(s,t,u),C(t,n),e[11](n),C(t,i),C(t,r),e[12](r)},p(s,u){u[0]&1&&U(n,"disabled",s[0]),u[0]&1&&U(r,"disabled",s[0]),u[0]&2&&U(t,"hide",s[1])},i:me,o:me,d(s){s&&X(t),e[11](null),e[12](null)}}}const nn=2,sn=178;function ln(e,t,n){var i=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),r=Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2)),s=Math.sqrt(Math.pow(n.x-e.x,2)+Math.pow(n.y-e.y,2)),u=Math.acos((r*r+i*i-s*s)/(2*r*i));return u*(180/Math.PI)}function ct(e){if(e.points.length<4)return e;for(let t=1;t<e.points.length-2;t++){const n=e.points[t-1],i=e.points[t],r=e.points[t+1];ln(n,i,r)>sn&&(e.points.splice(t,1),t--)}return e}async function He(e,t){if(t.lineWidth=e.lineWidth,t.lineCap="round",t.strokeStyle=e.color,e.points.length<2){t.beginPath(),t.moveTo(e.points[0].x,e.points[0].y),t.lineTo(e.points[0].x,e.points[0].y),t.stroke();return}t.beginPath();let n=e.points[0].x,i=e.points[0].y;for(let r=0;r<e.points.length-1;r++)t.moveTo(n,i),n=(e.points[r].x+e.points[r+1].x)/2,i=(e.points[r].y+e.points[r+1].y)/2,t.quadraticCurveTo(e.points[r].x,e.points[r].y,n,i);t.stroke()}function on(e){return{x:dt(e.x),y:dt(e.y)}}function dt(e){const t=e.toFixed(nn);return Number(t)}function rn(e,t,n){let i;se(e,ce,T=>n(23,i=T));let{radius:r=3}=t,{smoothness:s=0}=t,{stroke:u=5}=t,{color:o="#000000"}=t,{disabled:l=!1}=t,{hide:v=!1}=t,{tabID:f=""}=t;function x(){c.clearRect(0,0,V/p,Y/p),_=[]}function y(){if(_.length!=0){_.pop(),g.clearRect(0,0,V/p,Y/p);for(let T=0;T<_.length;T++)He(_[T],g);Z()}}let m,c,a,g,w={x:0,y:0},Y=0,V=0,p,P=!1,E,A,_=[];function k(){m&&($t(m),window.addEventListener("keydown",Be))}function L(){m&&(en(m),window.removeEventListener("keydown",Be))}const ee=(T,Q,R,de)=>{var b=R-T,D=de-Q;return Math.sqrt(b*b+D*D)},ie=(T,Q=300)=>{let R;return(...de)=>{clearTimeout(R),R=setTimeout(()=>{T.apply(void 0,de)},Q)}};function K(T,Q){let R=m.getBoundingClientRect();return{x:T-R.left,y:Q-R.top}}function J(){if(!m||!a)return;ne(),p=window.devicePixelRatio;let T=m.getBoundingClientRect();Y=T.height*p,V=T.width*p,n(2,m.width=V,m),n(2,m.height=Y,m),n(3,a.width=V,a),n(3,a.height=Y,a),c.scale(p,p),g.scale(p,p);for(let Q=0;Q<_.length;Q++)He(_[Q],g)}function Z(){i[f]&&fe(ce,i[f].paths=_.filter(T=>ct(T)),i)}function Ie(){i[f]&&(_=i[f].paths,J())}function Me(T,Q){P=!0,w=K(T,Q),c.lineWidth=u,c.lineCap="round",c.strokeStyle=o,c.beginPath(),c.moveTo(w.x,w.y),c.stroke(),E={points:[],lineWidth:u,color:o}}function oe(T,Q){if(!P)return;let R=K(T,Q);if(r>0){if(ee(R.x,R.y,w.x,w.y)<=r){E.points.length===0&&(E.points.push(R),He(E,c));return}let de=Math.sqrt(R.x*R.x+R.y*R.y-2*R.x*w.x+w.x*w.x-2*R.y*w.y+w.y*w.y);if(R={x:R.x+r*((w.x-R.x)/de),y:R.y+r*((w.y-R.y)/de)},ee(w.x,w.y,R.x,R.y)<=s)return}E.points.push(on(R)),c.clearRect(0,0,V/p,Y/p),He(E,c),w=R}function ne(){P&&(_.push(ct(E)),He(E,g),c.clearRect(0,0,V/p,Y/p),Z()),P=!1}const Be=function(T){T.ctrlKey&&T.key=="z"&&y(),T.preventDefault()};et(()=>{c=m.getContext("2d"),c.imageSmoothingEnabled=!1,g=a.getContext("2d"),g.imageSmoothingEnabled=!1,m.addEventListener("gesture",T=>{switch(T.detail.name){case"left-click-drag-start":case"touch-drag-start":Me(T.detail.x,T.detail.y);break;case"left-click-dragging":case"touch-dragging":oe(T.detail.x,T.detail.y);break;case"left-click-drag-end":case"touch-drag-end":ne();break;case"left-click":case"tap":Me(T.detail.x,T.detail.y),oe(T.detail.x,T.detail.y),ne();break}}),A=new ResizeObserver(ie(J,0)),A.observe(m),Ie(),l?L():k()}),Mt(()=>{A&&A.disconnect(),L()});function Ge(T){$[T?"unshift":"push"](()=>{a=T,n(3,a)})}function Ke(T){$[T?"unshift":"push"](()=>{m=T,n(2,m)})}return e.$$set=T=>{"radius"in T&&n(4,r=T.radius),"smoothness"in T&&n(5,s=T.smoothness),"stroke"in T&&n(6,u=T.stroke),"color"in T&&n(7,o=T.color),"disabled"in T&&n(0,l=T.disabled),"hide"in T&&n(1,v=T.hide),"tabID"in T&&n(8,f=T.tabID)},e.$$.update=()=>{e.$$.dirty[0]&1&&(l?L():k())},[l,v,m,a,r,s,u,o,f,x,y,Ge,Ke]}class an extends De{constructor(t){super(),Ce(this,t,rn,tn,xe,{radius:4,smoothness:5,stroke:6,color:7,disabled:0,hide:1,tabID:8,clear:9,undo:10},null,[-1,-1])}get clear(){return this.$$.ctx[9]}get undo(){return this.$$.ctx[10]}}function Fe(e,{delay:t=0,duration:n=400,easing:i=Vt,axis:r="y"}={}){const s=getComputedStyle(e),u=+s.opacity,o=r==="y"?"height":"width",l=parseFloat(s[o]),v=r==="y"?["top","bottom"]:["left","right"],f=v.map(w=>`${w[0].toUpperCase()}${w.slice(1)}`),x=parseFloat(s[`padding${f[0]}`]),y=parseFloat(s[`padding${f[1]}`]),m=parseFloat(s[`margin${f[0]}`]),c=parseFloat(s[`margin${f[1]}`]),a=parseFloat(s[`border${f[0]}Width`]),g=parseFloat(s[`border${f[1]}Width`]);return{delay:t,duration:n,easing:i,css:w=>`overflow: hidden;opacity: ${Math.min(w*20,1)*u};${o}: ${w*l}px;padding-${v[0]}: ${w*x}px;padding-${v[1]}: ${w*y}px;margin-${v[0]}: ${w*m}px;margin-${v[1]}: ${w*c}px;border-${v[0]}-width: ${w*a}px;border-${v[1]}-width: ${w*g}px;`}}function ut(e){let t,n,i=`<span class="button-icon svelte-lafg0f" style="-webkit-mask: url(${W}/images/svg/undo.svg) no-repeat center / contain; mask: url(${W}/images/svg/undo.svg) no-repeat center / contain;"></span>`,r,s,u,o,l,v,f,x;return{c(){t=H("div"),n=H("button"),n.innerHTML=i,r=j(),s=H("input"),u=j(),o=H("input"),this.h()},l(y){t=S(y,"DIV",{class:!0});var m=O(t);n=S(m,"BUTTON",{class:!0,"data-svelte-h":!0}),ve(n)!=="svelte-1b4fip4"&&(n.innerHTML=i),r=z(m),s=S(m,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),u=z(m),o=S(m,"INPUT",{type:!0,class:!0}),m.forEach(X),this.h()},h(){I(n,"class","button svelte-lafg0f"),I(s,"type","range"),I(s,"min","2"),I(s,"max","20"),I(s,"step","2"),I(s,"class","slider svelte-lafg0f"),I(o,"type","color"),I(o,"class","color-picker svelte-lafg0f"),I(t,"class","pencil-tools svelte-lafg0f")},m(y,m){le(y,t,m),C(t,n),C(t,r),C(t,s),Oe(s,e[0]),C(t,u),C(t,o),Oe(o,e[1]),v=!0,f||(x=[te(n,"click",function(){ke(e[4])&&e[4].apply(this,arguments)}),te(s,"change",e[9]),te(s,"input",e[9]),te(o,"input",e[10])],f=!0)},p(y,m){e=y,m&1&&Oe(s,e[0]),m&2&&Oe(o,e[1])},i(y){v||(y&&pt(()=>{v&&(l||(l=Ne(t,Fe,{duration:200,axis:"x"},!0)),l.run(1))}),v=!0)},o(y){y&&(l||(l=Ne(t,Fe,{duration:200,axis:"x"},!1)),l.run(0)),v=!1},d(y){y&&X(t),y&&l&&l.end(),f=!1,qe(x)}}}function cn(e){let t,n,i=`<span class="button-icon svelte-lafg0f" style="-webkit-mask: url(${W}/images/svg/pencil.svg) no-repeat center / contain; mask: url(${W}/images/svg/pencil.svg) no-repeat center / contain;"></span>`,r,s,u=`<span class="button-icon svelte-lafg0f" style="-webkit-mask: url(${W}/images/svg/highlighter.svg) no-repeat center / contain; mask: url(${W}/images/svg/highlighter.svg) no-repeat center / contain;"></span>`,o,l,v,f,x,y=`<span class="button-icon svelte-lafg0f" style="-webkit-mask: url(${W}/images/svg/trash.svg) no-repeat center / contain; mask: url(${W}/images/svg/trash.svg) no-repeat center / contain;"></span>`,m,c,a,g,w,Y,V=`<span class="button-icon svelte-lafg0f" style="-webkit-mask: url(${W}/images/svg/user.svg) no-repeat center / contain; mask: url(${W}/images/svg/user.svg) no-repeat center / contain;"></span>`,p,P,E,A,_=(e[5].activeTool==="pencil"||e[5].activeTool==="highlighter")&&ut(e);return{c(){t=H("div"),n=H("button"),n.innerHTML=i,r=j(),s=H("button"),s.innerHTML=u,o=j(),_&&_.c(),l=j(),v=H("div"),f=j(),x=H("button"),x.innerHTML=y,m=j(),c=H("button"),a=H("span"),w=j(),Y=H("a"),Y.innerHTML=V,this.h()},l(k){t=S(k,"DIV",{class:!0});var L=O(t);n=S(L,"BUTTON",{class:!0,"data-svelte-h":!0}),ve(n)!=="svelte-t1zbc2"&&(n.innerHTML=i),r=z(L),s=S(L,"BUTTON",{class:!0,"data-svelte-h":!0}),ve(s)!=="svelte-113qxbd"&&(s.innerHTML=u),o=z(L),_&&_.l(L),l=z(L),v=S(L,"DIV",{class:!0}),O(v).forEach(X),f=z(L),x=S(L,"BUTTON",{class:!0,"data-svelte-h":!0}),ve(x)!=="svelte-cbr57k"&&(x.innerHTML=y),m=z(L),c=S(L,"BUTTON",{class:!0});var ee=O(c);a=S(ee,"SPAN",{class:!0,style:!0}),O(a).forEach(X),ee.forEach(X),w=z(L),Y=S(L,"A",{class:!0,href:!0,"data-svelte-h":!0}),ve(Y)!=="svelte-1xuhzhs"&&(Y.innerHTML=V),L.forEach(X),this.h()},h(){I(n,"class","pencil button svelte-lafg0f"),U(n,"selected",e[5].activeTool==="pencil"),I(s,"class","button svelte-lafg0f"),U(s,"selected",e[5].activeTool==="highlighter"),I(v,"class","spacer svelte-lafg0f"),I(x,"class","close button svelte-lafg0f"),I(a,"class","button-icon svelte-lafg0f"),tt(a,"-webkit-mask","url("+W+"/images/svg/refresh.svg) no-repeat center / contain"),tt(a,"mask","url("+W+"/images/svg/refresh.svg) no-repeat center / contain"),I(c,"class","refresh button svelte-lafg0f"),c.disabled=g=e[6].savingStatus==="saving",I(Y,"class","button svelte-lafg0f"),I(Y,"href",W+"/profile"),I(t,"class","toolbar-container svelte-lafg0f")},m(k,L){le(k,t,L),C(t,n),C(t,r),C(t,s),C(t,o),_&&_.m(t,null),C(t,l),C(t,v),C(t,f),C(t,x),C(t,m),C(t,c),C(c,a),C(t,w),C(t,Y),P=!0,E||(A=[te(n,"click",e[7]),te(s,"click",e[8]),te(x,"click",function(){ke(e[3])&&e[3].apply(this,arguments)}),te(c,"click",function(){ke(e[2])&&e[2].apply(this,arguments)})],E=!0)},p(k,[L]){e=k,(!P||L&32)&&U(n,"selected",e[5].activeTool==="pencil"),(!P||L&32)&&U(s,"selected",e[5].activeTool==="highlighter"),e[5].activeTool==="pencil"||e[5].activeTool==="highlighter"?_?(_.p(e,L),L&32&&q(_,1)):(_=ut(e),_.c(),q(_,1),_.m(t,l)):_&&(Ee(),G(_,1,1,()=>{_=null}),Te()),(!P||L&64&&g!==(g=e[6].savingStatus==="saving"))&&(c.disabled=g)},i(k){P||(q(_),k&&pt(()=>{P&&(p||(p=Ne(t,Fe,{duration:200},!0)),p.run(1))}),P=!0)},o(k){G(_),k&&(p||(p=Ne(t,Fe,{duration:200},!1)),p.run(0)),P=!1},d(k){k&&X(t),_&&_.d(),k&&p&&p.end(),E=!1,qe(A)}}}function dn(e,t,n){let i,r;se(e,ge,c=>n(5,i=c)),se(e,_t,c=>n(6,r=c));let{onRefresh:s=()=>{}}=t,{onClose:u=()=>{}}=t,{onDrawingUndo:o=()=>{}}=t,{stroke:l}=t,{color:v}=t;const f=()=>{fe(ge,i.activeTool=i.activeTool==="pencil"?void 0:"pencil",i)},x=()=>{fe(ge,i.activeTool=i.activeTool==="highlighter"?void 0:"highlighter",i)};function y(){l=At(this.value),n(0,l)}function m(){v=this.value,n(1,v)}return e.$$set=c=>{"onRefresh"in c&&n(2,s=c.onRefresh),"onClose"in c&&n(3,u=c.onClose),"onDrawingUndo"in c&&n(4,o=c.onDrawingUndo),"stroke"in c&&n(0,l=c.stroke),"color"in c&&n(1,v=c.color)},[l,v,s,u,o,i,r,f,x,y,m]}class un extends De{constructor(t){super(),Ce(this,t,dn,cn,xe,{onRefresh:2,onClose:3,onDrawingUndo:4,stroke:0,color:1})}}function ft(e,t,n){const i=e.slice();return i[19]=t[n],i[20]=t,i[21]=n,i}function gt(e,t,n){const i=e.slice();return i[19]=t[n],i}function ht(e){let t,n,i,r;function s(l){e[13](l)}function u(l){e[14](l)}let o={onClose:e[10],onDrawingUndo:e[11],onRefresh:e[12]};return e[3]!==void 0&&(o.stroke=e[3]),e[0]!==void 0&&(o.color=e[0]),t=new un({props:o}),$.push(()=>Re(t,"stroke",s)),$.push(()=>Re(t,"color",u)),{c(){pe(t.$$.fragment)},l(l){be(t.$$.fragment,l)},m(l,v){_e(t,l,v),r=!0},p(l,v){const f={};v&16&&(f.onClose=l[10]),v&96&&(f.onDrawingUndo=l[11]),!n&&v&8&&(n=!0,f.stroke=l[3],Se(()=>n=!1)),!i&&v&1&&(i=!0,f.color=l[0],Se(()=>i=!1)),t.$set(f)},i(l){r||(q(t.$$.fragment,l),r=!0)},o(l){G(t.$$.fragment,l),r=!1},d(l){ye(t,l)}}}function fn(e){let t,n;return t=new St({}),{c(){pe(t.$$.fragment)},l(i){be(t.$$.fragment,i)},m(i,r){_e(t,i,r),n=!0},p:me,i(i){n||(q(t.$$.fragment,i),n=!0)},o(i){G(t.$$.fragment,i),n=!1},d(i){ye(t,i)}}}function gn(e){let t,n,i=[],r=new Map,s,u,o=[],l=new Map,v,f=we(Object.keys(e[8]));const x=c=>c[19];for(let c=0;c<f.length;c+=1){let a=gt(e,f,c),g=x(a);r.set(g,i[c]=vt(g,a))}let y=we(Object.keys(e[8]));const m=c=>c[19];for(let c=0;c<y.length;c+=1){let a=ft(e,y,c),g=m(a);l.set(g,o[c]=mt(g,a))}return{c(){t=H("div"),n=H("div");for(let c=0;c<i.length;c+=1)i[c].c();s=j(),u=H("div");for(let c=0;c<o.length;c+=1)o[c].c();this.h()},l(c){t=S(c,"DIV",{class:!0});var a=O(t);n=S(a,"DIV",{class:!0});var g=O(n);for(let Y=0;Y<i.length;Y+=1)i[Y].l(g);g.forEach(X),s=z(a),u=S(a,"DIV",{class:!0});var w=O(u);for(let Y=0;Y<o.length;Y+=1)o[Y].l(w);w.forEach(X),a.forEach(X),this.h()},h(){I(n,"class","editor-container svelte-11mfkf2"),I(u,"class","drawing-container svelte-11mfkf2"),U(u,"disabled",e[1].activeTool===void 0),I(t,"class","canvas-container svelte-11mfkf2")},m(c,a){le(c,t,a),C(t,n);for(let g=0;g<i.length;g+=1)i[g]&&i[g].m(n,null);C(t,s),C(t,u);for(let g=0;g<o.length;g+=1)o[g]&&o[g].m(u,null);v=!0},p(c,a){a&320&&(f=we(Object.keys(c[8])),Ee(),i=Ze(i,a,x,1,c,f,r,n,$e,vt,null,gt),Te()),a&366&&(y=we(Object.keys(c[8])),Ee(),o=Ze(o,a,m,1,c,y,l,u,$e,mt,null,ft),Te()),(!v||a&2)&&U(u,"disabled",c[1].activeTool===void 0)},i(c){if(!v){for(let a=0;a<f.length;a+=1)q(i[a]);for(let a=0;a<y.length;a+=1)q(o[a]);v=!0}},o(c){for(let a=0;a<i.length;a+=1)G(i[a]);for(let a=0;a<o.length;a+=1)G(o[a]);v=!1},d(c){c&&X(t);for(let a=0;a<i.length;a+=1)i[a].d();for(let a=0;a<o.length;a+=1)o[a].d()}}}function vt(e,t){let n,i,r;return i=new Gt({props:{disabled:t[19]!==t[6],tabID:t[19]}}),{key:e,first:null,c(){n=Ue(),pe(i.$$.fragment),this.h()},l(s){n=Ue(),be(i.$$.fragment,s),this.h()},h(){this.first=n},m(s,u){le(s,n,u),_e(i,s,u),r=!0},p(s,u){t=s;const o={};u&320&&(o.disabled=t[19]!==t[6]),u&256&&(o.tabID=t[19]),i.$set(o)},i(s){r||(q(i.$$.fragment,s),r=!0)},o(s){G(i.$$.fragment,s),r=!1},d(s){s&&X(n),ye(i,s)}}}function mt(e,t){let n,i,r=t[19],s,u,o;const l=()=>t[15](i,r),v=()=>t[15](null,r);function f(m){t[16](m)}function x(m){t[17](m)}let y={tabID:t[19],hide:t[19]!==t[6],disabled:t[19]!==t[6]||t[1].activeTool===void 0};return t[2]!==void 0&&(y.color=t[2]),t[3]!==void 0&&(y.stroke=t[3]),i=new an({props:y}),l(),$.push(()=>Re(i,"color",f)),$.push(()=>Re(i,"stroke",x)),{key:e,first:null,c(){n=Ue(),pe(i.$$.fragment),this.h()},l(m){n=Ue(),be(i.$$.fragment,m),this.h()},h(){this.first=n},m(m,c){le(m,n,c),_e(i,m,c),o=!0},p(m,c){t=m,r!==t[19]&&(v(),r=t[19],l());const a={};c&256&&(a.tabID=t[19]),c&320&&(a.hide=t[19]!==t[6]),c&322&&(a.disabled=t[19]!==t[6]||t[1].activeTool===void 0),!s&&c&4&&(s=!0,a.color=t[2],Se(()=>s=!1)),!u&&c&8&&(u=!0,a.stroke=t[3],Se(()=>u=!1)),i.$set(a)},i(m){o||(q(i.$$.fragment,m),o=!0)},o(m){G(i.$$.fragment,m),o=!1},d(m){m&&X(n),v(),ye(i,m)}}}function hn(e){let t,n,i,r,s,u,o,l,v={};n=new Wt({props:v}),e[9](n);let f=e[1].toolbarVisible&&e[1].order.length>0&&ht(e);const x=[gn,fn],y=[];function m(c,a){return c[7].currentUser&&!c[7].isLoading?0:1}return u=m(e),o=y[u]=x[u](e),{c(){t=H("div"),pe(n.$$.fragment),i=j(),r=H("div"),f&&f.c(),s=j(),o.c(),this.h()},l(c){t=S(c,"DIV",{class:!0});var a=O(t);be(n.$$.fragment,a),i=z(a),r=S(a,"DIV",{class:!0});var g=O(r);f&&f.l(g),g.forEach(X),s=z(a),o.l(a),a.forEach(X),this.h()},h(){I(r,"class","toolbar"),I(t,"class","page-container svelte-11mfkf2")},m(c,a){le(c,t,a),_e(n,t,null),C(t,i),C(t,r),f&&f.m(r,null),C(t,s),y[u].m(t,null),l=!0},p(c,[a]){const g={};n.$set(g),c[1].toolbarVisible&&c[1].order.length>0?f?(f.p(c,a),a&2&&q(f,1)):(f=ht(c),f.c(),q(f,1),f.m(r,null)):f&&(Ee(),G(f,1,1,()=>{f=null}),Te());let w=u;u=m(c),u===w?y[u].p(c,a):(Ee(),G(y[w],1,1,()=>{y[w]=null}),Te(),o=y[u],o?o.p(c,a):(o=y[u]=x[u](c),o.c()),q(o,1),o.m(t,null))},i(c){l||(q(n.$$.fragment,c),q(f),q(o),l=!0)},o(c){G(n.$$.fragment,c),G(f),G(o),l=!1},d(c){c&&X(t),e[9](null),ye(n),f&&f.d(),y[u].d()}}}function vn(e,t){var n=parseInt(e.slice(1,3),16),i=parseInt(e.slice(3,5),16),r=parseInt(e.slice(5,7),16);return"rgba("+n+", "+i+", "+r+", "+t+")"}function mn(e,t,n){let i,r,s,u,o;se(e,ge,E=>n(1,r=E)),se(e,bt,E=>n(18,s=E)),se(e,_t,E=>n(7,u=E)),se(e,ce,E=>n(8,o=E));let l="#000000",v="rgba(0, 0, 0, 1)",f=10,x,y={};ge.subscribe(E=>{if(E.activeTool==="highlighter")n(0,l="#ffdd33");else if(E.activeTool==="pencil"){const A=Rt.find(_=>_.name===s.theme);A&&n(0,l=A.caret)}});function m(E){$[E?"unshift":"push"](()=>{x=E,n(4,x)})}const c=()=>x.closeActiveTab(),a=()=>y[i].undo(),g=()=>Ht.loadFromFirestore();function w(E){f=E,n(3,f)}function Y(E){l=E,n(0,l)}function V(E,A){$[E?"unshift":"push"](()=>{y[A]=E,n(5,y)})}function p(E){v=E,n(2,v),n(1,r),n(0,l)}function P(E){f=E,n(3,f)}return e.$$.update=()=>{e.$$.dirty&2&&n(6,i=r.order[r.activeIndex]),e.$$.dirty&3&&n(2,v=r.activeTool==="highlighter"?vn(l,.3):l)},[l,r,v,f,x,y,i,u,o,m,c,a,g,w,Y,V,p,P]}class xn extends De{constructor(t){super(),Ce(this,t,mn,hn,xe,{})}}export{xn as component};
