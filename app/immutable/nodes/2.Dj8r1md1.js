const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/quill.Bk4jDS0q.js","../chunks/core.CG__ofcG.js"])))=>i.map(i=>d[i]);
var Ct=Object.defineProperty;var It=(e,t,n)=>t in e?Ct(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var q=(e,t,n)=>It(e,typeof t!="symbol"?t+"":t,n);import{s as De,n as ge,r as $e,i as Ee,e as et,c as ie,a as de,o as tt,d as Z,A as Mt,B as Se,C as Yt}from"../chunks/scheduler.CE28Mlnp.js";import{S as Ce,i as Ie,e as A,b as Pt,c as S,d as V,f as Xt,g as H,w as I,A as F,j as te,k as C,x as $,F as Ke,l as Ht,s as G,v as ae,h as j,z as nt,a as W,o as ve,t as Q,n as me,G as Te,C as Ve,I as At,p as pe,q as be,r as _e,u as ye,J as Re,m as Ue}from"../chunks/index.D5PJChdz.js";import{e as ke,u as Je,o as Ze}from"../chunks/each.Cu__Fv10.js";import{b as z}from"../chunks/paths.B8-opH-5.js";import{m as ce,a as _t,t as ue,d as oe,s as yt,f as St}from"../chunks/firebaseStore.DdkJNw79.js";import{_ as it}from"../chunks/preload-helper.D6kgxu3v.js";import{P as Rt}from"../chunks/ProgressBar.CJ1_gDeh.js";import{t as Bt}from"../chunks/themes.BTx5Q4mv.js";function Ot(e){let t,n,i,r,o,u;return{c(){t=A("div"),n=A("button"),i=A("span"),r=Pt(e[0]),this.h()},l(l){t=S(l,"DIV",{class:!0});var s=V(t);n=S(s,"BUTTON",{class:!0,draggable:!0});var g=V(n);i=S(g,"SPAN",{class:!0});var h=V(i);r=Xt(h,e[0]),h.forEach(H),g.forEach(H),s.forEach(H),this.h()},h(){I(i,"class","title svelte-w1fi59"),I(n,"class","tab svelte-w1fi59"),I(n,"draggable","true"),F(n,"active",e[1]),I(t,"class","tab-container svelte-w1fi59"),F(t,"preventHover",e[2])},m(l,s){te(l,t,s),C(t,n),C(n,i),C(i,r),o||(u=[$(n,"mousedown",Ke(function(){Ee(e[3])&&e[3].apply(this,arguments)})),$(n,"touchstart",Ke(function(){Ee(e[3])&&e[3].apply(this,arguments)})),$(n,"dragstart",Ke(function(){Ee(e[4])&&e[4].apply(this,arguments)}))],o=!0)},p(l,[s]){e=l,s&1&&Ht(r,e[0]),s&2&&F(n,"active",e[1]),s&4&&F(t,"preventHover",e[2])},i:ge,o:ge,d(l){l&&H(t),o=!1,$e(u)}}}function Vt(e,t,n){let{title:i=""}=t,{active:r=!1}=t,{preventHover:o=!1}=t,{onPointerdown:u=s=>{}}=t,{onDragstart:l=s=>{}}=t;return e.$$set=s=>{"title"in s&&n(0,i=s.title),"active"in s&&n(1,r=s.active),"preventHover"in s&&n(2,o=s.preventHover),"onPointerdown"in s&&n(3,u=s.onPointerdown),"onDragstart"in s&&n(4,l=s.onDragstart)},[i,r,o,u,l]}class wt extends Ce{constructor(t){super(),Ie(this,t,Vt,Ot,De,{title:0,active:1,preventHover:2,onPointerdown:3,onDragstart:4})}}function he(e){return e<.5?4*e*e*e:.5*Math.pow(2*e-2,3)+1}function Nt(e){const t=e-1;return t*t*t+1}const st=(e,t)=>{const{duration:n=300,easing:i=he,onEnd:r=()=>{},onStep:o=()=>{},css:u}=t;let l;function s(g){if(!e){console.warn("Cannot find element to animate");return}l===void 0&&(l=g);const h=i((g-l)/n),x=1-h;h<1?(e.style.cssText=u(h,x),o(h,x),requestAnimationFrame(s)):(e.style.cssText="",r())}requestAnimationFrame(s)},Qe=e=>{const{duration:t=300,easing:n=he,onEnd:i=()=>{},onStep:r=()=>{}}=e;let o;function u(l){o===void 0&&(o=l);const s=n((l-o)/t),g=1-s;s<1?(r(s,g),requestAnimationFrame(u)):i()}requestAnimationFrame(u)};function Le(e,{delay:t=0,duration:n=400,easing:i=Nt,axis:r="y"}={}){const o=getComputedStyle(e),u=+o.opacity,l=r==="y"?"height":"width",s=parseFloat(o[l]),g=r==="y"?["top","bottom"]:["left","right"],h=g.map(w=>`${w[0].toUpperCase()}${w.slice(1)}`),x=parseFloat(o[`padding${h[0]}`]),E=parseFloat(o[`padding${h[1]}`]),p=parseFloat(o[`margin${h[0]}`]),d=parseFloat(o[`margin${h[1]}`]),a=parseFloat(o[`border${h[0]}Width`]),v=parseFloat(o[`border${h[1]}Width`]);return{delay:t,duration:n,easing:i,css:w=>`overflow: hidden;opacity: ${Math.min(w*20,1)*u};${l}: ${w*s}px;padding-${g[0]}: ${w*x}px;padding-${g[1]}: ${w*E}px;margin-${g[0]}: ${w*p}px;margin-${g[1]}: ${w*d}px;border-${g[0]}-width: ${w*a}px;border-${g[1]}-width: ${w*v}px;`}}function lt(e){let t,n,i=`<span class="button-icon svelte-gdw1d8" style="-webkit-mask: url(${z}/images/svg/undo.svg) no-repeat center / contain; mask: url(${z}/images/svg/undo.svg) no-repeat center / contain;"></span>`,r,o,u,l,s,g,h,x;return{c(){t=A("div"),n=A("button"),n.innerHTML=i,r=G(),o=A("input"),u=G(),l=A("input"),this.h()},l(E){t=S(E,"DIV",{class:!0});var p=V(t);n=S(p,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(n)!=="svelte-1b4fip4"&&(n.innerHTML=i),r=j(p),o=S(p,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),u=j(p),l=S(p,"INPUT",{type:!0,class:!0}),p.forEach(H),this.h()},h(){I(n,"class","button svelte-gdw1d8"),I(o,"type","range"),I(o,"min","2"),I(o,"max","20"),I(o,"step","2"),I(o,"class","slider svelte-gdw1d8"),I(l,"type","color"),I(l,"class","color-picker svelte-gdw1d8"),I(t,"class","pencil-tools svelte-gdw1d8")},m(E,p){te(E,t,p),C(t,n),C(t,r),C(t,o),Ve(o,e[0]),C(t,u),C(t,l),Ve(l,e[1]),g=!0,h||(x=[$(n,"click",function(){Ee(e[4])&&e[4].apply(this,arguments)}),$(o,"change",e[9]),$(o,"input",e[9]),$(l,"input",e[10])],h=!0)},p(E,p){e=E,p&1&&Ve(o,e[0]),p&2&&Ve(l,e[1])},i(E){g||(E&&et(()=>{g&&(s||(s=Te(t,Le,{duration:200,axis:"x"},!0)),s.run(1))}),g=!0)},o(E){E&&(s||(s=Te(t,Le,{duration:200,axis:"x"},!1)),s.run(0)),g=!1},d(E){E&&H(t),E&&s&&s.end(),h=!1,$e(x)}}}function Ut(e){let t,n,i=`<span class="button-icon svelte-gdw1d8" style="-webkit-mask: url(${z}/images/svg/pencil.svg) no-repeat center / contain; mask: url(${z}/images/svg/pencil.svg) no-repeat center / contain;"></span>`,r,o,u=`<span class="button-icon svelte-gdw1d8" style="-webkit-mask: url(${z}/images/svg/highlighter.svg) no-repeat center / contain; mask: url(${z}/images/svg/highlighter.svg) no-repeat center / contain;"></span>`,l,s,g,h,x,E=`<span class="button-icon svelte-gdw1d8" style="-webkit-mask: url(${z}/images/svg/trash.svg) no-repeat center / contain; mask: url(${z}/images/svg/trash.svg) no-repeat center / contain;"></span>`,p,d,a,v,w,Y,U=`<span class="button-icon svelte-gdw1d8" style="-webkit-mask: url(${z}/images/svg/user.svg) no-repeat center / contain; mask: url(${z}/images/svg/user.svg) no-repeat center / contain;"></span>`,_,X,y=`<span class="button-icon svelte-gdw1d8" style="-webkit-mask: url(${z}/images/svg/xmark-small.svg) no-repeat center / contain; mask: url(${z}/images/svg/xmark-small.svg) no-repeat center / contain;"></span>`,b,T,D,ee,R=(e[5].activeTool==="pencil"||e[5].activeTool==="highlighter")&&lt(e);return{c(){t=A("div"),n=A("button"),n.innerHTML=i,r=G(),o=A("button"),o.innerHTML=u,l=G(),R&&R.c(),s=G(),g=A("div"),h=G(),x=A("button"),x.innerHTML=E,p=G(),d=A("button"),a=A("span"),w=G(),Y=A("a"),Y.innerHTML=U,_=G(),X=A("button"),X.innerHTML=y,this.h()},l(N){t=S(N,"DIV",{class:!0});var P=V(t);n=S(P,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(n)!=="svelte-t1zbc2"&&(n.innerHTML=i),r=j(P),o=S(P,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(o)!=="svelte-113qxbd"&&(o.innerHTML=u),l=j(P),R&&R.l(P),s=j(P),g=S(P,"DIV",{class:!0}),V(g).forEach(H),h=j(P),x=S(P,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(x)!=="svelte-cbr57k"&&(x.innerHTML=E),p=j(P),d=S(P,"BUTTON",{class:!0});var K=V(d);a=S(K,"SPAN",{class:!0,style:!0}),V(a).forEach(H),K.forEach(H),w=j(P),Y=S(P,"A",{class:!0,href:!0,"data-svelte-h":!0}),ae(Y)!=="svelte-1xuhzhs"&&(Y.innerHTML=U),_=j(P),X=S(P,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(X)!=="svelte-1fqu5xp"&&(X.innerHTML=y),P.forEach(H),this.h()},h(){I(n,"class","pencil button svelte-gdw1d8"),F(n,"selected",e[5].activeTool==="pencil"),I(o,"class","button svelte-gdw1d8"),F(o,"selected",e[5].activeTool==="highlighter"),I(g,"class","spacer svelte-gdw1d8"),I(x,"class","close button svelte-gdw1d8"),I(a,"class","button-icon svelte-gdw1d8"),nt(a,"-webkit-mask","url("+z+"/images/svg/refresh.svg) no-repeat center / contain"),nt(a,"mask","url("+z+"/images/svg/refresh.svg) no-repeat center / contain"),I(d,"class","refresh button svelte-gdw1d8"),d.disabled=v=e[6].savingStatus==="saving",I(Y,"class","button svelte-gdw1d8"),I(Y,"href",z+"/profile"),I(X,"class","button svelte-gdw1d8"),I(t,"class","toolbar-container svelte-gdw1d8")},m(N,P){te(N,t,P),C(t,n),C(t,r),C(t,o),C(t,l),R&&R.m(t,null),C(t,s),C(t,g),C(t,h),C(t,x),C(t,p),C(t,d),C(d,a),C(t,w),C(t,Y),C(t,_),C(t,X),T=!0,D||(ee=[$(n,"click",e[7]),$(o,"click",e[8]),$(x,"click",function(){Ee(e[3])&&e[3].apply(this,arguments)}),$(d,"click",function(){Ee(e[2])&&e[2].apply(this,arguments)}),$(X,"click",e[11])],D=!0)},p(N,[P]){e=N,(!T||P&32)&&F(n,"selected",e[5].activeTool==="pencil"),(!T||P&32)&&F(o,"selected",e[5].activeTool==="highlighter"),e[5].activeTool==="pencil"||e[5].activeTool==="highlighter"?R?(R.p(e,P),P&32&&W(R,1)):(R=lt(e),R.c(),W(R,1),R.m(t,s)):R&&(ve(),Q(R,1,1,()=>{R=null}),me()),(!T||P&64&&v!==(v=e[6].savingStatus==="saving"))&&(d.disabled=v)},i(N){T||(W(R),N&&et(()=>{T&&(b||(b=Te(t,Le,{duration:200},!0)),b.run(1))}),T=!0)},o(N){Q(R),N&&(b||(b=Te(t,Le,{duration:200},!1)),b.run(0)),T=!1},d(N){N&&H(t),R&&R.d(),N&&b&&b.end(),D=!1,$e(ee)}}}function Ft(e,t,n){let i,r;ie(e,ce,a=>n(5,i=a)),ie(e,_t,a=>n(6,r=a));let{onRefresh:o=()=>{}}=t,{onClose:u=()=>{}}=t,{onDrawingUndo:l=()=>{}}=t,{stroke:s}=t,{color:g}=t;const h=()=>{de(ce,i.activeTool=i.activeTool==="pencil"?void 0:"pencil",i)},x=()=>{de(ce,i.activeTool=i.activeTool==="highlighter"?void 0:"highlighter",i)};function E(){s=At(this.value),n(0,s)}function p(){g=this.value,n(1,g)}const d=()=>{de(ce,i.toolbarVisible=!1,i),de(ce,i.activeTool=void 0,i)};return e.$$set=a=>{"onRefresh"in a&&n(2,o=a.onRefresh),"onClose"in a&&n(3,u=a.onClose),"onDrawingUndo"in a&&n(4,l=a.onDrawingUndo),"stroke"in a&&n(0,s=a.stroke),"color"in a&&n(1,g=a.color)},[s,g,o,u,l,i,r,h,x,E,p,d]}class qt extends Ce{constructor(t){super(),Ie(this,t,Ft,Ut,De,{onRefresh:2,onClose:3,onDrawingUndo:4,stroke:0,color:1})}}function rt(e,t,n){const i=e.slice();return i[41]=t[n],i[42]=t,i[43]=n,i}function ot(e,t){let n,i,r,o,u=t[43],l,s,g;function h(...a){return t[17](t[43],...a)}function x(a){t[18](a,t[41])}let E={active:t[9]==t[41],preventHover:t[8],onPointerdown:h,onDragstart:t[14]};t[11][t[41]].title!==void 0&&(E.title=t[11][t[41]].title),i=new wt({props:E}),Z.push(()=>Re(i,"title",x));const p=()=>t[19](n,u),d=()=>t[19](null,u);return{key:e,first:null,c(){n=A("div"),pe(i.$$.fragment),o=G(),this.h()},l(a){n=S(a,"DIV",{class:!0});var v=V(n);be(i.$$.fragment,v),o=j(v),v.forEach(H),this.h()},h(){I(n,"class","tab-container svelte-6u8cf7"),F(n,"placeholder",t[10]==t[41]),this.first=n},m(a,v){te(a,n,v),_e(i,n,null),C(n,o),p(),l=!0,s||(g=Mt(t[13].call(null,n)),s=!0)},p(a,v){t=a;const w={};v[0]&514&&(w.active=t[9]==t[41]),v[0]&256&&(w.preventHover=t[8]),v[0]&2&&(w.onPointerdown=h),!r&&v[0]&2050&&(r=!0,w.title=t[11][t[41]].title,Se(()=>r=!1)),i.$set(w),u!==t[43]&&(d(),u=t[43],p()),(!l||v[0]&1026)&&F(n,"placeholder",t[10]==t[41])},i(a){l||(W(i.$$.fragment,a),l=!0)},o(a){Q(i.$$.fragment,a),l=!1},d(a){a&&H(n),ye(i),d(),s=!1,g()}}}function at(e){let t,n=`<span class="button-icon svelte-6u8cf7" style="-webkit-mask: url(${z}/images/svg/gear.svg) no-repeat center / contain; mask: url(${z}/images/svg/gear.svg) no-repeat center / contain;"></span>`,i,r,o,u;return{c(){t=A("button"),t.innerHTML=n,this.h()},l(l){t=S(l,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(t)!=="svelte-1wioe5y"&&(t.innerHTML=n),this.h()},h(){I(t,"class","button svelte-6u8cf7")},m(l,s){te(l,t,s),r=!0,o||(u=$(t,"click",e[21]),o=!0)},p:ge,i(l){r||(l&&et(()=>{r&&(i||(i=Te(t,Le,{duration:200,axis:"x"},!0)),i.run(1))}),r=!0)},o(l){l&&(i||(i=Te(t,Le,{duration:200,axis:"x"},!1)),i.run(0)),r=!1},d(l){l&&H(t),l&&i&&i.end(),o=!1,u()}}}function Wt(e){let t,n,i,r=[],o=new Map,u,l,s,g=`<span class="button-icon svelte-6u8cf7" style="-webkit-mask: url(${z}/images/svg/plus.svg) no-repeat center / contain; mask: url(${z}/images/svg/plus.svg) no-repeat center / contain;"></span>`,h,x,E,p,d,a,v,w,Y,U,_=ke(e[1].order);const X=b=>b[41];for(let b=0;b<_.length;b+=1){let T=rt(e,_,b),D=X(T);o.set(D,r[b]=ot(D,T))}let y=!e[1].toolbarVisible&&e[1].order.length>0&&at(e);return d=new wt({props:{title:e[4],active:!e[6],preventHover:!0}}),{c(){t=A("div"),n=A("div"),i=A("div");for(let b=0;b<r.length;b+=1)r[b].c();u=G(),l=A("div"),s=A("button"),s.innerHTML=g,h=G(),x=A("div"),y&&y.c(),E=G(),p=A("div"),pe(d.$$.fragment),a=G(),v=A("div"),this.h()},l(b){t=S(b,"DIV",{class:!0});var T=V(t);n=S(T,"DIV",{class:!0});var D=V(n);i=S(D,"DIV",{class:!0});var ee=V(i);for(let K=0;K<r.length;K+=1)r[K].l(ee);ee.forEach(H),u=j(D),l=S(D,"DIV",{class:!0});var R=V(l);s=S(R,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(s)!=="svelte-g0ls06"&&(s.innerHTML=g),R.forEach(H),h=j(D),x=S(D,"DIV",{class:!0});var N=V(x);y&&y.l(N),N.forEach(H),E=j(D),p=S(D,"DIV",{class:!0});var P=V(p);be(d.$$.fragment,P),P.forEach(H),D.forEach(H),a=j(T),v=S(T,"DIV",{class:!0}),V(v).forEach(H),T.forEach(H),this.h()},h(){I(i,"class","tabs svelte-6u8cf7"),I(s,"class","button svelte-6u8cf7"),I(l,"class","new-tab-container svelte-6u8cf7"),I(x,"class","buttons-container svelte-6u8cf7"),I(p,"class","clone svelte-6u8cf7"),F(p,"dragging",e[0]),I(n,"class","tabbar svelte-6u8cf7"),I(v,"class","divider svelte-6u8cf7"),I(t,"class","svelte-6u8cf7")},m(b,T){te(b,t,T),C(t,n),C(n,i);for(let D=0;D<r.length;D+=1)r[D]&&r[D].m(i,null);e[20](i),C(n,u),C(n,l),C(l,s),C(n,h),C(n,x),y&&y.m(x,null),C(n,E),C(n,p),_e(d,p,null),e[22](p),C(t,a),C(t,v),e[23](t),w=!0,Y||(U=$(s,"click",e[12]),Y=!0)},p(b,T){T[0]&53002&&(_=ke(b[1].order),ve(),r=Je(r,T,X,1,b,_,o,i,Ze,ot,null,rt),me()),!b[1].toolbarVisible&&b[1].order.length>0?y?(y.p(b,T),T[0]&2&&W(y,1)):(y=at(b),y.c(),W(y,1),y.m(x,null)):y&&(ve(),Q(y,1,1,()=>{y=null}),me());const D={};T[0]&16&&(D.title=b[4]),T[0]&64&&(D.active=!b[6]),d.$set(D),(!w||T[0]&1)&&F(p,"dragging",b[0])},i(b){if(!w){for(let T=0;T<_.length;T+=1)W(r[T]);W(y),W(d.$$.fragment,b),w=!0}},o(b){for(let T=0;T<r.length;T+=1)Q(r[T]);Q(y),Q(d.$$.fragment,b),w=!1},d(b){b&&H(t);for(let T=0;T<r.length;T+=1)r[T].d();e[20](null),y&&y.d(),ye(d),e[22](null),e[23](null),Y=!1,U()}}}const zt=12,Ne=200,Xe=32,He=200,Gt=1600,ct=.3;function jt(e,t,n){let i,r,o,u;ie(e,ce,f=>n(1,o=f)),ie(e,ue,f=>n(11,u=f));const l=()=>{D(o.order[o.activeIndex])};let s,g=[],h=0,x=null,E=-1,p="",d,a,v,w=!1,Y=!1,U=0,_=0,X,y=!1;const b=(f,L=300)=>{let B;return(...O)=>{clearTimeout(B),B=setTimeout(()=>{f.apply(void 0,O)},L)}};function T(){oe.newTab()}const D=f=>{const L=o.order.findIndex(B=>B===f);if(L<0||!g[L]){console.warn("Cannot close tab!");return}h=g[L].getBoundingClientRect().width,L<o.order.length-1&&(s.style.setProperty("--tab-max-width",`${h}px`),ee()),L==o.activeIndex&&(L==o.order.length-1?oe.setActiveIndex(L-1):oe.setActiveIndex(L+1)),Qe({duration:He,easing:he,onStep:(B,O)=>{L==0?n(2,s.style.gridTemplateColumns=`minmax(${O*Xe}px, ${O*h}px)`,s):n(2,s.style.gridTemplateColumns=`repeat(${L}, minmax(var(--tab-min-width), var(--tab-max-width))) minmax(${O*Xe}px, ${O*h}px)`,s)},onEnd:()=>{n(2,s.style.gridTemplateColumns="",s),oe.removeTab(f)}})},ee=b(()=>{s&&(s.style.setProperty("--tab-max-width",`${Ne}px`),Qe({duration:He,easing:he,onStep:(f,L)=>{s.style.setProperty("--tab-max-width",`${h+f*(Ne-h)}px`)},onEnd:()=>{s.style.setProperty("--tab-max-width",`${Ne}px`)}}))},Gt);function R(f){if(!s)return;const L=f.getBoundingClientRect().width;Qe({duration:He,easing:he,onStep:(B,O)=>{o.order.length==1?n(2,s.style.gridTemplateColumns=`minmax(${B*Xe}px, ${B*L}px)`,s):n(2,s.style.gridTemplateColumns=`repeat(${o.order.length-1}, minmax(var(--tab-min-width), var(--tab-max-width))) minmax(${B*Xe}px, ${B*L}px)`,s),n(2,s.scrollLeft=s.scrollWidth,s)},onEnd:()=>{n(2,s.style.gridTemplateColumns="",s)}})}const N=(f,L)=>{const B=g[0].getBoundingClientRect().width;oe.moveTab(f,L,()=>{if(f>L)for(let O=L;O<f;O++)st(g[O],{duration:He,easing:he,css:(Ye,re)=>`transform: translateX(-${re*B}px);`});if(f<L)for(let O=L;O>f;O--)st(g[O],{duration:He,easing:he,css:(Ye,re)=>`transform: translateX(${re*B}px);`})})};function P(f){!f.target||!f.dataTransfer||(f.dataTransfer.setData("text/plain",i),f.dataTransfer.setDragImage(new Image,0,0))}function K(f,L){if(f==0&&L==0){n(5,v.style.left="-1000px",v),n(5,v.style.top="-1000px",v);return}let B=X.getBoundingClientRect();if(f<B.left||f>B.right||L<B.top||L>B.bottom){Y||(_=0),n(5,v.style.left=`${f+U}px`,v),n(5,v.style.top=`${L-a.height/2}px`,v),n(6,Y=!0);return}Y&&n(6,Y=!1),n(5,v.style.left=`${f+U}px`,v),n(5,v.style.top=`${a.top}px`,v);const O=-s.scrollLeft,Ye=g[0].getBoundingClientRect().width;let re=-1;if(f>O+o.order.length*Ye)re=o.order.length-1;else for(let Pe=0;Pe<o.order.length;Pe++)if(f>O+Pe*Ye&&f<O+(Pe+1)*Ye){re=Pe;break}f<20?(_=-ct,requestAnimationFrame(we)):f>s.clientWidth-10?(_=ct,requestAnimationFrame(we)):_=0,!(re==-1||re==o.placeholderIndex)&&N(o.placeholderIndex,re)}let se=0;function we(f){if(!w||_==0){se=0;return}se==0&&(se=f);const L=f-se;se=f,s.scrollBy({left:_*L}),requestAnimationFrame(we)}function Be(f,L){if(!f.target)return;let B,O;f instanceof TouchEvent?(B=f.touches[0].clientX,O=f.touches[0].clientY):(B=f.clientX,O=f.clientY),window.addEventListener("touchmove",le,{passive:!1}),window.addEventListener("touchend",ne),window.addEventListener("mousemove",le),window.addEventListener("mouseup",ne),window.addEventListener("drag",le),window.addEventListener("dragend",ne),window.addEventListener("blur",ne),oe.setActiveIndex(L),d=f.target,a=d.getBoundingClientRect(),x=[B,O],U=a.left-B,a.top-O,n(5,v.style.width=`${a.width}px`,v),n(5,v.style.left=`${a.left}px`,v),n(5,v.style.top=`${a.top}px`,v),E=L,n(4,p=u[o.order[L]].title)}function le(f){let L,B;if(f instanceof TouchEvent?(L=f.touches[0].clientX,B=f.touches[0].clientY,f.preventDefault()):(L=f.clientX,B=f.clientY),w){K(L,B);return}x===null||Math.hypot(x[0]-L,x[1]-B)<zt||(n(0,w=!0),oe.setPlaceholderIndex(E),oe.setActiveIndex(E))}function ne(){window.removeEventListener("touchmove",le),window.removeEventListener("touchend",ne),window.removeEventListener("mousemove",le),window.removeEventListener("mouseup",ne),window.removeEventListener("drag",le),window.removeEventListener("dragend",ne),window.removeEventListener("blur",ne),x=null,n(6,Y=!1),E=-1,U=0,oe.setPlaceholderIndex(),n(0,w=!1)}tt(()=>{s.style.setProperty("--tab-max-width",`${Ne}px`),s.style.setProperty("--tab-min-width",`${Xe}px`)});const Me=(f,L)=>Be(L,f);function Oe(f,L){e.$$.not_equal(u[L].title,f)&&(u[L].title=f,ue.set(u))}function ze(f,L){Z[f?"unshift":"push"](()=>{g[L]=f,n(3,g)})}function Ge(f){Z[f?"unshift":"push"](()=>{s=f,n(2,s)})}const je=()=>{de(ce,o.toolbarVisible=!0,o)};function k(f){Z[f?"unshift":"push"](()=>{v=f,n(5,v)})}function J(f){Z[f?"unshift":"push"](()=>{X=f,n(7,X)})}return e.$$.update=()=>{e.$$.dirty[0]&2&&n(9,i=o.order[o.activeIndex]),e.$$.dirty[0]&2&&n(10,r=o.order[o.placeholderIndex]),e.$$.dirty[0]&1&&(w?n(8,y=!0):setTimeout(()=>n(8,y=!1),20))},[w,o,s,g,p,v,Y,X,y,i,r,u,T,R,P,Be,l,Me,Oe,ze,Ge,je,k,J]}class Kt extends Ce{constructor(t){super(),Ie(this,t,jt,Wt,De,{closeActiveTab:16},null,[-1,-1])}get closeActiveTab(){return this.$$.ctx[16]}}function Qt(e){let t,n;return{c(){t=A("div"),n=A("div"),this.h()},l(i){t=S(i,"DIV",{class:!0});var r=V(t);n=S(r,"DIV",{class:!0}),V(n).forEach(H),r.forEach(H),this.h()},h(){I(n,"class","quill-editor svelte-763iug"),I(t,"class","quill-editor-wrapper svelte-763iug"),F(t,"disabled",e[0])},m(i,r){te(i,t,r),C(t,n),e[5](n)},p(i,[r]){r&1&&F(t,"disabled",i[0])},i:ge,o:ge,d(i){i&&H(t),e[5](null)}}}function Jt(e,t,n){let i,r;ie(e,ue,_=>n(6,i=_)),ie(e,yt,_=>n(4,r=_));let{tabID:o}=t,{disabled:u=!1}=t,l,s;const g=(_,X=300)=>{let y;return(...b)=>{clearTimeout(y),y=setTimeout(()=>{_.apply(void 0,b)},X)}};async function h(_){var T,D,ee,R;if(!l)return;const{Delta:X,Range:y}=await it(async()=>{const{Delta:N,Range:P}=await import("../chunks/core.CG__ofcG.js").then(K=>K.G);return{Delta:N,Range:P}},[],import.meta.url);if(_.undo.length>0)for(var b=0;b<_.undo.length;b++){const N=(T=_.undo[b].range)==null?void 0:T.index,P=(D=_.undo[b].range)==null?void 0:D.length,K={delta:new X(_.undo[b].delta.ops),range:N!==void 0&&P!==void 0?new y(N,P):null};l.history.stack.undo.push(K)}if(_.redo.length>0)for(var b=0;b<_.redo.length;b++){const P=(ee=_.redo[b].range)==null?void 0:ee.index,K=(R=_.redo[b].range)==null?void 0:R.length,se={delta:new X(_.redo[b].delta.ops),range:P!==void 0&&K!==void 0?new y(P,K):null};l.history.stack.redo.push(se)}}function x(_){var X;l&&((X=l.getSelection())==null?void 0:X.length)===0&&window.open(_.target.href,"_blank")}function E(){if(!l||!i[o])return;const _=i[o].ops;l.setContents(_);const X=i[o].history;h(X)}function p(){if(!l||!i[o])return;de(ue,i[o].ops=l.getContents().ops,i);const _=structuredClone(l.history.stack);de(ue,i[o].history=_,i)}const d=g(p,500);function a(){if(!l)return;l.formatText(0,l.getLength(),"link",!1,"api");const _=l.getText(),X=/https?:\/\/\S+/gi,y=_.matchAll(X);for(const D of y)l.formatText(D.index,D[0].length,"link",D[0],"api");const b=/.+\@.+\..+/gi,T=_.matchAll(b);for(const D of T)l.formatText(D.index,D[0].length,"link","mailto:"+D[0],"api");document.querySelectorAll(".ql-editor a").forEach(D=>{D.addEventListener("click",x)})}const v=g(a,500);function w(_,X,y){if(y==="user"){const b=l.getText().split(`
`)[0].trim();de(ue,i[o].title=b===""?"Untitled":b,i),v(),d()}}async function Y(){const{default:_}=await it(async()=>{const{default:X}=await import("../chunks/quill.Bk4jDS0q.js");return{default:X}},__vite__mapDeps([0,1]),import.meta.url);n(3,l=new _(s,{formats:["bold","italic","underline","strike","code","link"],placeholder:"Enter text here"})),E(),a(),l.on("text-change",w),l.keyboard.addBinding({key:"/",altKey:!0},()=>{l.format("code",!l.getFormat().code)}),l.keyboard.addBinding({key:"-",altKey:!0},()=>{l.format("strike",!l.getFormat().strike)})}tt(()=>{Y()});function U(_){Z[_?"unshift":"push"](()=>{s=_,n(1,s)})}return e.$$set=_=>{"tabID"in _&&n(2,o=_.tabID),"disabled"in _&&n(0,u=_.disabled)},e.$$.update=()=>{e.$$.dirty&9&&(u?l==null||l.disable():l==null||l.enable()),e.$$.dirty&24&&(l==null||l.root.setAttribute("spellcheck",r.spellCheck.toString()))},[u,s,o,l,r,U]}class Zt extends Ce{constructor(t){super(),Ie(this,t,Jt,Qt,De,{tabID:2,disabled:0})}}const dt=500,$t=300,ut=500,en=300;class tn{constructor(){q(this,"isMoving",!1);q(this,"isLongclick",!1);q(this,"button",0);q(this,"lastX",0);q(this,"lastY",0);q(this,"consecutiveClicks",0);q(this,"lastMouseupTime",0);q(this,"activeElement",null);this.reset()}reset(){this.isMoving=!1,this.isLongclick=!1,this.button=0,this.lastX=0,this.lastY=0,this.consecutiveClicks=0,this.lastMouseupTime=0,this.activeElement=null}}class nn{constructor(){q(this,"isDragging",!1);q(this,"isPinching",!1);q(this,"isLongpressed",!1);q(this,"consecutiveTaps",0);q(this,"lastTouchendTime",0);q(this,"lastCenterX",0);q(this,"lastCenterY",0);q(this,"identifier",0);q(this,"x",0);q(this,"y",0);q(this,"hypotenuse",0);q(this,"activeElement",null);this.reset()}reset(){this.isDragging=!1,this.isPinching=!1,this.isLongpressed=!1,this.consecutiveTaps=0,this.lastTouchendTime=0,this.lastCenterX=0,this.lastCenterY=0,this.identifier=0,this.x=0,this.y=0,this.hypotenuse=0,this.activeElement=null}}let fe=[],m=new tn,c=new nn;const M=(e,t)=>{e!=null&&e.dispatchEvent(new CustomEvent("gesture",{detail:t,bubbles:!1,cancelable:!1}))},kt=e=>{m.reset(),c.reset(),m.lastMouseupTime=Date.now(),window.removeEventListener("mousemove",Fe),window.removeEventListener("mouseup",qe),window.removeEventListener("touchmove",We),window.removeEventListener("touchend",xe)},Et=e=>{if(window.removeEventListener("mousemove",Fe),window.removeEventListener("mouseup",qe),window.removeEventListener("touchmove",We),window.removeEventListener("touchend",xe),m.isMoving)if(m.isMoving=!1,m.isLongclick)m.isLongclick=!1,M(m.activeElement,{event:e,name:"longclick-drag-end",x:m.lastX,y:m.lastY,dx:0,dy:0});else switch(m.button){case 0:M(m.activeElement,{event:e,name:"left-click-drag-end",x:m.lastX,y:m.lastY,dx:0,dy:0});break;case 1:M(m.activeElement,{event:e,name:"middle-click-drag-end",x:m.lastX,y:m.lastY,dx:0,dy:0});break;case 2:M(m.activeElement,{event:e,name:"right-click-drag-end",x:m.lastX,y:m.lastY,dx:0,dy:0});break}m.isLongclick&&M(m.activeElement,{event:e,name:"longclick-release",x:m.lastX,y:m.lastY,dx:0,dy:0}),m.reset(),c.isDragging&&(c.isDragging=!1,c.isLongpressed?(c.isLongpressed=!1,M(c.activeElement,{event:e,name:"longpress-drag-end",x:c.lastCenterX,y:c.lastCenterY,dx:0,dy:0})):M(c.activeElement,{event:e,name:"touch-drag-end",x:c.lastCenterX,y:c.lastCenterY,dx:0,dy:0})),c.isLongpressed&&M(c.activeElement,{event:e,name:"longpress-release",x:c.lastCenterX,y:c.lastCenterY,dx:0,dy:0}),c.reset()},Tt=e=>{M(e.target,{event:e,name:"wheel",x:e.clientX,y:e.clientY,dx:0,dy:0})},Lt=e=>{},xt=e=>{document.activeElement!==e.target&&(window.addEventListener("mousemove",Fe),window.addEventListener("mouseup",qe),m.activeElement=e.target,m.lastX=e.clientX,m.lastY=e.clientY,m.isMoving||(m.button=e.button),m.button===0&&window.setTimeout(()=>{Date.now()-m.lastMouseupTime>=ut&&!m.isMoving&&(m.isLongclick=!0,M(m.activeElement,{event:e,name:"longclick",x:e.clientX,y:e.clientY,dx:0,dy:0}))},ut))},Fe=e=>{if(e.movementX===0&&e.movementY===0)return;let t=e.clientX-m.lastX,n=e.clientY-m.lastY;if(!m.isMoving)if(m.isLongclick)M(m.activeElement,{event:e,name:"longclick-drag-start",x:e.clientX,y:e.clientY,dx:0,dy:0});else switch(m.button){case 0:M(m.activeElement,{event:e,name:"left-click-drag-start",x:e.clientX,y:e.clientY,dx:0,dy:0});break;case 1:M(m.activeElement,{event:e,name:"middle-click-drag-start",x:e.clientX,y:e.clientY,dx:0,dy:0});break;case 2:M(m.activeElement,{event:e,name:"right-click-drag-start",x:e.clientX,y:e.clientY,dx:0,dy:0});break}if(m.isMoving=!0,m.lastX=e.clientX,m.lastY=e.clientY,m.isLongclick)M(m.activeElement,{event:e,name:"longclick-dragging",x:e.clientX,y:e.clientY,dx:t,dy:n});else switch(m.button){case 0:M(m.activeElement,{event:e,name:"left-click-dragging",x:e.clientX,y:e.clientY,dx:t,dy:n});break;case 1:M(m.activeElement,{event:e,name:"middle-click-dragging",x:e.clientX,y:e.clientY,dx:t,dy:n});break;case 2:M(m.activeElement,{event:e,name:"right-click-dragging",x:e.clientX,y:e.clientY,dx:t,dy:n});break}},qe=e=>{if(window.removeEventListener("mousemove",Fe),window.removeEventListener("mouseup",qe),m.lastMouseupTime=Date.now(),m.isMoving)if(m.isMoving=!1,m.isLongclick)m.isLongclick=!1,M(m.activeElement,{event:e,name:"longclick-drag-end",x:m.lastX,y:m.lastY,dx:0,dy:0});else switch(m.button){case 0:M(m.activeElement,{event:e,name:"left-click-drag-end",x:m.lastX,y:m.lastY,dx:0,dy:0});break;case 1:M(m.activeElement,{event:e,name:"middle-click-drag-end",x:m.lastX,y:m.lastY,dx:0,dy:0});break;case 2:M(m.activeElement,{event:e,name:"right-click-drag-end",x:m.lastX,y:m.lastY,dx:0,dy:0});break}else m.isLongclick||(e.button===2?M(m.activeElement,{event:e,name:"right-click",x:e.clientX,y:e.clientY,dx:0,dy:0}):e.button===1?M(m.activeElement,{event:e,name:"middle-click",x:e.clientX,y:e.clientY,dx:0,dy:0}):(m.consecutiveClicks===0&&M(m.activeElement,{event:e,name:"left-click",x:e.clientX,y:e.clientY,dx:0,dy:0}),m.consecutiveClicks++,window.setTimeout(()=>{m.consecutiveClicks>1&&M(m.activeElement,{event:e,name:"double-click",x:e.clientX,y:e.clientY,dx:0,dy:0}),m.consecutiveClicks=0},en)));m.isLongclick&&M(m.activeElement,{event:e,name:"longclick-release",x:e.clientX,y:e.clientY,dx:0,dy:0}),m.isLongclick=!1},Dt=e=>{if(e.touches.length>1,document.activeElement!==e.target){if(e.touches.length>1){if(e.touches[0].identifier===c.identifier)return;c.isPinching=!0}window.addEventListener("touchmove",We,{passive:!1}),window.addEventListener("touchend",xe),window.addEventListener("touchcancel",xe),c.identifier=e.touches[0].identifier,c.x=e.touches[0].clientX,c.y=e.touches[0].clientY,c.activeElement=e.target,window.setTimeout(()=>{c.isPinching||c.isDragging||Date.now()-c.lastTouchendTime>=dt&&(c.isDragging=!1,c.isPinching=!1,c.hypotenuse=null,c.isLongpressed=!0,M(c.activeElement,{event:e,name:"longpress",x:c.x,y:c.y,dx:0,dy:0}))},dt)}},We=e=>{if(c.isDragging){let t=c.x,n=c.y;c.x=e.touches[0].clientX,c.y=e.touches[0].clientY;let i=c.x-t,r=c.y-n;c.isLongpressed?M(c.activeElement,{event:e,name:"longpress-dragging",x:c.x,y:c.y,dx:i,dy:r,force:e.touches[0].force}):M(c.activeElement,{event:e,name:"touch-dragging",x:c.x,y:c.y,dx:i,dy:r,force:e.touches[0].force});return}else if(!c.isLongpressed&&(c.isPinching||e.touches.length>1)){c.x=e.touches[0].clientX,c.y=e.touches[0].clientY;let t={x:e.touches[1].clientX,y:e.touches[1].clientY},n={x:(c.x+t.x)/2,y:(c.y+t.y)/2},i=Math.hypot(c.x-t.x,c.y-t.y);c.hypotenuse===null&&(c.hypotenuse=i,c.lastCenterX=n.x,c.lastCenterY=n.y,M(c.activeElement,{event:e,name:"pinch-start",x:n.x,y:n.y,dx:0,dy:0})),c.isPinching=!0;let r=i/c.hypotenuse,o=n.x-c.lastCenterX,u=n.y-c.lastCenterY;M(c.activeElement,{event:e,name:"pinching",x:n.x,y:n.y,zoom:r,dx:o,dy:u}),c.hypotenuse=i,c.lastCenterX=n.x,c.lastCenterY=n.y;return}else c.isDragging=!0,c.isLongpressed?(M(c.activeElement,{event:e,name:"longpress-drag-start",x:c.x,y:c.y,dx:0,dy:0,force:e.touches[0].force}),c.x=e.touches[0].clientX,c.y=e.touches[0].clientY,M(c.activeElement,{event:e,name:"longpress-dragging",x:c.x,y:c.y,dx:0,dy:0,force:e.touches[0].force})):(M(c.activeElement,{event:e,name:"touch-drag-start",x:c.x,y:c.y,dx:0,dy:0,force:e.touches[0].force}),c.x=e.touches[0].clientX,c.y=e.touches[0].clientY,M(c.activeElement,{event:e,name:"touch-dragging",x:c.x,y:c.y,dx:0,dy:0,force:e.touches[0].force}))},xe=e=>{c.isDragging&&e.touches.length>0&&e.touches[0].identifier===c.identifier||(c.lastTouchendTime=Date.now(),window.removeEventListener("touchmove",We),window.removeEventListener("touchend",xe),window.removeEventListener("touchcancel",xe),c.isDragging?(c.isDragging=!1,c.isLongpressed?(c.isLongpressed=!1,M(c.activeElement,{event:e,name:"longpress-drag-end",x:c.x,y:c.y,dx:0,dy:0})):M(c.activeElement,{event:e,name:"touch-drag-end",x:c.x,y:c.y,dx:0,dy:0})):c.isPinching?(c.isPinching=!1,c.hypotenuse=null,M(c.activeElement,{event:e,name:"pinch-end",x:c.lastCenterX,y:c.lastCenterY,dx:0,dy:0})):c.isLongpressed||(c.consecutiveTaps===0&&M(c.activeElement,{event:e,name:"tap",x:c.x,y:c.y,dx:0,dy:0}),c.consecutiveTaps++,window.setTimeout(()=>{c.consecutiveTaps>1&&M(c.activeElement,{event:e,name:"double-tap",x:c.x,y:c.y,dx:0,dy:0}),c.consecutiveTaps=0},$t)),c.isLongpressed&&M(c.activeElement,{event:e,name:"longpress-release",x:c.x,y:c.y,dx:0,dy:0}),c.isLongpressed=!1)};function sn(...e){for(let t of e)fe.findIndex(n=>n===t)===-1&&(fe.length==0&&(window.addEventListener("blur",Et),window.addEventListener("focus",kt)),fe.push(t),t.addEventListener("touchstart",Dt,{passive:!1}),t.addEventListener("mousedown",xt,{passive:!1}),t.addEventListener("contextmenu",Lt,{passive:!1}),t.addEventListener("wheel",Tt,{passive:!1}))}function ln(...e){const t=n=>{n.removeEventListener("touchstart",Dt),n.removeEventListener("mousedown",xt),n.removeEventListener("contextmenu",Lt),n.removeEventListener("wheel",Tt)};if(e.length==0){for(let n of fe)t(n);fe=[]}else for(let n of e){let i=fe.findIndex(r=>r===n);i!==-1&&(t(n),fe.splice(i,1))}fe.length==0&&(window.removeEventListener("blur",Et),window.removeEventListener("focus",kt))}function rn(e){let t,n,i,r,o,u,l="LOG";return{c(){t=A("div"),n=A("canvas"),i=G(),r=A("canvas"),o=G(),u=A("div"),u.textContent=l,this.h()},l(s){t=S(s,"DIV",{class:!0});var g=V(t);n=S(g,"CANVAS",{id:!0,class:!0}),V(n).forEach(H),i=j(g),r=S(g,"CANVAS",{id:!0,class:!0}),V(r).forEach(H),o=j(g),u=S(g,"DIV",{class:!0,"data-svelte-h":!0}),ae(u)!=="svelte-rtly9t"&&(u.textContent=l),g.forEach(H),this.h()},h(){I(n,"id","currentPath"),I(n,"class","svelte-1b93g54"),F(n,"disabled",e[0]),I(r,"id","canvas"),I(r,"class","svelte-1b93g54"),F(r,"disabled",e[0]),I(u,"class","log svelte-1b93g54"),I(t,"class","canvas-container svelte-1b93g54"),F(t,"hide",e[1])},m(s,g){te(s,t,g),C(t,n),e[12](n),C(t,i),C(t,r),e[13](r),C(t,o),C(t,u),e[14](u)},p(s,g){g[0]&1&&F(n,"disabled",s[0]),g[0]&1&&F(r,"disabled",s[0]),g[0]&2&&F(t,"hide",s[1])},i:ge,o:ge,d(s){s&&H(t),e[12](null),e[13](null),e[14](null)}}}const on=2,an=178;function cn(e,t,n){var i=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),r=Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2)),o=Math.sqrt(Math.pow(n.x-e.x,2)+Math.pow(n.y-e.y,2)),u=Math.acos((r*r+i*i-o*o)/(2*r*i));return u*(180/Math.PI)}function ft(e){if(e.points.length<4)return e;for(let t=1;t<e.points.length-2;t++){const n=e.points[t-1],i=e.points[t],r=e.points[t+1];cn(n,i,r)>an&&(e.points.splice(t,1),t--)}return e}async function Ae(e,t){if(t.lineWidth=e.lineWidth,t.lineCap="round",t.strokeStyle=e.color,e.points.length<2){t.beginPath(),t.moveTo(e.points[0].x,e.points[0].y),t.lineTo(e.points[0].x,e.points[0].y),t.stroke();return}t.beginPath();let n=e.points[0].x,i=e.points[0].y;for(let r=0;r<e.points.length-1;r++)t.moveTo(n,i),n=(e.points[r].x+e.points[r+1].x)/2,i=(e.points[r].y+e.points[r+1].y)/2,t.quadraticCurveTo(e.points[r].x,e.points[r].y,n,i);t.stroke()}function dn(e){return{x:gt(e.x),y:gt(e.y)}}function gt(e){const t=e.toFixed(on);return Number(t)}function un(e,t,n){let i;ie(e,ue,k=>n(25,i=k));let{radius:r=3}=t,{smoothness:o=0}=t,{stroke:u=5}=t,{color:l="#000000"}=t,{disabled:s=!1}=t,{hide:g=!1}=t,{tabID:h=""}=t;function x(){d.clearRect(0,0,U/_,Y/_),D=[]}function E(){if(D.length!=0){n(4,y.innerHTML="Undo",y),D.pop(),v.clearRect(0,0,U/_,Y/_);for(let k=0;k<D.length;k++)Ae(D[k],v);we()}}let p,d,a,v,w={x:0,y:0},Y=0,U=0,_,X=!1,y,b,T,D=[];function ee(){p&&(sn(p),window.addEventListener("keydown",Oe))}function R(){p&&(ln(p),window.removeEventListener("keydown",Oe))}const N=(k,J,f,L)=>{var B=f-k,O=L-J;return Math.sqrt(B*B+O*O)},P=(k,J=300)=>{let f;return(...L)=>{clearTimeout(f),f=setTimeout(()=>{k.apply(void 0,L)},J)}};function K(k,J){let f=p.getBoundingClientRect();return{x:k-f.left,y:J-f.top}}function se(){if(!p||!a)return;Me(),_=window.devicePixelRatio;let k=p.getBoundingClientRect();Y=k.height*_,U=k.width*_,n(2,p.width=U,p),n(2,p.height=Y,p),n(3,a.width=U,a),n(3,a.height=Y,a),d.scale(_,_),v.scale(_,_);for(let J=0;J<D.length;J++)Ae(D[J],v)}function we(){i[h]&&de(ue,i[h].paths=D.filter(k=>ft(k)),i)}function Be(){i[h]&&(D=i[h].paths,se())}function le(k,J){X=!0,w=K(k,J),d.lineWidth=u,d.lineCap="round",d.strokeStyle=l,d.beginPath(),d.moveTo(w.x,w.y),d.stroke(),b={points:[],lineWidth:u,color:l}}function ne(k,J){if(!X)return;let f=K(k,J);if(r>0){if(N(f.x,f.y,w.x,w.y)<=r){b.points.length===0&&(b.points.push(f),Ae(b,d));return}let L=Math.sqrt(f.x*f.x+f.y*f.y-2*f.x*w.x+w.x*w.x-2*f.y*w.y+w.y*w.y);if(f={x:f.x+r*((w.x-f.x)/L),y:f.y+r*((w.y-f.y)/L)},N(w.x,w.y,f.x,f.y)<=o)return}b.points.push(dn(f)),d.clearRect(0,0,U/_,Y/_),Ae(b,d),w=f}function Me(){X&&(D.push(ft(b)),Ae(b,v),d.clearRect(0,0,U/_,Y/_),we()),X=!1}const Oe=function(k){k.ctrlKey&&k.key=="z"&&E(),k.preventDefault()};tt(()=>{d=p.getContext("2d"),d.imageSmoothingEnabled=!1,v=a.getContext("2d"),v.imageSmoothingEnabled=!1,p.addEventListener("gesture",k=>{switch(k.detail.name){case"left-click-drag-start":case"touch-drag-start":le(k.detail.x,k.detail.y);break;case"left-click-dragging":case"touch-dragging":k.detail.force>0&&n(4,y.innerHTML=k.detail.force,y),ne(k.detail.x,k.detail.y);break;case"left-click-drag-end":case"touch-drag-end":Me();break;case"left-click":case"tap":le(k.detail.x,k.detail.y),ne(k.detail.x,k.detail.y),Me();break}}),T=new ResizeObserver(P(se,0)),T.observe(p),Be(),s?R():ee()}),Yt(()=>{T&&T.disconnect(),R()});function ze(k){Z[k?"unshift":"push"](()=>{a=k,n(3,a)})}function Ge(k){Z[k?"unshift":"push"](()=>{p=k,n(2,p)})}function je(k){Z[k?"unshift":"push"](()=>{y=k,n(4,y)})}return e.$$set=k=>{"radius"in k&&n(5,r=k.radius),"smoothness"in k&&n(6,o=k.smoothness),"stroke"in k&&n(7,u=k.stroke),"color"in k&&n(8,l=k.color),"disabled"in k&&n(0,s=k.disabled),"hide"in k&&n(1,g=k.hide),"tabID"in k&&n(9,h=k.tabID)},e.$$.update=()=>{e.$$.dirty[0]&1&&(s?R():ee())},[s,g,p,a,y,r,o,u,l,h,x,E,ze,Ge,je]}class fn extends Ce{constructor(t){super(),Ie(this,t,un,rn,De,{radius:5,smoothness:6,stroke:7,color:8,disabled:0,hide:1,tabID:9,clear:10,undo:11},null,[-1,-1])}get clear(){return this.$$.ctx[10]}get undo(){return this.$$.ctx[11]}}function ht(e,t,n){const i=e.slice();return i[19]=t[n],i[20]=t,i[21]=n,i}function vt(e,t,n){const i=e.slice();return i[19]=t[n],i}function mt(e){let t,n,i,r;function o(s){e[13](s)}function u(s){e[14](s)}let l={onClose:e[10],onDrawingUndo:e[11],onRefresh:e[12]};return e[3]!==void 0&&(l.stroke=e[3]),e[0]!==void 0&&(l.color=e[0]),t=new qt({props:l}),Z.push(()=>Re(t,"stroke",o)),Z.push(()=>Re(t,"color",u)),{c(){pe(t.$$.fragment)},l(s){be(t.$$.fragment,s)},m(s,g){_e(t,s,g),r=!0},p(s,g){const h={};g&16&&(h.onClose=s[10]),g&96&&(h.onDrawingUndo=s[11]),!n&&g&8&&(n=!0,h.stroke=s[3],Se(()=>n=!1)),!i&&g&1&&(i=!0,h.color=s[0],Se(()=>i=!1)),t.$set(h)},i(s){r||(W(t.$$.fragment,s),r=!0)},o(s){Q(t.$$.fragment,s),r=!1},d(s){ye(t,s)}}}function gn(e){let t,n;return t=new Rt({}),{c(){pe(t.$$.fragment)},l(i){be(t.$$.fragment,i)},m(i,r){_e(t,i,r),n=!0},p:ge,i(i){n||(W(t.$$.fragment,i),n=!0)},o(i){Q(t.$$.fragment,i),n=!1},d(i){ye(t,i)}}}function hn(e){let t,n,i=[],r=new Map,o,u,l=[],s=new Map,g,h=ke(Object.keys(e[8]));const x=d=>d[19];for(let d=0;d<h.length;d+=1){let a=vt(e,h,d),v=x(a);r.set(v,i[d]=pt(v,a))}let E=ke(Object.keys(e[8]));const p=d=>d[19];for(let d=0;d<E.length;d+=1){let a=ht(e,E,d),v=p(a);s.set(v,l[d]=bt(v,a))}return{c(){t=A("div"),n=A("div");for(let d=0;d<i.length;d+=1)i[d].c();o=G(),u=A("div");for(let d=0;d<l.length;d+=1)l[d].c();this.h()},l(d){t=S(d,"DIV",{class:!0});var a=V(t);n=S(a,"DIV",{class:!0});var v=V(n);for(let Y=0;Y<i.length;Y+=1)i[Y].l(v);v.forEach(H),o=j(a),u=S(a,"DIV",{class:!0});var w=V(u);for(let Y=0;Y<l.length;Y+=1)l[Y].l(w);w.forEach(H),a.forEach(H),this.h()},h(){I(n,"class","editor-container svelte-11mfkf2"),I(u,"class","drawing-container svelte-11mfkf2"),F(u,"disabled",e[1].activeTool===void 0),I(t,"class","canvas-container svelte-11mfkf2")},m(d,a){te(d,t,a),C(t,n);for(let v=0;v<i.length;v+=1)i[v]&&i[v].m(n,null);C(t,o),C(t,u);for(let v=0;v<l.length;v+=1)l[v]&&l[v].m(u,null);g=!0},p(d,a){a&320&&(h=ke(Object.keys(d[8])),ve(),i=Je(i,a,x,1,d,h,r,n,Ze,pt,null,vt),me()),a&366&&(E=ke(Object.keys(d[8])),ve(),l=Je(l,a,p,1,d,E,s,u,Ze,bt,null,ht),me()),(!g||a&2)&&F(u,"disabled",d[1].activeTool===void 0)},i(d){if(!g){for(let a=0;a<h.length;a+=1)W(i[a]);for(let a=0;a<E.length;a+=1)W(l[a]);g=!0}},o(d){for(let a=0;a<i.length;a+=1)Q(i[a]);for(let a=0;a<l.length;a+=1)Q(l[a]);g=!1},d(d){d&&H(t);for(let a=0;a<i.length;a+=1)i[a].d();for(let a=0;a<l.length;a+=1)l[a].d()}}}function pt(e,t){let n,i,r;return i=new Zt({props:{disabled:t[19]!==t[6],tabID:t[19]}}),{key:e,first:null,c(){n=Ue(),pe(i.$$.fragment),this.h()},l(o){n=Ue(),be(i.$$.fragment,o),this.h()},h(){this.first=n},m(o,u){te(o,n,u),_e(i,o,u),r=!0},p(o,u){t=o;const l={};u&320&&(l.disabled=t[19]!==t[6]),u&256&&(l.tabID=t[19]),i.$set(l)},i(o){r||(W(i.$$.fragment,o),r=!0)},o(o){Q(i.$$.fragment,o),r=!1},d(o){o&&H(n),ye(i,o)}}}function bt(e,t){let n,i,r=t[19],o,u,l;const s=()=>t[15](i,r),g=()=>t[15](null,r);function h(p){t[16](p)}function x(p){t[17](p)}let E={tabID:t[19],hide:t[19]!==t[6],disabled:t[19]!==t[6]||t[1].activeTool===void 0};return t[2]!==void 0&&(E.color=t[2]),t[3]!==void 0&&(E.stroke=t[3]),i=new fn({props:E}),s(),Z.push(()=>Re(i,"color",h)),Z.push(()=>Re(i,"stroke",x)),{key:e,first:null,c(){n=Ue(),pe(i.$$.fragment),this.h()},l(p){n=Ue(),be(i.$$.fragment,p),this.h()},h(){this.first=n},m(p,d){te(p,n,d),_e(i,p,d),l=!0},p(p,d){t=p,r!==t[19]&&(g(),r=t[19],s());const a={};d&256&&(a.tabID=t[19]),d&320&&(a.hide=t[19]!==t[6]),d&322&&(a.disabled=t[19]!==t[6]||t[1].activeTool===void 0),!o&&d&4&&(o=!0,a.color=t[2],Se(()=>o=!1)),!u&&d&8&&(u=!0,a.stroke=t[3],Se(()=>u=!1)),i.$set(a)},i(p){l||(W(i.$$.fragment,p),l=!0)},o(p){Q(i.$$.fragment,p),l=!1},d(p){p&&H(n),g(),ye(i,p)}}}function vn(e){let t,n,i,r,o,u,l,s,g={};n=new Kt({props:g}),e[9](n);let h=e[1].toolbarVisible&&e[1].order.length>0&&mt(e);const x=[hn,gn],E=[];function p(d,a){return d[7].currentUser&&!d[7].isLoading?0:1}return u=p(e),l=E[u]=x[u](e),{c(){t=A("div"),pe(n.$$.fragment),i=G(),r=A("div"),h&&h.c(),o=G(),l.c(),this.h()},l(d){t=S(d,"DIV",{class:!0});var a=V(t);be(n.$$.fragment,a),i=j(a),r=S(a,"DIV",{class:!0});var v=V(r);h&&h.l(v),v.forEach(H),o=j(a),l.l(a),a.forEach(H),this.h()},h(){I(r,"class","toolbar"),I(t,"class","page-container svelte-11mfkf2")},m(d,a){te(d,t,a),_e(n,t,null),C(t,i),C(t,r),h&&h.m(r,null),C(t,o),E[u].m(t,null),s=!0},p(d,[a]){const v={};n.$set(v),d[1].toolbarVisible&&d[1].order.length>0?h?(h.p(d,a),a&2&&W(h,1)):(h=mt(d),h.c(),W(h,1),h.m(r,null)):h&&(ve(),Q(h,1,1,()=>{h=null}),me());let w=u;u=p(d),u===w?E[u].p(d,a):(ve(),Q(E[w],1,1,()=>{E[w]=null}),me(),l=E[u],l?l.p(d,a):(l=E[u]=x[u](d),l.c()),W(l,1),l.m(t,null))},i(d){s||(W(n.$$.fragment,d),W(h),W(l),s=!0)},o(d){Q(n.$$.fragment,d),Q(h),Q(l),s=!1},d(d){d&&H(t),e[9](null),ye(n),h&&h.d(),E[u].d()}}}function mn(e,t){var n=parseInt(e.slice(1,3),16),i=parseInt(e.slice(3,5),16),r=parseInt(e.slice(5,7),16);return"rgba("+n+", "+i+", "+r+", "+t+")"}function pn(e,t,n){let i,r,o,u,l;ie(e,ce,y=>n(1,r=y)),ie(e,yt,y=>n(18,o=y)),ie(e,_t,y=>n(7,u=y)),ie(e,ue,y=>n(8,l=y));let s="#000000",g="rgba(0, 0, 0, 1)",h=10,x,E={};ce.subscribe(y=>{if(y.activeTool==="highlighter")n(0,s="#ffdd33");else if(y.activeTool==="pencil"){const b=Bt.find(T=>T.name===o.theme);b&&n(0,s=b.caret)}});function p(y){Z[y?"unshift":"push"](()=>{x=y,n(4,x)})}const d=()=>x.closeActiveTab(),a=()=>E[i].undo(),v=()=>St.loadFromFirestore();function w(y){h=y,n(3,h)}function Y(y){s=y,n(0,s)}function U(y,b){Z[y?"unshift":"push"](()=>{E[b]=y,n(5,E)})}function _(y){g=y,n(2,g),n(1,r),n(0,s)}function X(y){h=y,n(3,h)}return e.$$.update=()=>{e.$$.dirty&2&&n(6,i=r.order[r.activeIndex]),e.$$.dirty&3&&n(2,g=r.activeTool==="highlighter"?mn(s,.3):s)},[s,r,g,h,x,E,i,u,l,p,d,a,v,w,Y,U,_,X]}class Dn extends Ce{constructor(t){super(),Ie(this,t,pn,vn,De,{})}}export{Dn as component};
