import{w as p}from"./entry.BEZKNK-n.js";import{g as h}from"./scheduler.CIGC0wka.js";function f(){return crypto.randomUUID()}function r(t,e){let n;try{n=JSON.parse(e)}catch(a){throw a}if(!n||!n.title||!n.ops||!n.history)throw new Error("Invalid tab data!");v({id:t,data:n})}function v(t){const{id:e=f(),data:n={title:"Untitled",ops:[],history:{undo:[],redo:[]}},index:a=-1,callback:l=()=>{}}=t||{};s.update(i=>i[e]?(i[e]=n,i):(i[e]=n,a<0||a>h(o).order.length?o.update(d=>(d.order.push(e),d.activeIndex=d.order.length-1,d)):o.update(d=>(d.order.splice(a,0,e),d.activeIndex=a,d)),i)),l()}function g(t){h(s)[t]&&(s.update(e=>(delete e[t],e)),o.update(e=>{const n=e.order.indexOf(t);return n<0||(e.placeholderIndex==n&&(e.placeholderIndex=-1),e.order.splice(n,1),n==e.activeIndex-1?e.activeIndex=Math.max(0,n):e.activeIndex=Math.min(e.activeIndex,e.order.length-1)),e}))}function I(t){o.update(e=>(t<0?e.activeIndex=0:t>e.order.length?e.activeIndex=e.order.length-1:e.activeIndex=t,e))}function b(t){o.update(e=>(e.placeholderIndex=t===void 0||t<0||t>=e.order.length?-1:t,e))}function x(t,e,n=()=>{}){t!=e&&(o.update(a=>{if(t<0||t>=a.order.length||e<0||e>=a.order.length)return a;const l=a.order[t];return a.order.splice(t,1),a.order.splice(e,0,l),a.activeIndex==t&&(a.activeIndex=e),a.placeholderIndex==t&&(a.placeholderIndex=e),a}),n())}const c={newTabFromString:r,newTab:v,removeTab:g,setActiveIndex:I,setPlaceholderIndex:b,moveTab:x},s=p({}),o=p({order:[],activeIndex:0,placeholderIndex:-1});export{c as a,o as m,s as t};
