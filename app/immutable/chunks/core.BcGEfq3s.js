var ea=Object.defineProperty;var na=(n,t,e)=>t in n?ea(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var B=(n,t,e)=>na(n,typeof t!="symbol"?t+"":t,e);import{c as zt,g as eo}from"./_commonjsHelpers.Cpj98o6Y.js";var no=typeof global=="object"&&global&&global.Object===Object&&global,ra=typeof self=="object"&&self&&self.Object===Object&&self,Lt=no||ra||Function("return this")(),Ht=Lt.Symbol,ro=Object.prototype,sa=ro.hasOwnProperty,ia=ro.toString,tn=Ht?Ht.toStringTag:void 0;function oa(n){var t=sa.call(n,tn),e=n[tn];try{n[tn]=void 0;var r=!0}catch{}var s=ia.call(n);return r&&(t?n[tn]=e:delete n[tn]),s}var aa=Object.prototype,la=aa.toString;function ua(n){return la.call(n)}var ca="[object Null]",ha="[object Undefined]",ai=Ht?Ht.toStringTag:void 0;function Be(n){return n==null?n===void 0?ha:ca:ai&&ai in Object(n)?oa(n):ua(n)}function jt(n){return n!=null&&typeof n=="object"}var se=Array.isArray;function Gt(n){var t=typeof n;return n!=null&&(t=="object"||t=="function")}function so(n){return n}var fa="[object AsyncFunction]",da="[object Function]",pa="[object GeneratorFunction]",ga="[object Proxy]";function ks(n){if(!Gt(n))return!1;var t=Be(n);return t==da||t==pa||t==fa||t==ga}var ls=Lt["__core-js_shared__"],li=function(){var n=/[^.]+$/.exec(ls&&ls.keys&&ls.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function ma(n){return!!li&&li in n}var ba=Function.prototype,ya=ba.toString;function oe(n){if(n!=null){try{return ya.call(n)}catch{}try{return n+""}catch{}}return""}var va=/[\\^$.*+?()[\]{}|]/g,Ea=/^\[object .+?Constructor\]$/,Na=Function.prototype,Ta=Object.prototype,Aa=Na.toString,_a=Ta.hasOwnProperty,wa=RegExp("^"+Aa.call(_a).replace(va,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Oa(n){if(!Gt(n)||ma(n))return!1;var t=ks(n)?wa:Ea;return t.test(oe(n))}function La(n,t){return n==null?void 0:n[t]}function ae(n,t){var e=La(n,t);return Oa(e)?e:void 0}var Ns=ae(Lt,"WeakMap"),ui=Object.create,Sa=function(){function n(){}return function(t){if(!Gt(t))return{};if(ui)return ui(t);n.prototype=t;var e=new n;return n.prototype=void 0,e}}();function Ca(n,t,e){switch(e.length){case 0:return n.call(t);case 1:return n.call(t,e[0]);case 2:return n.call(t,e[0],e[1]);case 3:return n.call(t,e[0],e[1],e[2])}return n.apply(t,e)}function io(n,t){var e=-1,r=n.length;for(t||(t=Array(r));++e<r;)t[e]=n[e];return t}var xa=800,Ia=16,Ra=Date.now;function Ba(n){var t=0,e=0;return function(){var r=Ra(),s=Ia-(r-e);if(e=r,s>0){if(++t>=xa)return arguments[0]}else t=0;return n.apply(void 0,arguments)}}function Ma(n){return function(){return n}}var Jn=function(){try{var n=ae(Object,"defineProperty");return n({},"",{}),n}catch{}}(),ja=Jn?function(n,t){return Jn(n,"toString",{configurable:!0,enumerable:!1,value:Ma(t),writable:!0})}:so,$a=Ba(ja);function Pa(n,t){for(var e=-1,r=n==null?0:n.length;++e<r&&t(n[e],e,n)!==!1;);return n}var Da=9007199254740991,qa=/^(?:0|[1-9]\d*)$/;function oo(n,t){var e=typeof n;return t=t??Da,!!t&&(e=="number"||e!="symbol"&&qa.test(n))&&n>-1&&n%1==0&&n<t}function Us(n,t,e){t=="__proto__"&&Jn?Jn(n,t,{configurable:!0,enumerable:!0,value:e,writable:!0}):n[t]=e}function dn(n,t){return n===t||n!==n&&t!==t}var ka=Object.prototype,Ua=ka.hasOwnProperty;function ao(n,t,e){var r=n[t];(!(Ua.call(n,t)&&dn(r,e))||e===void 0&&!(t in n))&&Us(n,t,e)}function pn(n,t,e,r){var s=!e;e||(e={});for(var i=-1,a=t.length;++i<a;){var l=t[i],u=void 0;u===void 0&&(u=n[l]),s?Us(e,l,u):ao(e,l,u)}return e}var ci=Math.max;function Fa(n,t,e){return t=ci(t===void 0?n.length-1:t,0),function(){for(var r=arguments,s=-1,i=ci(r.length-t,0),a=Array(i);++s<i;)a[s]=r[t+s];s=-1;for(var l=Array(t+1);++s<t;)l[s]=r[s];return l[t]=e(a),Ca(n,this,l)}}function za(n,t){return $a(Fa(n,t,so),n+"")}var Ka=9007199254740991;function lo(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=Ka}function ir(n){return n!=null&&lo(n.length)&&!ks(n)}function Ha(n,t,e){if(!Gt(e))return!1;var r=typeof t;return(r=="number"?ir(e)&&oo(t,e.length):r=="string"&&t in e)?dn(e[t],n):!1}function Ga(n){return za(function(t,e){var r=-1,s=e.length,i=s>1?e[s-1]:void 0,a=s>2?e[2]:void 0;for(i=n.length>3&&typeof i=="function"?(s--,i):void 0,a&&Ha(e[0],e[1],a)&&(i=s<3?void 0:i,s=1),t=Object(t);++r<s;){var l=e[r];l&&n(t,l,r,i)}return t})}var Wa=Object.prototype;function Fs(n){var t=n&&n.constructor,e=typeof t=="function"&&t.prototype||Wa;return n===e}function Va(n,t){for(var e=-1,r=Array(n);++e<n;)r[e]=t(e);return r}var Xa="[object Arguments]";function hi(n){return jt(n)&&Be(n)==Xa}var uo=Object.prototype,Ya=uo.hasOwnProperty,Za=uo.propertyIsEnumerable,Ts=hi(function(){return arguments}())?hi:function(n){return jt(n)&&Ya.call(n,"callee")&&!Za.call(n,"callee")};function Ja(){return!1}var co=typeof exports=="object"&&exports&&!exports.nodeType&&exports,fi=co&&typeof module=="object"&&module&&!module.nodeType&&module,Qa=fi&&fi.exports===co,di=Qa?Lt.Buffer:void 0,tl=di?di.isBuffer:void 0,sn=tl||Ja,el="[object Arguments]",nl="[object Array]",rl="[object Boolean]",sl="[object Date]",il="[object Error]",ol="[object Function]",al="[object Map]",ll="[object Number]",ul="[object Object]",cl="[object RegExp]",hl="[object Set]",fl="[object String]",dl="[object WeakMap]",pl="[object ArrayBuffer]",gl="[object DataView]",ml="[object Float32Array]",bl="[object Float64Array]",yl="[object Int8Array]",vl="[object Int16Array]",El="[object Int32Array]",Nl="[object Uint8Array]",Tl="[object Uint8ClampedArray]",Al="[object Uint16Array]",_l="[object Uint32Array]",F={};F[ml]=F[bl]=F[yl]=F[vl]=F[El]=F[Nl]=F[Tl]=F[Al]=F[_l]=!0;F[el]=F[nl]=F[pl]=F[rl]=F[gl]=F[sl]=F[il]=F[ol]=F[al]=F[ll]=F[ul]=F[cl]=F[hl]=F[fl]=F[dl]=!1;function wl(n){return jt(n)&&lo(n.length)&&!!F[Be(n)]}function zs(n){return function(t){return n(t)}}var ho=typeof exports=="object"&&exports&&!exports.nodeType&&exports,en=ho&&typeof module=="object"&&module&&!module.nodeType&&module,Ol=en&&en.exports===ho,us=Ol&&no.process,xe=function(){try{var n=en&&en.require&&en.require("util").types;return n||us&&us.binding&&us.binding("util")}catch{}}(),pi=xe&&xe.isTypedArray,Ks=pi?zs(pi):wl,Ll=Object.prototype,Sl=Ll.hasOwnProperty;function fo(n,t){var e=se(n),r=!e&&Ts(n),s=!e&&!r&&sn(n),i=!e&&!r&&!s&&Ks(n),a=e||r||s||i,l=a?Va(n.length,String):[],u=l.length;for(var h in n)(t||Sl.call(n,h))&&!(a&&(h=="length"||s&&(h=="offset"||h=="parent")||i&&(h=="buffer"||h=="byteLength"||h=="byteOffset")||oo(h,u)))&&l.push(h);return l}function po(n,t){return function(e){return n(t(e))}}var Cl=po(Object.keys,Object),xl=Object.prototype,Il=xl.hasOwnProperty;function Rl(n){if(!Fs(n))return Cl(n);var t=[];for(var e in Object(n))Il.call(n,e)&&e!="constructor"&&t.push(e);return t}function Hs(n){return ir(n)?fo(n):Rl(n)}function Bl(n){var t=[];if(n!=null)for(var e in Object(n))t.push(e);return t}var Ml=Object.prototype,jl=Ml.hasOwnProperty;function $l(n){if(!Gt(n))return Bl(n);var t=Fs(n),e=[];for(var r in n)r=="constructor"&&(t||!jl.call(n,r))||e.push(r);return e}function gn(n){return ir(n)?fo(n,!0):$l(n)}var on=ae(Object,"create");function Pl(){this.__data__=on?on(null):{},this.size=0}function Dl(n){var t=this.has(n)&&delete this.__data__[n];return this.size-=t?1:0,t}var ql="__lodash_hash_undefined__",kl=Object.prototype,Ul=kl.hasOwnProperty;function Fl(n){var t=this.__data__;if(on){var e=t[n];return e===ql?void 0:e}return Ul.call(t,n)?t[n]:void 0}var zl=Object.prototype,Kl=zl.hasOwnProperty;function Hl(n){var t=this.__data__;return on?t[n]!==void 0:Kl.call(t,n)}var Gl="__lodash_hash_undefined__";function Wl(n,t){var e=this.__data__;return this.size+=this.has(n)?0:1,e[n]=on&&t===void 0?Gl:t,this}function ie(n){var t=-1,e=n==null?0:n.length;for(this.clear();++t<e;){var r=n[t];this.set(r[0],r[1])}}ie.prototype.clear=Pl;ie.prototype.delete=Dl;ie.prototype.get=Fl;ie.prototype.has=Hl;ie.prototype.set=Wl;function Vl(){this.__data__=[],this.size=0}function or(n,t){for(var e=n.length;e--;)if(dn(n[e][0],t))return e;return-1}var Xl=Array.prototype,Yl=Xl.splice;function Zl(n){var t=this.__data__,e=or(t,n);if(e<0)return!1;var r=t.length-1;return e==r?t.pop():Yl.call(t,e,1),--this.size,!0}function Jl(n){var t=this.__data__,e=or(t,n);return e<0?void 0:t[e][1]}function Ql(n){return or(this.__data__,n)>-1}function tu(n,t){var e=this.__data__,r=or(e,n);return r<0?(++this.size,e.push([n,t])):e[r][1]=t,this}function $t(n){var t=-1,e=n==null?0:n.length;for(this.clear();++t<e;){var r=n[t];this.set(r[0],r[1])}}$t.prototype.clear=Vl;$t.prototype.delete=Zl;$t.prototype.get=Jl;$t.prototype.has=Ql;$t.prototype.set=tu;var an=ae(Lt,"Map");function eu(){this.size=0,this.__data__={hash:new ie,map:new(an||$t),string:new ie}}function nu(n){var t=typeof n;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?n!=="__proto__":n===null}function ar(n,t){var e=n.__data__;return nu(t)?e[typeof t=="string"?"string":"hash"]:e.map}function ru(n){var t=ar(this,n).delete(n);return this.size-=t?1:0,t}function su(n){return ar(this,n).get(n)}function iu(n){return ar(this,n).has(n)}function ou(n,t){var e=ar(this,n),r=e.size;return e.set(n,t),this.size+=e.size==r?0:1,this}function le(n){var t=-1,e=n==null?0:n.length;for(this.clear();++t<e;){var r=n[t];this.set(r[0],r[1])}}le.prototype.clear=eu;le.prototype.delete=ru;le.prototype.get=su;le.prototype.has=iu;le.prototype.set=ou;function go(n,t){for(var e=-1,r=t.length,s=n.length;++e<r;)n[s+e]=t[e];return n}var Gs=po(Object.getPrototypeOf,Object),au="[object Object]",lu=Function.prototype,uu=Object.prototype,mo=lu.toString,cu=uu.hasOwnProperty,hu=mo.call(Object);function fu(n){if(!jt(n)||Be(n)!=au)return!1;var t=Gs(n);if(t===null)return!0;var e=cu.call(t,"constructor")&&t.constructor;return typeof e=="function"&&e instanceof e&&mo.call(e)==hu}function du(){this.__data__=new $t,this.size=0}function pu(n){var t=this.__data__,e=t.delete(n);return this.size=t.size,e}function gu(n){return this.__data__.get(n)}function mu(n){return this.__data__.has(n)}var bu=200;function yu(n,t){var e=this.__data__;if(e instanceof $t){var r=e.__data__;if(!an||r.length<bu-1)return r.push([n,t]),this.size=++e.size,this;e=this.__data__=new le(r)}return e.set(n,t),this.size=e.size,this}function At(n){var t=this.__data__=new $t(n);this.size=t.size}At.prototype.clear=du;At.prototype.delete=pu;At.prototype.get=gu;At.prototype.has=mu;At.prototype.set=yu;function vu(n,t){return n&&pn(t,Hs(t),n)}function Eu(n,t){return n&&pn(t,gn(t),n)}var bo=typeof exports=="object"&&exports&&!exports.nodeType&&exports,gi=bo&&typeof module=="object"&&module&&!module.nodeType&&module,Nu=gi&&gi.exports===bo,mi=Nu?Lt.Buffer:void 0,bi=mi?mi.allocUnsafe:void 0;function yo(n,t){if(t)return n.slice();var e=n.length,r=bi?bi(e):new n.constructor(e);return n.copy(r),r}function Tu(n,t){for(var e=-1,r=n==null?0:n.length,s=0,i=[];++e<r;){var a=n[e];t(a,e,n)&&(i[s++]=a)}return i}function vo(){return[]}var Au=Object.prototype,_u=Au.propertyIsEnumerable,yi=Object.getOwnPropertySymbols,Ws=yi?function(n){return n==null?[]:(n=Object(n),Tu(yi(n),function(t){return _u.call(n,t)}))}:vo;function wu(n,t){return pn(n,Ws(n),t)}var Ou=Object.getOwnPropertySymbols,Eo=Ou?function(n){for(var t=[];n;)go(t,Ws(n)),n=Gs(n);return t}:vo;function Lu(n,t){return pn(n,Eo(n),t)}function No(n,t,e){var r=t(n);return se(n)?r:go(r,e(n))}function As(n){return No(n,Hs,Ws)}function Su(n){return No(n,gn,Eo)}var _s=ae(Lt,"DataView"),ws=ae(Lt,"Promise"),Os=ae(Lt,"Set"),vi="[object Map]",Cu="[object Object]",Ei="[object Promise]",Ni="[object Set]",Ti="[object WeakMap]",Ai="[object DataView]",xu=oe(_s),Iu=oe(an),Ru=oe(ws),Bu=oe(Os),Mu=oe(Ns),pt=Be;(_s&&pt(new _s(new ArrayBuffer(1)))!=Ai||an&&pt(new an)!=vi||ws&&pt(ws.resolve())!=Ei||Os&&pt(new Os)!=Ni||Ns&&pt(new Ns)!=Ti)&&(pt=function(n){var t=Be(n),e=t==Cu?n.constructor:void 0,r=e?oe(e):"";if(r)switch(r){case xu:return Ai;case Iu:return vi;case Ru:return Ei;case Bu:return Ni;case Mu:return Ti}return t});var ju=Object.prototype,$u=ju.hasOwnProperty;function Pu(n){var t=n.length,e=new n.constructor(t);return t&&typeof n[0]=="string"&&$u.call(n,"index")&&(e.index=n.index,e.input=n.input),e}var Qn=Lt.Uint8Array;function Vs(n){var t=new n.constructor(n.byteLength);return new Qn(t).set(new Qn(n)),t}function Du(n,t){var e=t?Vs(n.buffer):n.buffer;return new n.constructor(e,n.byteOffset,n.byteLength)}var qu=/\w*$/;function ku(n){var t=new n.constructor(n.source,qu.exec(n));return t.lastIndex=n.lastIndex,t}var _i=Ht?Ht.prototype:void 0,wi=_i?_i.valueOf:void 0;function Uu(n){return wi?Object(wi.call(n)):{}}function To(n,t){var e=t?Vs(n.buffer):n.buffer;return new n.constructor(e,n.byteOffset,n.length)}var Fu="[object Boolean]",zu="[object Date]",Ku="[object Map]",Hu="[object Number]",Gu="[object RegExp]",Wu="[object Set]",Vu="[object String]",Xu="[object Symbol]",Yu="[object ArrayBuffer]",Zu="[object DataView]",Ju="[object Float32Array]",Qu="[object Float64Array]",tc="[object Int8Array]",ec="[object Int16Array]",nc="[object Int32Array]",rc="[object Uint8Array]",sc="[object Uint8ClampedArray]",ic="[object Uint16Array]",oc="[object Uint32Array]";function ac(n,t,e){var r=n.constructor;switch(t){case Yu:return Vs(n);case Fu:case zu:return new r(+n);case Zu:return Du(n,e);case Ju:case Qu:case tc:case ec:case nc:case rc:case sc:case ic:case oc:return To(n,e);case Ku:return new r;case Hu:case Vu:return new r(n);case Gu:return ku(n);case Wu:return new r;case Xu:return Uu(n)}}function Ao(n){return typeof n.constructor=="function"&&!Fs(n)?Sa(Gs(n)):{}}var lc="[object Map]";function uc(n){return jt(n)&&pt(n)==lc}var Oi=xe&&xe.isMap,cc=Oi?zs(Oi):uc,hc="[object Set]";function fc(n){return jt(n)&&pt(n)==hc}var Li=xe&&xe.isSet,dc=Li?zs(Li):fc,pc=1,gc=2,mc=4,_o="[object Arguments]",bc="[object Array]",yc="[object Boolean]",vc="[object Date]",Ec="[object Error]",wo="[object Function]",Nc="[object GeneratorFunction]",Tc="[object Map]",Ac="[object Number]",Oo="[object Object]",_c="[object RegExp]",wc="[object Set]",Oc="[object String]",Lc="[object Symbol]",Sc="[object WeakMap]",Cc="[object ArrayBuffer]",xc="[object DataView]",Ic="[object Float32Array]",Rc="[object Float64Array]",Bc="[object Int8Array]",Mc="[object Int16Array]",jc="[object Int32Array]",$c="[object Uint8Array]",Pc="[object Uint8ClampedArray]",Dc="[object Uint16Array]",qc="[object Uint32Array]",k={};k[_o]=k[bc]=k[Cc]=k[xc]=k[yc]=k[vc]=k[Ic]=k[Rc]=k[Bc]=k[Mc]=k[jc]=k[Tc]=k[Ac]=k[Oo]=k[_c]=k[wc]=k[Oc]=k[Lc]=k[$c]=k[Pc]=k[Dc]=k[qc]=!0;k[Ec]=k[wo]=k[Sc]=!1;function Zn(n,t,e,r,s,i){var a,l=t&pc,u=t&gc,h=t&mc;if(a!==void 0)return a;if(!Gt(n))return n;var p=se(n);if(p){if(a=Pu(n),!l)return io(n,a)}else{var b=pt(n),d=b==wo||b==Nc;if(sn(n))return yo(n,l);if(b==Oo||b==_o||d&&!s){if(a=u||d?{}:Ao(n),!l)return u?Lu(n,Eu(a,n)):wu(n,vu(a,n))}else{if(!k[b])return s?n:{};a=ac(n,b,l)}}i||(i=new At);var g=i.get(n);if(g)return g;i.set(n,a),dc(n)?n.forEach(function(y){a.add(Zn(y,t,e,y,n,i))}):cc(n)&&n.forEach(function(y,E){a.set(E,Zn(y,t,e,E,n,i))});var m=h?u?Su:As:u?gn:Hs,v=p?void 0:m(n);return Pa(v||n,function(y,E){v&&(E=y,y=n[E]),ao(a,E,Zn(y,t,e,E,n,i))}),a}var kc=1,Uc=4;function Le(n){return Zn(n,kc|Uc)}var Fc="__lodash_hash_undefined__";function zc(n){return this.__data__.set(n,Fc),this}function Kc(n){return this.__data__.has(n)}function tr(n){var t=-1,e=n==null?0:n.length;for(this.__data__=new le;++t<e;)this.add(n[t])}tr.prototype.add=tr.prototype.push=zc;tr.prototype.has=Kc;function Hc(n,t){for(var e=-1,r=n==null?0:n.length;++e<r;)if(t(n[e],e,n))return!0;return!1}function Gc(n,t){return n.has(t)}var Wc=1,Vc=2;function Lo(n,t,e,r,s,i){var a=e&Wc,l=n.length,u=t.length;if(l!=u&&!(a&&u>l))return!1;var h=i.get(n),p=i.get(t);if(h&&p)return h==t&&p==n;var b=-1,d=!0,g=e&Vc?new tr:void 0;for(i.set(n,t),i.set(t,n);++b<l;){var m=n[b],v=t[b];if(r)var y=a?r(v,m,b,t,n,i):r(m,v,b,n,t,i);if(y!==void 0){if(y)continue;d=!1;break}if(g){if(!Hc(t,function(E,T){if(!Gc(g,T)&&(m===E||s(m,E,e,r,i)))return g.push(T)})){d=!1;break}}else if(!(m===v||s(m,v,e,r,i))){d=!1;break}}return i.delete(n),i.delete(t),d}function Xc(n){var t=-1,e=Array(n.size);return n.forEach(function(r,s){e[++t]=[s,r]}),e}function Yc(n){var t=-1,e=Array(n.size);return n.forEach(function(r){e[++t]=r}),e}var Zc=1,Jc=2,Qc="[object Boolean]",th="[object Date]",eh="[object Error]",nh="[object Map]",rh="[object Number]",sh="[object RegExp]",ih="[object Set]",oh="[object String]",ah="[object Symbol]",lh="[object ArrayBuffer]",uh="[object DataView]",Si=Ht?Ht.prototype:void 0,cs=Si?Si.valueOf:void 0;function ch(n,t,e,r,s,i,a){switch(e){case uh:if(n.byteLength!=t.byteLength||n.byteOffset!=t.byteOffset)return!1;n=n.buffer,t=t.buffer;case lh:return!(n.byteLength!=t.byteLength||!i(new Qn(n),new Qn(t)));case Qc:case th:case rh:return dn(+n,+t);case eh:return n.name==t.name&&n.message==t.message;case sh:case oh:return n==t+"";case nh:var l=Xc;case ih:var u=r&Zc;if(l||(l=Yc),n.size!=t.size&&!u)return!1;var h=a.get(n);if(h)return h==t;r|=Jc,a.set(n,t);var p=Lo(l(n),l(t),r,s,i,a);return a.delete(n),p;case ah:if(cs)return cs.call(n)==cs.call(t)}return!1}var hh=1,fh=Object.prototype,dh=fh.hasOwnProperty;function ph(n,t,e,r,s,i){var a=e&hh,l=As(n),u=l.length,h=As(t),p=h.length;if(u!=p&&!a)return!1;for(var b=u;b--;){var d=l[b];if(!(a?d in t:dh.call(t,d)))return!1}var g=i.get(n),m=i.get(t);if(g&&m)return g==t&&m==n;var v=!0;i.set(n,t),i.set(t,n);for(var y=a;++b<u;){d=l[b];var E=n[d],T=t[d];if(r)var A=a?r(T,E,d,t,n,i):r(E,T,d,n,t,i);if(!(A===void 0?E===T||s(E,T,e,r,i):A)){v=!1;break}y||(y=d=="constructor")}if(v&&!y){var O=n.constructor,w=t.constructor;O!=w&&"constructor"in n&&"constructor"in t&&!(typeof O=="function"&&O instanceof O&&typeof w=="function"&&w instanceof w)&&(v=!1)}return i.delete(n),i.delete(t),v}var gh=1,Ci="[object Arguments]",xi="[object Array]",Hn="[object Object]",mh=Object.prototype,Ii=mh.hasOwnProperty;function bh(n,t,e,r,s,i){var a=se(n),l=se(t),u=a?xi:pt(n),h=l?xi:pt(t);u=u==Ci?Hn:u,h=h==Ci?Hn:h;var p=u==Hn,b=h==Hn,d=u==h;if(d&&sn(n)){if(!sn(t))return!1;a=!0,p=!1}if(d&&!p)return i||(i=new At),a||Ks(n)?Lo(n,t,e,r,s,i):ch(n,t,u,e,r,s,i);if(!(e&gh)){var g=p&&Ii.call(n,"__wrapped__"),m=b&&Ii.call(t,"__wrapped__");if(g||m){var v=g?n.value():n,y=m?t.value():t;return i||(i=new At),s(v,y,e,r,i)}}return d?(i||(i=new At),ph(n,t,e,r,s,i)):!1}function So(n,t,e,r,s){return n===t?!0:n==null||t==null||!jt(n)&&!jt(t)?n!==n&&t!==t:bh(n,t,e,r,So,s)}function yh(n){return function(t,e,r){for(var s=-1,i=Object(t),a=r(t),l=a.length;l--;){var u=a[++s];if(e(i[u],u,i)===!1)break}return t}}var vh=yh();function Ls(n,t,e){(e!==void 0&&!dn(n[t],e)||e===void 0&&!(t in n))&&Us(n,t,e)}function Eh(n){return jt(n)&&ir(n)}function Ss(n,t){if(!(t==="constructor"&&typeof n[t]=="function")&&t!="__proto__")return n[t]}function Nh(n){return pn(n,gn(n))}function Th(n,t,e,r,s,i,a){var l=Ss(n,e),u=Ss(t,e),h=a.get(u);if(h){Ls(n,e,h);return}var p=i?i(l,u,e+"",n,t,a):void 0,b=p===void 0;if(b){var d=se(u),g=!d&&sn(u),m=!d&&!g&&Ks(u);p=u,d||g||m?se(l)?p=l:Eh(l)?p=io(l):g?(b=!1,p=yo(u,!0)):m?(b=!1,p=To(u,!0)):p=[]:fu(u)||Ts(u)?(p=l,Ts(l)?p=Nh(l):(!Gt(l)||ks(l))&&(p=Ao(u))):b=!1}b&&(a.set(u,p),s(p,u,r,i,a),a.delete(u)),Ls(n,e,p)}function Co(n,t,e,r,s){n!==t&&vh(t,function(i,a){if(s||(s=new At),Gt(i))Th(n,t,a,e,Co,r,s);else{var l=r?r(Ss(n,a),i,a+"",n,t,s):void 0;l===void 0&&(l=i),Ls(n,a,l)}},gn)}function Xs(n,t){return So(n,t)}var nn=Ga(function(n,t,e){Co(n,t,e)}),S=(n=>(n[n.TYPE=3]="TYPE",n[n.LEVEL=12]="LEVEL",n[n.ATTRIBUTE=13]="ATTRIBUTE",n[n.BLOT=14]="BLOT",n[n.INLINE=7]="INLINE",n[n.BLOCK=11]="BLOCK",n[n.BLOCK_BLOT=10]="BLOCK_BLOT",n[n.INLINE_BLOT=6]="INLINE_BLOT",n[n.BLOCK_ATTRIBUTE=9]="BLOCK_ATTRIBUTE",n[n.INLINE_ATTRIBUTE=5]="INLINE_ATTRIBUTE",n[n.ANY=15]="ANY",n))(S||{});class wt{constructor(t,e,r={}){this.attrName=t,this.keyName=e;const s=S.TYPE&S.ATTRIBUTE;this.scope=r.scope!=null?r.scope&S.LEVEL|s:S.ATTRIBUTE,r.whitelist!=null&&(this.whitelist=r.whitelist)}static keys(t){return Array.from(t.attributes).map(e=>e.name)}add(t,e){return this.canAdd(t,e)?(t.setAttribute(this.keyName,e),!0):!1}canAdd(t,e){return this.whitelist==null?!0:typeof e=="string"?this.whitelist.indexOf(e.replace(/["']/g,""))>-1:this.whitelist.indexOf(e)>-1}remove(t){t.removeAttribute(this.keyName)}value(t){const e=t.getAttribute(this.keyName);return this.canAdd(t,e)&&e?e:""}}class Se extends Error{constructor(t){t="[Parchment] "+t,super(t),this.message=t,this.name=this.constructor.name}}const xo=class Cs{constructor(){this.attributes={},this.classes={},this.tags={},this.types={}}static find(t,e=!1){if(t==null)return null;if(this.blots.has(t))return this.blots.get(t)||null;if(e){let r=null;try{r=t.parentNode}catch{return null}return this.find(r,e)}return null}create(t,e,r){const s=this.query(e);if(s==null)throw new Se(`Unable to create ${e} blot`);const i=s,a=e instanceof Node||e.nodeType===Node.TEXT_NODE?e:i.create(r),l=new i(t,a,r);return Cs.blots.set(l.domNode,l),l}find(t,e=!1){return Cs.find(t,e)}query(t,e=S.ANY){let r;return typeof t=="string"?r=this.types[t]||this.attributes[t]:t instanceof Text||t.nodeType===Node.TEXT_NODE?r=this.types.text:typeof t=="number"?t&S.LEVEL&S.BLOCK?r=this.types.block:t&S.LEVEL&S.INLINE&&(r=this.types.inline):t instanceof Element&&((t.getAttribute("class")||"").split(/\s+/).some(s=>(r=this.classes[s],!!r)),r=r||this.tags[t.tagName]),r==null?null:"scope"in r&&e&S.LEVEL&r.scope&&e&S.TYPE&r.scope?r:null}register(...t){return t.map(e=>{const r="blotName"in e,s="attrName"in e;if(!r&&!s)throw new Se("Invalid definition");if(r&&e.blotName==="abstract")throw new Se("Cannot register abstract class");const i=r?e.blotName:s?e.attrName:void 0;return this.types[i]=e,s?typeof e.keyName=="string"&&(this.attributes[e.keyName]=e):r&&(e.className&&(this.classes[e.className]=e),e.tagName&&(Array.isArray(e.tagName)?e.tagName=e.tagName.map(a=>a.toUpperCase()):e.tagName=e.tagName.toUpperCase(),(Array.isArray(e.tagName)?e.tagName:[e.tagName]).forEach(a=>{(this.tags[a]==null||e.className==null)&&(this.tags[a]=e)}))),e})}};xo.blots=new WeakMap;let Ie=xo;function Ri(n,t){return(n.getAttribute("class")||"").split(/\s+/).filter(e=>e.indexOf(`${t}-`)===0)}class Ah extends wt{static keys(t){return(t.getAttribute("class")||"").split(/\s+/).map(e=>e.split("-").slice(0,-1).join("-"))}add(t,e){return this.canAdd(t,e)?(this.remove(t),t.classList.add(`${this.keyName}-${e}`),!0):!1}remove(t){Ri(t,this.keyName).forEach(e=>{t.classList.remove(e)}),t.classList.length===0&&t.removeAttribute("class")}value(t){const e=(Ri(t,this.keyName)[0]||"").slice(this.keyName.length+1);return this.canAdd(t,e)?e:""}}const Pt=Ah;function hs(n){const t=n.split("-"),e=t.slice(1).map(r=>r[0].toUpperCase()+r.slice(1)).join("");return t[0]+e}class _h extends wt{static keys(t){return(t.getAttribute("style")||"").split(";").map(e=>e.split(":")[0].trim())}add(t,e){return this.canAdd(t,e)?(t.style[hs(this.keyName)]=e,!0):!1}remove(t){t.style[hs(this.keyName)]="",t.getAttribute("style")||t.removeAttribute("style")}value(t){const e=t.style[hs(this.keyName)];return this.canAdd(t,e)?e:""}}const Wt=_h;class wh{constructor(t){this.attributes={},this.domNode=t,this.build()}attribute(t,e){e?t.add(this.domNode,e)&&(t.value(this.domNode)!=null?this.attributes[t.attrName]=t:delete this.attributes[t.attrName]):(t.remove(this.domNode),delete this.attributes[t.attrName])}build(){this.attributes={};const t=Ie.find(this.domNode);if(t==null)return;const e=wt.keys(this.domNode),r=Pt.keys(this.domNode),s=Wt.keys(this.domNode);e.concat(r).concat(s).forEach(i=>{const a=t.scroll.query(i,S.ATTRIBUTE);a instanceof wt&&(this.attributes[a.attrName]=a)})}copy(t){Object.keys(this.attributes).forEach(e=>{const r=this.attributes[e].value(this.domNode);t.format(e,r)})}move(t){this.copy(t),Object.keys(this.attributes).forEach(e=>{this.attributes[e].remove(this.domNode)}),this.attributes={}}values(){return Object.keys(this.attributes).reduce((t,e)=>(t[e]=this.attributes[e].value(this.domNode),t),{})}}const lr=wh,Io=class{constructor(t,e){this.scroll=t,this.domNode=e,Ie.blots.set(e,this),this.prev=null,this.next=null}static create(t){if(this.tagName==null)throw new Se("Blot definition missing tagName");let e,r;return Array.isArray(this.tagName)?(typeof t=="string"?(r=t.toUpperCase(),parseInt(r,10).toString()===r&&(r=parseInt(r,10))):typeof t=="number"&&(r=t),typeof r=="number"?e=document.createElement(this.tagName[r-1]):r&&this.tagName.indexOf(r)>-1?e=document.createElement(r):e=document.createElement(this.tagName[0])):e=document.createElement(this.tagName),this.className&&e.classList.add(this.className),e}get statics(){return this.constructor}attach(){}clone(){const t=this.domNode.cloneNode(!1);return this.scroll.create(t)}detach(){this.parent!=null&&this.parent.removeChild(this),Ie.blots.delete(this.domNode)}deleteAt(t,e){this.isolate(t,e).remove()}formatAt(t,e,r,s){const i=this.isolate(t,e);if(this.scroll.query(r,S.BLOT)!=null&&s)i.wrap(r,s);else if(this.scroll.query(r,S.ATTRIBUTE)!=null){const a=this.scroll.create(this.statics.scope);i.wrap(a),a.format(r,s)}}insertAt(t,e,r){const s=r==null?this.scroll.create("text",e):this.scroll.create(e,r),i=this.split(t);this.parent.insertBefore(s,i||void 0)}isolate(t,e){const r=this.split(t);if(r==null)throw new Error("Attempt to isolate at end");return r.split(e),r}length(){return 1}offset(t=this.parent){return this.parent==null||this===t?0:this.parent.children.offset(this)+this.parent.offset(t)}optimize(t){this.statics.requiredContainer&&!(this.parent instanceof this.statics.requiredContainer)&&this.wrap(this.statics.requiredContainer.blotName)}remove(){this.domNode.parentNode!=null&&this.domNode.parentNode.removeChild(this.domNode),this.detach()}replaceWith(t,e){const r=typeof t=="string"?this.scroll.create(t,e):t;return this.parent!=null&&(this.parent.insertBefore(r,this.next||void 0),this.remove()),r}split(t,e){return t===0?this:this.next}update(t,e){}wrap(t,e){const r=typeof t=="string"?this.scroll.create(t,e):t;if(this.parent!=null&&this.parent.insertBefore(r,this.next||void 0),typeof r.appendChild!="function")throw new Se(`Cannot wrap ${t}`);return r.appendChild(this),r}};Io.blotName="abstract";let Ro=Io;const Bo=class extends Ro{static value(t){return!0}index(t,e){return this.domNode===t||this.domNode.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(e,1):-1}position(t,e){let r=Array.from(this.parent.domNode.childNodes).indexOf(this.domNode);return t>0&&(r+=1),[this.parent.domNode,r]}value(){return{[this.statics.blotName]:this.statics.value(this.domNode)||!0}}};Bo.scope=S.INLINE_BLOT;let Oh=Bo;const Z=Oh;class Lh{constructor(){this.head=null,this.tail=null,this.length=0}append(...t){if(this.insertBefore(t[0],null),t.length>1){const e=t.slice(1);this.append(...e)}}at(t){const e=this.iterator();let r=e();for(;r&&t>0;)t-=1,r=e();return r}contains(t){const e=this.iterator();let r=e();for(;r;){if(r===t)return!0;r=e()}return!1}indexOf(t){const e=this.iterator();let r=e(),s=0;for(;r;){if(r===t)return s;s+=1,r=e()}return-1}insertBefore(t,e){t!=null&&(this.remove(t),t.next=e,e!=null?(t.prev=e.prev,e.prev!=null&&(e.prev.next=t),e.prev=t,e===this.head&&(this.head=t)):this.tail!=null?(this.tail.next=t,t.prev=this.tail,this.tail=t):(t.prev=null,this.head=this.tail=t),this.length+=1)}offset(t){let e=0,r=this.head;for(;r!=null;){if(r===t)return e;e+=r.length(),r=r.next}return-1}remove(t){this.contains(t)&&(t.prev!=null&&(t.prev.next=t.next),t.next!=null&&(t.next.prev=t.prev),t===this.head&&(this.head=t.next),t===this.tail&&(this.tail=t.prev),this.length-=1)}iterator(t=this.head){return()=>{const e=t;return t!=null&&(t=t.next),e}}find(t,e=!1){const r=this.iterator();let s=r();for(;s;){const i=s.length();if(t<i||e&&t===i&&(s.next==null||s.next.length()!==0))return[s,t];t-=i,s=r()}return[null,0]}forEach(t){const e=this.iterator();let r=e();for(;r;)t(r),r=e()}forEachAt(t,e,r){if(e<=0)return;const[s,i]=this.find(t);let a=t-i;const l=this.iterator(s);let u=l();for(;u&&a<t+e;){const h=u.length();t>a?r(u,t-a,Math.min(e,a+h-t)):r(u,0,Math.min(h,t+e-a)),a+=h,u=l()}}map(t){return this.reduce((e,r)=>(e.push(t(r)),e),[])}reduce(t,e){const r=this.iterator();let s=r();for(;s;)e=t(e,s),s=r();return e}}function Bi(n,t){const e=t.find(n);if(e)return e;try{return t.create(n)}catch{const r=t.create(S.INLINE);return Array.from(n.childNodes).forEach(s=>{r.domNode.appendChild(s)}),n.parentNode&&n.parentNode.replaceChild(r.domNode,n),r.attach(),r}}const Mo=class Ft extends Ro{constructor(t,e){super(t,e),this.uiNode=null,this.build()}appendChild(t){this.insertBefore(t)}attach(){super.attach(),this.children.forEach(t=>{t.attach()})}attachUI(t){this.uiNode!=null&&this.uiNode.remove(),this.uiNode=t,Ft.uiClass&&this.uiNode.classList.add(Ft.uiClass),this.uiNode.setAttribute("contenteditable","false"),this.domNode.insertBefore(this.uiNode,this.domNode.firstChild)}build(){this.children=new Lh,Array.from(this.domNode.childNodes).filter(t=>t!==this.uiNode).reverse().forEach(t=>{try{const e=Bi(t,this.scroll);this.insertBefore(e,this.children.head||void 0)}catch(e){if(e instanceof Se)return;throw e}})}deleteAt(t,e){if(t===0&&e===this.length())return this.remove();this.children.forEachAt(t,e,(r,s,i)=>{r.deleteAt(s,i)})}descendant(t,e=0){const[r,s]=this.children.find(e);return t.blotName==null&&t(r)||t.blotName!=null&&r instanceof t?[r,s]:r instanceof Ft?r.descendant(t,s):[null,-1]}descendants(t,e=0,r=Number.MAX_VALUE){let s=[],i=r;return this.children.forEachAt(e,r,(a,l,u)=>{(t.blotName==null&&t(a)||t.blotName!=null&&a instanceof t)&&s.push(a),a instanceof Ft&&(s=s.concat(a.descendants(t,l,i))),i-=u}),s}detach(){this.children.forEach(t=>{t.detach()}),super.detach()}enforceAllowedChildren(){let t=!1;this.children.forEach(e=>{t||this.statics.allowedChildren.some(r=>e instanceof r)||(e.statics.scope===S.BLOCK_BLOT?(e.next!=null&&this.splitAfter(e),e.prev!=null&&this.splitAfter(e.prev),e.parent.unwrap(),t=!0):e instanceof Ft?e.unwrap():e.remove())})}formatAt(t,e,r,s){this.children.forEachAt(t,e,(i,a,l)=>{i.formatAt(a,l,r,s)})}insertAt(t,e,r){const[s,i]=this.children.find(t);if(s)s.insertAt(i,e,r);else{const a=r==null?this.scroll.create("text",e):this.scroll.create(e,r);this.appendChild(a)}}insertBefore(t,e){t.parent!=null&&t.parent.children.remove(t);let r=null;this.children.insertBefore(t,e||null),t.parent=this,e!=null&&(r=e.domNode),(this.domNode.parentNode!==t.domNode||this.domNode.nextSibling!==r)&&this.domNode.insertBefore(t.domNode,r),t.attach()}length(){return this.children.reduce((t,e)=>t+e.length(),0)}moveChildren(t,e){this.children.forEach(r=>{t.insertBefore(r,e)})}optimize(t){if(super.optimize(t),this.enforceAllowedChildren(),this.uiNode!=null&&this.uiNode!==this.domNode.firstChild&&this.domNode.insertBefore(this.uiNode,this.domNode.firstChild),this.children.length===0)if(this.statics.defaultChild!=null){const e=this.scroll.create(this.statics.defaultChild.blotName);this.appendChild(e)}else this.remove()}path(t,e=!1){const[r,s]=this.children.find(t,e),i=[[this,t]];return r instanceof Ft?i.concat(r.path(s,e)):(r!=null&&i.push([r,s]),i)}removeChild(t){this.children.remove(t)}replaceWith(t,e){const r=typeof t=="string"?this.scroll.create(t,e):t;return r instanceof Ft&&this.moveChildren(r),super.replaceWith(r)}split(t,e=!1){if(!e){if(t===0)return this;if(t===this.length())return this.next}const r=this.clone();return this.parent&&this.parent.insertBefore(r,this.next||void 0),this.children.forEachAt(t,this.length(),(s,i,a)=>{const l=s.split(i,e);l!=null&&r.appendChild(l)}),r}splitAfter(t){const e=this.clone();for(;t.next!=null;)e.appendChild(t.next);return this.parent&&this.parent.insertBefore(e,this.next||void 0),e}unwrap(){this.parent&&this.moveChildren(this.parent,this.next||void 0),this.remove()}update(t,e){const r=[],s=[];t.forEach(i=>{i.target===this.domNode&&i.type==="childList"&&(r.push(...i.addedNodes),s.push(...i.removedNodes))}),s.forEach(i=>{if(i.parentNode!=null&&i.tagName!=="IFRAME"&&document.body.compareDocumentPosition(i)&Node.DOCUMENT_POSITION_CONTAINED_BY)return;const a=this.scroll.find(i);a!=null&&(a.domNode.parentNode==null||a.domNode.parentNode===this.domNode)&&a.detach()}),r.filter(i=>i.parentNode===this.domNode&&i!==this.uiNode).sort((i,a)=>i===a?0:i.compareDocumentPosition(a)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1).forEach(i=>{let a=null;i.nextSibling!=null&&(a=this.scroll.find(i.nextSibling));const l=Bi(i,this.scroll);(l.next!==a||l.next==null)&&(l.parent!=null&&l.parent.removeChild(this),this.insertBefore(l,a||void 0))}),this.enforceAllowedChildren()}};Mo.uiClass="";let Sh=Mo;const mt=Sh;function Ch(n,t){if(Object.keys(n).length!==Object.keys(t).length)return!1;for(const e in n)if(n[e]!==t[e])return!1;return!0}const Ne=class Te extends mt{static create(t){return super.create(t)}static formats(t,e){const r=e.query(Te.blotName);if(!(r!=null&&t.tagName===r.tagName)){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return t.tagName.toLowerCase()}}constructor(t,e){super(t,e),this.attributes=new lr(this.domNode)}format(t,e){if(t===this.statics.blotName&&!e)this.children.forEach(r=>{r instanceof Te||(r=r.wrap(Te.blotName,!0)),this.attributes.copy(r)}),this.unwrap();else{const r=this.scroll.query(t,S.INLINE);if(r==null)return;r instanceof wt?this.attributes.attribute(r,e):e&&(t!==this.statics.blotName||this.formats()[t]!==e)&&this.replaceWith(t,e)}}formats(){const t=this.attributes.values(),e=this.statics.formats(this.domNode,this.scroll);return e!=null&&(t[this.statics.blotName]=e),t}formatAt(t,e,r,s){this.formats()[r]!=null||this.scroll.query(r,S.ATTRIBUTE)?this.isolate(t,e).format(r,s):super.formatAt(t,e,r,s)}optimize(t){super.optimize(t);const e=this.formats();if(Object.keys(e).length===0)return this.unwrap();const r=this.next;r instanceof Te&&r.prev===this&&Ch(e,r.formats())&&(r.moveChildren(this),r.remove())}replaceWith(t,e){const r=super.replaceWith(t,e);return this.attributes.copy(r),r}update(t,e){super.update(t,e),t.some(r=>r.target===this.domNode&&r.type==="attributes")&&this.attributes.build()}wrap(t,e){const r=super.wrap(t,e);return r instanceof Te&&this.attributes.move(r),r}};Ne.allowedChildren=[Ne,Z],Ne.blotName="inline",Ne.scope=S.INLINE_BLOT,Ne.tagName="SPAN";let xh=Ne;const Ys=xh,Ae=class xs extends mt{static create(t){return super.create(t)}static formats(t,e){const r=e.query(xs.blotName);if(!(r!=null&&t.tagName===r.tagName)){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return t.tagName.toLowerCase()}}constructor(t,e){super(t,e),this.attributes=new lr(this.domNode)}format(t,e){const r=this.scroll.query(t,S.BLOCK);r!=null&&(r instanceof wt?this.attributes.attribute(r,e):t===this.statics.blotName&&!e?this.replaceWith(xs.blotName):e&&(t!==this.statics.blotName||this.formats()[t]!==e)&&this.replaceWith(t,e))}formats(){const t=this.attributes.values(),e=this.statics.formats(this.domNode,this.scroll);return e!=null&&(t[this.statics.blotName]=e),t}formatAt(t,e,r,s){this.scroll.query(r,S.BLOCK)!=null?this.format(r,s):super.formatAt(t,e,r,s)}insertAt(t,e,r){if(r==null||this.scroll.query(e,S.INLINE)!=null)super.insertAt(t,e,r);else{const s=this.split(t);if(s!=null){const i=this.scroll.create(e,r);s.parent.insertBefore(i,s)}else throw new Error("Attempt to insertAt after block boundaries")}}replaceWith(t,e){const r=super.replaceWith(t,e);return this.attributes.copy(r),r}update(t,e){super.update(t,e),t.some(r=>r.target===this.domNode&&r.type==="attributes")&&this.attributes.build()}};Ae.blotName="block",Ae.scope=S.BLOCK_BLOT,Ae.tagName="P",Ae.allowedChildren=[Ys,Ae,Z];let Ih=Ae;const ln=Ih,Is=class extends mt{checkMerge(){return this.next!==null&&this.next.statics.blotName===this.statics.blotName}deleteAt(t,e){super.deleteAt(t,e),this.enforceAllowedChildren()}formatAt(t,e,r,s){super.formatAt(t,e,r,s),this.enforceAllowedChildren()}insertAt(t,e,r){super.insertAt(t,e,r),this.enforceAllowedChildren()}optimize(t){super.optimize(t),this.children.length>0&&this.next!=null&&this.checkMerge()&&(this.next.moveChildren(this),this.next.remove())}};Is.blotName="container",Is.scope=S.BLOCK_BLOT;let Rh=Is;const ur=Rh;class Bh extends Z{static formats(t,e){}format(t,e){super.formatAt(0,this.length(),t,e)}formatAt(t,e,r,s){t===0&&e===this.length()?this.format(r,s):super.formatAt(t,e,r,s)}formats(){return this.statics.formats(this.domNode,this.scroll)}}const bt=Bh,Mh={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},jh=100,_e=class extends mt{constructor(t,e){super(null,e),this.registry=t,this.scroll=this,this.build(),this.observer=new MutationObserver(r=>{this.update(r)}),this.observer.observe(this.domNode,Mh),this.attach()}create(t,e){return this.registry.create(this,t,e)}find(t,e=!1){const r=this.registry.find(t,e);return r?r.scroll===this?r:e?this.find(r.scroll.domNode.parentNode,!0):null:null}query(t,e=S.ANY){return this.registry.query(t,e)}register(...t){return this.registry.register(...t)}build(){this.scroll!=null&&super.build()}detach(){super.detach(),this.observer.disconnect()}deleteAt(t,e){this.update(),t===0&&e===this.length()?this.children.forEach(r=>{r.remove()}):super.deleteAt(t,e)}formatAt(t,e,r,s){this.update(),super.formatAt(t,e,r,s)}insertAt(t,e,r){this.update(),super.insertAt(t,e,r)}optimize(t=[],e={}){super.optimize(e);const r=e.mutationsMap||new WeakMap;let s=Array.from(this.observer.takeRecords());for(;s.length>0;)t.push(s.pop());const i=(u,h=!0)=>{u==null||u===this||u.domNode.parentNode!=null&&(r.has(u.domNode)||r.set(u.domNode,[]),h&&i(u.parent))},a=u=>{r.has(u.domNode)&&(u instanceof mt&&u.children.forEach(a),r.delete(u.domNode),u.optimize(e))};let l=t;for(let u=0;l.length>0;u+=1){if(u>=jh)throw new Error("[Parchment] Maximum optimize iterations reached");for(l.forEach(h=>{const p=this.find(h.target,!0);p!=null&&(p.domNode===h.target&&(h.type==="childList"?(i(this.find(h.previousSibling,!1)),Array.from(h.addedNodes).forEach(b=>{const d=this.find(b,!1);i(d,!1),d instanceof mt&&d.children.forEach(g=>{i(g,!1)})})):h.type==="attributes"&&i(p.prev)),i(p))}),this.children.forEach(a),l=Array.from(this.observer.takeRecords()),s=l.slice();s.length>0;)t.push(s.pop())}}update(t,e={}){t=t||this.observer.takeRecords();const r=new WeakMap;t.map(s=>{const i=this.find(s.target,!0);return i==null?null:r.has(i.domNode)?(r.get(i.domNode).push(s),null):(r.set(i.domNode,[s]),i)}).forEach(s=>{s!=null&&s!==this&&r.has(s.domNode)&&s.update(r.get(s.domNode)||[],e)}),e.mutationsMap=r,r.has(this.domNode)&&super.update(r.get(this.domNode),e),this.optimize(t,e)}};_e.blotName="scroll",_e.defaultChild=ln,_e.allowedChildren=[ln,ur],_e.scope=S.BLOCK_BLOT,_e.tagName="DIV";let $h=_e;const Zs=$h,Rs=class jo extends Z{static create(t){return document.createTextNode(t)}static value(t){return t.data}constructor(t,e){super(t,e),this.text=this.statics.value(this.domNode)}deleteAt(t,e){this.domNode.data=this.text=this.text.slice(0,t)+this.text.slice(t+e)}index(t,e){return this.domNode===t?e:-1}insertAt(t,e,r){r==null?(this.text=this.text.slice(0,t)+e+this.text.slice(t),this.domNode.data=this.text):super.insertAt(t,e,r)}length(){return this.text.length}optimize(t){super.optimize(t),this.text=this.statics.value(this.domNode),this.text.length===0?this.remove():this.next instanceof jo&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())}position(t,e=!1){return[this.domNode,t]}split(t,e=!1){if(!e){if(t===0)return this;if(t===this.length())return this.next}const r=this.scroll.create(this.domNode.splitText(t));return this.parent.insertBefore(r,this.next||void 0),this.text=this.statics.value(this.domNode),r}update(t,e){t.some(r=>r.type==="characterData"&&r.target===this.domNode)&&(this.text=this.statics.value(this.domNode))}value(){return this.text}};Rs.blotName="text",Rs.scope=S.INLINE_BLOT;let Ph=Rs;const er=Ph,$o=Object.freeze(Object.defineProperty({__proto__:null,Attributor:wt,AttributorStore:lr,BlockBlot:ln,ClassAttributor:Pt,ContainerBlot:ur,EmbedBlot:bt,InlineBlot:Ys,LeafBlot:Z,ParentBlot:mt,Registry:Ie,Scope:S,ScrollBlot:Zs,StyleAttributor:Wt,TextBlot:er},Symbol.toStringTag,{value:"Module"}));var Bs={exports:{}},rt=-1,Q=1,H=0;function un(n,t,e,r,s){if(n===t)return n?[[H,n]]:[];if(e!=null){var i=Gh(n,t,e);if(i)return i}var a=Js(n,t),l=n.substring(0,a);n=n.substring(a),t=t.substring(a),a=cr(n,t);var u=n.substring(n.length-a);n=n.substring(0,n.length-a),t=t.substring(0,t.length-a);var h=Dh(n,t);return l&&h.unshift([H,l]),u&&h.push([H,u]),Qs(h,s),r&&Uh(h),h}function Dh(n,t){var e;if(!n)return[[Q,t]];if(!t)return[[rt,n]];var r=n.length>t.length?n:t,s=n.length>t.length?t:n,i=r.indexOf(s);if(i!==-1)return e=[[Q,r.substring(0,i)],[H,s],[Q,r.substring(i+s.length)]],n.length>t.length&&(e[0][0]=e[2][0]=rt),e;if(s.length===1)return[[rt,n],[Q,t]];var a=kh(n,t);if(a){var l=a[0],u=a[1],h=a[2],p=a[3],b=a[4],d=un(l,h),g=un(u,p);return d.concat([[H,b]],g)}return qh(n,t)}function qh(n,t){for(var e=n.length,r=t.length,s=Math.ceil((e+r)/2),i=s,a=2*s,l=new Array(a),u=new Array(a),h=0;h<a;h++)l[h]=-1,u[h]=-1;l[i+1]=0,u[i+1]=0;for(var p=e-r,b=p%2!==0,d=0,g=0,m=0,v=0,y=0;y<s;y++){for(var E=-y+d;E<=y-g;E+=2){var T=i+E,A;E===-y||E!==y&&l[T-1]<l[T+1]?A=l[T+1]:A=l[T-1]+1;for(var O=A-E;A<e&&O<r&&n.charAt(A)===t.charAt(O);)A++,O++;if(l[T]=A,A>e)g+=2;else if(O>r)d+=2;else if(b){var w=i+p-E;if(w>=0&&w<a&&u[w]!==-1){var I=e-u[w];if(A>=I)return Mi(n,t,A,O)}}}for(var M=-y+m;M<=y-v;M+=2){var w=i+M,I;M===-y||M!==y&&u[w-1]<u[w+1]?I=u[w+1]:I=u[w-1]+1;for(var U=I-M;I<e&&U<r&&n.charAt(e-I-1)===t.charAt(r-U-1);)I++,U++;if(u[w]=I,I>e)v+=2;else if(U>r)m+=2;else if(!b){var T=i+p-M;if(T>=0&&T<a&&l[T]!==-1){var A=l[T],O=i+A-T;if(I=e-I,A>=I)return Mi(n,t,A,O)}}}}return[[rt,n],[Q,t]]}function Mi(n,t,e,r){var s=n.substring(0,e),i=t.substring(0,r),a=n.substring(e),l=t.substring(r),u=un(s,i),h=un(a,l);return u.concat(h)}function Js(n,t){if(!n||!t||n.charAt(0)!==t.charAt(0))return 0;for(var e=0,r=Math.min(n.length,t.length),s=r,i=0;e<s;)n.substring(i,s)==t.substring(i,s)?(e=s,i=e):r=s,s=Math.floor((r-e)/2+e);return Po(n.charCodeAt(s-1))&&s--,s}function ji(n,t){var e=n.length,r=t.length;if(e==0||r==0)return 0;e>r?n=n.substring(e-r):e<r&&(t=t.substring(0,e));var s=Math.min(e,r);if(n==t)return s;for(var i=0,a=1;;){var l=n.substring(s-a),u=t.indexOf(l);if(u==-1)return i;a+=u,(u==0||n.substring(s-a)==t.substring(0,a))&&(i=a,a++)}}function cr(n,t){if(!n||!t||n.slice(-1)!==t.slice(-1))return 0;for(var e=0,r=Math.min(n.length,t.length),s=r,i=0;e<s;)n.substring(n.length-s,n.length-i)==t.substring(t.length-s,t.length-i)?(e=s,i=e):r=s,s=Math.floor((r-e)/2+e);return Do(n.charCodeAt(n.length-s))&&s--,s}function kh(n,t){var e=n.length>t.length?n:t,r=n.length>t.length?t:n;if(e.length<4||r.length*2<e.length)return null;function s(g,m,v){for(var y=g.substring(v,v+Math.floor(g.length/4)),E=-1,T="",A,O,w,I;(E=m.indexOf(y,E+1))!==-1;){var M=Js(g.substring(v),m.substring(E)),U=cr(g.substring(0,v),m.substring(0,E));T.length<U+M&&(T=m.substring(E-U,E)+m.substring(E,E+M),A=g.substring(0,v-U),O=g.substring(v+M),w=m.substring(0,E-U),I=m.substring(E+M))}return T.length*2>=g.length?[A,O,w,I,T]:null}var i=s(e,r,Math.ceil(e.length/4)),a=s(e,r,Math.ceil(e.length/2)),l;if(!i&&!a)return null;a?i?l=i[4].length>a[4].length?i:a:l=a:l=i;var u,h,p,b;n.length>t.length?(u=l[0],h=l[1],p=l[2],b=l[3]):(p=l[0],b=l[1],u=l[2],h=l[3]);var d=l[4];return[u,h,p,b,d]}function Uh(n){for(var t=!1,e=[],r=0,s=null,i=0,a=0,l=0,u=0,h=0;i<n.length;)n[i][0]==H?(e[r++]=i,a=u,l=h,u=0,h=0,s=n[i][1]):(n[i][0]==Q?u+=n[i][1].length:h+=n[i][1].length,s&&s.length<=Math.max(a,l)&&s.length<=Math.max(u,h)&&(n.splice(e[r-1],0,[rt,s]),n[e[r-1]+1][0]=Q,r--,r--,i=r>0?e[r-1]:-1,a=0,l=0,u=0,h=0,s=null,t=!0)),i++;for(t&&Qs(n),Kh(n),i=1;i<n.length;){if(n[i-1][0]==rt&&n[i][0]==Q){var p=n[i-1][1],b=n[i][1],d=ji(p,b),g=ji(b,p);d>=g?(d>=p.length/2||d>=b.length/2)&&(n.splice(i,0,[H,b.substring(0,d)]),n[i-1][1]=p.substring(0,p.length-d),n[i+1][1]=b.substring(d),i++):(g>=p.length/2||g>=b.length/2)&&(n.splice(i,0,[H,p.substring(0,g)]),n[i-1][0]=Q,n[i-1][1]=b.substring(0,b.length-g),n[i+1][0]=rt,n[i+1][1]=p.substring(g),i++),i++}i++}}var $i=/[^a-zA-Z0-9]/,Pi=/\s/,Di=/[\r\n]/,Fh=/\n\r?\n$/,zh=/^\r?\n\r?\n/;function Kh(n){function t(g,m){if(!g||!m)return 6;var v=g.charAt(g.length-1),y=m.charAt(0),E=v.match($i),T=y.match($i),A=E&&v.match(Pi),O=T&&y.match(Pi),w=A&&v.match(Di),I=O&&y.match(Di),M=w&&g.match(Fh),U=I&&m.match(zh);return M||U?5:w||I?4:E&&!A&&O?3:A||O?2:E||T?1:0}for(var e=1;e<n.length-1;){if(n[e-1][0]==H&&n[e+1][0]==H){var r=n[e-1][1],s=n[e][1],i=n[e+1][1],a=cr(r,s);if(a){var l=s.substring(s.length-a);r=r.substring(0,r.length-a),s=l+s.substring(0,s.length-a),i=l+i}for(var u=r,h=s,p=i,b=t(r,s)+t(s,i);s.charAt(0)===i.charAt(0);){r+=s.charAt(0),s=s.substring(1)+i.charAt(0),i=i.substring(1);var d=t(r,s)+t(s,i);d>=b&&(b=d,u=r,h=s,p=i)}n[e-1][1]!=u&&(u?n[e-1][1]=u:(n.splice(e-1,1),e--),n[e][1]=h,p?n[e+1][1]=p:(n.splice(e+1,1),e--))}e++}}function Qs(n,t){n.push([H,""]);for(var e=0,r=0,s=0,i="",a="",l;e<n.length;){if(e<n.length-1&&!n[e][1]){n.splice(e,1);continue}switch(n[e][0]){case Q:s++,a+=n[e][1],e++;break;case rt:r++,i+=n[e][1],e++;break;case H:var u=e-s-r-1;if(t){if(u>=0&&ko(n[u][1])){var h=n[u][1].slice(-1);if(n[u][1]=n[u][1].slice(0,-1),i=h+i,a=h+a,!n[u][1]){n.splice(u,1),e--;var p=u-1;n[p]&&n[p][0]===Q&&(s++,a=n[p][1]+a,p--),n[p]&&n[p][0]===rt&&(r++,i=n[p][1]+i,p--),u=p}}if(qo(n[e][1])){var h=n[e][1].charAt(0);n[e][1]=n[e][1].slice(1),i+=h,a+=h}}if(e<n.length-1&&!n[e][1]){n.splice(e,1);break}if(i.length>0||a.length>0){i.length>0&&a.length>0&&(l=Js(a,i),l!==0&&(u>=0?n[u][1]+=a.substring(0,l):(n.splice(0,0,[H,a.substring(0,l)]),e++),a=a.substring(l),i=i.substring(l)),l=cr(a,i),l!==0&&(n[e][1]=a.substring(a.length-l)+n[e][1],a=a.substring(0,a.length-l),i=i.substring(0,i.length-l)));var b=s+r;i.length===0&&a.length===0?(n.splice(e-b,b),e=e-b):i.length===0?(n.splice(e-b,b,[Q,a]),e=e-b+1):a.length===0?(n.splice(e-b,b,[rt,i]),e=e-b+1):(n.splice(e-b,b,[rt,i],[Q,a]),e=e-b+2)}e!==0&&n[e-1][0]===H?(n[e-1][1]+=n[e][1],n.splice(e,1)):e++,s=0,r=0,i="",a="";break}}n[n.length-1][1]===""&&n.pop();var d=!1;for(e=1;e<n.length-1;)n[e-1][0]===H&&n[e+1][0]===H&&(n[e][1].substring(n[e][1].length-n[e-1][1].length)===n[e-1][1]?(n[e][1]=n[e-1][1]+n[e][1].substring(0,n[e][1].length-n[e-1][1].length),n[e+1][1]=n[e-1][1]+n[e+1][1],n.splice(e-1,1),d=!0):n[e][1].substring(0,n[e+1][1].length)==n[e+1][1]&&(n[e-1][1]+=n[e+1][1],n[e][1]=n[e][1].substring(n[e+1][1].length)+n[e+1][1],n.splice(e+1,1),d=!0)),e++;d&&Qs(n,t)}function Po(n){return n>=55296&&n<=56319}function Do(n){return n>=56320&&n<=57343}function qo(n){return Do(n.charCodeAt(0))}function ko(n){return Po(n.charCodeAt(n.length-1))}function Hh(n){for(var t=[],e=0;e<n.length;e++)n[e][1].length>0&&t.push(n[e]);return t}function fs(n,t,e,r){return ko(n)||qo(r)?null:Hh([[H,n],[rt,t],[Q,e],[H,r]])}function Gh(n,t,e){var r=typeof e=="number"?{index:e,length:0}:e.oldRange,s=typeof e=="number"?null:e.newRange,i=n.length,a=t.length;if(r.length===0&&(s===null||s.length===0)){var l=r.index,u=n.slice(0,l),h=n.slice(l),p=s?s.index:null;t:{var b=l+a-i;if(p!==null&&p!==b||b<0||b>a)break t;var d=t.slice(0,b),g=t.slice(b);if(g!==h)break t;var m=Math.min(l,b),v=u.slice(0,m),y=d.slice(0,m);if(v!==y)break t;var E=u.slice(m),T=d.slice(m);return fs(v,E,T,h)}t:{if(p!==null&&p!==l)break t;var A=l,d=t.slice(0,A),g=t.slice(A);if(d!==u)break t;var O=Math.min(i-A,a-A),w=h.slice(h.length-O),I=g.slice(g.length-O);if(w!==I)break t;var E=h.slice(0,h.length-O),T=g.slice(0,g.length-O);return fs(u,E,T,w)}}if(r.length>0&&s&&s.length===0)t:{var v=n.slice(0,r.index),w=n.slice(r.index+r.length),m=v.length,O=w.length;if(a<m+O)break t;var y=t.slice(0,m),I=t.slice(a-O);if(v!==y||w!==I)break t;var E=n.slice(m,i-O),T=t.slice(m,a-O);return fs(v,E,T,w)}return null}function hr(n,t,e,r){return un(n,t,e,r,!0)}hr.INSERT=Q;hr.DELETE=rt;hr.EQUAL=H;var Wh=hr,nr={exports:{}};nr.exports;(function(n,t){var e=200,r="__lodash_hash_undefined__",s=9007199254740991,i="[object Arguments]",a="[object Array]",l="[object Boolean]",u="[object Date]",h="[object Error]",p="[object Function]",b="[object GeneratorFunction]",d="[object Map]",g="[object Number]",m="[object Object]",v="[object Promise]",y="[object RegExp]",E="[object Set]",T="[object String]",A="[object Symbol]",O="[object WeakMap]",w="[object ArrayBuffer]",I="[object DataView]",M="[object Float32Array]",U="[object Float64Array]",Ct="[object Int8Array]",qt="[object Int16Array]",Xt="[object Int32Array]",Yt="[object Uint8Array]",bn="[object Uint8ClampedArray]",yn="[object Uint16Array]",vn="[object Uint32Array]",pr=/[\\^$.*+?()[\]{}|]/g,gr=/\w*$/,mr=/^\[object .+?Constructor\]$/,br=/^(?:0|[1-9]\d*)$/,D={};D[i]=D[a]=D[w]=D[I]=D[l]=D[u]=D[M]=D[U]=D[Ct]=D[qt]=D[Xt]=D[d]=D[g]=D[m]=D[y]=D[E]=D[T]=D[A]=D[Yt]=D[bn]=D[yn]=D[vn]=!0,D[h]=D[p]=D[O]=!1;var yr=typeof zt=="object"&&zt&&zt.Object===Object&&zt,vr=typeof self=="object"&&self&&self.Object===Object&&self,lt=yr||vr||Function("return this")(),En=t&&!t.nodeType&&t,q=En&&!0&&n&&!n.nodeType&&n,Nn=q&&q.exports===En;function Er(o,c){return o.set(c[0],c[1]),o}function ut(o,c){return o.add(c),o}function Tn(o,c){for(var f=-1,N=o?o.length:0;++f<N&&c(o[f],f,o)!==!1;);return o}function An(o,c){for(var f=-1,N=c.length,R=o.length;++f<N;)o[R+f]=c[f];return o}function je(o,c,f,N){for(var R=-1,C=o?o.length:0;++R<C;)f=c(f,o[R],R,o);return f}function $e(o,c){for(var f=-1,N=Array(o);++f<o;)N[f]=c(f);return N}function _n(o,c){return o==null?void 0:o[c]}function Pe(o){var c=!1;if(o!=null&&typeof o.toString!="function")try{c=!!(o+"")}catch{}return c}function wn(o){var c=-1,f=Array(o.size);return o.forEach(function(N,R){f[++c]=[R,N]}),f}function De(o,c){return function(f){return o(c(f))}}function On(o){var c=-1,f=Array(o.size);return o.forEach(function(N){f[++c]=N}),f}var Nr=Array.prototype,Tr=Function.prototype,ce=Object.prototype,qe=lt["__core-js_shared__"],Ln=function(){var o=/[^.]+$/.exec(qe&&qe.keys&&qe.keys.IE_PROTO||"");return o?"Symbol(src)_1."+o:""}(),Sn=Tr.toString,yt=ce.hasOwnProperty,he=ce.toString,Ar=RegExp("^"+Sn.call(yt).replace(pr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Zt=Nn?lt.Buffer:void 0,fe=lt.Symbol,ke=lt.Uint8Array,it=De(Object.getPrototypeOf,Object),Cn=Object.create,xn=ce.propertyIsEnumerable,_r=Nr.splice,Ue=Object.getOwnPropertySymbols,de=Zt?Zt.isBuffer:void 0,In=De(Object.keys,Object),pe=ht(lt,"DataView"),Jt=ht(lt,"Map"),ct=ht(lt,"Promise"),ge=ht(lt,"Set"),Fe=ht(lt,"WeakMap"),Qt=ht(Object,"create"),ze=J(pe),te=J(Jt),Ke=J(ct),He=J(ge),Ge=J(Fe),kt=fe?fe.prototype:void 0,Rn=kt?kt.valueOf:void 0;function xt(o){var c=-1,f=o?o.length:0;for(this.clear();++c<f;){var N=o[c];this.set(N[0],N[1])}}function wr(){this.__data__=Qt?Qt(null):{}}function Or(o){return this.has(o)&&delete this.__data__[o]}function Lr(o){var c=this.__data__;if(Qt){var f=c[o];return f===r?void 0:f}return yt.call(c,o)?c[o]:void 0}function Bn(o){var c=this.__data__;return Qt?c[o]!==void 0:yt.call(c,o)}function We(o,c){var f=this.__data__;return f[o]=Qt&&c===void 0?r:c,this}xt.prototype.clear=wr,xt.prototype.delete=Or,xt.prototype.get=Lr,xt.prototype.has=Bn,xt.prototype.set=We;function G(o){var c=-1,f=o?o.length:0;for(this.clear();++c<f;){var N=o[c];this.set(N[0],N[1])}}function Sr(){this.__data__=[]}function Cr(o){var c=this.__data__,f=be(c,o);if(f<0)return!1;var N=c.length-1;return f==N?c.pop():_r.call(c,f,1),!0}function xr(o){var c=this.__data__,f=be(c,o);return f<0?void 0:c[f][1]}function Ir(o){return be(this.__data__,o)>-1}function Rr(o,c){var f=this.__data__,N=be(f,o);return N<0?f.push([o,c]):f[N][1]=c,this}G.prototype.clear=Sr,G.prototype.delete=Cr,G.prototype.get=xr,G.prototype.has=Ir,G.prototype.set=Rr;function V(o){var c=-1,f=o?o.length:0;for(this.clear();++c<f;){var N=o[c];this.set(N[0],N[1])}}function Br(){this.__data__={hash:new xt,map:new(Jt||G),string:new xt}}function Mr(o){return ne(this,o).delete(o)}function jr(o){return ne(this,o).get(o)}function $r(o){return ne(this,o).has(o)}function Pr(o,c){return ne(this,o).set(o,c),this}V.prototype.clear=Br,V.prototype.delete=Mr,V.prototype.get=jr,V.prototype.has=$r,V.prototype.set=Pr;function tt(o){this.__data__=new G(o)}function Dr(){this.__data__=new G}function qr(o){return this.__data__.delete(o)}function kr(o){return this.__data__.get(o)}function Ur(o){return this.__data__.has(o)}function Fr(o,c){var f=this.__data__;if(f instanceof G){var N=f.__data__;if(!Jt||N.length<e-1)return N.push([o,c]),this;f=this.__data__=new V(N)}return f.set(o,c),this}tt.prototype.clear=Dr,tt.prototype.delete=qr,tt.prototype.get=kr,tt.prototype.has=Ur,tt.prototype.set=Fr;function me(o,c){var f=Ze(o)||ve(o)?$e(o.length,String):[],N=f.length,R=!!N;for(var C in o)yt.call(o,C)&&!(R&&(C=="length"||ns(C,N)))&&f.push(C);return f}function Mn(o,c,f){var N=o[c];(!(yt.call(o,c)&&qn(N,f))||f===void 0&&!(c in o))&&(o[c]=f)}function be(o,c){for(var f=o.length;f--;)if(qn(o[f][0],c))return f;return-1}function vt(o,c){return o&&Ye(c,Qe(c),o)}function Ve(o,c,f,N,R,C,$){var j;if(N&&(j=C?N(o,R,C,$):N(o)),j!==void 0)return j;if(!Nt(o))return o;var z=Ze(o);if(z){if(j=ts(o),!c)return Zr(o,j)}else{var P=Rt(o),X=P==p||P==b;if(kn(o))return ye(o,c);if(P==m||P==i||X&&!C){if(Pe(o))return C?o:{};if(j=Et(X?{}:o),!c)return Jr(o,vt(j,o))}else{if(!D[P])return C?o:{};j=es(o,P,Ve,c)}}$||($=new tt);var et=$.get(o);if(et)return et;if($.set(o,j),!z)var K=f?Qr(o):Qe(o);return Tn(K||o,function(Y,W){K&&(W=Y,Y=o[W]),Mn(j,W,Ve(Y,c,f,N,W,o,$))}),j}function zr(o){return Nt(o)?Cn(o):{}}function Kr(o,c,f){var N=c(o);return Ze(o)?N:An(N,f(o))}function Hr(o){return he.call(o)}function Gr(o){if(!Nt(o)||ss(o))return!1;var c=Je(o)||Pe(o)?Ar:mr;return c.test(J(o))}function Wr(o){if(!Pn(o))return In(o);var c=[];for(var f in Object(o))yt.call(o,f)&&f!="constructor"&&c.push(f);return c}function ye(o,c){if(c)return o.slice();var f=new o.constructor(o.length);return o.copy(f),f}function Xe(o){var c=new o.constructor(o.byteLength);return new ke(c).set(new ke(o)),c}function ee(o,c){var f=c?Xe(o.buffer):o.buffer;return new o.constructor(f,o.byteOffset,o.byteLength)}function jn(o,c,f){var N=c?f(wn(o),!0):wn(o);return je(N,Er,new o.constructor)}function $n(o){var c=new o.constructor(o.source,gr.exec(o));return c.lastIndex=o.lastIndex,c}function Vr(o,c,f){var N=c?f(On(o),!0):On(o);return je(N,ut,new o.constructor)}function Xr(o){return Rn?Object(Rn.call(o)):{}}function Yr(o,c){var f=c?Xe(o.buffer):o.buffer;return new o.constructor(f,o.byteOffset,o.length)}function Zr(o,c){var f=-1,N=o.length;for(c||(c=Array(N));++f<N;)c[f]=o[f];return c}function Ye(o,c,f,N){f||(f={});for(var R=-1,C=c.length;++R<C;){var $=c[R],j=void 0;Mn(f,$,j===void 0?o[$]:j)}return f}function Jr(o,c){return Ye(o,It(o),c)}function Qr(o){return Kr(o,Qe,It)}function ne(o,c){var f=o.__data__;return rs(c)?f[typeof c=="string"?"string":"hash"]:f.map}function ht(o,c){var f=_n(o,c);return Gr(f)?f:void 0}var It=Ue?De(Ue,Object):os,Rt=Hr;(pe&&Rt(new pe(new ArrayBuffer(1)))!=I||Jt&&Rt(new Jt)!=d||ct&&Rt(ct.resolve())!=v||ge&&Rt(new ge)!=E||Fe&&Rt(new Fe)!=O)&&(Rt=function(o){var c=he.call(o),f=c==m?o.constructor:void 0,N=f?J(f):void 0;if(N)switch(N){case ze:return I;case te:return d;case Ke:return v;case He:return E;case Ge:return O}return c});function ts(o){var c=o.length,f=o.constructor(c);return c&&typeof o[0]=="string"&&yt.call(o,"index")&&(f.index=o.index,f.input=o.input),f}function Et(o){return typeof o.constructor=="function"&&!Pn(o)?zr(it(o)):{}}function es(o,c,f,N){var R=o.constructor;switch(c){case w:return Xe(o);case l:case u:return new R(+o);case I:return ee(o,N);case M:case U:case Ct:case qt:case Xt:case Yt:case bn:case yn:case vn:return Yr(o,N);case d:return jn(o,N,f);case g:case T:return new R(o);case y:return $n(o);case E:return Vr(o,N,f);case A:return Xr(o)}}function ns(o,c){return c=c??s,!!c&&(typeof o=="number"||br.test(o))&&o>-1&&o%1==0&&o<c}function rs(o){var c=typeof o;return c=="string"||c=="number"||c=="symbol"||c=="boolean"?o!=="__proto__":o===null}function ss(o){return!!Ln&&Ln in o}function Pn(o){var c=o&&o.constructor,f=typeof c=="function"&&c.prototype||ce;return o===f}function J(o){if(o!=null){try{return Sn.call(o)}catch{}try{return o+""}catch{}}return""}function Dn(o){return Ve(o,!0,!0)}function qn(o,c){return o===c||o!==o&&c!==c}function ve(o){return is(o)&&yt.call(o,"callee")&&(!xn.call(o,"callee")||he.call(o)==i)}var Ze=Array.isArray;function Ee(o){return o!=null&&Un(o.length)&&!Je(o)}function is(o){return Fn(o)&&Ee(o)}var kn=de||as;function Je(o){var c=Nt(o)?he.call(o):"";return c==p||c==b}function Un(o){return typeof o=="number"&&o>-1&&o%1==0&&o<=s}function Nt(o){var c=typeof o;return!!o&&(c=="object"||c=="function")}function Fn(o){return!!o&&typeof o=="object"}function Qe(o){return Ee(o)?me(o):Wr(o)}function os(){return[]}function as(){return!1}n.exports=Dn})(nr,nr.exports);var Uo=nr.exports,rr={exports:{}};rr.exports;(function(n,t){var e=200,r="__lodash_hash_undefined__",s=1,i=2,a=9007199254740991,l="[object Arguments]",u="[object Array]",h="[object AsyncFunction]",p="[object Boolean]",b="[object Date]",d="[object Error]",g="[object Function]",m="[object GeneratorFunction]",v="[object Map]",y="[object Number]",E="[object Null]",T="[object Object]",A="[object Promise]",O="[object Proxy]",w="[object RegExp]",I="[object Set]",M="[object String]",U="[object Symbol]",Ct="[object Undefined]",qt="[object WeakMap]",Xt="[object ArrayBuffer]",Yt="[object DataView]",bn="[object Float32Array]",yn="[object Float64Array]",vn="[object Int8Array]",pr="[object Int16Array]",gr="[object Int32Array]",mr="[object Uint8Array]",br="[object Uint8ClampedArray]",D="[object Uint16Array]",yr="[object Uint32Array]",vr=/[\\^$.*+?()[\]{}|]/g,lt=/^\[object .+?Constructor\]$/,En=/^(?:0|[1-9]\d*)$/,q={};q[bn]=q[yn]=q[vn]=q[pr]=q[gr]=q[mr]=q[br]=q[D]=q[yr]=!0,q[l]=q[u]=q[Xt]=q[p]=q[Yt]=q[b]=q[d]=q[g]=q[v]=q[y]=q[T]=q[w]=q[I]=q[M]=q[qt]=!1;var Nn=typeof zt=="object"&&zt&&zt.Object===Object&&zt,Er=typeof self=="object"&&self&&self.Object===Object&&self,ut=Nn||Er||Function("return this")(),Tn=t&&!t.nodeType&&t,An=Tn&&!0&&n&&!n.nodeType&&n,je=An&&An.exports===Tn,$e=je&&Nn.process,_n=function(){try{return $e&&$e.binding&&$e.binding("util")}catch{}}(),Pe=_n&&_n.isTypedArray;function wn(o,c){for(var f=-1,N=o==null?0:o.length,R=0,C=[];++f<N;){var $=o[f];c($,f,o)&&(C[R++]=$)}return C}function De(o,c){for(var f=-1,N=c.length,R=o.length;++f<N;)o[R+f]=c[f];return o}function On(o,c){for(var f=-1,N=o==null?0:o.length;++f<N;)if(c(o[f],f,o))return!0;return!1}function Nr(o,c){for(var f=-1,N=Array(o);++f<o;)N[f]=c(f);return N}function Tr(o){return function(c){return o(c)}}function ce(o,c){return o.has(c)}function qe(o,c){return o==null?void 0:o[c]}function Ln(o){var c=-1,f=Array(o.size);return o.forEach(function(N,R){f[++c]=[R,N]}),f}function Sn(o,c){return function(f){return o(c(f))}}function yt(o){var c=-1,f=Array(o.size);return o.forEach(function(N){f[++c]=N}),f}var he=Array.prototype,Ar=Function.prototype,Zt=Object.prototype,fe=ut["__core-js_shared__"],ke=Ar.toString,it=Zt.hasOwnProperty,Cn=function(){var o=/[^.]+$/.exec(fe&&fe.keys&&fe.keys.IE_PROTO||"");return o?"Symbol(src)_1."+o:""}(),xn=Zt.toString,_r=RegExp("^"+ke.call(it).replace(vr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ue=je?ut.Buffer:void 0,de=ut.Symbol,In=ut.Uint8Array,pe=Zt.propertyIsEnumerable,Jt=he.splice,ct=de?de.toStringTag:void 0,ge=Object.getOwnPropertySymbols,Fe=Ue?Ue.isBuffer:void 0,Qt=Sn(Object.keys,Object),ze=It(ut,"DataView"),te=It(ut,"Map"),Ke=It(ut,"Promise"),He=It(ut,"Set"),Ge=It(ut,"WeakMap"),kt=It(Object,"create"),Rn=J(ze),xt=J(te),wr=J(Ke),Or=J(He),Lr=J(Ge),Bn=de?de.prototype:void 0,We=Bn?Bn.valueOf:void 0;function G(o){var c=-1,f=o==null?0:o.length;for(this.clear();++c<f;){var N=o[c];this.set(N[0],N[1])}}function Sr(){this.__data__=kt?kt(null):{},this.size=0}function Cr(o){var c=this.has(o)&&delete this.__data__[o];return this.size-=c?1:0,c}function xr(o){var c=this.__data__;if(kt){var f=c[o];return f===r?void 0:f}return it.call(c,o)?c[o]:void 0}function Ir(o){var c=this.__data__;return kt?c[o]!==void 0:it.call(c,o)}function Rr(o,c){var f=this.__data__;return this.size+=this.has(o)?0:1,f[o]=kt&&c===void 0?r:c,this}G.prototype.clear=Sr,G.prototype.delete=Cr,G.prototype.get=xr,G.prototype.has=Ir,G.prototype.set=Rr;function V(o){var c=-1,f=o==null?0:o.length;for(this.clear();++c<f;){var N=o[c];this.set(N[0],N[1])}}function Br(){this.__data__=[],this.size=0}function Mr(o){var c=this.__data__,f=ye(c,o);if(f<0)return!1;var N=c.length-1;return f==N?c.pop():Jt.call(c,f,1),--this.size,!0}function jr(o){var c=this.__data__,f=ye(c,o);return f<0?void 0:c[f][1]}function $r(o){return ye(this.__data__,o)>-1}function Pr(o,c){var f=this.__data__,N=ye(f,o);return N<0?(++this.size,f.push([o,c])):f[N][1]=c,this}V.prototype.clear=Br,V.prototype.delete=Mr,V.prototype.get=jr,V.prototype.has=$r,V.prototype.set=Pr;function tt(o){var c=-1,f=o==null?0:o.length;for(this.clear();++c<f;){var N=o[c];this.set(N[0],N[1])}}function Dr(){this.size=0,this.__data__={hash:new G,map:new(te||V),string:new G}}function qr(o){var c=ht(this,o).delete(o);return this.size-=c?1:0,c}function kr(o){return ht(this,o).get(o)}function Ur(o){return ht(this,o).has(o)}function Fr(o,c){var f=ht(this,o),N=f.size;return f.set(o,c),this.size+=f.size==N?0:1,this}tt.prototype.clear=Dr,tt.prototype.delete=qr,tt.prototype.get=kr,tt.prototype.has=Ur,tt.prototype.set=Fr;function me(o){var c=-1,f=o==null?0:o.length;for(this.__data__=new tt;++c<f;)this.add(o[c])}function Mn(o){return this.__data__.set(o,r),this}function be(o){return this.__data__.has(o)}me.prototype.add=me.prototype.push=Mn,me.prototype.has=be;function vt(o){var c=this.__data__=new V(o);this.size=c.size}function Ve(){this.__data__=new V,this.size=0}function zr(o){var c=this.__data__,f=c.delete(o);return this.size=c.size,f}function Kr(o){return this.__data__.get(o)}function Hr(o){return this.__data__.has(o)}function Gr(o,c){var f=this.__data__;if(f instanceof V){var N=f.__data__;if(!te||N.length<e-1)return N.push([o,c]),this.size=++f.size,this;f=this.__data__=new tt(N)}return f.set(o,c),this.size=f.size,this}vt.prototype.clear=Ve,vt.prototype.delete=zr,vt.prototype.get=Kr,vt.prototype.has=Hr,vt.prototype.set=Gr;function Wr(o,c){var f=ve(o),N=!f&&qn(o),R=!f&&!N&&Ee(o),C=!f&&!N&&!R&&Fn(o),$=f||N||R||C,j=$?Nr(o.length,String):[],z=j.length;for(var P in o)it.call(o,P)&&!($&&(P=="length"||R&&(P=="offset"||P=="parent")||C&&(P=="buffer"||P=="byteLength"||P=="byteOffset")||es(P,z)))&&j.push(P);return j}function ye(o,c){for(var f=o.length;f--;)if(Dn(o[f][0],c))return f;return-1}function Xe(o,c,f){var N=c(o);return ve(o)?N:De(N,f(o))}function ee(o){return o==null?o===void 0?Ct:E:ct&&ct in Object(o)?Rt(o):Pn(o)}function jn(o){return Nt(o)&&ee(o)==l}function $n(o,c,f,N,R){return o===c?!0:o==null||c==null||!Nt(o)&&!Nt(c)?o!==o&&c!==c:Vr(o,c,f,N,$n,R)}function Vr(o,c,f,N,R,C){var $=ve(o),j=ve(c),z=$?u:Et(o),P=j?u:Et(c);z=z==l?T:z,P=P==l?T:P;var X=z==T,et=P==T,K=z==P;if(K&&Ee(o)){if(!Ee(c))return!1;$=!0,X=!1}if(K&&!X)return C||(C=new vt),$||Fn(o)?Ye(o,c,f,N,R,C):Jr(o,c,z,f,N,R,C);if(!(f&s)){var Y=X&&it.call(o,"__wrapped__"),W=et&&it.call(c,"__wrapped__");if(Y||W){var Ut=Y?o.value():o,Bt=W?c.value():c;return C||(C=new vt),R(Ut,Bt,f,N,C)}}return K?(C||(C=new vt),Qr(o,c,f,N,R,C)):!1}function Xr(o){if(!Un(o)||rs(o))return!1;var c=kn(o)?_r:lt;return c.test(J(o))}function Yr(o){return Nt(o)&&Je(o.length)&&!!q[ee(o)]}function Zr(o){if(!ss(o))return Qt(o);var c=[];for(var f in Object(o))it.call(o,f)&&f!="constructor"&&c.push(f);return c}function Ye(o,c,f,N,R,C){var $=f&s,j=o.length,z=c.length;if(j!=z&&!($&&z>j))return!1;var P=C.get(o);if(P&&C.get(c))return P==c;var X=-1,et=!0,K=f&i?new me:void 0;for(C.set(o,c),C.set(c,o);++X<j;){var Y=o[X],W=c[X];if(N)var Ut=$?N(W,Y,X,c,o,C):N(Y,W,X,o,c,C);if(Ut!==void 0){if(Ut)continue;et=!1;break}if(K){if(!On(c,function(Bt,re){if(!ce(K,re)&&(Y===Bt||R(Y,Bt,f,N,C)))return K.push(re)})){et=!1;break}}else if(!(Y===W||R(Y,W,f,N,C))){et=!1;break}}return C.delete(o),C.delete(c),et}function Jr(o,c,f,N,R,C,$){switch(f){case Yt:if(o.byteLength!=c.byteLength||o.byteOffset!=c.byteOffset)return!1;o=o.buffer,c=c.buffer;case Xt:return!(o.byteLength!=c.byteLength||!C(new In(o),new In(c)));case p:case b:case y:return Dn(+o,+c);case d:return o.name==c.name&&o.message==c.message;case w:case M:return o==c+"";case v:var j=Ln;case I:var z=N&s;if(j||(j=yt),o.size!=c.size&&!z)return!1;var P=$.get(o);if(P)return P==c;N|=i,$.set(o,c);var X=Ye(j(o),j(c),N,R,C,$);return $.delete(o),X;case U:if(We)return We.call(o)==We.call(c)}return!1}function Qr(o,c,f,N,R,C){var $=f&s,j=ne(o),z=j.length,P=ne(c),X=P.length;if(z!=X&&!$)return!1;for(var et=z;et--;){var K=j[et];if(!($?K in c:it.call(c,K)))return!1}var Y=C.get(o);if(Y&&C.get(c))return Y==c;var W=!0;C.set(o,c),C.set(c,o);for(var Ut=$;++et<z;){K=j[et];var Bt=o[K],re=c[K];if(N)var oi=$?N(re,Bt,K,c,o,C):N(Bt,re,K,o,c,C);if(!(oi===void 0?Bt===re||R(Bt,re,f,N,C):oi)){W=!1;break}Ut||(Ut=K=="constructor")}if(W&&!Ut){var zn=o.constructor,Kn=c.constructor;zn!=Kn&&"constructor"in o&&"constructor"in c&&!(typeof zn=="function"&&zn instanceof zn&&typeof Kn=="function"&&Kn instanceof Kn)&&(W=!1)}return C.delete(o),C.delete(c),W}function ne(o){return Xe(o,Qe,ts)}function ht(o,c){var f=o.__data__;return ns(c)?f[typeof c=="string"?"string":"hash"]:f.map}function It(o,c){var f=qe(o,c);return Xr(f)?f:void 0}function Rt(o){var c=it.call(o,ct),f=o[ct];try{o[ct]=void 0;var N=!0}catch{}var R=xn.call(o);return N&&(c?o[ct]=f:delete o[ct]),R}var ts=ge?function(o){return o==null?[]:(o=Object(o),wn(ge(o),function(c){return pe.call(o,c)}))}:os,Et=ee;(ze&&Et(new ze(new ArrayBuffer(1)))!=Yt||te&&Et(new te)!=v||Ke&&Et(Ke.resolve())!=A||He&&Et(new He)!=I||Ge&&Et(new Ge)!=qt)&&(Et=function(o){var c=ee(o),f=c==T?o.constructor:void 0,N=f?J(f):"";if(N)switch(N){case Rn:return Yt;case xt:return v;case wr:return A;case Or:return I;case Lr:return qt}return c});function es(o,c){return c=c??a,!!c&&(typeof o=="number"||En.test(o))&&o>-1&&o%1==0&&o<c}function ns(o){var c=typeof o;return c=="string"||c=="number"||c=="symbol"||c=="boolean"?o!=="__proto__":o===null}function rs(o){return!!Cn&&Cn in o}function ss(o){var c=o&&o.constructor,f=typeof c=="function"&&c.prototype||Zt;return o===f}function Pn(o){return xn.call(o)}function J(o){if(o!=null){try{return ke.call(o)}catch{}try{return o+""}catch{}}return""}function Dn(o,c){return o===c||o!==o&&c!==c}var qn=jn(function(){return arguments}())?jn:function(o){return Nt(o)&&it.call(o,"callee")&&!pe.call(o,"callee")},ve=Array.isArray;function Ze(o){return o!=null&&Je(o.length)&&!kn(o)}var Ee=Fe||as;function is(o,c){return $n(o,c)}function kn(o){if(!Un(o))return!1;var c=ee(o);return c==g||c==m||c==h||c==O}function Je(o){return typeof o=="number"&&o>-1&&o%1==0&&o<=a}function Un(o){var c=typeof o;return o!=null&&(c=="object"||c=="function")}function Nt(o){return o!=null&&typeof o=="object"}var Fn=Pe?Tr(Pe):Yr;function Qe(o){return Ze(o)?Wr(o):Zr(o)}function os(){return[]}function as(){return!1}n.exports=is})(rr,rr.exports);var Fo=rr.exports,ti={};Object.defineProperty(ti,"__esModule",{value:!0});const Vh=Uo,Xh=Fo;var Ms;(function(n){function t(i={},a={},l=!1){typeof i!="object"&&(i={}),typeof a!="object"&&(a={});let u=Vh(a);l||(u=Object.keys(u).reduce((h,p)=>(u[p]!=null&&(h[p]=u[p]),h),{}));for(const h in i)i[h]!==void 0&&a[h]===void 0&&(u[h]=i[h]);return Object.keys(u).length>0?u:void 0}n.compose=t;function e(i={},a={}){typeof i!="object"&&(i={}),typeof a!="object"&&(a={});const l=Object.keys(i).concat(Object.keys(a)).reduce((u,h)=>(Xh(i[h],a[h])||(u[h]=a[h]===void 0?null:a[h]),u),{});return Object.keys(l).length>0?l:void 0}n.diff=e;function r(i={},a={}){i=i||{};const l=Object.keys(a).reduce((u,h)=>(a[h]!==i[h]&&i[h]!==void 0&&(u[h]=a[h]),u),{});return Object.keys(i).reduce((u,h)=>(i[h]!==a[h]&&a[h]===void 0&&(u[h]=null),u),l)}n.invert=r;function s(i,a,l=!1){if(typeof i!="object")return a;if(typeof a!="object")return;if(!l)return a;const u=Object.keys(a).reduce((h,p)=>(i[p]===void 0&&(h[p]=a[p]),h),{});return Object.keys(u).length>0?u:void 0}n.transform=s})(Ms||(Ms={}));ti.default=Ms;var fr={};Object.defineProperty(fr,"__esModule",{value:!0});var js;(function(n){function t(e){return typeof e.delete=="number"?e.delete:typeof e.retain=="number"?e.retain:typeof e.retain=="object"&&e.retain!==null?1:typeof e.insert=="string"?e.insert.length:1}n.length=t})(js||(js={}));fr.default=js;var ei={};Object.defineProperty(ei,"__esModule",{value:!0});const qi=fr;class Yh{constructor(t){this.ops=t,this.index=0,this.offset=0}hasNext(){return this.peekLength()<1/0}next(t){t||(t=1/0);const e=this.ops[this.index];if(e){const r=this.offset,s=qi.default.length(e);if(t>=s-r?(t=s-r,this.index+=1,this.offset=0):this.offset+=t,typeof e.delete=="number")return{delete:t};{const i={};return e.attributes&&(i.attributes=e.attributes),typeof e.retain=="number"?i.retain=t:typeof e.retain=="object"&&e.retain!==null?i.retain=e.retain:typeof e.insert=="string"?i.insert=e.insert.substr(r,t):i.insert=e.insert,i}}else return{retain:1/0}}peek(){return this.ops[this.index]}peekLength(){return this.ops[this.index]?qi.default.length(this.ops[this.index])-this.offset:1/0}peekType(){const t=this.ops[this.index];return t?typeof t.delete=="number"?"delete":typeof t.retain=="number"||typeof t.retain=="object"&&t.retain!==null?"retain":"insert":"retain"}rest(){if(this.hasNext()){if(this.offset===0)return this.ops.slice(this.index);{const t=this.offset,e=this.index,r=this.next(),s=this.ops.slice(this.index);return this.offset=t,this.index=e,[r].concat(s)}}else return[]}}ei.default=Yh;(function(n,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AttributeMap=t.OpIterator=t.Op=void 0;const e=Wh,r=Uo,s=Fo,i=ti;t.AttributeMap=i.default;const a=fr;t.Op=a.default;const l=ei;t.OpIterator=l.default;const u="\0",h=(b,d)=>{if(typeof b!="object"||b===null)throw new Error(`cannot retain a ${typeof b}`);if(typeof d!="object"||d===null)throw new Error(`cannot retain a ${typeof d}`);const g=Object.keys(b)[0];if(!g||g!==Object.keys(d)[0])throw new Error(`embed types not matched: ${g} != ${Object.keys(d)[0]}`);return[g,b[g],d[g]]};class p{constructor(d){Array.isArray(d)?this.ops=d:d!=null&&Array.isArray(d.ops)?this.ops=d.ops:this.ops=[]}static registerEmbed(d,g){this.handlers[d]=g}static unregisterEmbed(d){delete this.handlers[d]}static getHandler(d){const g=this.handlers[d];if(!g)throw new Error(`no handlers for embed type "${d}"`);return g}insert(d,g){const m={};return typeof d=="string"&&d.length===0?this:(m.insert=d,g!=null&&typeof g=="object"&&Object.keys(g).length>0&&(m.attributes=g),this.push(m))}delete(d){return d<=0?this:this.push({delete:d})}retain(d,g){if(typeof d=="number"&&d<=0)return this;const m={retain:d};return g!=null&&typeof g=="object"&&Object.keys(g).length>0&&(m.attributes=g),this.push(m)}push(d){let g=this.ops.length,m=this.ops[g-1];if(d=r(d),typeof m=="object"){if(typeof d.delete=="number"&&typeof m.delete=="number")return this.ops[g-1]={delete:m.delete+d.delete},this;if(typeof m.delete=="number"&&d.insert!=null&&(g-=1,m=this.ops[g-1],typeof m!="object"))return this.ops.unshift(d),this;if(s(d.attributes,m.attributes)){if(typeof d.insert=="string"&&typeof m.insert=="string")return this.ops[g-1]={insert:m.insert+d.insert},typeof d.attributes=="object"&&(this.ops[g-1].attributes=d.attributes),this;if(typeof d.retain=="number"&&typeof m.retain=="number")return this.ops[g-1]={retain:m.retain+d.retain},typeof d.attributes=="object"&&(this.ops[g-1].attributes=d.attributes),this}}return g===this.ops.length?this.ops.push(d):this.ops.splice(g,0,d),this}chop(){const d=this.ops[this.ops.length-1];return d&&typeof d.retain=="number"&&!d.attributes&&this.ops.pop(),this}filter(d){return this.ops.filter(d)}forEach(d){this.ops.forEach(d)}map(d){return this.ops.map(d)}partition(d){const g=[],m=[];return this.forEach(v=>{(d(v)?g:m).push(v)}),[g,m]}reduce(d,g){return this.ops.reduce(d,g)}changeLength(){return this.reduce((d,g)=>g.insert?d+a.default.length(g):g.delete?d-g.delete:d,0)}length(){return this.reduce((d,g)=>d+a.default.length(g),0)}slice(d=0,g=1/0){const m=[],v=new l.default(this.ops);let y=0;for(;y<g&&v.hasNext();){let E;y<d?E=v.next(d-y):(E=v.next(g-y),m.push(E)),y+=a.default.length(E)}return new p(m)}compose(d){const g=new l.default(this.ops),m=new l.default(d.ops),v=[],y=m.peek();if(y!=null&&typeof y.retain=="number"&&y.attributes==null){let T=y.retain;for(;g.peekType()==="insert"&&g.peekLength()<=T;)T-=g.peekLength(),v.push(g.next());y.retain-T>0&&m.next(y.retain-T)}const E=new p(v);for(;g.hasNext()||m.hasNext();)if(m.peekType()==="insert")E.push(m.next());else if(g.peekType()==="delete")E.push(g.next());else{const T=Math.min(g.peekLength(),m.peekLength()),A=g.next(T),O=m.next(T);if(O.retain){const w={};if(typeof A.retain=="number")w.retain=typeof O.retain=="number"?T:O.retain;else if(typeof O.retain=="number")A.retain==null?w.insert=A.insert:w.retain=A.retain;else{const M=A.retain==null?"insert":"retain",[U,Ct,qt]=h(A[M],O.retain),Xt=p.getHandler(U);w[M]={[U]:Xt.compose(Ct,qt,M==="retain")}}const I=i.default.compose(A.attributes,O.attributes,typeof A.retain=="number");if(I&&(w.attributes=I),E.push(w),!m.hasNext()&&s(E.ops[E.ops.length-1],w)){const M=new p(g.rest());return E.concat(M).chop()}}else typeof O.delete=="number"&&(typeof A.retain=="number"||typeof A.retain=="object"&&A.retain!==null)&&E.push(O)}return E.chop()}concat(d){const g=new p(this.ops.slice());return d.ops.length>0&&(g.push(d.ops[0]),g.ops=g.ops.concat(d.ops.slice(1))),g}diff(d,g){if(this.ops===d.ops)return new p;const m=[this,d].map(A=>A.map(O=>{if(O.insert!=null)return typeof O.insert=="string"?O.insert:u;const w=A===d?"on":"with";throw new Error("diff() called "+w+" non-document")}).join("")),v=new p,y=e(m[0],m[1],g,!0),E=new l.default(this.ops),T=new l.default(d.ops);return y.forEach(A=>{let O=A[1].length;for(;O>0;){let w=0;switch(A[0]){case e.INSERT:w=Math.min(T.peekLength(),O),v.push(T.next(w));break;case e.DELETE:w=Math.min(O,E.peekLength()),E.next(w),v.delete(w);break;case e.EQUAL:w=Math.min(E.peekLength(),T.peekLength(),O);const I=E.next(w),M=T.next(w);s(I.insert,M.insert)?v.retain(w,i.default.diff(I.attributes,M.attributes)):v.push(M).delete(w);break}O-=w}}),v.chop()}eachLine(d,g=`
`){const m=new l.default(this.ops);let v=new p,y=0;for(;m.hasNext();){if(m.peekType()!=="insert")return;const E=m.peek(),T=a.default.length(E)-m.peekLength(),A=typeof E.insert=="string"?E.insert.indexOf(g,T)-T:-1;if(A<0)v.push(m.next());else if(A>0)v.push(m.next(A));else{if(d(v,m.next(1).attributes||{},y)===!1)return;y+=1,v=new p}}v.length()>0&&d(v,{},y)}invert(d){const g=new p;return this.reduce((m,v)=>{if(v.insert)g.delete(a.default.length(v));else{if(typeof v.retain=="number"&&v.attributes==null)return g.retain(v.retain),m+v.retain;if(v.delete||typeof v.retain=="number"){const y=v.delete||v.retain;return d.slice(m,m+y).forEach(T=>{v.delete?g.push(T):v.retain&&v.attributes&&g.retain(a.default.length(T),i.default.invert(v.attributes,T.attributes))}),m+y}else if(typeof v.retain=="object"&&v.retain!==null){const y=d.slice(m,m+1),E=new l.default(y.ops).next(),[T,A,O]=h(v.retain,E.insert),w=p.getHandler(T);return g.retain({[T]:w.invert(A,O)},i.default.invert(v.attributes,E.attributes)),m+1}}return m},0),g.chop()}transform(d,g=!1){if(g=!!g,typeof d=="number")return this.transformPosition(d,g);const m=d,v=new l.default(this.ops),y=new l.default(m.ops),E=new p;for(;v.hasNext()||y.hasNext();)if(v.peekType()==="insert"&&(g||y.peekType()!=="insert"))E.retain(a.default.length(v.next()));else if(y.peekType()==="insert")E.push(y.next());else{const T=Math.min(v.peekLength(),y.peekLength()),A=v.next(T),O=y.next(T);if(A.delete)continue;if(O.delete)E.push(O);else{const w=A.retain,I=O.retain;let M=typeof I=="object"&&I!==null?I:T;if(typeof w=="object"&&w!==null&&typeof I=="object"&&I!==null){const U=Object.keys(w)[0];if(U===Object.keys(I)[0]){const Ct=p.getHandler(U);Ct&&(M={[U]:Ct.transform(w[U],I[U],g)})}}E.retain(M,i.default.transform(A.attributes,O.attributes,g))}}return E.chop()}transformPosition(d,g=!1){g=!!g;const m=new l.default(this.ops);let v=0;for(;m.hasNext()&&v<=d;){const y=m.peekLength(),E=m.peekType();if(m.next(),E==="delete"){d-=Math.min(y,d-v);continue}else E==="insert"&&(v<d||!g)&&(d+=y);v+=y}return d}}p.Op=a.default,p.OpIterator=l.default,p.AttributeMap=i.default,p.handlers={},t.default=p,n.exports=p,n.exports.default=p})(Bs,Bs.exports);var nt=Bs.exports;const L=eo(nt);class St extends bt{static value(){}optimize(){(this.prev||this.next)&&this.remove()}length(){return 0}value(){return""}}St.blotName="break";St.tagName="BR";let Ot=class extends er{};function zo(n){return n.replace(/[&<>"']/g,t=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})[t])}const Tt=class Tt extends Ys{static compare(t,e){const r=Tt.order.indexOf(t),s=Tt.order.indexOf(e);return r>=0||s>=0?r-s:t===e?0:t<e?-1:1}formatAt(t,e,r,s){if(Tt.compare(this.statics.blotName,r)<0&&this.scroll.query(r,S.BLOT)){const i=this.isolate(t,e);s&&i.wrap(r,s)}else super.formatAt(t,e,r,s)}optimize(t){if(super.optimize(t),this.parent instanceof Tt&&Tt.compare(this.statics.blotName,this.parent.statics.blotName)>0){const e=this.parent.isolate(this.offset(),this.length());this.moveChildren(e),e.wrap(this)}}};B(Tt,"allowedChildren",[Tt,St,bt,Ot]),B(Tt,"order",["cursor","inline","link","underline","strike","italic","bold","script","code"]);let cn=Tt;const ki=1;class st extends ln{constructor(){super(...arguments);B(this,"cache",{})}delta(){return this.cache.delta==null&&(this.cache.delta=Zh(this)),this.cache.delta}deleteAt(e,r){super.deleteAt(e,r),this.cache={}}formatAt(e,r,s,i){r<=0||(this.scroll.query(s,S.BLOCK)?e+r===this.length()&&this.format(s,i):super.formatAt(e,Math.min(r,this.length()-e-1),s,i),this.cache={})}insertAt(e,r,s){if(s!=null){super.insertAt(e,r,s),this.cache={};return}if(r.length===0)return;const i=r.split(`
`),a=i.shift();a.length>0&&(e<this.length()-1||this.children.tail==null?super.insertAt(Math.min(e,this.length()-1),a):this.children.tail.insertAt(this.children.tail.length(),a),this.cache={});let l=this;i.reduce((u,h)=>(l=l.split(u,!0),l.insertAt(0,h),h.length),e+a.length)}insertBefore(e,r){const{head:s}=this.children;super.insertBefore(e,r),s instanceof St&&s.remove(),this.cache={}}length(){return this.cache.length==null&&(this.cache.length=super.length()+ki),this.cache.length}moveChildren(e,r){super.moveChildren(e,r),this.cache={}}optimize(e){super.optimize(e),this.cache={}}path(e){return super.path(e,!0)}removeChild(e){super.removeChild(e),this.cache={}}split(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(r&&(e===0||e>=this.length()-ki)){const i=this.clone();return e===0?(this.parent.insertBefore(i,this),this):(this.parent.insertBefore(i,this.next),i)}const s=super.split(e,r);return this.cache={},s}}st.blotName="block";st.tagName="P";st.defaultChild=St;st.allowedChildren=[St,cn,bt,Ot];class gt extends bt{attach(){super.attach(),this.attributes=new lr(this.domNode)}delta(){return new L().insert(this.value(),{...this.formats(),...this.attributes.values()})}format(t,e){const r=this.scroll.query(t,S.BLOCK_ATTRIBUTE);r!=null&&this.attributes.attribute(r,e)}formatAt(t,e,r,s){this.format(r,s)}insertAt(t,e,r){if(r!=null){super.insertAt(t,e,r);return}const s=e.split(`
`),i=s.pop(),a=s.map(u=>{const h=this.scroll.create(st.blotName);return h.insertAt(0,u),h}),l=this.split(t);a.forEach(u=>{this.parent.insertBefore(u,l)}),i&&this.parent.insertBefore(this.scroll.create("text",i),l)}}gt.scope=S.BLOCK_BLOT;function Zh(n){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return n.descendants(Z).reduce((e,r)=>r.length()===0?e:e.insert(r.value(),at(r,{},t)),new L).insert(`
`,at(n))}function at(n){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return n==null||("formats"in n&&typeof n.formats=="function"&&(t={...t,...n.formats()},e&&delete t["code-token"]),n.parent==null||n.parent.statics.blotName==="scroll"||n.parent.statics.scope!==n.statics.scope)?t:at(n.parent,t,e)}const ot=class ot extends bt{static value(){}constructor(t,e,r){super(t,e),this.selection=r,this.textNode=document.createTextNode(ot.CONTENTS),this.domNode.appendChild(this.textNode),this.savedLength=0}detach(){this.parent!=null&&this.parent.removeChild(this)}format(t,e){if(this.savedLength!==0){super.format(t,e);return}let r=this,s=0;for(;r!=null&&r.statics.scope!==S.BLOCK_BLOT;)s+=r.offset(r.parent),r=r.parent;r!=null&&(this.savedLength=ot.CONTENTS.length,r.optimize(),r.formatAt(s,ot.CONTENTS.length,t,e),this.savedLength=0)}index(t,e){return t===this.textNode?0:super.index(t,e)}length(){return this.savedLength}position(){return[this.textNode,this.textNode.data.length]}remove(){super.remove(),this.parent=null}restore(){if(this.selection.composing||this.parent==null)return null;const t=this.selection.getNativeRange();for(;this.domNode.lastChild!=null&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);const e=this.prev instanceof Ot?this.prev:null,r=e?e.length():0,s=this.next instanceof Ot?this.next:null,i=s?s.text:"",{textNode:a}=this,l=a.data.split(ot.CONTENTS).join("");a.data=ot.CONTENTS;let u;if(e)u=e,(l||s)&&(e.insertAt(e.length(),l+i),s&&s.remove());else if(s)u=s,s.insertAt(0,l);else{const h=document.createTextNode(l);u=this.scroll.create(h),this.parent.insertBefore(u,this)}if(this.remove(),t){const h=(d,g)=>e&&d===e.domNode?g:d===a?r+g-1:s&&d===s.domNode?r+l.length+g:null,p=h(t.start.node,t.start.offset),b=h(t.end.node,t.end.offset);if(p!==null&&b!==null)return{startNode:u.domNode,startOffset:p,endNode:u.domNode,endOffset:b}}return null}update(t,e){if(t.some(r=>r.type==="characterData"&&r.target===this.textNode)){const r=this.restore();r&&(e.range=r)}}optimize(t){super.optimize(t);let{parent:e}=this;for(;e;){if(e.domNode.tagName==="A"){this.savedLength=ot.CONTENTS.length,e.isolate(this.offset(e),this.length()).unwrap(),this.savedLength=0;break}e=e.parent}}value(){return""}};B(ot,"blotName","cursor"),B(ot,"className","ql-cursor"),B(ot,"tagName","span"),B(ot,"CONTENTS","\uFEFF");let hn=ot;var Ko={exports:{}};(function(n){var t=Object.prototype.hasOwnProperty,e="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(e=!1));function s(u,h,p){this.fn=u,this.context=h,this.once=p||!1}function i(u,h,p,b,d){if(typeof p!="function")throw new TypeError("The listener must be a function");var g=new s(p,b||u,d),m=e?e+h:h;return u._events[m]?u._events[m].fn?u._events[m]=[u._events[m],g]:u._events[m].push(g):(u._events[m]=g,u._eventsCount++),u}function a(u,h){--u._eventsCount===0?u._events=new r:delete u._events[h]}function l(){this._events=new r,this._eventsCount=0}l.prototype.eventNames=function(){var h=[],p,b;if(this._eventsCount===0)return h;for(b in p=this._events)t.call(p,b)&&h.push(e?b.slice(1):b);return Object.getOwnPropertySymbols?h.concat(Object.getOwnPropertySymbols(p)):h},l.prototype.listeners=function(h){var p=e?e+h:h,b=this._events[p];if(!b)return[];if(b.fn)return[b.fn];for(var d=0,g=b.length,m=new Array(g);d<g;d++)m[d]=b[d].fn;return m},l.prototype.listenerCount=function(h){var p=e?e+h:h,b=this._events[p];return b?b.fn?1:b.length:0},l.prototype.emit=function(h,p,b,d,g,m){var v=e?e+h:h;if(!this._events[v])return!1;var y=this._events[v],E=arguments.length,T,A;if(y.fn){switch(y.once&&this.removeListener(h,y.fn,void 0,!0),E){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,p),!0;case 3:return y.fn.call(y.context,p,b),!0;case 4:return y.fn.call(y.context,p,b,d),!0;case 5:return y.fn.call(y.context,p,b,d,g),!0;case 6:return y.fn.call(y.context,p,b,d,g,m),!0}for(A=1,T=new Array(E-1);A<E;A++)T[A-1]=arguments[A];y.fn.apply(y.context,T)}else{var O=y.length,w;for(A=0;A<O;A++)switch(y[A].once&&this.removeListener(h,y[A].fn,void 0,!0),E){case 1:y[A].fn.call(y[A].context);break;case 2:y[A].fn.call(y[A].context,p);break;case 3:y[A].fn.call(y[A].context,p,b);break;case 4:y[A].fn.call(y[A].context,p,b,d);break;default:if(!T)for(w=1,T=new Array(E-1);w<E;w++)T[w-1]=arguments[w];y[A].fn.apply(y[A].context,T)}}return!0},l.prototype.on=function(h,p,b){return i(this,h,p,b,!1)},l.prototype.once=function(h,p,b){return i(this,h,p,b,!0)},l.prototype.removeListener=function(h,p,b,d){var g=e?e+h:h;if(!this._events[g])return this;if(!p)return a(this,g),this;var m=this._events[g];if(m.fn)m.fn===p&&(!d||m.once)&&(!b||m.context===b)&&a(this,g);else{for(var v=0,y=[],E=m.length;v<E;v++)(m[v].fn!==p||d&&!m[v].once||b&&m[v].context!==b)&&y.push(m[v]);y.length?this._events[g]=y.length===1?y[0]:y:a(this,g)}return this},l.prototype.removeAllListeners=function(h){var p;return h?(p=e?e+h:h,this._events[p]&&a(this,p)):(this._events=new r,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=e,l.EventEmitter=l,n.exports=l})(Ko);var Jh=Ko.exports;const Qh=eo(Jh),$s=new WeakMap,Ps=["error","warn","log","info"];let Ds="warn";function Ho(n){if(Ds&&Ps.indexOf(n)<=Ps.indexOf(Ds)){for(var t=arguments.length,e=new Array(t>1?t-1:0),r=1;r<t;r++)e[r-1]=arguments[r];console[n](...e)}}function Vt(n){return Ps.reduce((t,e)=>(t[e]=Ho.bind(console,e,n),t),{})}Vt.level=n=>{Ds=n};Ho.level=Vt.level;const ds=Vt("quill:events"),tf=["selectionchange","mousedown","mouseup","click"];tf.forEach(n=>{document.addEventListener(n,function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];Array.from(document.querySelectorAll(".ql-container")).forEach(s=>{const i=$s.get(s);i&&i.emitter&&i.emitter.handleDOM(...e)})})});class x extends Qh{constructor(){super(),this.domListeners={},this.on("error",ds.error)}emit(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return ds.log.call(ds,...e),super.emit(...e)}handleDOM(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),s=1;s<e;s++)r[s-1]=arguments[s];(this.domListeners[t.type]||[]).forEach(i=>{let{node:a,handler:l}=i;(t.target===a||a.contains(t.target))&&l(t,...r)})}listenDOM(t,e,r){this.domListeners[t]||(this.domListeners[t]=[]),this.domListeners[t].push({node:e,handler:r})}}B(x,"events",{EDITOR_CHANGE:"editor-change",SCROLL_BEFORE_UPDATE:"scroll-before-update",SCROLL_BLOT_MOUNT:"scroll-blot-mount",SCROLL_BLOT_UNMOUNT:"scroll-blot-unmount",SCROLL_OPTIMIZE:"scroll-optimize",SCROLL_UPDATE:"scroll-update",SCROLL_EMBED_UPDATE:"scroll-embed-update",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change",COMPOSITION_BEFORE_START:"composition-before-start",COMPOSITION_START:"composition-start",COMPOSITION_BEFORE_END:"composition-before-end",COMPOSITION_END:"composition-end"}),B(x,"sources",{API:"api",SILENT:"silent",USER:"user"});const ps=Vt("quill:selection");class Re{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.index=t,this.length=e}}class ef{constructor(t,e){this.emitter=e,this.scroll=t,this.composing=!1,this.mouseDown=!1,this.root=this.scroll.domNode,this.cursor=this.scroll.create("cursor",this),this.savedRange=new Re(0,0),this.lastRange=this.savedRange,this.lastNative=null,this.handleComposition(),this.handleDragging(),this.emitter.listenDOM("selectionchange",document,()=>{!this.mouseDown&&!this.composing&&setTimeout(this.update.bind(this,x.sources.USER),1)}),this.emitter.on(x.events.SCROLL_BEFORE_UPDATE,()=>{if(!this.hasFocus())return;const r=this.getNativeRange();r!=null&&r.start.node!==this.cursor.textNode&&this.emitter.once(x.events.SCROLL_UPDATE,(s,i)=>{try{this.root.contains(r.start.node)&&this.root.contains(r.end.node)&&this.setNativeRange(r.start.node,r.start.offset,r.end.node,r.end.offset);const a=i.some(l=>l.type==="characterData"||l.type==="childList"||l.type==="attributes"&&l.target===this.root);this.update(a?x.sources.SILENT:s)}catch{}})}),this.emitter.on(x.events.SCROLL_OPTIMIZE,(r,s)=>{if(s.range){const{startNode:i,startOffset:a,endNode:l,endOffset:u}=s.range;this.setNativeRange(i,a,l,u),this.update(x.sources.SILENT)}}),this.update(x.sources.SILENT)}handleComposition(){this.emitter.on(x.events.COMPOSITION_BEFORE_START,()=>{this.composing=!0}),this.emitter.on(x.events.COMPOSITION_END,()=>{if(this.composing=!1,this.cursor.parent){const t=this.cursor.restore();if(!t)return;setTimeout(()=>{this.setNativeRange(t.startNode,t.startOffset,t.endNode,t.endOffset)},1)}})}handleDragging(){this.emitter.listenDOM("mousedown",document.body,()=>{this.mouseDown=!0}),this.emitter.listenDOM("mouseup",document.body,()=>{this.mouseDown=!1,this.update(x.sources.USER)})}focus(){this.hasFocus()||(this.root.focus({preventScroll:!0}),this.setRange(this.savedRange))}format(t,e){this.scroll.update();const r=this.getNativeRange();if(!(r==null||!r.native.collapsed||this.scroll.query(t,S.BLOCK))){if(r.start.node!==this.cursor.textNode){const s=this.scroll.find(r.start.node,!1);if(s==null)return;if(s instanceof Z){const i=s.split(r.start.offset);s.parent.insertBefore(this.cursor,i)}else s.insertBefore(this.cursor,r.start.node);this.cursor.attach()}this.cursor.format(t,e),this.scroll.optimize(),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length),this.update()}}getBounds(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.scroll.length();t=Math.min(t,r-1),e=Math.min(t+e,r-1)-t;let s,[i,a]=this.scroll.leaf(t);if(i==null)return null;if(e>0&&a===i.length()){const[p]=this.scroll.leaf(t+1);if(p){const[b]=this.scroll.line(t),[d]=this.scroll.line(t+1);b===d&&(i=p,a=0)}}[s,a]=i.position(a,!0);const l=document.createRange();if(e>0)return l.setStart(s,a),[i,a]=this.scroll.leaf(t+e),i==null?null:([s,a]=i.position(a,!0),l.setEnd(s,a),l.getBoundingClientRect());let u="left",h;if(s instanceof Text){if(!s.data.length)return null;a<s.data.length?(l.setStart(s,a),l.setEnd(s,a+1)):(l.setStart(s,a-1),l.setEnd(s,a),u="right"),h=l.getBoundingClientRect()}else{if(!(i.domNode instanceof Element))return null;h=i.domNode.getBoundingClientRect(),a>0&&(u="right")}return{bottom:h.top+h.height,height:h.height,left:h[u],right:h[u],top:h.top,width:0}}getNativeRange(){const t=document.getSelection();if(t==null||t.rangeCount<=0)return null;const e=t.getRangeAt(0);if(e==null)return null;const r=this.normalizeNative(e);return ps.info("getNativeRange",r),r}getRange(){const t=this.scroll.domNode;if("isConnected"in t&&!t.isConnected)return[null,null];const e=this.getNativeRange();return e==null?[null,null]:[this.normalizedToRange(e),e]}hasFocus(){return document.activeElement===this.root||document.activeElement!=null&&gs(this.root,document.activeElement)}normalizedToRange(t){const e=[[t.start.node,t.start.offset]];t.native.collapsed||e.push([t.end.node,t.end.offset]);const r=e.map(a=>{const[l,u]=a,h=this.scroll.find(l,!0),p=h.offset(this.scroll);return u===0?p:h instanceof Z?p+h.index(l,u):p+h.length()}),s=Math.min(Math.max(...r),this.scroll.length()-1),i=Math.min(s,...r);return new Re(i,s-i)}normalizeNative(t){if(!gs(this.root,t.startContainer)||!t.collapsed&&!gs(this.root,t.endContainer))return null;const e={start:{node:t.startContainer,offset:t.startOffset},end:{node:t.endContainer,offset:t.endOffset},native:t};return[e.start,e.end].forEach(r=>{let{node:s,offset:i}=r;for(;!(s instanceof Text)&&s.childNodes.length>0;)if(s.childNodes.length>i)s=s.childNodes[i],i=0;else if(s.childNodes.length===i)s=s.lastChild,s instanceof Text?i=s.data.length:s.childNodes.length>0?i=s.childNodes.length:i=s.childNodes.length+1;else break;r.node=s,r.offset=i}),e}rangeToNative(t){const e=this.scroll.length(),r=(s,i)=>{s=Math.min(e-1,s);const[a,l]=this.scroll.leaf(s);return a?a.position(l,i):[null,-1]};return[...r(t.index,!1),...r(t.index+t.length,!0)]}setNativeRange(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(ps.info("setNativeRange",t,e,r,s),t!=null&&(this.root.parentNode==null||t.parentNode==null||r.parentNode==null))return;const a=document.getSelection();if(a!=null)if(t!=null){this.hasFocus()||this.root.focus({preventScroll:!0});const{native:l}=this.getNativeRange()||{};if(l==null||i||t!==l.startContainer||e!==l.startOffset||r!==l.endContainer||s!==l.endOffset){t instanceof Element&&t.tagName==="BR"&&(e=Array.from(t.parentNode.childNodes).indexOf(t),t=t.parentNode),r instanceof Element&&r.tagName==="BR"&&(s=Array.from(r.parentNode.childNodes).indexOf(r),r=r.parentNode);const u=document.createRange();u.setStart(t,e),u.setEnd(r,s),a.removeAllRanges(),a.addRange(u)}}else a.removeAllRanges(),this.root.blur()}setRange(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:x.sources.API;if(typeof e=="string"&&(r=e,e=!1),ps.info("setRange",t),t!=null){const s=this.rangeToNative(t);this.setNativeRange(...s,e)}else this.setNativeRange(null);this.update(r)}update(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:x.sources.USER;const e=this.lastRange,[r,s]=this.getRange();if(this.lastRange=r,this.lastNative=s,this.lastRange!=null&&(this.savedRange=this.lastRange),!Xs(e,this.lastRange)){if(!this.composing&&s!=null&&s.native.collapsed&&s.start.node!==this.cursor.textNode){const a=this.cursor.restore();a&&this.setNativeRange(a.startNode,a.startOffset,a.endNode,a.endOffset)}const i=[x.events.SELECTION_CHANGE,Le(this.lastRange),Le(e),t];this.emitter.emit(x.events.EDITOR_CHANGE,...i),t!==x.sources.SILENT&&this.emitter.emit(...i)}}}function gs(n,t){try{t.parentNode}catch{return!1}return n.contains(t)}const nf=/^[ -~]*$/;class rf{constructor(t){this.scroll=t,this.delta=this.getDelta()}applyDelta(t){this.scroll.update();let e=this.scroll.length();this.scroll.batchStart();const r=Ui(t),s=new L;return of(r.ops.slice()).reduce((a,l)=>{const u=nt.Op.length(l);let h=l.attributes||{},p=!1,b=!1;if(l.insert!=null){if(s.retain(u),typeof l.insert=="string"){const m=l.insert;b=!m.endsWith(`
`)&&(e<=a||!!this.scroll.descendant(gt,a)[0]),this.scroll.insertAt(a,m);const[v,y]=this.scroll.line(a);let E=nn({},at(v));if(v instanceof st){const[T]=v.descendant(Z,y);T&&(E=nn(E,at(T)))}h=nt.AttributeMap.diff(E,h)||{}}else if(typeof l.insert=="object"){const m=Object.keys(l.insert)[0];if(m==null)return a;const v=this.scroll.query(m,S.INLINE)!=null;if(v)(e<=a||this.scroll.descendant(gt,a)[0])&&(b=!0);else if(a>0){const[y,E]=this.scroll.descendant(Z,a-1);y instanceof Ot?y.value()[E]!==`
`&&(p=!0):y instanceof bt&&y.statics.scope===S.INLINE_BLOT&&(p=!0)}if(this.scroll.insertAt(a,m,l.insert[m]),v){const[y]=this.scroll.descendant(Z,a);if(y){const E=nn({},at(y));h=nt.AttributeMap.diff(E,h)||{}}}}e+=u}else if(s.push(l),l.retain!==null&&typeof l.retain=="object"){const m=Object.keys(l.retain)[0];if(m==null)return a;this.scroll.updateEmbedAt(a,m,l.retain[m])}Object.keys(h).forEach(m=>{this.scroll.formatAt(a,u,m,h[m])});const d=p?1:0,g=b?1:0;return e+=d+g,s.retain(d),s.delete(g),a+u+d+g},0),s.reduce((a,l)=>typeof l.delete=="number"?(this.scroll.deleteAt(a,l.delete),a):a+nt.Op.length(l),0),this.scroll.batchEnd(),this.scroll.optimize(),this.update(r)}deleteText(t,e){return this.scroll.deleteAt(t,e),this.update(new L().retain(t).delete(e))}formatLine(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.scroll.update(),Object.keys(r).forEach(i=>{this.scroll.lines(t,Math.max(e,1)).forEach(a=>{a.format(i,r[i])})}),this.scroll.optimize();const s=new L().retain(t).retain(e,Le(r));return this.update(s)}formatText(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.keys(r).forEach(i=>{this.scroll.formatAt(t,e,i,r[i])});const s=new L().retain(t).retain(e,Le(r));return this.update(s)}getContents(t,e){return this.delta.slice(t,t+e)}getDelta(){return this.scroll.lines().reduce((t,e)=>t.concat(e.delta()),new L)}getFormat(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=[],s=[];e===0?this.scroll.path(t).forEach(l=>{const[u]=l;u instanceof st?r.push(u):u instanceof Z&&s.push(u)}):(r=this.scroll.lines(t,e),s=this.scroll.descendants(Z,t,e));const[i,a]=[r,s].map(l=>{const u=l.shift();if(u==null)return{};let h=at(u);for(;Object.keys(h).length>0;){const p=l.shift();if(p==null)return h;h=sf(at(p),h)}return h});return{...i,...a}}getHTML(t,e){const[r,s]=this.scroll.line(t);if(r){const i=r.length();return r.length()>=s+e&&!(s===0&&e===i)?fn(r,s,e,!0):fn(this.scroll,t,e,!0)}return""}getText(t,e){return this.getContents(t,e).filter(r=>typeof r.insert=="string").map(r=>r.insert).join("")}insertContents(t,e){const r=Ui(e),s=new L().retain(t).concat(r);return this.scroll.insertContents(t,r),this.update(s)}insertEmbed(t,e,r){return this.scroll.insertAt(t,e,r),this.update(new L().retain(t).insert({[e]:r}))}insertText(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return e=e.replace(/\r\n/g,`
`).replace(/\r/g,`
`),this.scroll.insertAt(t,e),Object.keys(r).forEach(s=>{this.scroll.formatAt(t,e.length,s,r[s])}),this.update(new L().retain(t).insert(e,Le(r)))}isBlank(){if(this.scroll.children.length===0)return!0;if(this.scroll.children.length>1)return!1;const t=this.scroll.children.head;if((t==null?void 0:t.statics.blotName)!==st.blotName)return!1;const e=t;return e.children.length>1?!1:e.children.head instanceof St}removeFormat(t,e){const r=this.getText(t,e),[s,i]=this.scroll.line(t+e);let a=0,l=new L;s!=null&&(a=s.length()-i,l=s.delta().slice(i,i+a-1).insert(`
`));const h=this.getContents(t,e+a).diff(new L().insert(r).concat(l)),p=new L().retain(t).concat(h);return this.applyDelta(p)}update(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;const s=this.delta;if(e.length===1&&e[0].type==="characterData"&&e[0].target.data.match(nf)&&this.scroll.find(e[0].target)){const i=this.scroll.find(e[0].target),a=at(i),l=i.offset(this.scroll),u=e[0].oldValue.replace(hn.CONTENTS,""),h=new L().insert(u),p=new L().insert(i.value()),b=r&&{oldRange:Fi(r.oldRange,-l),newRange:Fi(r.newRange,-l)};t=new L().retain(l).concat(h.diff(p,b)).reduce((g,m)=>m.insert?g.insert(m.insert,a):g.push(m),new L),this.delta=s.compose(t)}else this.delta=this.getDelta(),(!t||!Xs(s.compose(t),this.delta))&&(t=s.diff(this.delta,r));return t}}function we(n,t,e){if(n.length===0){const[g]=ms(e.pop());return t<=0?`</li></${g}>`:`</li></${g}>${we([],t-1,e)}`}const[{child:r,offset:s,length:i,indent:a,type:l},...u]=n,[h,p]=ms(l);if(a>t)return e.push(l),a===t+1?`<${h}><li${p}>${fn(r,s,i)}${we(u,a,e)}`:`<${h}><li>${we(n,t+1,e)}`;const b=e[e.length-1];if(a===t&&l===b)return`</li><li${p}>${fn(r,s,i)}${we(u,a,e)}`;const[d]=ms(e.pop());return`</li></${d}>${we(n,t-1,e)}`}function fn(n,t,e){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if("html"in n&&typeof n.html=="function")return n.html(t,e);if(n instanceof Ot)return zo(n.value().slice(t,t+e));if(n instanceof mt){if(n.statics.blotName==="list-container"){const h=[];return n.children.forEachAt(t,e,(p,b,d)=>{const g="formats"in p&&typeof p.formats=="function"?p.formats():{};h.push({child:p,offset:b,length:d,indent:g.indent||0,type:g.list})}),we(h,-1,[])}const s=[];if(n.children.forEachAt(t,e,(h,p,b)=>{s.push(fn(h,p,b))}),r||n.statics.blotName==="list")return s.join("");const{outerHTML:i,innerHTML:a}=n.domNode,[l,u]=i.split(`>${a}<`);return l==="<table"?`<table style="border: 1px solid #000;">${s.join("")}<${u}`:`${l}>${s.join("")}<${u}`}return n.domNode instanceof Element?n.domNode.outerHTML:""}function sf(n,t){return Object.keys(t).reduce((e,r)=>{if(n[r]==null)return e;const s=t[r];return s===n[r]?e[r]=s:Array.isArray(s)?s.indexOf(n[r])<0?e[r]=s.concat([n[r]]):e[r]=s:e[r]=[s,n[r]],e},{})}function ms(n){const t=n==="ordered"?"ol":"ul";switch(n){case"checked":return[t,' data-list="checked"'];case"unchecked":return[t,' data-list="unchecked"'];default:return[t,""]}}function Ui(n){return n.reduce((t,e)=>{if(typeof e.insert=="string"){const r=e.insert.replace(/\r\n/g,`
`).replace(/\r/g,`
`);return t.insert(r,e.attributes)}return t.push(e)},new L)}function Fi(n,t){let{index:e,length:r}=n;return new Re(e+t,r)}function of(n){const t=[];return n.forEach(e=>{typeof e.insert=="string"?e.insert.split(`
`).forEach((s,i)=>{i&&t.push({insert:`
`,attributes:e.attributes}),s&&t.push({insert:s,attributes:e.attributes})}):t.push(e)}),t}class Dt{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.quill=t,this.options=e}}B(Dt,"DEFAULTS",{});const Gn="\uFEFF";class Go extends bt{constructor(t,e){super(t,e),this.contentNode=document.createElement("span"),this.contentNode.setAttribute("contenteditable","false"),Array.from(this.domNode.childNodes).forEach(r=>{this.contentNode.appendChild(r)}),this.leftGuard=document.createTextNode(Gn),this.rightGuard=document.createTextNode(Gn),this.domNode.appendChild(this.leftGuard),this.domNode.appendChild(this.contentNode),this.domNode.appendChild(this.rightGuard)}index(t,e){return t===this.leftGuard?0:t===this.rightGuard?1:super.index(t,e)}restore(t){let e=null,r;const s=t.data.split(Gn).join("");if(t===this.leftGuard)if(this.prev instanceof Ot){const i=this.prev.length();this.prev.insertAt(i,s),e={startNode:this.prev.domNode,startOffset:i+s.length}}else r=document.createTextNode(s),this.parent.insertBefore(this.scroll.create(r),this),e={startNode:r,startOffset:s.length};else t===this.rightGuard&&(this.next instanceof Ot?(this.next.insertAt(0,s),e={startNode:this.next.domNode,startOffset:s.length}):(r=document.createTextNode(s),this.parent.insertBefore(this.scroll.create(r),this.next),e={startNode:r,startOffset:s.length}));return t.data=Gn,e}update(t,e){t.forEach(r=>{if(r.type==="characterData"&&(r.target===this.leftGuard||r.target===this.rightGuard)){const s=this.restore(r.target);s&&(e.range=s)}})}}class af{constructor(t,e){B(this,"isComposing",!1);this.scroll=t,this.emitter=e,this.setupListeners()}setupListeners(){this.scroll.domNode.addEventListener("compositionstart",t=>{this.isComposing||this.handleCompositionStart(t)}),this.scroll.domNode.addEventListener("compositionend",t=>{this.isComposing&&queueMicrotask(()=>{this.handleCompositionEnd(t)})})}handleCompositionStart(t){const e=t.target instanceof Node?this.scroll.find(t.target,!0):null;e&&!(e instanceof Go)&&(this.emitter.emit(x.events.COMPOSITION_BEFORE_START,t),this.scroll.batchStart(),this.emitter.emit(x.events.COMPOSITION_START,t),this.isComposing=!0)}handleCompositionEnd(t){this.emitter.emit(x.events.COMPOSITION_BEFORE_END,t),this.scroll.batchEnd(),this.emitter.emit(x.events.COMPOSITION_END,t),this.isComposing=!1}}const rn=class rn{constructor(t,e){B(this,"modules",{});this.quill=t,this.options=e}init(){Object.keys(this.options.modules).forEach(t=>{this.modules[t]==null&&this.addModule(t)})}addModule(t){const e=this.quill.constructor.import(`modules/${t}`);return this.modules[t]=new e(this.quill,this.options.modules[t]||{}),this.modules[t]}};B(rn,"DEFAULTS",{modules:{}}),B(rn,"themes",{default:rn});let sr=rn;const lf=n=>n.parentElement||n.getRootNode().host||null,uf=n=>{const t=n.getBoundingClientRect(),e="offsetWidth"in n&&Math.abs(t.width)/n.offsetWidth||1,r="offsetHeight"in n&&Math.abs(t.height)/n.offsetHeight||1;return{top:t.top,right:t.left+n.clientWidth*e,bottom:t.top+n.clientHeight*r,left:t.left}},Wn=n=>{const t=parseInt(n,10);return Number.isNaN(t)?0:t},zi=(n,t,e,r,s,i)=>n<e&&t>r?0:n<e?-(e-n+s):t>r?t-n>r-e?n+s-e:t-r+i:0,cf=(n,t)=>{var i,a,l;const e=n.ownerDocument;let r=t,s=n;for(;s;){const u=s===e.body,h=u?{top:0,right:((i=window.visualViewport)==null?void 0:i.width)??e.documentElement.clientWidth,bottom:((a=window.visualViewport)==null?void 0:a.height)??e.documentElement.clientHeight,left:0}:uf(s),p=getComputedStyle(s),b=zi(r.left,r.right,h.left,h.right,Wn(p.scrollPaddingLeft),Wn(p.scrollPaddingRight)),d=zi(r.top,r.bottom,h.top,h.bottom,Wn(p.scrollPaddingTop),Wn(p.scrollPaddingBottom));if(b||d)if(u)(l=e.defaultView)==null||l.scrollBy(b,d);else{const{scrollLeft:g,scrollTop:m}=s;d&&(s.scrollTop+=d),b&&(s.scrollLeft+=b);const v=s.scrollLeft-g,y=s.scrollTop-m;r={left:r.left-v,top:r.top-y,right:r.right-v,bottom:r.bottom-y}}s=u||p.position==="fixed"?null:lf(s)}},hf=100,ff=["block","break","cursor","inline","scroll","text"],df=(n,t,e)=>{const r=new Ie;return ff.forEach(s=>{const i=t.query(s);i&&r.register(i)}),n.forEach(s=>{let i=t.query(s);i||e.error(`Cannot register "${s}" specified in "formats" config. Are you sure it was registered?`);let a=0;for(;i;)if(r.register(i),i="blotName"in i?i.requiredContainer??null:null,a+=1,a>hf){e.error(`Cycle detected in registering blot requiredContainer: "${s}"`);break}}),r},Ce=Vt("quill"),Vn=new Ie;mt.uiClass="ql-ui";const dt=class dt{static debug(t){t===!0&&(t="log"),Vt.level(t)}static find(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return $s.get(t)||Vn.find(t,e)}static import(t){return this.imports[t]==null&&Ce.error(`Cannot import ${t}. Are you sure it was registered?`),this.imports[t]}static register(){if(typeof(arguments.length<=0?void 0:arguments[0])!="string"){const t=arguments.length<=0?void 0:arguments[0],e=!!(!(arguments.length<=1)&&arguments[1]),r="attrName"in t?t.attrName:t.blotName;typeof r=="string"?this.register(`formats/${r}`,t,e):Object.keys(t).forEach(s=>{this.register(s,t[s],e)})}else{const t=arguments.length<=0?void 0:arguments[0],e=arguments.length<=1?void 0:arguments[1],r=!!(!(arguments.length<=2)&&arguments[2]);this.imports[t]!=null&&!r&&Ce.warn(`Overwriting ${t} with`,e),this.imports[t]=e,(t.startsWith("blots/")||t.startsWith("formats/"))&&e&&typeof e!="boolean"&&e.blotName!=="abstract"&&Vn.register(e),typeof e.register=="function"&&e.register(Vn)}}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.options=pf(t,e),this.container=this.options.container,this.container==null){Ce.error("Invalid Quill container",t);return}this.options.debug&&dt.debug(this.options.debug);const r=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",$s.set(this.container,this),this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.emitter=new x;const s=Zs.blotName,i=this.options.registry.query(s);if(!i||!("blotName"in i))throw new Error(`Cannot initialize Quill without "${s}" blot`);if(this.scroll=new i(this.options.registry,this.root,{emitter:this.emitter}),this.editor=new rf(this.scroll),this.selection=new ef(this.scroll,this.emitter),this.composition=new af(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.uploader=this.theme.addModule("uploader"),this.theme.addModule("input"),this.theme.addModule("uiNode"),this.theme.init(),this.emitter.on(x.events.EDITOR_CHANGE,a=>{a===x.events.TEXT_CHANGE&&this.root.classList.toggle("ql-blank",this.editor.isBlank())}),this.emitter.on(x.events.SCROLL_UPDATE,(a,l)=>{const u=this.selection.lastRange,[h]=this.selection.getRange(),p=u&&h?{oldRange:u,newRange:h}:void 0;ft.call(this,()=>this.editor.update(null,l,p),a)}),this.emitter.on(x.events.SCROLL_EMBED_UPDATE,(a,l)=>{const u=this.selection.lastRange,[h]=this.selection.getRange(),p=u&&h?{oldRange:u,newRange:h}:void 0;ft.call(this,()=>{const b=new L().retain(a.offset(this)).retain({[a.statics.blotName]:l});return this.editor.update(b,[],p)},dt.sources.USER)}),r){const a=this.clipboard.convert({html:`${r}<p><br></p>`,text:`
`});this.setContents(a)}this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable(),this.allowReadOnlyEdits=!1}addContainer(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(typeof t=="string"){const r=t;t=document.createElement("div"),t.classList.add(r)}return this.container.insertBefore(t,e),t}blur(){this.selection.setRange(null)}deleteText(t,e,r){return[t,e,,r]=Mt(t,e,r),ft.call(this,()=>this.editor.deleteText(t,e),r,t,-1*e)}disable(){this.enable(!1)}editReadOnly(t){this.allowReadOnlyEdits=!0;const e=t();return this.allowReadOnlyEdits=!1,e}enable(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.scroll.enable(t),this.container.classList.toggle("ql-disabled",!t)}focus(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.selection.focus(),t.preventScroll||this.scrollSelectionIntoView()}format(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:x.sources.API;return ft.call(this,()=>{const s=this.getSelection(!0);let i=new L;if(s==null)return i;if(this.scroll.query(t,S.BLOCK))i=this.editor.formatLine(s.index,s.length,{[t]:e});else{if(s.length===0)return this.selection.format(t,e),i;i=this.editor.formatText(s.index,s.length,{[t]:e})}return this.setSelection(s,x.sources.SILENT),i},r)}formatLine(t,e,r,s,i){let a;return[t,e,a,i]=Mt(t,e,r,s,i),ft.call(this,()=>this.editor.formatLine(t,e,a),i,t,0)}formatText(t,e,r,s,i){let a;return[t,e,a,i]=Mt(t,e,r,s,i),ft.call(this,()=>this.editor.formatText(t,e,a),i,t,0)}getBounds(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=null;if(typeof t=="number"?r=this.selection.getBounds(t,e):r=this.selection.getBounds(t.index,t.length),!r)return null;const s=this.container.getBoundingClientRect();return{bottom:r.bottom-s.top,height:r.height,left:r.left-s.left,right:r.right-s.left,top:r.top-s.top,width:r.width}}getContents(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-t;return[t,e]=Mt(t,e),this.editor.getContents(t,e)}getFormat(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getSelection(!0),e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return typeof t=="number"?this.editor.getFormat(t,e):this.editor.getFormat(t.index,t.length)}getIndex(t){return t.offset(this.scroll)}getLength(){return this.scroll.length()}getLeaf(t){return this.scroll.leaf(t)}getLine(t){return this.scroll.line(t)}getLines(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;return typeof t!="number"?this.scroll.lines(t.index,t.length):this.scroll.lines(t,e)}getModule(t){return this.theme.modules[t]}getSelection(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&this.focus(),this.update(),this.selection.getRange()[0]}getSemanticHTML(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1?arguments[1]:void 0;return typeof t=="number"&&(e=e??this.getLength()-t),[t,e]=Mt(t,e),this.editor.getHTML(t,e)}getText(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1?arguments[1]:void 0;return typeof t=="number"&&(e=e??this.getLength()-t),[t,e]=Mt(t,e),this.editor.getText(t,e)}hasFocus(){return this.selection.hasFocus()}insertEmbed(t,e,r){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:dt.sources.API;return ft.call(this,()=>this.editor.insertEmbed(t,e,r),s,t)}insertText(t,e,r,s,i){let a;return[t,,a,i]=Mt(t,0,r,s,i),ft.call(this,()=>this.editor.insertText(t,e,a),i,t,e.length)}isEnabled(){return this.scroll.isEnabled()}off(){return this.emitter.off(...arguments)}on(){return this.emitter.on(...arguments)}once(){return this.emitter.once(...arguments)}removeFormat(t,e,r){return[t,e,,r]=Mt(t,e,r),ft.call(this,()=>this.editor.removeFormat(t,e),r,t)}scrollRectIntoView(t){cf(this.root,t)}scrollIntoView(){console.warn("Quill#scrollIntoView() has been deprecated and will be removed in the near future. Please use Quill#scrollSelectionIntoView() instead."),this.scrollSelectionIntoView()}scrollSelectionIntoView(){const t=this.selection.lastRange,e=t&&this.selection.getBounds(t.index,t.length);e&&this.scrollRectIntoView(e)}setContents(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:x.sources.API;return ft.call(this,()=>{t=new L(t);const r=this.getLength(),s=this.editor.deleteText(0,r),i=this.editor.insertContents(0,t),a=this.editor.deleteText(this.getLength()-1,1);return s.compose(i).compose(a)},e)}setSelection(t,e,r){t==null?this.selection.setRange(null,e||dt.sources.API):([t,e,,r]=Mt(t,e,r),this.selection.setRange(new Re(Math.max(0,t),e),r),r!==x.sources.SILENT&&this.scrollSelectionIntoView())}setText(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:x.sources.API;const r=new L().insert(t);return this.setContents(r,e)}update(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:x.sources.USER;const e=this.scroll.update(t);return this.selection.update(t),e}updateContents(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:x.sources.API;return ft.call(this,()=>(t=new L(t),this.editor.applyDelta(t)),e,!0)}};B(dt,"DEFAULTS",{bounds:null,modules:{clipboard:!0,keyboard:!0,history:!0,uploader:!0},placeholder:"",readOnly:!1,registry:Vn,theme:"default"}),B(dt,"events",x.events),B(dt,"sources",x.sources),B(dt,"version","2.0.2"),B(dt,"imports",{delta:L,parchment:$o,"core/module":Dt,"core/theme":sr});let _=dt;function Ki(n){return typeof n=="string"?document.querySelector(n):n}function bs(n){return Object.entries(n??{}).reduce((t,e)=>{let[r,s]=e;return{...t,[r]:s===!0?{}:s}},{})}function Hi(n){return Object.fromEntries(Object.entries(n).filter(t=>t[1]!==void 0))}function pf(n,t){const e=Ki(n);if(!e)throw new Error("Invalid Quill container");const s=!t.theme||t.theme===_.DEFAULTS.theme?sr:_.import(`themes/${t.theme}`);if(!s)throw new Error(`Invalid theme ${t.theme}. Did you register it?`);const{modules:i,...a}=_.DEFAULTS,{modules:l,...u}=s.DEFAULTS;let h=bs(t.modules);h!=null&&h.toolbar&&h.toolbar.constructor!==Object&&(h={...h,toolbar:{container:h.toolbar}});const p=nn({},bs(i),bs(l),h),b={...a,...Hi(u),...Hi(t)};let d=t.registry;return d?t.formats&&Ce.warn('Ignoring "formats" option because "registry" is specified'):d=t.formats?df(t.formats,b.registry,Ce):b.registry,{...b,registry:d,container:e,theme:s,modules:Object.entries(p).reduce((g,m)=>{let[v,y]=m;if(!y)return g;const E=_.import(`modules/${v}`);return E==null?(Ce.error(`Cannot load ${v} module. Are you sure you registered it?`),g):{...g,[v]:nn({},E.DEFAULTS||{},y)}},{}),bounds:Ki(b.bounds)}}function ft(n,t,e,r){if(!this.isEnabled()&&t===x.sources.USER&&!this.allowReadOnlyEdits)return new L;let s=e==null?null:this.getSelection();const i=this.editor.delta,a=n();if(s!=null&&(e===!0&&(e=s.index),r==null?s=Gi(s,a,t):r!==0&&(s=Gi(s,e,r,t)),this.setSelection(s,x.sources.SILENT)),a.length()>0){const l=[x.events.TEXT_CHANGE,a,i,t];this.emitter.emit(x.events.EDITOR_CHANGE,...l),t!==x.sources.SILENT&&this.emitter.emit(...l)}return a}function Mt(n,t,e,r,s){let i={};return typeof n.index=="number"&&typeof n.length=="number"?typeof t!="number"?(s=r,r=e,e=t,t=n.length,n=n.index):(t=n.length,n=n.index):typeof t!="number"&&(s=r,r=e,e=t,t=0),typeof e=="object"?(i=e,s=r):typeof e=="string"&&(r!=null?i[e]=r:s=e),s=s||x.sources.API,[n,t,i,s]}function Gi(n,t,e,r){const s=typeof e=="number"?e:0;if(n==null)return null;let i,a;return t&&typeof t.transformPosition=="function"?[i,a]=[n.index,n.index+n.length].map(l=>t.transformPosition(l,r!==x.sources.USER)):[i,a]=[n.index,n.index+n.length].map(l=>l<t||l===t&&r===x.sources.USER?l:s>=0?l+s:Math.max(t,l+s)),new Re(i,a-i)}class ni extends ur{}function Wi(n){return n instanceof st||n instanceof gt}function Vi(n){return typeof n.updateContent=="function"}class Oe extends Zs{constructor(t,e,r){let{emitter:s}=r;super(t,e),this.emitter=s,this.batch=!1,this.optimize(),this.enable(),this.domNode.addEventListener("dragstart",i=>this.handleDragStart(i))}batchStart(){Array.isArray(this.batch)||(this.batch=[])}batchEnd(){if(!this.batch)return;const t=this.batch;this.batch=!1,this.update(t)}emitMount(t){this.emitter.emit(x.events.SCROLL_BLOT_MOUNT,t)}emitUnmount(t){this.emitter.emit(x.events.SCROLL_BLOT_UNMOUNT,t)}emitEmbedUpdate(t,e){this.emitter.emit(x.events.SCROLL_EMBED_UPDATE,t,e)}deleteAt(t,e){const[r,s]=this.line(t),[i]=this.line(t+e);if(super.deleteAt(t,e),i!=null&&r!==i&&s>0){if(r instanceof gt||i instanceof gt){this.optimize();return}const a=i.children.head instanceof St?null:i.children.head;r.moveChildren(i,a),r.remove()}this.optimize()}enable(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.domNode.setAttribute("contenteditable",t?"true":"false")}formatAt(t,e,r,s){super.formatAt(t,e,r,s),this.optimize()}insertAt(t,e,r){if(t>=this.length())if(r==null||this.scroll.query(e,S.BLOCK)==null){const s=this.scroll.create(this.statics.defaultChild.blotName);this.appendChild(s),r==null&&e.endsWith(`
`)?s.insertAt(0,e.slice(0,-1),r):s.insertAt(0,e,r)}else{const s=this.scroll.create(e,r);this.appendChild(s)}else super.insertAt(t,e,r);this.optimize()}insertBefore(t,e){if(t.statics.scope===S.INLINE_BLOT){const r=this.scroll.create(this.statics.defaultChild.blotName);r.appendChild(t),super.insertBefore(r,e)}else super.insertBefore(t,e)}insertContents(t,e){const r=this.deltaToRenderBlocks(e.concat(new L().insert(`
`))),s=r.pop();if(s==null)return;this.batchStart();const i=r.shift();if(i){const u=i.type==="block"&&(i.delta.length()===0||!this.descendant(gt,t)[0]&&t<this.length()),h=i.type==="block"?i.delta:new L().insert({[i.key]:i.value});ys(this,t,h);const p=i.type==="block"?1:0,b=t+h.length()+p;u&&this.insertAt(b-1,`
`);const d=at(this.line(t)[0]),g=nt.AttributeMap.diff(d,i.attributes)||{};Object.keys(g).forEach(m=>{this.formatAt(b-1,1,m,g[m])}),t=b}let[a,l]=this.children.find(t);if(r.length&&(a&&(a=a.split(l),l=0),r.forEach(u=>{if(u.type==="block"){const h=this.createBlock(u.attributes,a||void 0);ys(h,0,u.delta)}else{const h=this.create(u.key,u.value);this.insertBefore(h,a||void 0),Object.keys(u.attributes).forEach(p=>{h.format(p,u.attributes[p])})}})),s.type==="block"&&s.delta.length()){const u=a?a.offset(a.scroll)+l:this.length();ys(this,u,s.delta)}this.batchEnd(),this.optimize()}isEnabled(){return this.domNode.getAttribute("contenteditable")==="true"}leaf(t){const e=this.path(t).pop();if(!e)return[null,-1];const[r,s]=e;return r instanceof Z?[r,s]:[null,-1]}line(t){return t===this.length()?this.line(t-1):this.descendant(Wi,t)}lines(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;const r=(s,i,a)=>{let l=[],u=a;return s.children.forEachAt(i,a,(h,p,b)=>{Wi(h)?l.push(h):h instanceof ur&&(l=l.concat(r(h,p,u))),u-=b}),l};return r(this,t,e)}optimize(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.batch||(super.optimize(t,e),t.length>0&&this.emitter.emit(x.events.SCROLL_OPTIMIZE,t,e))}path(t){return super.path(t).slice(1)}remove(){}update(t){if(this.batch){Array.isArray(t)&&(this.batch=this.batch.concat(t));return}let e=x.sources.USER;typeof t=="string"&&(e=t),Array.isArray(t)||(t=this.observer.takeRecords()),t=t.filter(r=>{let{target:s}=r;const i=this.find(s,!0);return i&&!Vi(i)}),t.length>0&&this.emitter.emit(x.events.SCROLL_BEFORE_UPDATE,e,t),super.update(t.concat([])),t.length>0&&this.emitter.emit(x.events.SCROLL_UPDATE,e,t)}updateEmbedAt(t,e,r){const[s]=this.descendant(i=>i instanceof gt,t);s&&s.statics.blotName===e&&Vi(s)&&s.updateContent(r)}handleDragStart(t){t.preventDefault()}deltaToRenderBlocks(t){const e=[];let r=new L;return t.forEach(s=>{const i=s==null?void 0:s.insert;if(i)if(typeof i=="string"){const a=i.split(`
`);a.slice(0,-1).forEach(u=>{r.insert(u,s.attributes),e.push({type:"block",delta:r,attributes:s.attributes??{}}),r=new L});const l=a[a.length-1];l&&r.insert(l,s.attributes)}else{const a=Object.keys(i)[0];if(!a)return;this.query(a,S.INLINE)?r.push(s):(r.length()&&e.push({type:"block",delta:r,attributes:{}}),r=new L,e.push({type:"blockEmbed",key:a,value:i[a],attributes:s.attributes??{}}))}}),r.length()&&e.push({type:"block",delta:r,attributes:{}}),e}createBlock(t,e){let r;const s={};Object.entries(t).forEach(l=>{let[u,h]=l;this.query(u,S.BLOCK&S.BLOT)!=null?r=u:s[u]=h});const i=this.create(r||this.statics.defaultChild.blotName,r?t[r]:void 0);this.insertBefore(i,e||void 0);const a=i.length();return Object.entries(s).forEach(l=>{let[u,h]=l;i.formatAt(0,a,u,h)}),i}}B(Oe,"blotName","scroll"),B(Oe,"className","ql-editor"),B(Oe,"tagName","DIV"),B(Oe,"defaultChild",st),B(Oe,"allowedChildren",[st,gt,ni]);function ys(n,t,e){e.reduce((r,s)=>{const i=nt.Op.length(s);let a=s.attributes||{};if(s.insert!=null){if(typeof s.insert=="string"){const l=s.insert;n.insertAt(r,l);const[u]=n.descendant(Z,r),h=at(u);a=nt.AttributeMap.diff(h,a)||{}}else if(typeof s.insert=="object"){const l=Object.keys(s.insert)[0];if(l==null)return r;if(n.insertAt(r,l,s.insert[l]),n.scroll.query(l,S.INLINE)!=null){const[h]=n.descendant(Z,r),p=at(h);a=nt.AttributeMap.diff(p,a)||{}}}}return Object.keys(a).forEach(l=>{n.formatAt(r,i,l,a[l])}),r+i},t)}const ri={scope:S.BLOCK,whitelist:["right","center","justify"]},gf=new wt("align","align",ri),yd=new Pt("align","ql-align",ri),mf=new Wt("align","text-align",ri);class Wo extends Wt{value(t){let e=super.value(t);return e.startsWith("rgb(")?(e=e.replace(/^[^\d]+/,"").replace(/[^\d]+$/,""),`#${e.split(",").map(s=>`00${parseInt(s,10).toString(16)}`.slice(-2)).join("")}`):e}}const vd=new Pt("color","ql-color",{scope:S.INLINE}),bf=new Wo("color","color",{scope:S.INLINE}),Ed=new Pt("background","ql-bg",{scope:S.INLINE}),yf=new Wo("background","background-color",{scope:S.INLINE});class Me extends ni{static create(t){const e=super.create(t);return e.setAttribute("spellcheck","false"),e}code(t,e){return this.children.map(r=>r.length()<=1?"":r.domNode.innerText).join(`
`).slice(t,t+e)}html(t,e){return`<pre>
${zo(this.code(t,e))}
</pre>`}}class _t extends st{static register(){_.register(Me)}}B(_t,"TAB","  ");class Vo extends cn{}Vo.blotName="code";Vo.tagName="CODE";_t.blotName="code-block";_t.className="ql-code-block";_t.tagName="DIV";Me.blotName="code-block-container";Me.className="ql-code-block-container";Me.tagName="DIV";Me.allowedChildren=[_t];_t.allowedChildren=[Ot,St,hn];_t.requiredContainer=Me;const si={scope:S.BLOCK,whitelist:["rtl"]},vf=new wt("direction","dir",si),Nd=new Pt("direction","ql-direction",si),Ef=new Wt("direction","direction",si),Xo={scope:S.INLINE,whitelist:["serif","monospace"]},Td=new Pt("font","ql-font",Xo);class Nf extends Wt{value(t){return super.value(t).replace(/["']/g,"")}}const Tf=new Nf("font","font-family",Xo),Ad=new Pt("size","ql-size",{scope:S.INLINE,whitelist:["small","large","huge"]}),Af=new Wt("size","font-size",{scope:S.INLINE,whitelist:["10px","18px","32px"]}),_f=Vt("quill:keyboard"),wf=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey";class dr extends Dt{static match(t,e){return["altKey","ctrlKey","metaKey","shiftKey"].some(r=>!!e[r]!==t[r]&&e[r]!==null)?!1:e.key===t.key||e.key===t.which}constructor(t,e){super(t,e),this.bindings={},Object.keys(this.options.bindings).forEach(r=>{this.options.bindings[r]&&this.addBinding(this.options.bindings[r])}),this.addBinding({key:"Enter",shiftKey:null},this.handleEnter),this.addBinding({key:"Enter",metaKey:null,ctrlKey:null,altKey:null},()=>{}),/Firefox/i.test(navigator.userAgent)?(this.addBinding({key:"Backspace"},{collapsed:!0},this.handleBackspace),this.addBinding({key:"Delete"},{collapsed:!0},this.handleDelete)):(this.addBinding({key:"Backspace"},{collapsed:!0,prefix:/^.?$/},this.handleBackspace),this.addBinding({key:"Delete"},{collapsed:!0,suffix:/^.?$/},this.handleDelete)),this.addBinding({key:"Backspace"},{collapsed:!1},this.handleDeleteRange),this.addBinding({key:"Delete"},{collapsed:!1},this.handleDeleteRange),this.addBinding({key:"Backspace",altKey:null,ctrlKey:null,metaKey:null,shiftKey:null},{collapsed:!0,offset:0},this.handleBackspace),this.listen()}addBinding(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=Lf(t);if(s==null){_f.warn("Attempted to add invalid keyboard binding",s);return}typeof e=="function"&&(e={handler:e}),typeof r=="function"&&(r={handler:r}),(Array.isArray(s.key)?s.key:[s.key]).forEach(a=>{const l={...s,key:a,...e,...r};this.bindings[l.key]=this.bindings[l.key]||[],this.bindings[l.key].push(l)})}listen(){this.quill.root.addEventListener("keydown",t=>{if(t.defaultPrevented||t.isComposing||t.keyCode===229&&(t.key==="Enter"||t.key==="Backspace"))return;const s=(this.bindings[t.key]||[]).concat(this.bindings[t.which]||[]).filter(E=>dr.match(t,E));if(s.length===0)return;const i=_.find(t.target,!0);if(i&&i.scroll!==this.quill.scroll)return;const a=this.quill.getSelection();if(a==null||!this.quill.hasFocus())return;const[l,u]=this.quill.getLine(a.index),[h,p]=this.quill.getLeaf(a.index),[b,d]=a.length===0?[h,p]:this.quill.getLeaf(a.index+a.length),g=h instanceof er?h.value().slice(0,p):"",m=b instanceof er?b.value().slice(d):"",v={collapsed:a.length===0,empty:a.length===0&&l.length()<=1,format:this.quill.getFormat(a),line:l,offset:u,prefix:g,suffix:m,event:t};s.some(E=>{if(E.collapsed!=null&&E.collapsed!==v.collapsed||E.empty!=null&&E.empty!==v.empty||E.offset!=null&&E.offset!==v.offset)return!1;if(Array.isArray(E.format)){if(E.format.every(T=>v.format[T]==null))return!1}else if(typeof E.format=="object"&&!Object.keys(E.format).every(T=>E.format[T]===!0?v.format[T]!=null:E.format[T]===!1?v.format[T]==null:Xs(E.format[T],v.format[T])))return!1;return E.prefix!=null&&!E.prefix.test(v.prefix)||E.suffix!=null&&!E.suffix.test(v.suffix)?!1:E.handler.call(this,a,v,E)!==!0})&&t.preventDefault()})}handleBackspace(t,e){const r=/[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(e.prefix)?2:1;if(t.index===0||this.quill.getLength()<=1)return;let s={};const[i]=this.quill.getLine(t.index);let a=new L().retain(t.index-r).delete(r);if(e.offset===0){const[l]=this.quill.getLine(t.index-1);if(l&&!(l.statics.blotName==="block"&&l.length()<=1)){const h=i.formats(),p=this.quill.getFormat(t.index-1,1);if(s=nt.AttributeMap.diff(h,p)||{},Object.keys(s).length>0){const b=new L().retain(t.index+i.length()-2).retain(1,s);a=a.compose(b)}}}this.quill.updateContents(a,_.sources.USER),this.quill.focus()}handleDelete(t,e){const r=/^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(e.suffix)?2:1;if(t.index>=this.quill.getLength()-r)return;let s={};const[i]=this.quill.getLine(t.index);let a=new L().retain(t.index).delete(r);if(e.offset>=i.length()-1){const[l]=this.quill.getLine(t.index+1);if(l){const u=i.formats(),h=this.quill.getFormat(t.index,1);s=nt.AttributeMap.diff(u,h)||{},Object.keys(s).length>0&&(a=a.retain(l.length()-1).retain(1,s))}}this.quill.updateContents(a,_.sources.USER),this.quill.focus()}handleDeleteRange(t){ii({range:t,quill:this.quill}),this.quill.focus()}handleEnter(t,e){const r=Object.keys(e.format).reduce((i,a)=>(this.quill.scroll.query(a,S.BLOCK)&&!Array.isArray(e.format[a])&&(i[a]=e.format[a]),i),{}),s=new L().retain(t.index).delete(t.length).insert(`
`,r);this.quill.updateContents(s,_.sources.USER),this.quill.setSelection(t.index+1,_.sources.SILENT),this.quill.focus()}}const Of={bindings:{bold:vs("bold"),italic:vs("italic"),underline:vs("underline"),indent:{key:"Tab",format:["blockquote","indent","list"],handler(n,t){return t.collapsed&&t.offset!==0?!0:(this.quill.format("indent","+1",_.sources.USER),!1)}},outdent:{key:"Tab",shiftKey:!0,format:["blockquote","indent","list"],handler(n,t){return t.collapsed&&t.offset!==0?!0:(this.quill.format("indent","-1",_.sources.USER),!1)}},"outdent backspace":{key:"Backspace",collapsed:!0,shiftKey:null,metaKey:null,ctrlKey:null,altKey:null,format:["indent","list"],offset:0,handler(n,t){t.format.indent!=null?this.quill.format("indent","-1",_.sources.USER):t.format.list!=null&&this.quill.format("list",!1,_.sources.USER)}},"indent code-block":Xi(!0),"outdent code-block":Xi(!1),"remove tab":{key:"Tab",shiftKey:!0,collapsed:!0,prefix:/\t$/,handler(n){this.quill.deleteText(n.index-1,1,_.sources.USER)}},tab:{key:"Tab",handler(n,t){if(t.format.table)return!0;this.quill.history.cutoff();const e=new L().retain(n.index).delete(n.length).insert("	");return this.quill.updateContents(e,_.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(n.index+1,_.sources.SILENT),!1}},"blockquote empty enter":{key:"Enter",collapsed:!0,format:["blockquote"],empty:!0,handler(){this.quill.format("blockquote",!1,_.sources.USER)}},"list empty enter":{key:"Enter",collapsed:!0,format:["list"],empty:!0,handler(n,t){const e={list:!1};t.format.indent&&(e.indent=!1),this.quill.formatLine(n.index,n.length,e,_.sources.USER)}},"checklist enter":{key:"Enter",collapsed:!0,format:{list:"checked"},handler(n){const[t,e]=this.quill.getLine(n.index),r={...t.formats(),list:"checked"},s=new L().retain(n.index).insert(`
`,r).retain(t.length()-e-1).retain(1,{list:"unchecked"});this.quill.updateContents(s,_.sources.USER),this.quill.setSelection(n.index+1,_.sources.SILENT),this.quill.scrollSelectionIntoView()}},"header enter":{key:"Enter",collapsed:!0,format:["header"],suffix:/^$/,handler(n,t){const[e,r]=this.quill.getLine(n.index),s=new L().retain(n.index).insert(`
`,t.format).retain(e.length()-r-1).retain(1,{header:null});this.quill.updateContents(s,_.sources.USER),this.quill.setSelection(n.index+1,_.sources.SILENT),this.quill.scrollSelectionIntoView()}},"table backspace":{key:"Backspace",format:["table"],collapsed:!0,offset:0,handler(){}},"table delete":{key:"Delete",format:["table"],collapsed:!0,suffix:/^$/,handler(){}},"table enter":{key:"Enter",shiftKey:null,format:["table"],handler(n){const t=this.quill.getModule("table");if(t){const[e,r,s,i]=t.getTable(n),a=Sf(e,r,s,i);if(a==null)return;let l=e.offset();if(a<0){const u=new L().retain(l).insert(`
`);this.quill.updateContents(u,_.sources.USER),this.quill.setSelection(n.index+1,n.length,_.sources.SILENT)}else if(a>0){l+=e.length();const u=new L().retain(l).insert(`
`);this.quill.updateContents(u,_.sources.USER),this.quill.setSelection(l,_.sources.USER)}}}},"table tab":{key:"Tab",shiftKey:null,format:["table"],handler(n,t){const{event:e,line:r}=t,s=r.offset(this.quill.scroll);e.shiftKey?this.quill.setSelection(s-1,_.sources.USER):this.quill.setSelection(s+r.length(),_.sources.USER)}},"list autofill":{key:" ",shiftKey:null,collapsed:!0,format:{"code-block":!1,blockquote:!1,table:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler(n,t){if(this.quill.scroll.query("list")==null)return!0;const{length:e}=t.prefix,[r,s]=this.quill.getLine(n.index);if(s>e)return!0;let i;switch(t.prefix.trim()){case"[]":case"[ ]":i="unchecked";break;case"[x]":i="checked";break;case"-":case"*":i="bullet";break;default:i="ordered"}this.quill.insertText(n.index," ",_.sources.USER),this.quill.history.cutoff();const a=new L().retain(n.index-s).delete(e+1).retain(r.length()-2-s).retain(1,{list:i});return this.quill.updateContents(a,_.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(n.index-e,_.sources.SILENT),!1}},"code exit":{key:"Enter",collapsed:!0,format:["code-block"],prefix:/^$/,suffix:/^\s*$/,handler(n){const[t,e]=this.quill.getLine(n.index);let r=2,s=t;for(;s!=null&&s.length()<=1&&s.formats()["code-block"];)if(s=s.prev,r-=1,r<=0){const i=new L().retain(n.index+t.length()-e-2).retain(1,{"code-block":null}).delete(1);return this.quill.updateContents(i,_.sources.USER),this.quill.setSelection(n.index-1,_.sources.SILENT),!1}return!0}},"embed left":Xn("ArrowLeft",!1),"embed left shift":Xn("ArrowLeft",!0),"embed right":Xn("ArrowRight",!1),"embed right shift":Xn("ArrowRight",!0),"table down":Yi(!1),"table up":Yi(!0)}};dr.DEFAULTS=Of;function Xi(n){return{key:"Tab",shiftKey:!n,format:{"code-block":!0},handler(t,e){let{event:r}=e;const s=this.quill.scroll.query("code-block"),{TAB:i}=s;if(t.length===0&&!r.shiftKey){this.quill.insertText(t.index,i,_.sources.USER),this.quill.setSelection(t.index+i.length,_.sources.SILENT);return}const a=t.length===0?this.quill.getLines(t.index,1):this.quill.getLines(t);let{index:l,length:u}=t;a.forEach((h,p)=>{n?(h.insertAt(0,i),p===0?l+=i.length:u+=i.length):h.domNode.textContent.startsWith(i)&&(h.deleteAt(0,i.length),p===0?l-=i.length:u-=i.length)}),this.quill.update(_.sources.USER),this.quill.setSelection(l,u,_.sources.SILENT)}}}function Xn(n,t){return{key:n,shiftKey:t,altKey:null,[n==="ArrowLeft"?"prefix":"suffix"]:/^$/,handler(r){let{index:s}=r;n==="ArrowRight"&&(s+=r.length+1);const[i]=this.quill.getLeaf(s);return i instanceof bt?(n==="ArrowLeft"?t?this.quill.setSelection(r.index-1,r.length+1,_.sources.USER):this.quill.setSelection(r.index-1,_.sources.USER):t?this.quill.setSelection(r.index,r.length+1,_.sources.USER):this.quill.setSelection(r.index+r.length+1,_.sources.USER),!1):!0}}}function vs(n){return{key:n[0],shortKey:!0,handler(t,e){this.quill.format(n,!e.format[n],_.sources.USER)}}}function Yi(n){return{key:n?"ArrowUp":"ArrowDown",collapsed:!0,format:["table"],handler(t,e){const r=n?"prev":"next",s=e.line,i=s.parent[r];if(i!=null){if(i.statics.blotName==="table-row"){let a=i.children.head,l=s;for(;l.prev!=null;)l=l.prev,a=a.next;const u=a.offset(this.quill.scroll)+Math.min(e.offset,a.length()-1);this.quill.setSelection(u,0,_.sources.USER)}}else{const a=s.table()[r];a!=null&&(n?this.quill.setSelection(a.offset(this.quill.scroll)+a.length()-1,0,_.sources.USER):this.quill.setSelection(a.offset(this.quill.scroll),0,_.sources.USER))}return!1}}}function Lf(n){if(typeof n=="string"||typeof n=="number")n={key:n};else if(typeof n=="object")n=Le(n);else return null;return n.shortKey&&(n[wf]=n.shortKey,delete n.shortKey),n}function ii(n){let{quill:t,range:e}=n;const r=t.getLines(e);let s={};if(r.length>1){const i=r[0].formats(),a=r[r.length-1].formats();s=nt.AttributeMap.diff(a,i)||{}}t.deleteText(e,_.sources.USER),Object.keys(s).length>0&&t.formatLine(e.index,1,s,_.sources.USER),t.setSelection(e.index,_.sources.SILENT)}function Sf(n,t,e,r){return t.prev==null&&t.next==null?e.prev==null&&e.next==null?r===0?-1:1:e.prev==null?-1:1:t.prev==null?-1:t.next==null?1:null}const Cf=/font-weight:\s*normal/,xf=["P","OL","UL"],Zi=n=>n&&xf.includes(n.tagName),If=n=>{Array.from(n.querySelectorAll("br")).filter(t=>Zi(t.previousElementSibling)&&Zi(t.nextElementSibling)).forEach(t=>{var e;(e=t.parentNode)==null||e.removeChild(t)})},Rf=n=>{Array.from(n.querySelectorAll('b[style*="font-weight"]')).filter(t=>{var e;return(e=t.getAttribute("style"))==null?void 0:e.match(Cf)}).forEach(t=>{var r;const e=n.createDocumentFragment();e.append(...t.childNodes),(r=t.parentNode)==null||r.replaceChild(e,t)})};function Bf(n){n.querySelector('[id^="docs-internal-guid-"]')&&(Rf(n),If(n))}const Mf=/\bmso-list:[^;]*ignore/i,jf=/\bmso-list:[^;]*\bl(\d+)/i,$f=/\bmso-list:[^;]*\blevel(\d+)/i,Pf=(n,t)=>{const e=n.getAttribute("style"),r=e==null?void 0:e.match(jf);if(!r)return null;const s=Number(r[1]),i=e==null?void 0:e.match($f),a=i?Number(i[1]):1,l=new RegExp(`@list l${s}:level${a}\\s*\\{[^\\}]*mso-level-number-format:\\s*([\\w-]+)`,"i"),u=t.match(l),h=u&&u[1]==="bullet"?"bullet":"ordered";return{id:s,indent:a,type:h,element:n}},Df=n=>{var a,l;const t=Array.from(n.querySelectorAll("[style*=mso-list]")),e=[],r=[];t.forEach(u=>{(u.getAttribute("style")||"").match(Mf)?e.push(u):r.push(u)}),e.forEach(u=>{var h;return(h=u.parentNode)==null?void 0:h.removeChild(u)});const s=n.documentElement.innerHTML,i=r.map(u=>Pf(u,s)).filter(u=>u);for(;i.length;){const u=[];let h=i.shift();for(;h;)u.push(h),h=i.length&&((a=i[0])==null?void 0:a.element)===h.element.nextElementSibling&&i[0].id===h.id?i.shift():null;const p=document.createElement("ul");u.forEach(g=>{const m=document.createElement("li");m.setAttribute("data-list",g.type),g.indent>1&&m.setAttribute("class",`ql-indent-${g.indent-1}`),m.innerHTML=g.element.innerHTML,p.appendChild(m)});const b=(l=u[0])==null?void 0:l.element,{parentNode:d}=b??{};b&&(d==null||d.replaceChild(p,b)),u.slice(1).forEach(g=>{let{element:m}=g;d==null||d.removeChild(m)})}};function qf(n){n.documentElement.getAttribute("xmlns:w")==="urn:schemas-microsoft-com:office:word"&&Df(n)}const kf=[qf,Bf],Uf=n=>{n.documentElement&&kf.forEach(t=>{t(n)})},Ff=Vt("quill:clipboard"),zf=[[Node.TEXT_NODE,ed],[Node.TEXT_NODE,Qi],["br",Vf],[Node.ELEMENT_NODE,Qi],[Node.ELEMENT_NODE,Wf],[Node.ELEMENT_NODE,Gf],[Node.ELEMENT_NODE,Qf],["li",Zf],["ol, ul",Jf],["pre",Xf],["tr",td],["b",Es("bold")],["i",Es("italic")],["strike",Es("strike")],["style",Yf]],Kf=[gf,vf].reduce((n,t)=>(n[t.keyName]=t,n),{}),Ji=[mf,yf,bf,Ef,Tf,Af].reduce((n,t)=>(n[t.keyName]=t,n),{});class Yo extends Dt{constructor(t,e){super(t,e),this.quill.root.addEventListener("copy",r=>this.onCaptureCopy(r,!1)),this.quill.root.addEventListener("cut",r=>this.onCaptureCopy(r,!0)),this.quill.root.addEventListener("paste",this.onCapturePaste.bind(this)),this.matchers=[],zf.concat(this.options.matchers??[]).forEach(r=>{let[s,i]=r;this.addMatcher(s,i)})}addMatcher(t,e){this.matchers.push([t,e])}convert(t){let{html:e,text:r}=t,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(s[_t.blotName])return new L().insert(r||"",{[_t.blotName]:s[_t.blotName]});if(!e)return new L().insert(r||"",s);const i=this.convertHTML(e);return mn(i,`
`)&&(i.ops[i.ops.length-1].attributes==null||s.table)?i.compose(new L().retain(i.length()-1).delete(1)):i}normalizeHTML(t){Uf(t)}convertHTML(t){const e=new DOMParser().parseFromString(t,"text/html");this.normalizeHTML(e);const r=e.body,s=new WeakMap,[i,a]=this.prepareMatching(r,s);return Jo(this.quill.scroll,r,i,a,s)}dangerouslyPasteHTML(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:_.sources.API;if(typeof t=="string"){const s=this.convert({html:t,text:""});this.quill.setContents(s,e),this.quill.setSelection(0,_.sources.SILENT)}else{const s=this.convert({html:e,text:""});this.quill.updateContents(new L().retain(t).concat(s),r),this.quill.setSelection(t+s.length(),_.sources.SILENT)}}onCaptureCopy(t){var a,l;let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(t.defaultPrevented)return;t.preventDefault();const[r]=this.quill.selection.getRange();if(r==null)return;const{html:s,text:i}=this.onCopy(r,e);(a=t.clipboardData)==null||a.setData("text/plain",i),(l=t.clipboardData)==null||l.setData("text/html",s),e&&ii({range:r,quill:this.quill})}normalizeURIList(t){return t.split(/\r?\n/).filter(e=>e[0]!=="#").join(`
`)}onCapturePaste(t){var a,l,u,h,p;if(t.defaultPrevented||!this.quill.isEnabled())return;t.preventDefault();const e=this.quill.getSelection(!0);if(e==null)return;const r=(a=t.clipboardData)==null?void 0:a.getData("text/html");let s=(l=t.clipboardData)==null?void 0:l.getData("text/plain");if(!r&&!s){const b=(u=t.clipboardData)==null?void 0:u.getData("text/uri-list");b&&(s=this.normalizeURIList(b))}const i=Array.from(((h=t.clipboardData)==null?void 0:h.files)||[]);if(!r&&i.length>0){this.quill.uploader.upload(e,i);return}if(r&&i.length>0){const b=new DOMParser().parseFromString(r,"text/html");if(b.body.childElementCount===1&&((p=b.body.firstElementChild)==null?void 0:p.tagName)==="IMG"){this.quill.uploader.upload(e,i);return}}this.onPaste(e,{html:r,text:s})}onCopy(t){const e=this.quill.getText(t);return{html:this.quill.getSemanticHTML(t),text:e}}onPaste(t,e){let{text:r,html:s}=e;const i=this.quill.getFormat(t.index),a=this.convert({text:r,html:s},i);Ff.log("onPaste",a,{text:r,html:s});const l=new L().retain(t.index).delete(t.length).concat(a);this.quill.updateContents(l,_.sources.USER),this.quill.setSelection(l.length()-t.length,_.sources.SILENT),this.quill.scrollSelectionIntoView()}prepareMatching(t,e){const r=[],s=[];return this.matchers.forEach(i=>{const[a,l]=i;switch(a){case Node.TEXT_NODE:s.push(l);break;case Node.ELEMENT_NODE:r.push(l);break;default:Array.from(t.querySelectorAll(a)).forEach(u=>{if(e.has(u)){const h=e.get(u);h==null||h.push(l)}else e.set(u,[l])});break}}),[r,s]}}B(Yo,"DEFAULTS",{matchers:[]});function ue(n,t,e,r){return r.query(t)?n.reduce((s,i)=>{if(!i.insert)return s;if(i.attributes&&i.attributes[t])return s.push(i);const a=e?{[t]:e}:{};return s.insert(i.insert,{...a,...i.attributes})},new L):n}function mn(n,t){let e="";for(let r=n.ops.length-1;r>=0&&e.length<t.length;--r){const s=n.ops[r];if(typeof s.insert!="string")break;e=s.insert+e}return e.slice(-1*t.length)===t}function Kt(n,t){if(!(n instanceof Element))return!1;const e=t.query(n);return e&&e.prototype instanceof bt?!1:["address","article","blockquote","canvas","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","iframe","li","main","nav","ol","output","p","pre","section","table","td","tr","ul","video"].includes(n.tagName.toLowerCase())}function Hf(n,t){return n.previousElementSibling&&n.nextElementSibling&&!Kt(n.previousElementSibling,t)&&!Kt(n.nextElementSibling,t)}const Yn=new WeakMap;function Zo(n){return n==null?!1:(Yn.has(n)||(n.tagName==="PRE"?Yn.set(n,!0):Yn.set(n,Zo(n.parentNode))),Yn.get(n))}function Jo(n,t,e,r,s){return t.nodeType===t.TEXT_NODE?r.reduce((i,a)=>a(t,i,n),new L):t.nodeType===t.ELEMENT_NODE?Array.from(t.childNodes||[]).reduce((i,a)=>{let l=Jo(n,a,e,r,s);return a.nodeType===t.ELEMENT_NODE&&(l=e.reduce((u,h)=>h(a,u,n),l),l=(s.get(a)||[]).reduce((u,h)=>h(a,u,n),l)),i.concat(l)},new L):new L}function Es(n){return(t,e,r)=>ue(e,n,!0,r)}function Gf(n,t,e){const r=wt.keys(n),s=Pt.keys(n),i=Wt.keys(n),a={};return r.concat(s).concat(i).forEach(l=>{let u=e.query(l,S.ATTRIBUTE);u!=null&&(a[u.attrName]=u.value(n),a[u.attrName])||(u=Kf[l],u!=null&&(u.attrName===l||u.keyName===l)&&(a[u.attrName]=u.value(n)||void 0),u=Ji[l],u!=null&&(u.attrName===l||u.keyName===l)&&(u=Ji[l],a[u.attrName]=u.value(n)||void 0))}),Object.entries(a).reduce((l,u)=>{let[h,p]=u;return ue(l,h,p,e)},t)}function Wf(n,t,e){const r=e.query(n);if(r==null)return t;if(r.prototype instanceof bt){const s={},i=r.value(n);if(i!=null)return s[r.blotName]=i,new L().insert(s,r.formats(n,e))}else if(r.prototype instanceof ln&&!mn(t,`
`)&&t.insert(`
`),"blotName"in r&&"formats"in r&&typeof r.formats=="function")return ue(t,r.blotName,r.formats(n,e),e);return t}function Vf(n,t){return mn(t,`
`)||t.insert(`
`),t}function Xf(n,t,e){const r=e.query("code-block"),s=r&&"formats"in r&&typeof r.formats=="function"?r.formats(n,e):!0;return ue(t,"code-block",s,e)}function Yf(){return new L}function Zf(n,t,e){const r=e.query(n);if(r==null||r.blotName!=="list"||!mn(t,`
`))return t;let s=-1,i=n.parentNode;for(;i!=null;)["OL","UL"].includes(i.tagName)&&(s+=1),i=i.parentNode;return s<=0?t:t.reduce((a,l)=>l.insert?l.attributes&&typeof l.attributes.indent=="number"?a.push(l):a.insert(l.insert,{indent:s,...l.attributes||{}}):a,new L)}function Jf(n,t,e){const r=n;let s=r.tagName==="OL"?"ordered":"bullet";const i=r.getAttribute("data-checked");return i&&(s=i==="true"?"checked":"unchecked"),ue(t,"list",s,e)}function Qi(n,t,e){if(!mn(t,`
`)){if(Kt(n,e)&&(n.childNodes.length>0||n instanceof HTMLParagraphElement))return t.insert(`
`);if(t.length()>0&&n.nextSibling){let r=n.nextSibling;for(;r!=null;){if(Kt(r,e))return t.insert(`
`);const s=e.query(r);if(s&&s.prototype instanceof gt)return t.insert(`
`);r=r.firstChild}}}return t}function Qf(n,t,e){var i;const r={},s=n.style||{};return s.fontStyle==="italic"&&(r.italic=!0),s.textDecoration==="underline"&&(r.underline=!0),s.textDecoration==="line-through"&&(r.strike=!0),((i=s.fontWeight)!=null&&i.startsWith("bold")||parseInt(s.fontWeight,10)>=700)&&(r.bold=!0),t=Object.entries(r).reduce((a,l)=>{let[u,h]=l;return ue(a,u,h,e)},t),parseFloat(s.textIndent||0)>0?new L().insert("	").concat(t):t}function td(n,t,e){var s,i;const r=((s=n.parentElement)==null?void 0:s.tagName)==="TABLE"?n.parentElement:(i=n.parentElement)==null?void 0:i.parentElement;if(r!=null){const l=Array.from(r.querySelectorAll("tr")).indexOf(n)+1;return ue(t,"table",l,e)}return t}function ed(n,t,e){var s;let r=n.data;if(((s=n.parentElement)==null?void 0:s.tagName)==="O:P")return t.insert(r.trim());if(!Zo(n)){if(r.trim().length===0&&r.includes(`
`)&&!Hf(n,e))return t;const i=(a,l)=>{const u=l.replace(/[^\u00a0]/g,"");return u.length<1&&a?" ":u};r=r.replace(/\r\n/g," ").replace(/\n/g," "),r=r.replace(/\s\s+/g,i.bind(i,!0)),(n.previousSibling==null&&n.parentElement!=null&&Kt(n.parentElement,e)||n.previousSibling instanceof Element&&Kt(n.previousSibling,e))&&(r=r.replace(/^\s+/,i.bind(i,!1))),(n.nextSibling==null&&n.parentElement!=null&&Kt(n.parentElement,e)||n.nextSibling instanceof Element&&Kt(n.nextSibling,e))&&(r=r.replace(/\s+$/,i.bind(i,!1)))}return t.insert(r)}class Qo extends Dt{constructor(e,r){super(e,r);B(this,"lastRecorded",0);B(this,"ignoreChange",!1);B(this,"stack",{undo:[],redo:[]});B(this,"currentRange",null);this.quill.on(_.events.EDITOR_CHANGE,(s,i,a,l)=>{s===_.events.SELECTION_CHANGE?i&&l!==_.sources.SILENT&&(this.currentRange=i):s===_.events.TEXT_CHANGE&&(this.ignoreChange||(!this.options.userOnly||l===_.sources.USER?this.record(i,a):this.transform(i)),this.currentRange=qs(this.currentRange,i))}),this.quill.keyboard.addBinding({key:"z",shortKey:!0},this.undo.bind(this)),this.quill.keyboard.addBinding({key:["z","Z"],shortKey:!0,shiftKey:!0},this.redo.bind(this)),/Win/i.test(navigator.platform)&&this.quill.keyboard.addBinding({key:"y",shortKey:!0},this.redo.bind(this)),this.quill.root.addEventListener("beforeinput",s=>{s.inputType==="historyUndo"?(this.undo(),s.preventDefault()):s.inputType==="historyRedo"&&(this.redo(),s.preventDefault())})}change(e,r){if(this.stack[e].length===0)return;const s=this.stack[e].pop();if(!s)return;const i=this.quill.getContents(),a=s.delta.invert(i);this.stack[r].push({delta:a,range:qs(s.range,a)}),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(s.delta,_.sources.USER),this.ignoreChange=!1,this.restoreSelection(s)}clear(){this.stack={undo:[],redo:[]}}cutoff(){this.lastRecorded=0}record(e,r){if(e.ops.length===0)return;this.stack.redo=[];let s=e.invert(r),i=this.currentRange;const a=Date.now();if(this.lastRecorded+this.options.delay>a&&this.stack.undo.length>0){const l=this.stack.undo.pop();l&&(s=s.compose(l.delta),i=l.range)}else this.lastRecorded=a;s.length()!==0&&(this.stack.undo.push({delta:s,range:i}),this.stack.undo.length>this.options.maxStack&&this.stack.undo.shift())}redo(){this.change("redo","undo")}transform(e){to(this.stack.undo,e),to(this.stack.redo,e)}undo(){this.change("undo","redo")}restoreSelection(e){if(e.range)this.quill.setSelection(e.range,_.sources.USER);else{const r=rd(this.quill.scroll,e.delta);this.quill.setSelection(r,_.sources.USER)}}}B(Qo,"DEFAULTS",{delay:1e3,maxStack:100,userOnly:!1});function to(n,t){let e=t;for(let r=n.length-1;r>=0;r-=1){const s=n[r];n[r]={delta:e.transform(s.delta,!0),range:s.range&&qs(s.range,e)},e=s.delta.transform(e),n[r].delta.length()===0&&n.splice(r,1)}}function nd(n,t){const e=t.ops[t.ops.length-1];return e==null?!1:e.insert!=null?typeof e.insert=="string"&&e.insert.endsWith(`
`):e.attributes!=null?Object.keys(e.attributes).some(r=>n.query(r,S.BLOCK)!=null):!1}function rd(n,t){const e=t.reduce((s,i)=>s+(i.delete||0),0);let r=t.length()-e;return nd(n,t)&&(r-=1),r}function qs(n,t){if(!n)return n;const e=t.transformPosition(n.index),r=t.transformPosition(n.index+n.length);return{index:e,length:r-e}}class ta extends Dt{constructor(t,e){super(t,e),t.root.addEventListener("drop",r=>{var a;r.preventDefault();let s=null;if(document.caretRangeFromPoint)s=document.caretRangeFromPoint(r.clientX,r.clientY);else if(document.caretPositionFromPoint){const l=document.caretPositionFromPoint(r.clientX,r.clientY);s=document.createRange(),s.setStart(l.offsetNode,l.offset),s.setEnd(l.offsetNode,l.offset)}const i=s&&t.selection.normalizeNative(s);if(i){const l=t.selection.normalizedToRange(i);(a=r.dataTransfer)!=null&&a.files&&this.upload(l,r.dataTransfer.files)}})}upload(t,e){const r=[];Array.from(e).forEach(s=>{var i;s&&((i=this.options.mimetypes)!=null&&i.includes(s.type))&&r.push(s)}),r.length>0&&this.options.handler.call(this,t,r)}}ta.DEFAULTS={mimetypes:["image/png","image/jpeg"],handler(n,t){if(!this.quill.scroll.query("image"))return;const e=t.map(r=>new Promise(s=>{const i=new FileReader;i.onload=()=>{s(i.result)},i.readAsDataURL(r)}));Promise.all(e).then(r=>{const s=r.reduce((i,a)=>i.insert({image:a}),new L().retain(n.index).delete(n.length));this.quill.updateContents(s,x.sources.USER),this.quill.setSelection(n.index+r.length,x.sources.SILENT)})}};const sd=["insertText","insertReplacementText"];class id extends Dt{constructor(t,e){super(t,e),t.root.addEventListener("beforeinput",r=>{this.handleBeforeInput(r)}),/Android/i.test(navigator.userAgent)||t.on(_.events.COMPOSITION_BEFORE_START,()=>{this.handleCompositionStart()})}deleteRange(t){ii({range:t,quill:this.quill})}replaceText(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(t.length===0)return!1;if(e){const r=this.quill.getFormat(t.index,1);this.deleteRange(t),this.quill.updateContents(new L().retain(t.index).insert(e,r),_.sources.USER)}else this.deleteRange(t);return this.quill.setSelection(t.index+e.length,0,_.sources.SILENT),!0}handleBeforeInput(t){if(this.quill.composition.isComposing||t.defaultPrevented||!sd.includes(t.inputType))return;const e=t.getTargetRanges?t.getTargetRanges()[0]:null;if(!e||e.collapsed===!0)return;const r=od(t);if(r==null)return;const s=this.quill.selection.normalizeNative(e),i=s?this.quill.selection.normalizedToRange(s):null;i&&this.replaceText(i,r)&&t.preventDefault()}handleCompositionStart(){const t=this.quill.getSelection();t&&this.replaceText(t)}}function od(n){var t;return typeof n.data=="string"?n.data:(t=n.dataTransfer)!=null&&t.types.includes("text/plain")?n.dataTransfer.getData("text/plain"):null}const ad=/Mac/i.test(navigator.platform),ld=100,ud=n=>!!(n.key==="ArrowLeft"||n.key==="ArrowRight"||n.key==="ArrowUp"||n.key==="ArrowDown"||n.key==="Home"||ad&&n.key==="a"&&n.ctrlKey===!0);class cd extends Dt{constructor(e,r){super(e,r);B(this,"isListening",!1);B(this,"selectionChangeDeadline",0);this.handleArrowKeys(),this.handleNavigationShortcuts()}handleArrowKeys(){this.quill.keyboard.addBinding({key:["ArrowLeft","ArrowRight"],offset:0,shiftKey:null,handler(e,r){let{line:s,event:i}=r;if(!(s instanceof mt)||!s.uiNode)return!0;const a=getComputedStyle(s.domNode).direction==="rtl";return a&&i.key!=="ArrowRight"||!a&&i.key!=="ArrowLeft"?!0:(this.quill.setSelection(e.index-1,e.length+(i.shiftKey?1:0),_.sources.USER),!1)}})}handleNavigationShortcuts(){this.quill.root.addEventListener("keydown",e=>{!e.defaultPrevented&&ud(e)&&this.ensureListeningToSelectionChange()})}ensureListeningToSelectionChange(){if(this.selectionChangeDeadline=Date.now()+ld,this.isListening)return;this.isListening=!0;const e=()=>{this.isListening=!1,Date.now()<=this.selectionChangeDeadline&&this.handleSelectionChange()};document.addEventListener("selectionchange",e,{once:!0})}handleSelectionChange(){const e=document.getSelection();if(!e)return;const r=e.getRangeAt(0);if(r.collapsed!==!0||r.startOffset!==0)return;const s=this.quill.scroll.find(r.startContainer);if(!(s instanceof mt)||!s.uiNode)return;const i=document.createRange();i.setStartAfter(s.uiNode),i.setEndAfter(s.uiNode),e.removeAllRanges(),e.addRange(i)}}_.register({"blots/block":st,"blots/block/embed":gt,"blots/break":St,"blots/container":ni,"blots/cursor":hn,"blots/embed":Go,"blots/inline":cn,"blots/scroll":Oe,"blots/text":Ot,"modules/clipboard":Yo,"modules/history":Qo,"modules/keyboard":dr,"modules/uploader":ta,"modules/input":id,"modules/uiNode":cd});const _d=Object.freeze(Object.defineProperty({__proto__:null,AttributeMap:nt.AttributeMap,Delta:L,Module:Dt,Op:nt.Op,Parchment:$o,Range:Re,default:_},Symbol.toStringTag,{value:"Module"}));export{yd as A,st as B,Pt as C,L as D,Go as E,Td as F,_d as G,cn as I,Dt as M,$o as P,_ as Q,Re as R,S,Ot as T,ni as a,bt as b,gt as c,hn as d,St as e,_t as f,Me as g,Zh as h,zo as i,sr as j,x as k,vf as l,nn as m,Vt as n,Ed as o,vd as p,Nd as q,Ad as r,mf as s,Jo as t,yf as u,bf as v,Ef as w,Tf as x,Af as y,Vo as z};
