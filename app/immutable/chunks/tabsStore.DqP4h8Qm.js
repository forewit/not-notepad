import{w as p}from"./entry.Ddy_nTT5.js";import{g as r}from"./scheduler.CIGC0wka.js";const c={'{"retain":':"⒜",'},{"delete":':"⒝",'}]},"range":{"index":':"⒞",',"length":':"⒟",'}]},"range":null':"⒠",'},{"delta":{"ops":[':"⒡",'"insert":':"⒢",'"attributes":{':"⒣",'"code":true':"⒤",'"code":false':"⒥",'"bold":true':"⒦",'"bold":false':"⒧",'"italic":true':"⒨",'"italic":false':"⒩",'"underline":true':"⒪",'"underline":false':"⒫",'"strike":true':"⒬",'"strike":false':"⒭"},b=Object.fromEntries(Object.entries(c).map(([t,e])=>[e,t]));function f(t,e){for(const[a,n]of Object.entries(e))t=t.split(a).join(n);return t}function v(){return crypto.randomUUID()}function g(t,e){let a;try{a=JSON.parse(e)}catch(n){throw n}if(!a||!a.title||!a.ops||!a.history)throw new Error("Invalid tab data!");h({id:t,data:a})}function I(){let t={};return Object.entries(r(d)).forEach(([e,a])=>{const n=JSON.stringify(a);t[e]=f(n,c)}),t}function u(t){Object.entries(t).forEach(([e,a])=>{const n=f(a,b);g(e,n)})}function h(t){const{id:e=v(),data:a={title:"Untitled",ops:[],history:{undo:[],redo:[]}},index:n=-1,callback:s=()=>{}}=t||{};d.update(l=>l[e]?(l[e]=a,l):(l[e]=a,n<0||n>r(o).order.length?o.update(i=>(i.order.push(e),i.activeIndex=i.order.length-1,i)):o.update(i=>(i.order.splice(n,0,e),i.activeIndex=n,i)),l)),s()}function m(t){r(d)[t]&&(d.update(e=>(delete e[t],e)),o.update(e=>{const a=e.order.indexOf(t);return a<0||(e.placeholderIndex==a&&(e.placeholderIndex=-1),e.order.splice(a,1),a==e.activeIndex-1?e.activeIndex=Math.max(0,a):e.activeIndex=Math.min(e.activeIndex,e.order.length-1)),e}))}function x(t){o.update(e=>(t<0?e.activeIndex=0:t>e.order.length?e.activeIndex=e.order.length-1:e.activeIndex=t,e))}function O(t){o.update(e=>(e.placeholderIndex=t===void 0||t<0||t>=e.order.length?-1:t,e))}function k(t,e,a=()=>{}){t!=e&&(o.update(n=>{if(t<0||t>=n.order.length||e<0||e>=n.order.length)return n;const s=n.order[t];return n.order.splice(t,1),n.order.splice(e,0,s),n.activeIndex==t&&(n.activeIndex=e),n.placeholderIndex==t&&(n.placeholderIndex=e),n}),a())}const j={loadPackedTabs:u,packTabs:I,newTab:h,removeTab:m,setActiveIndex:x,setPlaceholderIndex:O,moveTab:k},d=p({}),o=p({order:[],activeIndex:0,placeholderIndex:-1});export{j as a,o as m,d as t};
